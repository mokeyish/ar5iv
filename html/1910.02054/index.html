<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>ZeRO: Memory Optimizations Toward Training Trillion Parameter Models</title>
<!--Generated on Tue Jul 25 05:18:57 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dginev/ar5iv-css@0.7.6/css/ar5iv.min.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">ZeRO: Memory Optimizations Toward Training Trillion Parameter Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Samyam Rajbhandari<math id="id1.1.m1.1" class="ltx_Math" alttext="{}^{*}" display="inline"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">*</mo></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><times id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{}^{*}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">start_FLOATSUPERSCRIPT * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Jeff Rasley<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Equal Contributors</span></span></span>, Olatunji Ruwase, Yuxiong He 
<br class="ltx_break"><span id="id2.2.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{samyamr, jerasley, olruwase, yuxhe}@microsoft.com<span id="id2.2.id1.1" class="ltx_text" style="font-size:111%;"> </span></span>
</span></span>
</div>

<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Abstract</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Large deep learning models offer significant accuracy gains, but training billions to trillions of parameters is challenging. Existing solutions such as data and model parallelisms exhibit fundamental limitations to fit these models into limited device memory, while obtaining computation, communication and development efficiency.
We develop a novel solution, Zero Redundancy Optimizer (<em id="Sx1.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>), to optimize memory, vastly improving training speed while increasing the model size that can be efficiently trained.
<em id="Sx1.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> eliminates memory redundancies in data- and model-parallel training while retaining low communication volume and high computational granularity, allowing us to scale the model size proportional to the number of devices with sustained high efficiency. Our analysis on memory requirements and communication volume demonstrates: <em id="Sx1.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em> has the potential to scale beyond 1 <em id="Sx1.p1.1.4" class="ltx_emph ltx_font_italic">Trillion</em> parameters using todayâ€™s hardware.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">We implement and evaluate ZeRO: it trains large models of over 100B parameter with super-linear speedup on 400 GPUs, achieving throughput of 15 Petaflops. This represents an 8x increase in model size and 10x increase in achievable performance over state-of-the-art.
In terms of usability,
<em id="Sx1.p2.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> can train large models of up to 13B parameters (e.g., larger than Megatron GPT 8.3B and T5 11B) without requiring model parallelism which is harder for scientists to apply.
Last but not the least, researchers have used the system breakthroughs of <em id="Sx1.p2.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> to create the worldâ€™s largest language model (17B parameters) with record breaking accuracy.</p>
</div>
</section>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Extended Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Deep Learning (DL) models are becoming larger, and the increase in model size offers significant accuracy gain. In the area of Natural Language Processing (NLP), the transformers have paved way for large models like Bert-large (0.3B)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, GPT-2 (1.5B)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, Megatron-LM (8.3B)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, T5 (11B)Â <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. To enable the continuation of model size growth from 10s of billions to trillions of parameters, we experience the challenges of training them - they clearly do not fit within the memory of a single device, e.g., GPU or TPU, and simply adding more devices will not help scale the training.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Basic data parallelism (DP) does not reduce memory per device, and runs out of memory for models with more than 1.4B parameters on current generation of GPUs with 32â€‰GB memory. Other existing solutions such as Pipeline Parallelism (PP), Model Parallelism (MP), CPU-Offloading, etc, make trade-offs between functionality, usability, as well as memory and compute/communication efficiency, but all of which are crucial to training with speed and scale. </p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Among different existing solution for training large models, MP is perhaps the most promising. The largest models in the current literature, the 11B T5 model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, and Megatron-LM 8.3B <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, were both powered by model parallelism, implemented in Mesh-Tensorflow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and Megatron-LM<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, respectively. However, MP cannot scale much further beyond these models sizes. MP splits the model vertically, partitioning the computation and parameters in each layer across multiple devices, requiring significant communication between each layer. As a result, they work well within a single node where the inter-GPU communication bandwidth is high, but the efficiency degrades quickly beyond a single node <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. We tested a 40B parameter model using Megatron-LM across two DGX-2 nodes and observe about <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="5\,Tflops" display="inline"><semantics id="S1.p3.1.m1.1a"><mrow id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mn id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">5</mn><mo lspace="0.170em" id="S1.p3.1.m1.1.1.1" xref="S1.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">T</mi><mo id="S1.p3.1.m1.1.1.1a" xref="S1.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S1.p3.1.m1.1.1.4" xref="S1.p3.1.m1.1.1.4.cmml">f</mi><mo id="S1.p3.1.m1.1.1.1b" xref="S1.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S1.p3.1.m1.1.1.5" xref="S1.p3.1.m1.1.1.5.cmml">l</mi><mo id="S1.p3.1.m1.1.1.1c" xref="S1.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S1.p3.1.m1.1.1.6" xref="S1.p3.1.m1.1.1.6.cmml">o</mi><mo id="S1.p3.1.m1.1.1.1d" xref="S1.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S1.p3.1.m1.1.1.7" xref="S1.p3.1.m1.1.1.7.cmml">p</mi><mo id="S1.p3.1.m1.1.1.1e" xref="S1.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S1.p3.1.m1.1.1.8" xref="S1.p3.1.m1.1.1.8.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><times id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1"></times><cn type="integer" id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">5</cn><ci id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">ğ‘‡</ci><ci id="S1.p3.1.m1.1.1.4.cmml" xref="S1.p3.1.m1.1.1.4">ğ‘“</ci><ci id="S1.p3.1.m1.1.1.5.cmml" xref="S1.p3.1.m1.1.1.5">ğ‘™</ci><ci id="S1.p3.1.m1.1.1.6.cmml" xref="S1.p3.1.m1.1.1.6">ğ‘œ</ci><ci id="S1.p3.1.m1.1.1.7.cmml" xref="S1.p3.1.m1.1.1.7">ğ‘</ci><ci id="S1.p3.1.m1.1.1.8.cmml" xref="S1.p3.1.m1.1.1.8">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">5\,Tflops</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">5 italic_T italic_f italic_l italic_o italic_p italic_s</annotation></semantics></math> per V100 GPU (less than 5% of hardware peak).</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">So, how can we overcome the limitations of existing solutions and train large models more efficiently? To answer this question, we first analyze the full spectrum of memory consumption of the existing systems on model training and classify it into two parts: 1) For large models, the majority of the memory is occupied by <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">model states</em> which include the optimizer states (such as momentum and variances in AdamÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>), gradients, and parameters. 2) The remaining memory is consumed by activation, temporary buffers and unusable fragmented memory, which we refer to collectively as <em id="S1.p4.1.2" class="ltx_emph ltx_font_italic">residual</em> states.
We develop <em id="S1.p4.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>â€” Zero Redundancy Optimizer â€” to optimize memory efficiency on both while obtaining high compute and communication efficiency.
As these two parts face different challenges, we develop and discuss their solutions correspondingly.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p"><span id="S1.p5.1.1" class="ltx_text ltx_font_bold">Optimizing Model State Memory</span>
Model states often consume the largest amount of memory during training, but existing approaches such as DP and MP do not offer satisfying solution. DP has good compute/communication efficiency but poor memory efficiency while MP can have poor compute/communication efficiency. More specifically, DP replicates the entire model states across all data parallel process resulting in redundant memory consumption;
while MP partition these states to obtain high memory efficiency, but often result in too fine-grained computation and expensive communication that is less scaling efficient.
Furthermore, all of these approaches maintain all the model states required over the entire
training process statically, even though not all model states are required all the time during
the training.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.15.7.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.12.6" class="ltx_text" style="font-size:90%;">Comparing the per-device memory consumption of model states, with three stages of <em id="S1.F1.12.6.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP optimizations. <math id="S1.F1.7.1.m1.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S1.F1.7.1.m1.1b"><mi mathvariant="normal" id="S1.F1.7.1.m1.1.1" xref="S1.F1.7.1.m1.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S1.F1.7.1.m1.1c"><ci id="S1.F1.7.1.m1.1.1.cmml" xref="S1.F1.7.1.m1.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.1.m1.1d">\Psi</annotation><annotation encoding="application/x-llamapun" id="S1.F1.7.1.m1.1e">roman_Î¨</annotation></semantics></math> denotes model size (number of parameters), <math id="S1.F1.8.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S1.F1.8.2.m2.1b"><mi id="S1.F1.8.2.m2.1.1" xref="S1.F1.8.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.F1.8.2.m2.1c"><ci id="S1.F1.8.2.m2.1.1.cmml" xref="S1.F1.8.2.m2.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.2.m2.1d">K</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.2.m2.1e">italic_K</annotation></semantics></math> denotes the memory multiplier of optimizer states, and <math id="S1.F1.9.3.m3.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S1.F1.9.3.m3.1b"><msub id="S1.F1.9.3.m3.1.1" xref="S1.F1.9.3.m3.1.1.cmml"><mi id="S1.F1.9.3.m3.1.1.2" xref="S1.F1.9.3.m3.1.1.2.cmml">N</mi><mi id="S1.F1.9.3.m3.1.1.3" xref="S1.F1.9.3.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.9.3.m3.1c"><apply id="S1.F1.9.3.m3.1.1.cmml" xref="S1.F1.9.3.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.9.3.m3.1.1.1.cmml" xref="S1.F1.9.3.m3.1.1">subscript</csymbol><ci id="S1.F1.9.3.m3.1.1.2.cmml" xref="S1.F1.9.3.m3.1.1.2">ğ‘</ci><ci id="S1.F1.9.3.m3.1.1.3.cmml" xref="S1.F1.9.3.m3.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.9.3.m3.1d">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.9.3.m3.1e">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> denotes DP degree. In the example, we assume a model size of <math id="S1.F1.10.4.m4.1" class="ltx_Math" alttext="\Psi=7.5B" display="inline"><semantics id="S1.F1.10.4.m4.1b"><mrow id="S1.F1.10.4.m4.1.1" xref="S1.F1.10.4.m4.1.1.cmml"><mi mathvariant="normal" id="S1.F1.10.4.m4.1.1.2" xref="S1.F1.10.4.m4.1.1.2.cmml">Î¨</mi><mo id="S1.F1.10.4.m4.1.1.1" xref="S1.F1.10.4.m4.1.1.1.cmml">=</mo><mrow id="S1.F1.10.4.m4.1.1.3" xref="S1.F1.10.4.m4.1.1.3.cmml"><mn id="S1.F1.10.4.m4.1.1.3.2" xref="S1.F1.10.4.m4.1.1.3.2.cmml">7.5</mn><mo id="S1.F1.10.4.m4.1.1.3.1" xref="S1.F1.10.4.m4.1.1.3.1.cmml">â¢</mo><mi id="S1.F1.10.4.m4.1.1.3.3" xref="S1.F1.10.4.m4.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.10.4.m4.1c"><apply id="S1.F1.10.4.m4.1.1.cmml" xref="S1.F1.10.4.m4.1.1"><eq id="S1.F1.10.4.m4.1.1.1.cmml" xref="S1.F1.10.4.m4.1.1.1"></eq><ci id="S1.F1.10.4.m4.1.1.2.cmml" xref="S1.F1.10.4.m4.1.1.2">Î¨</ci><apply id="S1.F1.10.4.m4.1.1.3.cmml" xref="S1.F1.10.4.m4.1.1.3"><times id="S1.F1.10.4.m4.1.1.3.1.cmml" xref="S1.F1.10.4.m4.1.1.3.1"></times><cn type="float" id="S1.F1.10.4.m4.1.1.3.2.cmml" xref="S1.F1.10.4.m4.1.1.3.2">7.5</cn><ci id="S1.F1.10.4.m4.1.1.3.3.cmml" xref="S1.F1.10.4.m4.1.1.3.3">ğµ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.10.4.m4.1d">\Psi=7.5B</annotation><annotation encoding="application/x-llamapun" id="S1.F1.10.4.m4.1e">roman_Î¨ = 7.5 italic_B</annotation></semantics></math> and DP of <math id="S1.F1.11.5.m5.1" class="ltx_Math" alttext="N_{d}=64" display="inline"><semantics id="S1.F1.11.5.m5.1b"><mrow id="S1.F1.11.5.m5.1.1" xref="S1.F1.11.5.m5.1.1.cmml"><msub id="S1.F1.11.5.m5.1.1.2" xref="S1.F1.11.5.m5.1.1.2.cmml"><mi id="S1.F1.11.5.m5.1.1.2.2" xref="S1.F1.11.5.m5.1.1.2.2.cmml">N</mi><mi id="S1.F1.11.5.m5.1.1.2.3" xref="S1.F1.11.5.m5.1.1.2.3.cmml">d</mi></msub><mo id="S1.F1.11.5.m5.1.1.1" xref="S1.F1.11.5.m5.1.1.1.cmml">=</mo><mn id="S1.F1.11.5.m5.1.1.3" xref="S1.F1.11.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.11.5.m5.1c"><apply id="S1.F1.11.5.m5.1.1.cmml" xref="S1.F1.11.5.m5.1.1"><eq id="S1.F1.11.5.m5.1.1.1.cmml" xref="S1.F1.11.5.m5.1.1.1"></eq><apply id="S1.F1.11.5.m5.1.1.2.cmml" xref="S1.F1.11.5.m5.1.1.2"><csymbol cd="ambiguous" id="S1.F1.11.5.m5.1.1.2.1.cmml" xref="S1.F1.11.5.m5.1.1.2">subscript</csymbol><ci id="S1.F1.11.5.m5.1.1.2.2.cmml" xref="S1.F1.11.5.m5.1.1.2.2">ğ‘</ci><ci id="S1.F1.11.5.m5.1.1.2.3.cmml" xref="S1.F1.11.5.m5.1.1.2.3">ğ‘‘</ci></apply><cn type="integer" id="S1.F1.11.5.m5.1.1.3.cmml" xref="S1.F1.11.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.11.5.m5.1d">N_{d}=64</annotation><annotation encoding="application/x-llamapun" id="S1.F1.11.5.m5.1e">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 64</annotation></semantics></math> with <math id="S1.F1.12.6.m6.1" class="ltx_Math" alttext="K=12" display="inline"><semantics id="S1.F1.12.6.m6.1b"><mrow id="S1.F1.12.6.m6.1.1" xref="S1.F1.12.6.m6.1.1.cmml"><mi id="S1.F1.12.6.m6.1.1.2" xref="S1.F1.12.6.m6.1.1.2.cmml">K</mi><mo id="S1.F1.12.6.m6.1.1.1" xref="S1.F1.12.6.m6.1.1.1.cmml">=</mo><mn id="S1.F1.12.6.m6.1.1.3" xref="S1.F1.12.6.m6.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.12.6.m6.1c"><apply id="S1.F1.12.6.m6.1.1.cmml" xref="S1.F1.12.6.m6.1.1"><eq id="S1.F1.12.6.m6.1.1.1.cmml" xref="S1.F1.12.6.m6.1.1.1"></eq><ci id="S1.F1.12.6.m6.1.1.2.cmml" xref="S1.F1.12.6.m6.1.1.2">ğ¾</ci><cn type="integer" id="S1.F1.12.6.m6.1.1.3.cmml" xref="S1.F1.12.6.m6.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.12.6.m6.1d">K=12</annotation><annotation encoding="application/x-llamapun" id="S1.F1.12.6.m6.1e">italic_K = 12</annotation></semantics></math> based on mixed-precision training with Adam optimizer. </span></figcaption>
</figure>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Based on these observations, we develop <em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP, ZeRO-powered data parallelism, that achieves the computation/communication efficiency of DP while achieving memory efficiency of MP. <em id="S1.p6.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP removes the memory state redundancies across data-parallel processes by <em id="S1.p6.1.3" class="ltx_emph ltx_font_italic">partitioning</em> the model states instead of replicating them, and it retains the compute/communication efficiency by retaining the computational granularity and communication volume of DP using a dynamic communication schedule during training.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p"><em id="S1.p7.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP has three main optimization stages (as depicted in Figure <a href="#S1.F1" title="Figure 1 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), which correspond to the partitioning of optimizer states, gradients, and parameters. When enabled cumulatively:</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">1) Optimizer State Partitioning (<math id="S1.p8.1.m1.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S1.p8.1.m1.1a"><msub id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml"><mi id="S1.p8.1.m1.1.1.2" xref="S1.p8.1.m1.1.1.2.cmml">P</mi><mrow id="S1.p8.1.m1.1.1.3" xref="S1.p8.1.m1.1.1.3.cmml"><mi id="S1.p8.1.m1.1.1.3.2" xref="S1.p8.1.m1.1.1.3.2.cmml">o</mi><mo id="S1.p8.1.m1.1.1.3.1" xref="S1.p8.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S1.p8.1.m1.1.1.3.3" xref="S1.p8.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><apply id="S1.p8.1.m1.1.1.cmml" xref="S1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p8.1.m1.1.1.1.cmml" xref="S1.p8.1.m1.1.1">subscript</csymbol><ci id="S1.p8.1.m1.1.1.2.cmml" xref="S1.p8.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S1.p8.1.m1.1.1.3.cmml" xref="S1.p8.1.m1.1.1.3"><times id="S1.p8.1.m1.1.1.3.1.cmml" xref="S1.p8.1.m1.1.1.3.1"></times><ci id="S1.p8.1.m1.1.1.3.2.cmml" xref="S1.p8.1.m1.1.1.3.2">ğ‘œ</ci><ci id="S1.p8.1.m1.1.1.3.3.cmml" xref="S1.p8.1.m1.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S1.p8.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math>): 4x memory reduction, same communication volume as DP;</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">2) Add Gradient Partitioning (<math id="S1.p9.1.m1.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S1.p9.1.m1.1a"><msub id="S1.p9.1.m1.1.1" xref="S1.p9.1.m1.1.1.cmml"><mi id="S1.p9.1.m1.1.1.2" xref="S1.p9.1.m1.1.1.2.cmml">P</mi><mrow id="S1.p9.1.m1.1.1.3" xref="S1.p9.1.m1.1.1.3.cmml"><mrow id="S1.p9.1.m1.1.1.3.2" xref="S1.p9.1.m1.1.1.3.2.cmml"><mi id="S1.p9.1.m1.1.1.3.2.2" xref="S1.p9.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S1.p9.1.m1.1.1.3.2.1" xref="S1.p9.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S1.p9.1.m1.1.1.3.2.3" xref="S1.p9.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S1.p9.1.m1.1.1.3.1" xref="S1.p9.1.m1.1.1.3.1.cmml">+</mo><mi id="S1.p9.1.m1.1.1.3.3" xref="S1.p9.1.m1.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p9.1.m1.1b"><apply id="S1.p9.1.m1.1.1.cmml" xref="S1.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p9.1.m1.1.1.1.cmml" xref="S1.p9.1.m1.1.1">subscript</csymbol><ci id="S1.p9.1.m1.1.1.2.cmml" xref="S1.p9.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S1.p9.1.m1.1.1.3.cmml" xref="S1.p9.1.m1.1.1.3"><plus id="S1.p9.1.m1.1.1.3.1.cmml" xref="S1.p9.1.m1.1.1.3.1"></plus><apply id="S1.p9.1.m1.1.1.3.2.cmml" xref="S1.p9.1.m1.1.1.3.2"><times id="S1.p9.1.m1.1.1.3.2.1.cmml" xref="S1.p9.1.m1.1.1.3.2.1"></times><ci id="S1.p9.1.m1.1.1.3.2.2.cmml" xref="S1.p9.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S1.p9.1.m1.1.1.3.2.3.cmml" xref="S1.p9.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S1.p9.1.m1.1.1.3.3.cmml" xref="S1.p9.1.m1.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p9.1.m1.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S1.p9.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math>): 8x memory reduction, same communication volume as DP;</p>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.3" class="ltx_p">3) Add Parameter Partitioning (<math id="S1.p10.1.m1.1" class="ltx_Math" alttext="P_{os+g+p}" display="inline"><semantics id="S1.p10.1.m1.1a"><msub id="S1.p10.1.m1.1.1" xref="S1.p10.1.m1.1.1.cmml"><mi id="S1.p10.1.m1.1.1.2" xref="S1.p10.1.m1.1.1.2.cmml">P</mi><mrow id="S1.p10.1.m1.1.1.3" xref="S1.p10.1.m1.1.1.3.cmml"><mrow id="S1.p10.1.m1.1.1.3.2" xref="S1.p10.1.m1.1.1.3.2.cmml"><mi id="S1.p10.1.m1.1.1.3.2.2" xref="S1.p10.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S1.p10.1.m1.1.1.3.2.1" xref="S1.p10.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S1.p10.1.m1.1.1.3.2.3" xref="S1.p10.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S1.p10.1.m1.1.1.3.1" xref="S1.p10.1.m1.1.1.3.1.cmml">+</mo><mi id="S1.p10.1.m1.1.1.3.3" xref="S1.p10.1.m1.1.1.3.3.cmml">g</mi><mo id="S1.p10.1.m1.1.1.3.1a" xref="S1.p10.1.m1.1.1.3.1.cmml">+</mo><mi id="S1.p10.1.m1.1.1.3.4" xref="S1.p10.1.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p10.1.m1.1b"><apply id="S1.p10.1.m1.1.1.cmml" xref="S1.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p10.1.m1.1.1.1.cmml" xref="S1.p10.1.m1.1.1">subscript</csymbol><ci id="S1.p10.1.m1.1.1.2.cmml" xref="S1.p10.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S1.p10.1.m1.1.1.3.cmml" xref="S1.p10.1.m1.1.1.3"><plus id="S1.p10.1.m1.1.1.3.1.cmml" xref="S1.p10.1.m1.1.1.3.1"></plus><apply id="S1.p10.1.m1.1.1.3.2.cmml" xref="S1.p10.1.m1.1.1.3.2"><times id="S1.p10.1.m1.1.1.3.2.1.cmml" xref="S1.p10.1.m1.1.1.3.2.1"></times><ci id="S1.p10.1.m1.1.1.3.2.2.cmml" xref="S1.p10.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S1.p10.1.m1.1.1.3.2.3.cmml" xref="S1.p10.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S1.p10.1.m1.1.1.3.3.cmml" xref="S1.p10.1.m1.1.1.3.3">ğ‘”</ci><ci id="S1.p10.1.m1.1.1.3.4.cmml" xref="S1.p10.1.m1.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p10.1.m1.1c">P_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S1.p10.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g + italic_p end_POSTSUBSCRIPT</annotation></semantics></math>): Memory reduction is linear with DP degree <math id="S1.p10.2.m2.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S1.p10.2.m2.1a"><msub id="S1.p10.2.m2.1.1" xref="S1.p10.2.m2.1.1.cmml"><mi id="S1.p10.2.m2.1.1.2" xref="S1.p10.2.m2.1.1.2.cmml">N</mi><mi id="S1.p10.2.m2.1.1.3" xref="S1.p10.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p10.2.m2.1b"><apply id="S1.p10.2.m2.1.1.cmml" xref="S1.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p10.2.m2.1.1.1.cmml" xref="S1.p10.2.m2.1.1">subscript</csymbol><ci id="S1.p10.2.m2.1.1.2.cmml" xref="S1.p10.2.m2.1.1.2">ğ‘</ci><ci id="S1.p10.2.m2.1.1.3.cmml" xref="S1.p10.2.m2.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p10.2.m2.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S1.p10.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. For example, splitting across 64 GPUs (<math id="S1.p10.3.m3.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S1.p10.3.m3.1a"><msub id="S1.p10.3.m3.1.1" xref="S1.p10.3.m3.1.1.cmml"><mi id="S1.p10.3.m3.1.1.2" xref="S1.p10.3.m3.1.1.2.cmml">N</mi><mi id="S1.p10.3.m3.1.1.3" xref="S1.p10.3.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p10.3.m3.1b"><apply id="S1.p10.3.m3.1.1.cmml" xref="S1.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p10.3.m3.1.1.1.cmml" xref="S1.p10.3.m3.1.1">subscript</csymbol><ci id="S1.p10.3.m3.1.1.2.cmml" xref="S1.p10.3.m3.1.1.2">ğ‘</ci><ci id="S1.p10.3.m3.1.1.3.cmml" xref="S1.p10.3.m3.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p10.3.m3.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S1.p10.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> = 64) will yield a 64x memory reduction. There is a modest 50% increase in communication volume.</p>
</div>
<div id="S1.p11" class="ltx_para">
<p id="S1.p11.1" class="ltx_p">ZeRO-DP eliminates memory redundancies and makes the full aggregate memory capacity of a cluster available. With all three stages enabled, ZeRO can train a trillion-parameter model on just 1024 NVIDIA GPUs. A trillion-parameter model with an optimizer like AdamÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> in 16-bit precision requires approximately 16 terabytes (TB) of memory to hold the optimizer states, gradients, and parameters. 16TB divided by 1024 is 16GB, which is well within a reasonable bound for a GPU (e.g., with 32GB of on-device memory).</p>
</div>
<div id="S1.p12" class="ltx_para">
<p id="S1.p12.1" class="ltx_p"><span id="S1.p12.1.1" class="ltx_text ltx_font_bold">Optimizing Residual State Memory</span>
After <em id="S1.p12.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP boosts memory efficiency for model states, the rest of the memory consumed by activations, temporary buffers, and unusable memory fragments could become a secondary memory bottleneck. We develop <em id="S1.p12.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>-R to optimize the residual memory consumed by these three factors respectively.</p>
</div>
<div id="S1.p13" class="ltx_para">
<p id="S1.p13.1" class="ltx_p">1) For activations (stored from forward pass in order to perform backward pass), we noticed checkpointing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> helps but not sufficient for large models.
Thus <em id="S1.p13.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R optimizes activation memory by identifying and removing activation replication in existing MP approaches through activation partitioning. It also offloads activations to CPU when appropriate.
</p>
</div>
<div id="S1.p14" class="ltx_para">
<p id="S1.p14.1" class="ltx_p">2) <em id="S1.p14.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R defines appropriate size for temporary buffers to strike for a balance of memory and computation efficiency.</p>
</div>
<div id="S1.p15" class="ltx_para">
<p id="S1.p15.1" class="ltx_p">3) We observe fragmented memory during training due to variations in the lifetime of different tensors. Lack of contiguous memory due to fragmentation can cause memory allocation failure, even when enough free memory is available. <em id="S1.p15.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R proactively manages memory based on the different lifetime of tensors, preventing memory fragmentation.</p>
</div>
<div id="S1.p16" class="ltx_para">
<p id="S1.p16.1" class="ltx_p"><em id="S1.p16.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP and <em id="S1.p16.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-R combined together forms a powerful system of memory optimizations for DL training that we collectively refer to as <em id="S1.p16.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>.</p>
</div>
<div id="S1.p17" class="ltx_para">
<p id="S1.p17.1" class="ltx_p"><em id="S1.p17.1.1" class="ltx_emph ltx_font_bold ltx_font_italic">ZeRO</em><span id="S1.p17.1.2" class="ltx_text ltx_font_bold"> and MP</span>: Since <em id="S1.p17.1.3" class="ltx_emph ltx_font_italic">ZeRO</em> eliminates the memory inefficiency in DP, it is natural to ask: Do we still need MP, and when? How does <em id="S1.p17.1.4" class="ltx_emph ltx_font_italic">ZeRO</em> work with MP? With <em id="S1.p17.1.5" class="ltx_emph ltx_font_italic">ZeRO</em>, MP becomes a less attractive option for the purpose of fitting large models alone. <em id="S1.p17.1.6" class="ltx_emph ltx_font_italic">ZeRO</em>-DP is at least as effective on reducing per-device memory footprint as MP, or more effective sometimes when MP cannot divide the model evenly. It also has comparable or better scaling efficiency. Furthermore, data parallelism is so easy to use that it is widely applicable across different workloads, while MP approaches today often need some work from model developers to revise their model, system developers to work out distributed operators, and existing work like Megatron-LM only supports a limited set of operators and models.</p>
</div>
<div id="S1.p18" class="ltx_para">
<p id="S1.p18.1" class="ltx_p">That being said, there are still cases where we want to leverage MP: i) When used with <em id="S1.p18.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R, MP can reduce activation memory footprint for very large models. ii) For smaller models where activation memory is not an issue, MP can also have benefits when aggregated batch size using DP alone is too big to have good convergence.<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Prior work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> shows, very large batch size could slow down convergence. For given model and data, there is a measure of critical-batch size, where increasing batch size further slows down convergence. The detailed discussion of this topic is beyond the scope of the paper.</span></span></span> In those case, one can combine <em id="S1.p18.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> with MP to fit the model with an acceptable aggregated batch size.</p>
</div>
<div id="S1.p19" class="ltx_para">
<p id="S1.p19.3" class="ltx_p">We show that <em id="S1.p19.3.1" class="ltx_emph ltx_font_italic">ZeRO</em> can be combined with MP, resulting in a max theoretical memory reduction of <math id="S1.p19.1.m1.1" class="ltx_Math" alttext="N_{d}\times N_{m}" display="inline"><semantics id="S1.p19.1.m1.1a"><mrow id="S1.p19.1.m1.1.1" xref="S1.p19.1.m1.1.1.cmml"><msub id="S1.p19.1.m1.1.1.2" xref="S1.p19.1.m1.1.1.2.cmml"><mi id="S1.p19.1.m1.1.1.2.2" xref="S1.p19.1.m1.1.1.2.2.cmml">N</mi><mi id="S1.p19.1.m1.1.1.2.3" xref="S1.p19.1.m1.1.1.2.3.cmml">d</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S1.p19.1.m1.1.1.1" xref="S1.p19.1.m1.1.1.1.cmml">Ã—</mo><msub id="S1.p19.1.m1.1.1.3" xref="S1.p19.1.m1.1.1.3.cmml"><mi id="S1.p19.1.m1.1.1.3.2" xref="S1.p19.1.m1.1.1.3.2.cmml">N</mi><mi id="S1.p19.1.m1.1.1.3.3" xref="S1.p19.1.m1.1.1.3.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.p19.1.m1.1b"><apply id="S1.p19.1.m1.1.1.cmml" xref="S1.p19.1.m1.1.1"><times id="S1.p19.1.m1.1.1.1.cmml" xref="S1.p19.1.m1.1.1.1"></times><apply id="S1.p19.1.m1.1.1.2.cmml" xref="S1.p19.1.m1.1.1.2"><csymbol cd="ambiguous" id="S1.p19.1.m1.1.1.2.1.cmml" xref="S1.p19.1.m1.1.1.2">subscript</csymbol><ci id="S1.p19.1.m1.1.1.2.2.cmml" xref="S1.p19.1.m1.1.1.2.2">ğ‘</ci><ci id="S1.p19.1.m1.1.1.2.3.cmml" xref="S1.p19.1.m1.1.1.2.3">ğ‘‘</ci></apply><apply id="S1.p19.1.m1.1.1.3.cmml" xref="S1.p19.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.p19.1.m1.1.1.3.1.cmml" xref="S1.p19.1.m1.1.1.3">subscript</csymbol><ci id="S1.p19.1.m1.1.1.3.2.cmml" xref="S1.p19.1.m1.1.1.3.2">ğ‘</ci><ci id="S1.p19.1.m1.1.1.3.3.cmml" xref="S1.p19.1.m1.1.1.3.3">ğ‘š</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p19.1.m1.1c">N_{d}\times N_{m}</annotation><annotation encoding="application/x-llamapun" id="S1.p19.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT Ã— italic_N start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> times on each device with a DP degree of <math id="S1.p19.2.m2.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S1.p19.2.m2.1a"><msub id="S1.p19.2.m2.1.1" xref="S1.p19.2.m2.1.1.cmml"><mi id="S1.p19.2.m2.1.1.2" xref="S1.p19.2.m2.1.1.2.cmml">N</mi><mi id="S1.p19.2.m2.1.1.3" xref="S1.p19.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p19.2.m2.1b"><apply id="S1.p19.2.m2.1.1.cmml" xref="S1.p19.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p19.2.m2.1.1.1.cmml" xref="S1.p19.2.m2.1.1">subscript</csymbol><ci id="S1.p19.2.m2.1.1.2.cmml" xref="S1.p19.2.m2.1.1.2">ğ‘</ci><ci id="S1.p19.2.m2.1.1.3.cmml" xref="S1.p19.2.m2.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p19.2.m2.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S1.p19.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and MP degree of <math id="S1.p19.3.m3.1" class="ltx_Math" alttext="N_{m}" display="inline"><semantics id="S1.p19.3.m3.1a"><msub id="S1.p19.3.m3.1.1" xref="S1.p19.3.m3.1.1.cmml"><mi id="S1.p19.3.m3.1.1.2" xref="S1.p19.3.m3.1.1.2.cmml">N</mi><mi id="S1.p19.3.m3.1.1.3" xref="S1.p19.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p19.3.m3.1b"><apply id="S1.p19.3.m3.1.1.cmml" xref="S1.p19.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p19.3.m3.1.1.1.cmml" xref="S1.p19.3.m3.1.1">subscript</csymbol><ci id="S1.p19.3.m3.1.1.2.cmml" xref="S1.p19.3.m3.1.1.2">ğ‘</ci><ci id="S1.p19.3.m3.1.1.3.cmml" xref="S1.p19.3.m3.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p19.3.m3.1c">N_{m}</annotation><annotation encoding="application/x-llamapun" id="S1.p19.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>.
This could allow us to fit a trillion parameter model on 1024 GPUs with 16-way model parallelism (within each DGX2 node) and 64-way data parallelism across nodes, and run it efficiently using a modest batch size!</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="241" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.4.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><em id="S1.F2.5.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ZeRO</em><span id="S1.F2.6.3" class="ltx_text" style="font-size:90%;"> training throughput and speedup w.r.t SOTA baseline for varying model sizes. For <em id="S1.F2.6.3.1" class="ltx_emph ltx_font_italic">ZeRO</em>, the MP always fit in a node, while for baseline, models larger than 40B require MP across nodes.</span></figcaption>
</figure>
<figure id="S1.F3" class="ltx_figure"><img src="x3.png" id="S1.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="275" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S1.F3.4.2" class="ltx_text" style="font-size:90%;">Superlinear scalability and per GPU training throughput of a 60B parameter model using <em id="S1.F3.4.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>-100B.</span></figcaption>
</figure>
<div id="S1.p20" class="ltx_para">
<p id="S1.p20.3" class="ltx_p"><span id="S1.p20.3.1" class="ltx_text ltx_font_bold">Implementation &amp; Evaluation</span>
The complete set of optimizations in <em id="S1.p20.3.2" class="ltx_emph ltx_font_italic">ZeRO</em> could allow us to run models with trillion parameters on the high-end hardware cluster today (e.g., with 1K V100 GPUs), however, the hardware compute capacity is still too limited and training time can be impractically long (<math id="S1.p20.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S1.p20.1.m1.1a"><mo id="S1.p20.1.m1.1.1" xref="S1.p20.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S1.p20.1.m1.1b"><gt id="S1.p20.1.m1.1.1.cmml" xref="S1.p20.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S1.p20.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S1.p20.1.m1.1d">&gt;</annotation></semantics></math>1 year). Therefore, our focus for this implementation is to efficiently support models with 10x parameters (<math id="S1.p20.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S1.p20.2.m2.1a"><mo id="S1.p20.2.m2.1.1" xref="S1.p20.2.m2.1.1.cmml">âˆ¼</mo><annotation-xml encoding="MathML-Content" id="S1.p20.2.m2.1b"><csymbol cd="latexml" id="S1.p20.2.m2.1.1.cmml" xref="S1.p20.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.p20.2.m2.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S1.p20.2.m2.1d">âˆ¼</annotation></semantics></math>100B parameters) than state-of-the-art (SOTA) while still being within reach of the compute capabilities of current hardware. We implement and evaluate a subset of optimizations in <em id="S1.p20.3.3" class="ltx_emph ltx_font_italic">ZeRO</em> called <em id="S1.p20.3.4" class="ltx_emph ltx_font_italic">ZeRO</em>-100B â€” <math id="S1.p20.3.m3.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S1.p20.3.m3.1a"><msub id="S1.p20.3.m3.1.1" xref="S1.p20.3.m3.1.1.cmml"><mi id="S1.p20.3.m3.1.1.2" xref="S1.p20.3.m3.1.1.2.cmml">P</mi><mrow id="S1.p20.3.m3.1.1.3" xref="S1.p20.3.m3.1.1.3.cmml"><mrow id="S1.p20.3.m3.1.1.3.2" xref="S1.p20.3.m3.1.1.3.2.cmml"><mi id="S1.p20.3.m3.1.1.3.2.2" xref="S1.p20.3.m3.1.1.3.2.2.cmml">o</mi><mo id="S1.p20.3.m3.1.1.3.2.1" xref="S1.p20.3.m3.1.1.3.2.1.cmml">â¢</mo><mi id="S1.p20.3.m3.1.1.3.2.3" xref="S1.p20.3.m3.1.1.3.2.3.cmml">s</mi></mrow><mo id="S1.p20.3.m3.1.1.3.1" xref="S1.p20.3.m3.1.1.3.1.cmml">+</mo><mi id="S1.p20.3.m3.1.1.3.3" xref="S1.p20.3.m3.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p20.3.m3.1b"><apply id="S1.p20.3.m3.1.1.cmml" xref="S1.p20.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p20.3.m3.1.1.1.cmml" xref="S1.p20.3.m3.1.1">subscript</csymbol><ci id="S1.p20.3.m3.1.1.2.cmml" xref="S1.p20.3.m3.1.1.2">ğ‘ƒ</ci><apply id="S1.p20.3.m3.1.1.3.cmml" xref="S1.p20.3.m3.1.1.3"><plus id="S1.p20.3.m3.1.1.3.1.cmml" xref="S1.p20.3.m3.1.1.3.1"></plus><apply id="S1.p20.3.m3.1.1.3.2.cmml" xref="S1.p20.3.m3.1.1.3.2"><times id="S1.p20.3.m3.1.1.3.2.1.cmml" xref="S1.p20.3.m3.1.1.3.2.1"></times><ci id="S1.p20.3.m3.1.1.3.2.2.cmml" xref="S1.p20.3.m3.1.1.3.2.2">ğ‘œ</ci><ci id="S1.p20.3.m3.1.1.3.2.3.cmml" xref="S1.p20.3.m3.1.1.3.2.3">ğ‘ </ci></apply><ci id="S1.p20.3.m3.1.1.3.3.cmml" xref="S1.p20.3.m3.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p20.3.m3.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S1.p20.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> of <em id="S1.p20.3.5" class="ltx_emph ltx_font_italic">ZeRO</em>-DP plus ZeRO-R â€” that allow us to achieve this goal. The results show:</p>
</div>
<div id="S1.p21" class="ltx_para">
<p id="S1.p21.1" class="ltx_p"><span id="S1.p21.1.1" class="ltx_text ltx_framed_underline">Model Size</span> Combined with MP, <em id="S1.p21.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B runs 170B parameter models efficiently, while the existing system like using Megatron alone cannot scale efficiently beyond 40B parameters, as shown in FigureÂ <a href="#S1.F2" title="Figure 2 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
This is an over 8x increase in model size compared to SOTA.</p>
</div>
<div id="S1.p22" class="ltx_para">
<p id="S1.p22.1" class="ltx_p"><span id="S1.p22.1.1" class="ltx_text ltx_framed_underline">Speed</span> Improved memory efficiency powers higher throughput and faster training.
As shown in FigureÂ <a href="#S1.F2" title="Figure 2 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <em id="S1.p22.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> runs 100B parameter models on a 400 Nvidia V100 GPU cluster with over 38 TFlops per GPU, and aggregate performance over 15 Petaflops. This is more than 10x improvement in training speed compared to SOTA for the same model size.</p>
</div>
<div id="S1.p23" class="ltx_para">
<p id="S1.p23.1" class="ltx_p"><span id="S1.p23.1.1" class="ltx_text ltx_framed_underline">Scalability</span> We observe super linear speedup in the regime of 64-400 GPUs, where the performance more than doubles when we double the number of GPUs. This is a property of <em id="S1.p23.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP which reduces the memory footprint of the model states as we increase the DP degree allowing us to fit larger batch sizes per GPU resulting in better performance. We expect this behaviour to continue further as we increase the number of GPUs beyond 400.</p>
</div>
<div id="S1.p24" class="ltx_para">
<p id="S1.p24.1" class="ltx_p"><span id="S1.p24.1.1" class="ltx_text ltx_framed_underline">Democratization of Large Model Training</span> <em id="S1.p24.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B powers data scientist to train models with up to 13B parameters without any MP or PP that requires model refactoring, where 13B is more parameters than the largest model in literature (T5 with 11B parameters). Data scientists can thus experiment freely with large models without worrying about parallelism. In comparison, exist systems (e.g., PyTorch Distributed Data Parallel) runs out of memory with 1.4B parameter models.
</p>
</div>
<div id="S1.p25" class="ltx_para">
<p id="S1.p25.1" class="ltx_p"><span id="S1.p25.1.1" class="ltx_text ltx_framed_underline">New SOTA Model</span> <em id="S1.p25.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> powers the largest language model with 17B parameters and record-breaking accuracy, Turing-NLGÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
</p>
</div>
<div id="S1.p26" class="ltx_para">
<p id="S1.p26.1" class="ltx_p">We share <em id="S1.p26.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> as a part of our open source DL training optimization library called DeepSpeed<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/microsoft/deepspeed</span></span></span>.
We plan to release all implementations described in this paper by end of May 2020 and extend it further to support 1 trillion parameters by enabling <em id="S1.p26.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP stage 3 partitioning parameters (<math id="S1.p26.1.m1.1" class="ltx_Math" alttext="P_{os+g+p}" display="inline"><semantics id="S1.p26.1.m1.1a"><msub id="S1.p26.1.m1.1.1" xref="S1.p26.1.m1.1.1.cmml"><mi id="S1.p26.1.m1.1.1.2" xref="S1.p26.1.m1.1.1.2.cmml">P</mi><mrow id="S1.p26.1.m1.1.1.3" xref="S1.p26.1.m1.1.1.3.cmml"><mrow id="S1.p26.1.m1.1.1.3.2" xref="S1.p26.1.m1.1.1.3.2.cmml"><mi id="S1.p26.1.m1.1.1.3.2.2" xref="S1.p26.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S1.p26.1.m1.1.1.3.2.1" xref="S1.p26.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S1.p26.1.m1.1.1.3.2.3" xref="S1.p26.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S1.p26.1.m1.1.1.3.1" xref="S1.p26.1.m1.1.1.3.1.cmml">+</mo><mi id="S1.p26.1.m1.1.1.3.3" xref="S1.p26.1.m1.1.1.3.3.cmml">g</mi><mo id="S1.p26.1.m1.1.1.3.1a" xref="S1.p26.1.m1.1.1.3.1.cmml">+</mo><mi id="S1.p26.1.m1.1.1.3.4" xref="S1.p26.1.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S1.p26.1.m1.1b"><apply id="S1.p26.1.m1.1.1.cmml" xref="S1.p26.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p26.1.m1.1.1.1.cmml" xref="S1.p26.1.m1.1.1">subscript</csymbol><ci id="S1.p26.1.m1.1.1.2.cmml" xref="S1.p26.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S1.p26.1.m1.1.1.3.cmml" xref="S1.p26.1.m1.1.1.3"><plus id="S1.p26.1.m1.1.1.3.1.cmml" xref="S1.p26.1.m1.1.1.3.1"></plus><apply id="S1.p26.1.m1.1.1.3.2.cmml" xref="S1.p26.1.m1.1.1.3.2"><times id="S1.p26.1.m1.1.1.3.2.1.cmml" xref="S1.p26.1.m1.1.1.3.2.1"></times><ci id="S1.p26.1.m1.1.1.3.2.2.cmml" xref="S1.p26.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S1.p26.1.m1.1.1.3.2.3.cmml" xref="S1.p26.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S1.p26.1.m1.1.1.3.3.cmml" xref="S1.p26.1.m1.1.1.3.3">ğ‘”</ci><ci id="S1.p26.1.m1.1.1.3.4.cmml" xref="S1.p26.1.m1.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p26.1.m1.1c">P_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S1.p26.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g + italic_p end_POSTSUBSCRIPT</annotation></semantics></math>). We plan to make <em id="S1.p26.1.3" class="ltx_emph ltx_font_italic">ZeRO</em> fully accessible to the DL community to catalyze the evolution and democratization of large model training at scale.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Data, Model and Pipeline Parallelism</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Parallelization is a key strategy on training large models at scale. For a model that fits in the device memory for training, data parallelism (DP) is used to scale training to multiple devices. In DP, model parameters are replicated on each device. At each step, a mini-batch is divided evenly across all the data parallel processes, such that each process executes the forward and backward propagation on a different subset of data samples, and uses averaged gradients across processes to update the model locally.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">When a model does not fit in the device memory, model parallelism (MP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and pipeline parallelism (PP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> split the model among processes, in vertical and horizontal way respectively. Sec.Â <a href="#S1" title="1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> discussed how <em id="S2.SS1.p2.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> relates to DP and MP. We now discuss PP and how it relates to reducing memory consumption.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">PP splits a model horizontally across layers running each partition on a different device and use micro-batching to hide the pipeline bubble <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Model functionalities such as tied-weights and batch-normalization are difficult to implement due to horizontal splitting and micro-batching, respectively. Popular PP implementation such as G-pipe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> partitions both model parameters and total activations but requires a batch size proportional to number of pipeline partitions to hide the pipeline bubble. The large batch size can affect the convergence rate, while also requiring significant memory to store activations. A different implementation of PP in PipeDream <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> keeps multiple copies of stale parameters to hide the pipeline bubble without increasing the batch size significantly, making it less memory efficient. Additionally, the implementation is not equivalent to the standard DL training and has implications on training convergence.
In contrast, <em id="S2.SS1.p3.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> obtains the same or better memory efficiency than PP without incurring functionality, performance and convergence related restrictions of PP.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Non-parallelism based approach to reduce memory</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In addition to MP and PP, there are multiple lines of work that target reducing memory overheads of DL training.</p>
</div>
<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Reducing Activation Memory</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para">
<p id="S2.SS2.SSS1.p1.1" class="ltx_p">Multiple efforts have focused on reducing the memory footprint of activations through compressionÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, activation checkpointingÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, or live analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. These efforts are complimentary and can work together with <em id="S2.SS2.SSS1.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>. In fact, activation memory reduction in <em id="S2.SS2.SSS1.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-R works in parallel with activation checkpointing.</p>
</div>
</section>
<section id="S2.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>CPU Offload</h4>

<div id="S2.SS2.SSS2.p1" class="ltx_para">
<p id="S2.SS2.SSS2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> exploit heterogeneous nature of todayâ€™s compute nodes, offloading model states to CPU memory through algorithmic design or virtualized memory, respectively. Up to <math id="S2.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><mrow id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mn id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">50</mn><mo id="S2.SS2.SSS2.p1.1.m1.1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">50\%</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">50 %</annotation></semantics></math> of training time can be spent on GPU-CPU-GPU transfers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. <em id="S2.SS2.SSS2.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> differs in that it reduces the memory consumption significantly without storing the model states to CPU memory whose bandwidth is severely constrained due to PCI-E. On rare cases, <em id="S2.SS2.SSS2.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-R may offload just the activation checkpoints for very large models to improve performance (see Sec.Â <a href="#S6.SS1" title="6.1 ğ‘ƒ_ğ‘: Partitioned Activation Checkpointing â€£ 6 Deep Dive into ZeRO-R â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a> for details).</p>
</div>
</section>
<section id="S2.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.3 </span>Memory Efficient Optimizer</h4>

<div id="S2.SS2.SSS3.p1" class="ltx_para">
<p id="S2.SS2.SSS3.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> focus on reducing memory consumption of adaptive optimization methods by maintaining coarser-grained statistics of model parameters and gradients, with potential impact on model convergence guarantees. <em id="S2.SS2.SSS3.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> is orthogonal to these efforts, and its optimizations
do not change the model optimization method or affect model convergence, but effectively reduce memory footprint of optimizer states and gradients per device.</p>
</div>
</section>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Training Optimizers </h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Adaptive optimization methodsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> are crucial to achieving SOTA performance and accuracy for effective model training of large models. Compared to SGD, by maintaining fine-grained first-order and second-order statistics for each model parameter and gradient at the cost of significant memory footprint. <em id="S2.SS3.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> can reduce the memory footprint of these optimizers by orders of magnitude, making these sophisticated optimization methods practical for training large models on hardware with modest device memory. It also makes it possible to develop and use even more complex and memory hungry optimizers that may have better convergence.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Where Did All the Memory Go?</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Letâ€™s take a step back to examine the memory consumption of the current training system. For example, a 1.5B parameter GPT-2 model requires 3GB of memory for its weights (or parameters) in 16-bit precision, yet, it cannot be trained on a single GPU with 32GB memory using Tensorflow or PyTorch. One may wonder where all the memory goes.
During model training, most of the memory is consumed by <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">model states</span>, i.e., tensors comprising of pptimizer states, gradients, and parameters. Besides these model states, the rest of the memory is consumed by activations, temporary buffers and fragmented memory which we call <em id="S3.p1.1.2" class="ltx_emph ltx_font_italic">residual states</em>. We look at the memory consumption from both in details.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model States: Optimizer States, Gradients and Parameters</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Majority of the device memory is consumed by model states during training. Consider for instance, AdamÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, one of the most popular optimizers for DL training. Adam requires storing two optimizer states, i) the time averaged momentum and ii) variance of the gradients to compute the updates. Therefore, to train a model with ADAM, there has to be enough memory to hold a copy of both the momentum and variance of the gradients. In addition, there needs to be enough memory to store the gradients and the weights themselves. Of these three types of the parameter-related tensors, the optimizer states usually consume the most memory, specially when mixed-precision training is applied.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p"><span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_bold">Mixed-Precision Training</span> The state-of-the-art approach to train large models on the current generation of NVIDIA GPUs is via mixed precision (fp16/32) trainingÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, where parameters and activations are stored as fp16, enabling the use of the high throughput tensor core unitsÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> on these GPUs. During mixed-precision training, both the forward and backward propagation are performed using fp16 weights and activations. However, to effectively compute and apply the updates at the end of the backward propagation, the mixed-precision optimizer keeps an fp32 copy of the parameters as well as an fp32 copy of all the other optimizer states.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.16" class="ltx_p">Letâ€™s take Adam as a concrete example. Mixed precision training of a model with <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi mathvariant="normal" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">roman_Î¨</annotation></semantics></math> parameters using Adam requires enough memory to hold an <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="fp16" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">f</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">p</mi><mo id="S3.SS1.p3.2.m2.1.1.1a" xref="S3.SS1.p3.2.m2.1.1.1.cmml">â¢</mo><mn id="S3.SS1.p3.2.m2.1.1.4" xref="S3.SS1.p3.2.m2.1.1.4.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><times id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></times><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">ğ‘“</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">ğ‘</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.4.cmml" xref="S3.SS1.p3.2.m2.1.1.4">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">fp16</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_f italic_p 16</annotation></semantics></math> copy of the parameters and the gradients, with memory requirements of <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="2\Psi" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mn id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">2</mn><mo id="S3.SS1.p3.3.m3.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><times id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1"></times><cn type="integer" id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">2</cn><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">2\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">2 roman_Î¨</annotation></semantics></math> and <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="2\Psi" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mn id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">2</mn><mo id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><times id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1"></times><cn type="integer" id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">2</cn><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">2\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">2 roman_Î¨</annotation></semantics></math> bytes respectively. In addition, it needs to hold the optimizer states: an <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="fp32" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">f</mi><mo id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml">p</mi><mo id="S3.SS1.p3.5.m5.1.1.1a" xref="S3.SS1.p3.5.m5.1.1.1.cmml">â¢</mo><mn id="S3.SS1.p3.5.m5.1.1.4" xref="S3.SS1.p3.5.m5.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><times id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1"></times><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">ğ‘“</ci><ci id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3">ğ‘</ci><cn type="integer" id="S3.SS1.p3.5.m5.1.1.4.cmml" xref="S3.SS1.p3.5.m5.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">fp32</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_f italic_p 32</annotation></semantics></math> copy of the parameters, momentum and variance, with memory requirements of <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="4\Psi" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mrow id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mn id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml">4</mn><mo id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><times id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"></times><cn type="integer" id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2">4</cn><ci id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">4\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">4 roman_Î¨</annotation></semantics></math>, <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="4\Psi" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mrow id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mn id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">4</mn><mo id="S3.SS1.p3.7.m7.1.1.1" xref="S3.SS1.p3.7.m7.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><times id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1.1"></times><cn type="integer" id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">4</cn><ci id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">4\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">4 roman_Î¨</annotation></semantics></math>, and <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="4\Psi" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><mrow id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mn id="S3.SS1.p3.8.m8.1.1.2" xref="S3.SS1.p3.8.m8.1.1.2.cmml">4</mn><mo id="S3.SS1.p3.8.m8.1.1.1" xref="S3.SS1.p3.8.m8.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><times id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1"></times><cn type="integer" id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2">4</cn><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">4\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">4 roman_Î¨</annotation></semantics></math> bytes, respectively. Letâ€™s use <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><mi id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><ci id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">ğ¾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m9.1d">italic_K</annotation></semantics></math> to denote the memory multiplier of the optimizer states, i.e., the additional memory required to store them is <math id="S3.SS1.p3.10.m10.1" class="ltx_Math" alttext="K\Psi" display="inline"><semantics id="S3.SS1.p3.10.m10.1a"><mrow id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml"><mi id="S3.SS1.p3.10.m10.1.1.2" xref="S3.SS1.p3.10.m10.1.1.2.cmml">K</mi><mo id="S3.SS1.p3.10.m10.1.1.1" xref="S3.SS1.p3.10.m10.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.10.m10.1.1.3" xref="S3.SS1.p3.10.m10.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><apply id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1"><times id="S3.SS1.p3.10.m10.1.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1.1"></times><ci id="S3.SS1.p3.10.m10.1.1.2.cmml" xref="S3.SS1.p3.10.m10.1.1.2">ğ¾</ci><ci id="S3.SS1.p3.10.m10.1.1.3.cmml" xref="S3.SS1.p3.10.m10.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">K\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m10.1d">italic_K roman_Î¨</annotation></semantics></math> bytes. Mixed-precision Adam has <math id="S3.SS1.p3.11.m11.1" class="ltx_Math" alttext="K=12" display="inline"><semantics id="S3.SS1.p3.11.m11.1a"><mrow id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml"><mi id="S3.SS1.p3.11.m11.1.1.2" xref="S3.SS1.p3.11.m11.1.1.2.cmml">K</mi><mo id="S3.SS1.p3.11.m11.1.1.1" xref="S3.SS1.p3.11.m11.1.1.1.cmml">=</mo><mn id="S3.SS1.p3.11.m11.1.1.3" xref="S3.SS1.p3.11.m11.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><apply id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1"><eq id="S3.SS1.p3.11.m11.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1.1"></eq><ci id="S3.SS1.p3.11.m11.1.1.2.cmml" xref="S3.SS1.p3.11.m11.1.1.2">ğ¾</ci><cn type="integer" id="S3.SS1.p3.11.m11.1.1.3.cmml" xref="S3.SS1.p3.11.m11.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">K=12</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m11.1d">italic_K = 12</annotation></semantics></math>. In total, this results in <math id="S3.SS1.p3.12.m12.1" class="ltx_Math" alttext="2\Psi+2\Psi+K\Psi=16\Psi" display="inline"><semantics id="S3.SS1.p3.12.m12.1a"><mrow id="S3.SS1.p3.12.m12.1.1" xref="S3.SS1.p3.12.m12.1.1.cmml"><mrow id="S3.SS1.p3.12.m12.1.1.2" xref="S3.SS1.p3.12.m12.1.1.2.cmml"><mrow id="S3.SS1.p3.12.m12.1.1.2.2" xref="S3.SS1.p3.12.m12.1.1.2.2.cmml"><mn id="S3.SS1.p3.12.m12.1.1.2.2.2" xref="S3.SS1.p3.12.m12.1.1.2.2.2.cmml">2</mn><mo id="S3.SS1.p3.12.m12.1.1.2.2.1" xref="S3.SS1.p3.12.m12.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.12.m12.1.1.2.2.3" xref="S3.SS1.p3.12.m12.1.1.2.2.3.cmml">Î¨</mi></mrow><mo id="S3.SS1.p3.12.m12.1.1.2.1" xref="S3.SS1.p3.12.m12.1.1.2.1.cmml">+</mo><mrow id="S3.SS1.p3.12.m12.1.1.2.3" xref="S3.SS1.p3.12.m12.1.1.2.3.cmml"><mn id="S3.SS1.p3.12.m12.1.1.2.3.2" xref="S3.SS1.p3.12.m12.1.1.2.3.2.cmml">2</mn><mo id="S3.SS1.p3.12.m12.1.1.2.3.1" xref="S3.SS1.p3.12.m12.1.1.2.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.12.m12.1.1.2.3.3" xref="S3.SS1.p3.12.m12.1.1.2.3.3.cmml">Î¨</mi></mrow><mo id="S3.SS1.p3.12.m12.1.1.2.1a" xref="S3.SS1.p3.12.m12.1.1.2.1.cmml">+</mo><mrow id="S3.SS1.p3.12.m12.1.1.2.4" xref="S3.SS1.p3.12.m12.1.1.2.4.cmml"><mi id="S3.SS1.p3.12.m12.1.1.2.4.2" xref="S3.SS1.p3.12.m12.1.1.2.4.2.cmml">K</mi><mo id="S3.SS1.p3.12.m12.1.1.2.4.1" xref="S3.SS1.p3.12.m12.1.1.2.4.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.12.m12.1.1.2.4.3" xref="S3.SS1.p3.12.m12.1.1.2.4.3.cmml">Î¨</mi></mrow></mrow><mo id="S3.SS1.p3.12.m12.1.1.1" xref="S3.SS1.p3.12.m12.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.12.m12.1.1.3" xref="S3.SS1.p3.12.m12.1.1.3.cmml"><mn id="S3.SS1.p3.12.m12.1.1.3.2" xref="S3.SS1.p3.12.m12.1.1.3.2.cmml">16</mn><mo id="S3.SS1.p3.12.m12.1.1.3.1" xref="S3.SS1.p3.12.m12.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S3.SS1.p3.12.m12.1.1.3.3" xref="S3.SS1.p3.12.m12.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.1b"><apply id="S3.SS1.p3.12.m12.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1"><eq id="S3.SS1.p3.12.m12.1.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1.1"></eq><apply id="S3.SS1.p3.12.m12.1.1.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2"><plus id="S3.SS1.p3.12.m12.1.1.2.1.cmml" xref="S3.SS1.p3.12.m12.1.1.2.1"></plus><apply id="S3.SS1.p3.12.m12.1.1.2.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2.2"><times id="S3.SS1.p3.12.m12.1.1.2.2.1.cmml" xref="S3.SS1.p3.12.m12.1.1.2.2.1"></times><cn type="integer" id="S3.SS1.p3.12.m12.1.1.2.2.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2.2.2">2</cn><ci id="S3.SS1.p3.12.m12.1.1.2.2.3.cmml" xref="S3.SS1.p3.12.m12.1.1.2.2.3">Î¨</ci></apply><apply id="S3.SS1.p3.12.m12.1.1.2.3.cmml" xref="S3.SS1.p3.12.m12.1.1.2.3"><times id="S3.SS1.p3.12.m12.1.1.2.3.1.cmml" xref="S3.SS1.p3.12.m12.1.1.2.3.1"></times><cn type="integer" id="S3.SS1.p3.12.m12.1.1.2.3.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2.3.2">2</cn><ci id="S3.SS1.p3.12.m12.1.1.2.3.3.cmml" xref="S3.SS1.p3.12.m12.1.1.2.3.3">Î¨</ci></apply><apply id="S3.SS1.p3.12.m12.1.1.2.4.cmml" xref="S3.SS1.p3.12.m12.1.1.2.4"><times id="S3.SS1.p3.12.m12.1.1.2.4.1.cmml" xref="S3.SS1.p3.12.m12.1.1.2.4.1"></times><ci id="S3.SS1.p3.12.m12.1.1.2.4.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2.4.2">ğ¾</ci><ci id="S3.SS1.p3.12.m12.1.1.2.4.3.cmml" xref="S3.SS1.p3.12.m12.1.1.2.4.3">Î¨</ci></apply></apply><apply id="S3.SS1.p3.12.m12.1.1.3.cmml" xref="S3.SS1.p3.12.m12.1.1.3"><times id="S3.SS1.p3.12.m12.1.1.3.1.cmml" xref="S3.SS1.p3.12.m12.1.1.3.1"></times><cn type="integer" id="S3.SS1.p3.12.m12.1.1.3.2.cmml" xref="S3.SS1.p3.12.m12.1.1.3.2">16</cn><ci id="S3.SS1.p3.12.m12.1.1.3.3.cmml" xref="S3.SS1.p3.12.m12.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.1c">2\Psi+2\Psi+K\Psi=16\Psi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.12.m12.1d">2 roman_Î¨ + 2 roman_Î¨ + italic_K roman_Î¨ = 16 roman_Î¨</annotation></semantics></math> bytes of memory requirement.
For a model such as GPT-2 with <math id="S3.SS1.p3.13.m13.1" class="ltx_Math" alttext="1.5" display="inline"><semantics id="S3.SS1.p3.13.m13.1a"><mn id="S3.SS1.p3.13.m13.1.1" xref="S3.SS1.p3.13.m13.1.1.cmml">1.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.1b"><cn type="float" id="S3.SS1.p3.13.m13.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1">1.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.1c">1.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.13.m13.1d">1.5</annotation></semantics></math> Billion parameters, this leads to a memory requirement of at least <math id="S3.SS1.p3.14.m14.1" class="ltx_Math" alttext="24\,GB" display="inline"><semantics id="S3.SS1.p3.14.m14.1a"><mrow id="S3.SS1.p3.14.m14.1.1" xref="S3.SS1.p3.14.m14.1.1.cmml"><mn id="S3.SS1.p3.14.m14.1.1.2" xref="S3.SS1.p3.14.m14.1.1.2.cmml">24</mn><mo lspace="0.170em" id="S3.SS1.p3.14.m14.1.1.1" xref="S3.SS1.p3.14.m14.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.14.m14.1.1.3" xref="S3.SS1.p3.14.m14.1.1.3.cmml">G</mi><mo id="S3.SS1.p3.14.m14.1.1.1a" xref="S3.SS1.p3.14.m14.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.14.m14.1.1.4" xref="S3.SS1.p3.14.m14.1.1.4.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m14.1b"><apply id="S3.SS1.p3.14.m14.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1"><times id="S3.SS1.p3.14.m14.1.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1.1"></times><cn type="integer" id="S3.SS1.p3.14.m14.1.1.2.cmml" xref="S3.SS1.p3.14.m14.1.1.2">24</cn><ci id="S3.SS1.p3.14.m14.1.1.3.cmml" xref="S3.SS1.p3.14.m14.1.1.3">ğº</ci><ci id="S3.SS1.p3.14.m14.1.1.4.cmml" xref="S3.SS1.p3.14.m14.1.1.4">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m14.1c">24\,GB</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.14.m14.1d">24 italic_G italic_B</annotation></semantics></math>, which is significantly higher than the meager <math id="S3.SS1.p3.15.m15.1" class="ltx_Math" alttext="3\,GB" display="inline"><semantics id="S3.SS1.p3.15.m15.1a"><mrow id="S3.SS1.p3.15.m15.1.1" xref="S3.SS1.p3.15.m15.1.1.cmml"><mn id="S3.SS1.p3.15.m15.1.1.2" xref="S3.SS1.p3.15.m15.1.1.2.cmml">3</mn><mo lspace="0.170em" id="S3.SS1.p3.15.m15.1.1.1" xref="S3.SS1.p3.15.m15.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.15.m15.1.1.3" xref="S3.SS1.p3.15.m15.1.1.3.cmml">G</mi><mo id="S3.SS1.p3.15.m15.1.1.1a" xref="S3.SS1.p3.15.m15.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.15.m15.1.1.4" xref="S3.SS1.p3.15.m15.1.1.4.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.15.m15.1b"><apply id="S3.SS1.p3.15.m15.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1"><times id="S3.SS1.p3.15.m15.1.1.1.cmml" xref="S3.SS1.p3.15.m15.1.1.1"></times><cn type="integer" id="S3.SS1.p3.15.m15.1.1.2.cmml" xref="S3.SS1.p3.15.m15.1.1.2">3</cn><ci id="S3.SS1.p3.15.m15.1.1.3.cmml" xref="S3.SS1.p3.15.m15.1.1.3">ğº</ci><ci id="S3.SS1.p3.15.m15.1.1.4.cmml" xref="S3.SS1.p3.15.m15.1.1.4">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.15.m15.1c">3\,GB</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.15.m15.1d">3 italic_G italic_B</annotation></semantics></math> of memory required to hold the <math id="S3.SS1.p3.16.m16.1" class="ltx_Math" alttext="fp16" display="inline"><semantics id="S3.SS1.p3.16.m16.1a"><mrow id="S3.SS1.p3.16.m16.1.1" xref="S3.SS1.p3.16.m16.1.1.cmml"><mi id="S3.SS1.p3.16.m16.1.1.2" xref="S3.SS1.p3.16.m16.1.1.2.cmml">f</mi><mo id="S3.SS1.p3.16.m16.1.1.1" xref="S3.SS1.p3.16.m16.1.1.1.cmml">â¢</mo><mi id="S3.SS1.p3.16.m16.1.1.3" xref="S3.SS1.p3.16.m16.1.1.3.cmml">p</mi><mo id="S3.SS1.p3.16.m16.1.1.1a" xref="S3.SS1.p3.16.m16.1.1.1.cmml">â¢</mo><mn id="S3.SS1.p3.16.m16.1.1.4" xref="S3.SS1.p3.16.m16.1.1.4.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.16.m16.1b"><apply id="S3.SS1.p3.16.m16.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1"><times id="S3.SS1.p3.16.m16.1.1.1.cmml" xref="S3.SS1.p3.16.m16.1.1.1"></times><ci id="S3.SS1.p3.16.m16.1.1.2.cmml" xref="S3.SS1.p3.16.m16.1.1.2">ğ‘“</ci><ci id="S3.SS1.p3.16.m16.1.1.3.cmml" xref="S3.SS1.p3.16.m16.1.1.3">ğ‘</ci><cn type="integer" id="S3.SS1.p3.16.m16.1.1.4.cmml" xref="S3.SS1.p3.16.m16.1.1.4">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.16.m16.1c">fp16</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.16.m16.1d">italic_f italic_p 16</annotation></semantics></math> parameters alone.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Residual Memory Consumption</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">Activations</span> can take up a significant amount of memory <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> during training. As a concrete example, the 1.5B parameter GPT-2 model trained with sequence length of 1K and batch size of 32 requires about 60â€‰GB of memory<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The activation memory of a transformer-based model is proportional to the number of transformer layers <math id="footnote4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="footnote4.m1.1b"><mo id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml">Ã—</mo><annotation-xml encoding="MathML-Content" id="footnote4.m1.1c"><times id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="footnote4.m1.1e">Ã—</annotation></semantics></math> hidden dimensions <math id="footnote4.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="footnote4.m2.1b"><mo id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml">Ã—</mo><annotation-xml encoding="MathML-Content" id="footnote4.m2.1c"><times id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="footnote4.m2.1e">Ã—</annotation></semantics></math> sequence length <math id="footnote4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="footnote4.m3.1b"><mo id="footnote4.m3.1.1" xref="footnote4.m3.1.1.cmml">Ã—</mo><annotation-xml encoding="MathML-Content" id="footnote4.m3.1c"><times id="footnote4.m3.1.1.cmml" xref="footnote4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="footnote4.m3.1e">Ã—</annotation></semantics></math> batch size. For a GPT-2 like architecture the total activations is about <math id="footnote4.m4.1" class="ltx_Math" alttext="12\times hidden\_dim\times batch\times seq\_length\times transformer\_layers" display="inline"><semantics id="footnote4.m4.1b"><mrow id="footnote4.m4.1.1" xref="footnote4.m4.1.1.cmml"><mrow id="footnote4.m4.1.1.2" xref="footnote4.m4.1.1.2.cmml"><mrow id="footnote4.m4.1.1.2.2" xref="footnote4.m4.1.1.2.2.cmml"><mrow id="footnote4.m4.1.1.2.2.2" xref="footnote4.m4.1.1.2.2.2.cmml"><mrow id="footnote4.m4.1.1.2.2.2.2" xref="footnote4.m4.1.1.2.2.2.2.cmml"><mrow id="footnote4.m4.1.1.2.2.2.2.2" xref="footnote4.m4.1.1.2.2.2.2.2.cmml"><mrow id="footnote4.m4.1.1.2.2.2.2.2.2" xref="footnote4.m4.1.1.2.2.2.2.2.2.cmml"><mrow id="footnote4.m4.1.1.2.2.2.2.2.2.2" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.cmml"><mn id="footnote4.m4.1.1.2.2.2.2.2.2.2.2" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.2.cmml">12</mn><mo lspace="0.222em" rspace="0.222em" id="footnote4.m4.1.1.2.2.2.2.2.2.2.1" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.1.cmml">Ã—</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.2.3" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.3.cmml">h</mi></mrow><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.3" xref="footnote4.m4.1.1.2.2.2.2.2.2.3.cmml">i</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1b" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.4" xref="footnote4.m4.1.1.2.2.2.2.2.2.4.cmml">d</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1c" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.5" xref="footnote4.m4.1.1.2.2.2.2.2.2.5.cmml">d</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1d" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.6" xref="footnote4.m4.1.1.2.2.2.2.2.2.6.cmml">e</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1e" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.7" xref="footnote4.m4.1.1.2.2.2.2.2.2.7.cmml">n</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1f" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="footnote4.m4.1.1.2.2.2.2.2.2.8" xref="footnote4.m4.1.1.2.2.2.2.2.2.8.cmml">_</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1g" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.9" xref="footnote4.m4.1.1.2.2.2.2.2.2.9.cmml">d</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1h" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.10" xref="footnote4.m4.1.1.2.2.2.2.2.2.10.cmml">i</mi><mo id="footnote4.m4.1.1.2.2.2.2.2.2.1i" xref="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.2.11" xref="footnote4.m4.1.1.2.2.2.2.2.2.11.cmml">m</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="footnote4.m4.1.1.2.2.2.2.2.1" xref="footnote4.m4.1.1.2.2.2.2.2.1.cmml">Ã—</mo><mi id="footnote4.m4.1.1.2.2.2.2.2.3" xref="footnote4.m4.1.1.2.2.2.2.2.3.cmml">b</mi></mrow><mo id="footnote4.m4.1.1.2.2.2.2.1" xref="footnote4.m4.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.3" xref="footnote4.m4.1.1.2.2.2.2.3.cmml">a</mi><mo id="footnote4.m4.1.1.2.2.2.2.1b" xref="footnote4.m4.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.4" xref="footnote4.m4.1.1.2.2.2.2.4.cmml">t</mi><mo id="footnote4.m4.1.1.2.2.2.2.1c" xref="footnote4.m4.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.5" xref="footnote4.m4.1.1.2.2.2.2.5.cmml">c</mi><mo id="footnote4.m4.1.1.2.2.2.2.1d" xref="footnote4.m4.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.2.2.6" xref="footnote4.m4.1.1.2.2.2.2.6.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="footnote4.m4.1.1.2.2.2.1" xref="footnote4.m4.1.1.2.2.2.1.cmml">Ã—</mo><mi id="footnote4.m4.1.1.2.2.2.3" xref="footnote4.m4.1.1.2.2.2.3.cmml">s</mi></mrow><mo id="footnote4.m4.1.1.2.2.1" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.3" xref="footnote4.m4.1.1.2.2.3.cmml">e</mi><mo id="footnote4.m4.1.1.2.2.1b" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.4" xref="footnote4.m4.1.1.2.2.4.cmml">q</mi><mo id="footnote4.m4.1.1.2.2.1c" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="footnote4.m4.1.1.2.2.5" xref="footnote4.m4.1.1.2.2.5.cmml">_</mi><mo id="footnote4.m4.1.1.2.2.1d" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.6" xref="footnote4.m4.1.1.2.2.6.cmml">l</mi><mo id="footnote4.m4.1.1.2.2.1e" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.7" xref="footnote4.m4.1.1.2.2.7.cmml">e</mi><mo id="footnote4.m4.1.1.2.2.1f" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.8" xref="footnote4.m4.1.1.2.2.8.cmml">n</mi><mo id="footnote4.m4.1.1.2.2.1g" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.9" xref="footnote4.m4.1.1.2.2.9.cmml">g</mi><mo id="footnote4.m4.1.1.2.2.1h" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.10" xref="footnote4.m4.1.1.2.2.10.cmml">t</mi><mo id="footnote4.m4.1.1.2.2.1i" xref="footnote4.m4.1.1.2.2.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.2.2.11" xref="footnote4.m4.1.1.2.2.11.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="footnote4.m4.1.1.2.1" xref="footnote4.m4.1.1.2.1.cmml">Ã—</mo><mi id="footnote4.m4.1.1.2.3" xref="footnote4.m4.1.1.2.3.cmml">t</mi></mrow><mo id="footnote4.m4.1.1.1" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.3" xref="footnote4.m4.1.1.3.cmml">r</mi><mo id="footnote4.m4.1.1.1b" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.4" xref="footnote4.m4.1.1.4.cmml">a</mi><mo id="footnote4.m4.1.1.1c" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.5" xref="footnote4.m4.1.1.5.cmml">n</mi><mo id="footnote4.m4.1.1.1d" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.6" xref="footnote4.m4.1.1.6.cmml">s</mi><mo id="footnote4.m4.1.1.1e" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.7" xref="footnote4.m4.1.1.7.cmml">f</mi><mo id="footnote4.m4.1.1.1f" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.8" xref="footnote4.m4.1.1.8.cmml">o</mi><mo id="footnote4.m4.1.1.1g" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.9" xref="footnote4.m4.1.1.9.cmml">r</mi><mo id="footnote4.m4.1.1.1h" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.10" xref="footnote4.m4.1.1.10.cmml">m</mi><mo id="footnote4.m4.1.1.1i" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.11" xref="footnote4.m4.1.1.11.cmml">e</mi><mo id="footnote4.m4.1.1.1j" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.12" xref="footnote4.m4.1.1.12.cmml">r</mi><mo id="footnote4.m4.1.1.1k" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="footnote4.m4.1.1.13" xref="footnote4.m4.1.1.13.cmml">_</mi><mo id="footnote4.m4.1.1.1l" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.14" xref="footnote4.m4.1.1.14.cmml">l</mi><mo id="footnote4.m4.1.1.1m" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.15" xref="footnote4.m4.1.1.15.cmml">a</mi><mo id="footnote4.m4.1.1.1n" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.16" xref="footnote4.m4.1.1.16.cmml">y</mi><mo id="footnote4.m4.1.1.1o" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.17" xref="footnote4.m4.1.1.17.cmml">e</mi><mo id="footnote4.m4.1.1.1p" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.18" xref="footnote4.m4.1.1.18.cmml">r</mi><mo id="footnote4.m4.1.1.1q" xref="footnote4.m4.1.1.1.cmml">â¢</mo><mi id="footnote4.m4.1.1.19" xref="footnote4.m4.1.1.19.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m4.1c"><apply id="footnote4.m4.1.1.cmml" xref="footnote4.m4.1.1"><times id="footnote4.m4.1.1.1.cmml" xref="footnote4.m4.1.1.1"></times><apply id="footnote4.m4.1.1.2.cmml" xref="footnote4.m4.1.1.2"><times id="footnote4.m4.1.1.2.1.cmml" xref="footnote4.m4.1.1.2.1"></times><apply id="footnote4.m4.1.1.2.2.cmml" xref="footnote4.m4.1.1.2.2"><times id="footnote4.m4.1.1.2.2.1.cmml" xref="footnote4.m4.1.1.2.2.1"></times><apply id="footnote4.m4.1.1.2.2.2.cmml" xref="footnote4.m4.1.1.2.2.2"><times id="footnote4.m4.1.1.2.2.2.1.cmml" xref="footnote4.m4.1.1.2.2.2.1"></times><apply id="footnote4.m4.1.1.2.2.2.2.cmml" xref="footnote4.m4.1.1.2.2.2.2"><times id="footnote4.m4.1.1.2.2.2.2.1.cmml" xref="footnote4.m4.1.1.2.2.2.2.1"></times><apply id="footnote4.m4.1.1.2.2.2.2.2.cmml" xref="footnote4.m4.1.1.2.2.2.2.2"><times id="footnote4.m4.1.1.2.2.2.2.2.1.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.1"></times><apply id="footnote4.m4.1.1.2.2.2.2.2.2.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2"><times id="footnote4.m4.1.1.2.2.2.2.2.2.1.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.1"></times><apply id="footnote4.m4.1.1.2.2.2.2.2.2.2.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.2"><times id="footnote4.m4.1.1.2.2.2.2.2.2.2.1.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.1"></times><cn type="integer" id="footnote4.m4.1.1.2.2.2.2.2.2.2.2.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.2">12</cn><ci id="footnote4.m4.1.1.2.2.2.2.2.2.2.3.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.2.3">â„</ci></apply><ci id="footnote4.m4.1.1.2.2.2.2.2.2.3.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.3">ğ‘–</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.4.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.4">ğ‘‘</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.5.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.5">ğ‘‘</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.6.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.6">ğ‘’</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.7.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.7">ğ‘›</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.8.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.8">_</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.9.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.9">ğ‘‘</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.10.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.10">ğ‘–</ci><ci id="footnote4.m4.1.1.2.2.2.2.2.2.11.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.2.11">ğ‘š</ci></apply><ci id="footnote4.m4.1.1.2.2.2.2.2.3.cmml" xref="footnote4.m4.1.1.2.2.2.2.2.3">ğ‘</ci></apply><ci id="footnote4.m4.1.1.2.2.2.2.3.cmml" xref="footnote4.m4.1.1.2.2.2.2.3">ğ‘</ci><ci id="footnote4.m4.1.1.2.2.2.2.4.cmml" xref="footnote4.m4.1.1.2.2.2.2.4">ğ‘¡</ci><ci id="footnote4.m4.1.1.2.2.2.2.5.cmml" xref="footnote4.m4.1.1.2.2.2.2.5">ğ‘</ci><ci id="footnote4.m4.1.1.2.2.2.2.6.cmml" xref="footnote4.m4.1.1.2.2.2.2.6">â„</ci></apply><ci id="footnote4.m4.1.1.2.2.2.3.cmml" xref="footnote4.m4.1.1.2.2.2.3">ğ‘ </ci></apply><ci id="footnote4.m4.1.1.2.2.3.cmml" xref="footnote4.m4.1.1.2.2.3">ğ‘’</ci><ci id="footnote4.m4.1.1.2.2.4.cmml" xref="footnote4.m4.1.1.2.2.4">ğ‘</ci><ci id="footnote4.m4.1.1.2.2.5.cmml" xref="footnote4.m4.1.1.2.2.5">_</ci><ci id="footnote4.m4.1.1.2.2.6.cmml" xref="footnote4.m4.1.1.2.2.6">ğ‘™</ci><ci id="footnote4.m4.1.1.2.2.7.cmml" xref="footnote4.m4.1.1.2.2.7">ğ‘’</ci><ci id="footnote4.m4.1.1.2.2.8.cmml" xref="footnote4.m4.1.1.2.2.8">ğ‘›</ci><ci id="footnote4.m4.1.1.2.2.9.cmml" xref="footnote4.m4.1.1.2.2.9">ğ‘”</ci><ci id="footnote4.m4.1.1.2.2.10.cmml" xref="footnote4.m4.1.1.2.2.10">ğ‘¡</ci><ci id="footnote4.m4.1.1.2.2.11.cmml" xref="footnote4.m4.1.1.2.2.11">â„</ci></apply><ci id="footnote4.m4.1.1.2.3.cmml" xref="footnote4.m4.1.1.2.3">ğ‘¡</ci></apply><ci id="footnote4.m4.1.1.3.cmml" xref="footnote4.m4.1.1.3">ğ‘Ÿ</ci><ci id="footnote4.m4.1.1.4.cmml" xref="footnote4.m4.1.1.4">ğ‘</ci><ci id="footnote4.m4.1.1.5.cmml" xref="footnote4.m4.1.1.5">ğ‘›</ci><ci id="footnote4.m4.1.1.6.cmml" xref="footnote4.m4.1.1.6">ğ‘ </ci><ci id="footnote4.m4.1.1.7.cmml" xref="footnote4.m4.1.1.7">ğ‘“</ci><ci id="footnote4.m4.1.1.8.cmml" xref="footnote4.m4.1.1.8">ğ‘œ</ci><ci id="footnote4.m4.1.1.9.cmml" xref="footnote4.m4.1.1.9">ğ‘Ÿ</ci><ci id="footnote4.m4.1.1.10.cmml" xref="footnote4.m4.1.1.10">ğ‘š</ci><ci id="footnote4.m4.1.1.11.cmml" xref="footnote4.m4.1.1.11">ğ‘’</ci><ci id="footnote4.m4.1.1.12.cmml" xref="footnote4.m4.1.1.12">ğ‘Ÿ</ci><ci id="footnote4.m4.1.1.13.cmml" xref="footnote4.m4.1.1.13">_</ci><ci id="footnote4.m4.1.1.14.cmml" xref="footnote4.m4.1.1.14">ğ‘™</ci><ci id="footnote4.m4.1.1.15.cmml" xref="footnote4.m4.1.1.15">ğ‘</ci><ci id="footnote4.m4.1.1.16.cmml" xref="footnote4.m4.1.1.16">ğ‘¦</ci><ci id="footnote4.m4.1.1.17.cmml" xref="footnote4.m4.1.1.17">ğ‘’</ci><ci id="footnote4.m4.1.1.18.cmml" xref="footnote4.m4.1.1.18">ğ‘Ÿ</ci><ci id="footnote4.m4.1.1.19.cmml" xref="footnote4.m4.1.1.19">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m4.1d">12\times hidden\_dim\times batch\times seq\_length\times transformer\_layers</annotation><annotation encoding="application/x-llamapun" id="footnote4.m4.1e">12 Ã— italic_h italic_i italic_d italic_d italic_e italic_n _ italic_d italic_i italic_m Ã— italic_b italic_a italic_t italic_c italic_h Ã— italic_s italic_e italic_q _ italic_l italic_e italic_n italic_g italic_t italic_h Ã— italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m italic_e italic_r _ italic_l italic_a italic_y italic_e italic_r italic_s</annotation></semantics></math>.</span></span></span>. Activation checkpointing (or activation recomputation) is a common approach to reduce the activation memory by approximately the square root of the total activations at the expense of <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="33\%" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mn id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">33</mn><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">33\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">33 %</annotation></semantics></math> re-computation overhead <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. This would reduce the activation memory consumption of this model to about 8â€‰GB.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Despite the significant reduction, the activation memory can grow quite large for bigger models even with activation checkpointing. For example, a GPT-like model with 100 billion parameters requires around 60 GB of memory for batch size 32, even when using activation checkpointing.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p"><span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_bold">Temporary buffers</span> used for storing intermediate results consumes non-trivial amount of memory for large models. Operations such as gradient all-reduce, or gradient norm computation tend to fuse all the gradients into a single flattened buffer before applying the operation in an effort to improve throughput. For example, the bandwidth of all-reduce across devices improves with large message sizes. While the gradient themselves are usually stored as fp16 tensors, the fused buffer can be an fp32 tensor depending on the operation. When the size of the model is large, these temporary buffer sizes are non-trivial. For example, for a model with 1.5B parameters, a flattened fp32 buffer would required <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="6\,GB" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mn id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">6</mn><mo lspace="0.170em" id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">G</mi><mo id="S3.SS2.p3.1.m1.1.1.1a" xref="S3.SS2.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S3.SS2.p3.1.m1.1.1.4" xref="S3.SS2.p3.1.m1.1.1.4.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><times id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></times><cn type="integer" id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">6</cn><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">ğº</ci><ci id="S3.SS2.p3.1.m1.1.1.4.cmml" xref="S3.SS2.p3.1.m1.1.1.4">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">6\,GB</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">6 italic_G italic_B</annotation></semantics></math> of memory.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p"><span id="S3.SS2.p4.1.1" class="ltx_text ltx_font_bold">Memory Fragmentation: </span> So far we have discussed the actual memory consumption during training. Additionally, it is possible to run out of usable memory even when there is plenty of available memory. This can happen with memory fragmentation. A request for a memory will fail if there isnâ€™t enough contiguous memory to satisfy it, even if the total available memory is larger than requested. We observe significant memory fragmentation when training very large models, resulting in out of memory issue with over 30% of memory still available in some extreme cases.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><em id="S4.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>: Insights and Overview</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><em id="S4.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> has two sets of optimizations: i) <em id="S4.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP aimed at reducing the memory footprint of the model states, and ii) <em id="S4.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>-R targeted towards reducing the residual memory consumption. We present an overview of the optimizations and the insights behind, which allows <em id="S4.p1.1.4" class="ltx_emph ltx_font_italic">ZeRO</em> to reduce memory footprint while remaining efficient. Please note efficiency is a key here: without this constraint, trivial solutions like moving all the parameter states to the CPU memory, or increasing the MP degree arbitrarily can reduce memory footprint.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Insights and Overview: <em id="S4.SS1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><em id="S4.SS1.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> powered DP is based on three key insights:</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_italic">a)</span> DP has better scaling efficiency than MP because MP reduces the granularity of the computation while also increasing the communication overhead. Beyond a certain point, lower computational granularity reduces the efficiency per GPU, while the increased communication overhead, hiders the scalability across GPUs, especially when crossing node boundaries. On the contrary, DP has both higher computational granularity and lower communication volume, allowing for much higher efficiency.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_italic">b)</span> DP is memory inefficient as model states are stored redundantly across all data-parallel processes. On the contrary, MP partitions the model states to obtain memory efficiency.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_italic">c)</span> Both DP and MP keep all the model states needed over the entire training process, but not everything is required all the time. For example, parameters corresponding to each layer is only needed during the forward propagation and backward propagation of the layer. </p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">Based on these insights, <em id="S4.SS1.p5.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP retains the training efficiency of DP while achieving the memory efficiency of MP. <em id="S4.SS1.p5.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP <em id="S4.SS1.p5.1.3" class="ltx_emph ltx_font_italic">partitions</em> the model states instead of replicating them (Section <a href="#S5" title="5 Deep Dive into ZeRO-DP â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) and uses a dynamic communication schedule that exploits the intrinsically temporal nature of the model states while minimizing the communication volume (Section <a href="#S7" title="7 Communication Analysis of ZeRO-DP â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). By doing so, <em id="S4.SS1.p5.1.4" class="ltx_emph ltx_font_italic">ZeRO</em>-DP reduces per-device memory footprint of a model <em id="S4.SS1.p5.1.5" class="ltx_emph ltx_font_italic">linearly</em> with the increased DP degree while maintaining the communication volume close to that of the default DP, retaining the efficiency.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Insights and Overview: <em id="S4.SS2.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Reducing Activation Memory</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">Two key insights are:</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p"><span id="S4.SS2.SSS1.p2.1.1" class="ltx_text ltx_font_italic">a)</span> MP partitions the model states but often requires replication of the activation memory. For example, if we split the parameters of a linear layer vertically and compute them in parallel across two GPUs, each GPU requires the entire activation to compute its partition
</p>
</div>
<div id="S4.SS2.SSS1.p3" class="ltx_para">
<p id="S4.SS2.SSS1.p3.1" class="ltx_p"><span id="S4.SS2.SSS1.p3.1.1" class="ltx_text ltx_font_italic">b)</span> For models such as GPT-2 or larger, the arithmetic intensity (ratio of the amount of computation per iteration to amount of activation checkpoints per iteration) is very large (<math id="S4.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="\geq 10K" display="inline"><semantics id="S4.SS2.SSS1.p3.1.m1.1a"><mrow id="S4.SS2.SSS1.p3.1.m1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.1.m1.1.1.2" xref="S4.SS2.SSS1.p3.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.SSS1.p3.1.m1.1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.1.cmml">â‰¥</mo><mrow id="S4.SS2.SSS1.p3.1.m1.1.1.3" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.cmml"><mn id="S4.SS2.SSS1.p3.1.m1.1.1.3.2" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.2.cmml">10</mn><mo id="S4.SS2.SSS1.p3.1.m1.1.1.3.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S4.SS2.SSS1.p3.1.m1.1.1.3.3" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.1b"><apply id="S4.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1"><geq id="S4.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.1"></geq><csymbol cd="latexml" id="S4.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.2">absent</csymbol><apply id="S4.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3"><times id="S4.SS2.SSS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.1"></times><cn type="integer" id="S4.SS2.SSS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.2">10</cn><ci id="S4.SS2.SSS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1.3.3">ğ¾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.1c">\geq 10K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.1.m1.1d">â‰¥ 10 italic_K</annotation></semantics></math>) and increases linearly with hidden dimension making it possible to hide the data-movement cost for the activation checkpoints, even when the bandwidth is low.</p>
</div>
<div id="S4.SS2.SSS1.p4" class="ltx_para">
<p id="S4.SS2.SSS1.p4.1" class="ltx_p"><em id="S4.SS2.SSS1.p4.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> removes the memory redundancies in MP by <em id="S4.SS2.SSS1.p4.1.2" class="ltx_emph ltx_font_italic">partitioning</em> the activations checkpoints across GPUs, and uses allgather to reconstruct them on demand. The activation memory footprint is reduced proportional to the MP degree. For very large models, <em id="S4.SS2.SSS1.p4.1.3" class="ltx_emph ltx_font_italic">ZeRO</em> can even choose to move the activation partitions to the CPU memory, while still achieving good efficiency due to large arithmetic intensity in these models.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Managing Temporary buffers</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p"><em id="S4.SS2.SSS2.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R uses constant size buffers to avoid temporary buffers from blowing up as the model size increases, while making them large enough to remain efficient.</p>
</div>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3 </span>Managing fragmented Memory</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para">
<p id="S4.SS2.SSS3.p1.1" class="ltx_p">Memory fragmentation is a result of interleaving between short lived and long lived memory objects. During the forward propagation activation checkpoints are long lived but the activations that recomputed are short lived. Similarly, the backward computation, the activation gradients are short lived while the parameter gradients are long lived. Based on this insight, <em id="S4.SS2.SSS3.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> performs on-the-fly memory defragmentation by moving activation checkpoints and gradients to pre-allocated contiguous memory buffers. This not only increases memory availability but also improves efficiency by reducing the time it takes for the memory allocator to find free contiguous memory.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Deep Dive into <em id="S5.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.3" class="ltx_p">While the existing DP approach replicates the model states at each device and introduces significant memory overhead, <em id="S5.p1.3.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP eliminates this memory redundancy by partitioning them â€” optimizer states, gradients and parameters â€” across data parallel processes.
Figure <a href="#S1.F1" title="Figure 1 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> quantifies and visualizes the memory requirement with and without <em id="S5.p1.3.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP. The figure shows the memory footprint after partitioning (1) optimizer state, (2) gradient and (3) parameter redundancies accumulatively. We refer to them as the three optimization phases of <em id="S5.p1.3.3" class="ltx_emph ltx_font_italic">ZeRO</em>-DP: <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml"><mi id="S5.p1.1.m1.1.1.3.2" xref="S5.p1.1.m1.1.1.3.2.cmml">o</mi><mo id="S5.p1.1.m1.1.1.3.1" xref="S5.p1.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S5.p1.1.m1.1.1.3.3" xref="S5.p1.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3"><times id="S5.p1.1.m1.1.1.3.1.cmml" xref="S5.p1.1.m1.1.1.3.1"></times><ci id="S5.p1.1.m1.1.1.3.2.cmml" xref="S5.p1.1.m1.1.1.3.2">ğ‘œ</ci><ci id="S5.p1.1.m1.1.1.3.3.cmml" xref="S5.p1.1.m1.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="P_{g}" display="inline"><semantics id="S5.p1.2.m2.1a"><msub id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">P</mi><mi id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1.2">ğ‘ƒ</ci><ci id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">P_{g}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, and <math id="S5.p1.3.m3.1" class="ltx_Math" alttext="P_{p}" display="inline"><semantics id="S5.p1.3.m3.1a"><msub id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml"><mi id="S5.p1.3.m3.1.1.2" xref="S5.p1.3.m3.1.1.2.cmml">P</mi><mi id="S5.p1.3.m3.1.1.3" xref="S5.p1.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p1.3.m3.1b"><apply id="S5.p1.3.m3.1.1.cmml" xref="S5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p1.3.m3.1.1.1.cmml" xref="S5.p1.3.m3.1.1">subscript</csymbol><ci id="S5.p1.3.m3.1.1.2.cmml" xref="S5.p1.3.m3.1.1.2">ğ‘ƒ</ci><ci id="S5.p1.3.m3.1.1.3.cmml" xref="S5.p1.3.m3.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.3.m3.1c">P_{p}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, which we elaborate below.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>P<math id="S5.SS1.1.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S5.SS1.1.m1.1b"><msub id="S5.SS1.1.m1.1.1" xref="S5.SS1.1.m1.1.1.cmml"><mi id="S5.SS1.1.m1.1.1b" xref="S5.SS1.1.m1.1.1.cmml"></mi><mrow id="S5.SS1.1.m1.1.1.1" xref="S5.SS1.1.m1.1.1.1.cmml"><mi id="S5.SS1.1.m1.1.1.1.2" xref="S5.SS1.1.m1.1.1.1.2.cmml">o</mi><mo id="S5.SS1.1.m1.1.1.1.1" xref="S5.SS1.1.m1.1.1.1.1.cmml">â¢</mo><mi id="S5.SS1.1.m1.1.1.1.3" xref="S5.SS1.1.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.1.m1.1c"><apply id="S5.SS1.1.m1.1.1.cmml" xref="S5.SS1.1.m1.1.1"><apply id="S5.SS1.1.m1.1.1.1.cmml" xref="S5.SS1.1.m1.1.1.1"><times id="S5.SS1.1.m1.1.1.1.1.cmml" xref="S5.SS1.1.m1.1.1.1.1"></times><ci id="S5.SS1.1.m1.1.1.1.2.cmml" xref="S5.SS1.1.m1.1.1.1.2">ğ‘œ</ci><ci id="S5.SS1.1.m1.1.1.1.3.cmml" xref="S5.SS1.1.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.1.m1.1d">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.1.m1.1e">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math> : Optimizer State Partitioning </h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.6" class="ltx_p">For a DP degree of <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><msub id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">N</mi><mi id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">ğ‘</ci><ci id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, we group the optimizer states into <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><msub id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">N</mi><mi id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">ğ‘</ci><ci id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> equal partitions, such that the <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><msup id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">i</mi><mrow id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml"><mi id="S5.SS1.p1.3.m3.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S5.SS1.p1.3.m3.1.1.3.1" xref="S5.SS1.p1.3.m3.1.1.3.1.cmml">â¢</mo><mi id="S5.SS1.p1.3.m3.1.1.3.3" xref="S5.SS1.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">ğ‘–</ci><apply id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3"><times id="S5.SS1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.3.1"></times><ci id="S5.SS1.p1.3.m3.1.1.3.2.cmml" xref="S5.SS1.p1.3.m3.1.1.3.2">ğ‘¡</ci><ci id="S5.SS1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3.3">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> data parallel process only updates the optimizer states corresponding to the <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><msup id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">i</mi><mrow id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml"><mi id="S5.SS1.p1.4.m4.1.1.3.2" xref="S5.SS1.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S5.SS1.p1.4.m4.1.1.3.1" xref="S5.SS1.p1.4.m4.1.1.3.1.cmml">â¢</mo><mi id="S5.SS1.p1.4.m4.1.1.3.3" xref="S5.SS1.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">ğ‘–</ci><apply id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3"><times id="S5.SS1.p1.4.m4.1.1.3.1.cmml" xref="S5.SS1.p1.4.m4.1.1.3.1"></times><ci id="S5.SS1.p1.4.m4.1.1.3.2.cmml" xref="S5.SS1.p1.4.m4.1.1.3.2">ğ‘¡</ci><ci id="S5.SS1.p1.4.m4.1.1.3.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3.3">â„</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> partition. Thus, each data parallel process only needs to store and update <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="\frac{1}{N_{d}}" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mfrac id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml"><mn id="S5.SS1.p1.5.m5.1.1.2" xref="S5.SS1.p1.5.m5.1.1.2.cmml">1</mn><msub id="S5.SS1.p1.5.m5.1.1.3" xref="S5.SS1.p1.5.m5.1.1.3.cmml"><mi id="S5.SS1.p1.5.m5.1.1.3.2" xref="S5.SS1.p1.5.m5.1.1.3.2.cmml">N</mi><mi id="S5.SS1.p1.5.m5.1.1.3.3" xref="S5.SS1.p1.5.m5.1.1.3.3.cmml">d</mi></msub></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><apply id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"><divide id="S5.SS1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1"></divide><cn type="integer" id="S5.SS1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.p1.5.m5.1.1.2">1</cn><apply id="S5.SS1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.5.m5.1.1.3.1.cmml" xref="S5.SS1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S5.SS1.p1.5.m5.1.1.3.2.cmml" xref="S5.SS1.p1.5.m5.1.1.3.2">ğ‘</ci><ci id="S5.SS1.p1.5.m5.1.1.3.3.cmml" xref="S5.SS1.p1.5.m5.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">\frac{1}{N_{d}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> of the total optimizer states and then only update <math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="\frac{1}{N_{d}}" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mfrac id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml"><mn id="S5.SS1.p1.6.m6.1.1.2" xref="S5.SS1.p1.6.m6.1.1.2.cmml">1</mn><msub id="S5.SS1.p1.6.m6.1.1.3" xref="S5.SS1.p1.6.m6.1.1.3.cmml"><mi id="S5.SS1.p1.6.m6.1.1.3.2" xref="S5.SS1.p1.6.m6.1.1.3.2.cmml">N</mi><mi id="S5.SS1.p1.6.m6.1.1.3.3" xref="S5.SS1.p1.6.m6.1.1.3.3.cmml">d</mi></msub></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><apply id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1"><divide id="S5.SS1.p1.6.m6.1.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1"></divide><cn type="integer" id="S5.SS1.p1.6.m6.1.1.2.cmml" xref="S5.SS1.p1.6.m6.1.1.2">1</cn><apply id="S5.SS1.p1.6.m6.1.1.3.cmml" xref="S5.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.6.m6.1.1.3.1.cmml" xref="S5.SS1.p1.6.m6.1.1.3">subscript</csymbol><ci id="S5.SS1.p1.6.m6.1.1.3.2.cmml" xref="S5.SS1.p1.6.m6.1.1.3.2">ğ‘</ci><ci id="S5.SS1.p1.6.m6.1.1.3.3.cmml" xref="S5.SS1.p1.6.m6.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\frac{1}{N_{d}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.6.m6.1d">divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> of the parameters.
We perform an all-gather across the data parallel process at the end of each training step to get the fully updated parameters across all data parallel process. </p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.7" class="ltx_p"><span id="S5.SS1.p2.7.1" class="ltx_text ltx_font_bold">Memory Savings: </span> As shown in Figure 1, the memory consumption after optimizing state partition reduces from <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="4\Psi+K\Psi" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mrow id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml"><mn id="S5.SS1.p2.1.m1.1.1.2.2" xref="S5.SS1.p2.1.m1.1.1.2.2.cmml">4</mn><mo id="S5.SS1.p2.1.m1.1.1.2.1" xref="S5.SS1.p2.1.m1.1.1.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.1.m1.1.1.2.3" xref="S5.SS1.p2.1.m1.1.1.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">+</mo><mrow id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml"><mi id="S5.SS1.p2.1.m1.1.1.3.2" xref="S5.SS1.p2.1.m1.1.1.3.2.cmml">K</mi><mo id="S5.SS1.p2.1.m1.1.1.3.1" xref="S5.SS1.p2.1.m1.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.1.m1.1.1.3.3" xref="S5.SS1.p2.1.m1.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><plus id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1"></plus><apply id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2"><times id="S5.SS1.p2.1.m1.1.1.2.1.cmml" xref="S5.SS1.p2.1.m1.1.1.2.1"></times><cn type="integer" id="S5.SS1.p2.1.m1.1.1.2.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2.2">4</cn><ci id="S5.SS1.p2.1.m1.1.1.2.3.cmml" xref="S5.SS1.p2.1.m1.1.1.2.3">Î¨</ci></apply><apply id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3"><times id="S5.SS1.p2.1.m1.1.1.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3.1"></times><ci id="S5.SS1.p2.1.m1.1.1.3.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2">ğ¾</ci><ci id="S5.SS1.p2.1.m1.1.1.3.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">4\Psi+K\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">4 roman_Î¨ + italic_K roman_Î¨</annotation></semantics></math> to <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="4\Psi+\frac{K\Psi}{N_{d}}" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mrow id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><mrow id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml"><mn id="S5.SS1.p2.2.m2.1.1.2.2" xref="S5.SS1.p2.2.m2.1.1.2.2.cmml">4</mn><mo id="S5.SS1.p2.2.m2.1.1.2.1" xref="S5.SS1.p2.2.m2.1.1.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.2.m2.1.1.2.3" xref="S5.SS1.p2.2.m2.1.1.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS1.p2.2.m2.1.1.1" xref="S5.SS1.p2.2.m2.1.1.1.cmml">+</mo><mfrac id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml"><mrow id="S5.SS1.p2.2.m2.1.1.3.2" xref="S5.SS1.p2.2.m2.1.1.3.2.cmml"><mi id="S5.SS1.p2.2.m2.1.1.3.2.2" xref="S5.SS1.p2.2.m2.1.1.3.2.2.cmml">K</mi><mo id="S5.SS1.p2.2.m2.1.1.3.2.1" xref="S5.SS1.p2.2.m2.1.1.3.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.2.m2.1.1.3.2.3" xref="S5.SS1.p2.2.m2.1.1.3.2.3.cmml">Î¨</mi></mrow><msub id="S5.SS1.p2.2.m2.1.1.3.3" xref="S5.SS1.p2.2.m2.1.1.3.3.cmml"><mi id="S5.SS1.p2.2.m2.1.1.3.3.2" xref="S5.SS1.p2.2.m2.1.1.3.3.2.cmml">N</mi><mi id="S5.SS1.p2.2.m2.1.1.3.3.3" xref="S5.SS1.p2.2.m2.1.1.3.3.3.cmml">d</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><plus id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1"></plus><apply id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2"><times id="S5.SS1.p2.2.m2.1.1.2.1.cmml" xref="S5.SS1.p2.2.m2.1.1.2.1"></times><cn type="integer" id="S5.SS1.p2.2.m2.1.1.2.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2.2">4</cn><ci id="S5.SS1.p2.2.m2.1.1.2.3.cmml" xref="S5.SS1.p2.2.m2.1.1.2.3">Î¨</ci></apply><apply id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3"><divide id="S5.SS1.p2.2.m2.1.1.3.1.cmml" xref="S5.SS1.p2.2.m2.1.1.3"></divide><apply id="S5.SS1.p2.2.m2.1.1.3.2.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2"><times id="S5.SS1.p2.2.m2.1.1.3.2.1.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2.1"></times><ci id="S5.SS1.p2.2.m2.1.1.3.2.2.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2.2">ğ¾</ci><ci id="S5.SS1.p2.2.m2.1.1.3.2.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2.3">Î¨</ci></apply><apply id="S5.SS1.p2.2.m2.1.1.3.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="S5.SS1.p2.2.m2.1.1.3.3.2.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3.2">ğ‘</ci><ci id="S5.SS1.p2.2.m2.1.1.3.3.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3.3">ğ‘‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">4\Psi+\frac{K\Psi}{N_{d}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.1d">4 roman_Î¨ + divide start_ARG italic_K roman_Î¨ end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. As the concrete example depicted in Figure <a href="#S1.F1" title="Figure 1 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, a 7.5 B parameter model requires 31.4GB of memory using <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><msub id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">P</mi><mrow id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml"><mi id="S5.SS1.p2.3.m3.1.1.3.2" xref="S5.SS1.p2.3.m3.1.1.3.2.cmml">o</mi><mo id="S5.SS1.p2.3.m3.1.1.3.1" xref="S5.SS1.p2.3.m3.1.1.3.1.cmml">â¢</mo><mi id="S5.SS1.p2.3.m3.1.1.3.3" xref="S5.SS1.p2.3.m3.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">ğ‘ƒ</ci><apply id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3"><times id="S5.SS1.p2.3.m3.1.1.3.1.cmml" xref="S5.SS1.p2.3.m3.1.1.3.1"></times><ci id="S5.SS1.p2.3.m3.1.1.3.2.cmml" xref="S5.SS1.p2.3.m3.1.1.3.2">ğ‘œ</ci><ci id="S5.SS1.p2.3.m3.1.1.3.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> with 64-way DP (<math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="N_{d}=64" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mrow id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><msub id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml"><mi id="S5.SS1.p2.4.m4.1.1.2.2" xref="S5.SS1.p2.4.m4.1.1.2.2.cmml">N</mi><mi id="S5.SS1.p2.4.m4.1.1.2.3" xref="S5.SS1.p2.4.m4.1.1.2.3.cmml">d</mi></msub><mo id="S5.SS1.p2.4.m4.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><eq id="S5.SS1.p2.4.m4.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1"></eq><apply id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.2.1.cmml" xref="S5.SS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.2.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2.2">ğ‘</ci><ci id="S5.SS1.p2.4.m4.1.1.2.3.cmml" xref="S5.SS1.p2.4.m4.1.1.2.3">ğ‘‘</ci></apply><cn type="integer" id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">N_{d}=64</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 64</annotation></semantics></math>), while requiring 120 GB with standard DP.
Furthermore, when <math id="S5.SS1.p2.5.m5.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S5.SS1.p2.5.m5.1a"><msub id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml"><mi id="S5.SS1.p2.5.m5.1.1.2" xref="S5.SS1.p2.5.m5.1.1.2.cmml">N</mi><mi id="S5.SS1.p2.5.m5.1.1.3" xref="S5.SS1.p2.5.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><apply id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS1.p2.5.m5.1.1.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2">ğ‘</ci><ci id="S5.SS1.p2.5.m5.1.1.3.cmml" xref="S5.SS1.p2.5.m5.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is large, the memory requirement on model states reduces from <math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="4\Psi+12\Psi=16\Psi" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><mrow id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml"><mrow id="S5.SS1.p2.6.m6.1.1.2" xref="S5.SS1.p2.6.m6.1.1.2.cmml"><mrow id="S5.SS1.p2.6.m6.1.1.2.2" xref="S5.SS1.p2.6.m6.1.1.2.2.cmml"><mn id="S5.SS1.p2.6.m6.1.1.2.2.2" xref="S5.SS1.p2.6.m6.1.1.2.2.2.cmml">4</mn><mo id="S5.SS1.p2.6.m6.1.1.2.2.1" xref="S5.SS1.p2.6.m6.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.6.m6.1.1.2.2.3" xref="S5.SS1.p2.6.m6.1.1.2.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS1.p2.6.m6.1.1.2.1" xref="S5.SS1.p2.6.m6.1.1.2.1.cmml">+</mo><mrow id="S5.SS1.p2.6.m6.1.1.2.3" xref="S5.SS1.p2.6.m6.1.1.2.3.cmml"><mn id="S5.SS1.p2.6.m6.1.1.2.3.2" xref="S5.SS1.p2.6.m6.1.1.2.3.2.cmml">12</mn><mo id="S5.SS1.p2.6.m6.1.1.2.3.1" xref="S5.SS1.p2.6.m6.1.1.2.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.6.m6.1.1.2.3.3" xref="S5.SS1.p2.6.m6.1.1.2.3.3.cmml">Î¨</mi></mrow></mrow><mo id="S5.SS1.p2.6.m6.1.1.1" xref="S5.SS1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S5.SS1.p2.6.m6.1.1.3" xref="S5.SS1.p2.6.m6.1.1.3.cmml"><mn id="S5.SS1.p2.6.m6.1.1.3.2" xref="S5.SS1.p2.6.m6.1.1.3.2.cmml">16</mn><mo id="S5.SS1.p2.6.m6.1.1.3.1" xref="S5.SS1.p2.6.m6.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.6.m6.1.1.3.3" xref="S5.SS1.p2.6.m6.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><apply id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1"><eq id="S5.SS1.p2.6.m6.1.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1.1"></eq><apply id="S5.SS1.p2.6.m6.1.1.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2"><plus id="S5.SS1.p2.6.m6.1.1.2.1.cmml" xref="S5.SS1.p2.6.m6.1.1.2.1"></plus><apply id="S5.SS1.p2.6.m6.1.1.2.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2.2"><times id="S5.SS1.p2.6.m6.1.1.2.2.1.cmml" xref="S5.SS1.p2.6.m6.1.1.2.2.1"></times><cn type="integer" id="S5.SS1.p2.6.m6.1.1.2.2.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2.2.2">4</cn><ci id="S5.SS1.p2.6.m6.1.1.2.2.3.cmml" xref="S5.SS1.p2.6.m6.1.1.2.2.3">Î¨</ci></apply><apply id="S5.SS1.p2.6.m6.1.1.2.3.cmml" xref="S5.SS1.p2.6.m6.1.1.2.3"><times id="S5.SS1.p2.6.m6.1.1.2.3.1.cmml" xref="S5.SS1.p2.6.m6.1.1.2.3.1"></times><cn type="integer" id="S5.SS1.p2.6.m6.1.1.2.3.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2.3.2">12</cn><ci id="S5.SS1.p2.6.m6.1.1.2.3.3.cmml" xref="S5.SS1.p2.6.m6.1.1.2.3.3">Î¨</ci></apply></apply><apply id="S5.SS1.p2.6.m6.1.1.3.cmml" xref="S5.SS1.p2.6.m6.1.1.3"><times id="S5.SS1.p2.6.m6.1.1.3.1.cmml" xref="S5.SS1.p2.6.m6.1.1.3.1"></times><cn type="integer" id="S5.SS1.p2.6.m6.1.1.3.2.cmml" xref="S5.SS1.p2.6.m6.1.1.3.2">16</cn><ci id="S5.SS1.p2.6.m6.1.1.3.3.cmml" xref="S5.SS1.p2.6.m6.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">4\Psi+12\Psi=16\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.6.m6.1d">4 roman_Î¨ + 12 roman_Î¨ = 16 roman_Î¨</annotation></semantics></math> bytes to <math id="S5.SS1.p2.7.m7.1" class="ltx_Math" alttext="4\Psi+\frac{12\Psi}{N_{d}}\approx 4\Psi" display="inline"><semantics id="S5.SS1.p2.7.m7.1a"><mrow id="S5.SS1.p2.7.m7.1.1" xref="S5.SS1.p2.7.m7.1.1.cmml"><mrow id="S5.SS1.p2.7.m7.1.1.2" xref="S5.SS1.p2.7.m7.1.1.2.cmml"><mrow id="S5.SS1.p2.7.m7.1.1.2.2" xref="S5.SS1.p2.7.m7.1.1.2.2.cmml"><mn id="S5.SS1.p2.7.m7.1.1.2.2.2" xref="S5.SS1.p2.7.m7.1.1.2.2.2.cmml">4</mn><mo id="S5.SS1.p2.7.m7.1.1.2.2.1" xref="S5.SS1.p2.7.m7.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.7.m7.1.1.2.2.3" xref="S5.SS1.p2.7.m7.1.1.2.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS1.p2.7.m7.1.1.2.1" xref="S5.SS1.p2.7.m7.1.1.2.1.cmml">+</mo><mfrac id="S5.SS1.p2.7.m7.1.1.2.3" xref="S5.SS1.p2.7.m7.1.1.2.3.cmml"><mrow id="S5.SS1.p2.7.m7.1.1.2.3.2" xref="S5.SS1.p2.7.m7.1.1.2.3.2.cmml"><mn id="S5.SS1.p2.7.m7.1.1.2.3.2.2" xref="S5.SS1.p2.7.m7.1.1.2.3.2.2.cmml">12</mn><mo id="S5.SS1.p2.7.m7.1.1.2.3.2.1" xref="S5.SS1.p2.7.m7.1.1.2.3.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.7.m7.1.1.2.3.2.3" xref="S5.SS1.p2.7.m7.1.1.2.3.2.3.cmml">Î¨</mi></mrow><msub id="S5.SS1.p2.7.m7.1.1.2.3.3" xref="S5.SS1.p2.7.m7.1.1.2.3.3.cmml"><mi id="S5.SS1.p2.7.m7.1.1.2.3.3.2" xref="S5.SS1.p2.7.m7.1.1.2.3.3.2.cmml">N</mi><mi id="S5.SS1.p2.7.m7.1.1.2.3.3.3" xref="S5.SS1.p2.7.m7.1.1.2.3.3.3.cmml">d</mi></msub></mfrac></mrow><mo id="S5.SS1.p2.7.m7.1.1.1" xref="S5.SS1.p2.7.m7.1.1.1.cmml">â‰ˆ</mo><mrow id="S5.SS1.p2.7.m7.1.1.3" xref="S5.SS1.p2.7.m7.1.1.3.cmml"><mn id="S5.SS1.p2.7.m7.1.1.3.2" xref="S5.SS1.p2.7.m7.1.1.3.2.cmml">4</mn><mo id="S5.SS1.p2.7.m7.1.1.3.1" xref="S5.SS1.p2.7.m7.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS1.p2.7.m7.1.1.3.3" xref="S5.SS1.p2.7.m7.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.1b"><apply id="S5.SS1.p2.7.m7.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1"><approx id="S5.SS1.p2.7.m7.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1"></approx><apply id="S5.SS1.p2.7.m7.1.1.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2"><plus id="S5.SS1.p2.7.m7.1.1.2.1.cmml" xref="S5.SS1.p2.7.m7.1.1.2.1"></plus><apply id="S5.SS1.p2.7.m7.1.1.2.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2.2"><times id="S5.SS1.p2.7.m7.1.1.2.2.1.cmml" xref="S5.SS1.p2.7.m7.1.1.2.2.1"></times><cn type="integer" id="S5.SS1.p2.7.m7.1.1.2.2.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2.2.2">4</cn><ci id="S5.SS1.p2.7.m7.1.1.2.2.3.cmml" xref="S5.SS1.p2.7.m7.1.1.2.2.3">Î¨</ci></apply><apply id="S5.SS1.p2.7.m7.1.1.2.3.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3"><divide id="S5.SS1.p2.7.m7.1.1.2.3.1.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3"></divide><apply id="S5.SS1.p2.7.m7.1.1.2.3.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.2"><times id="S5.SS1.p2.7.m7.1.1.2.3.2.1.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.2.1"></times><cn type="integer" id="S5.SS1.p2.7.m7.1.1.2.3.2.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.2.2">12</cn><ci id="S5.SS1.p2.7.m7.1.1.2.3.2.3.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.2.3">Î¨</ci></apply><apply id="S5.SS1.p2.7.m7.1.1.2.3.3.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.1.1.2.3.3.1.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.3">subscript</csymbol><ci id="S5.SS1.p2.7.m7.1.1.2.3.3.2.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.3.2">ğ‘</ci><ci id="S5.SS1.p2.7.m7.1.1.2.3.3.3.cmml" xref="S5.SS1.p2.7.m7.1.1.2.3.3.3">ğ‘‘</ci></apply></apply></apply><apply id="S5.SS1.p2.7.m7.1.1.3.cmml" xref="S5.SS1.p2.7.m7.1.1.3"><times id="S5.SS1.p2.7.m7.1.1.3.1.cmml" xref="S5.SS1.p2.7.m7.1.1.3.1"></times><cn type="integer" id="S5.SS1.p2.7.m7.1.1.3.2.cmml" xref="S5.SS1.p2.7.m7.1.1.3.2">4</cn><ci id="S5.SS1.p2.7.m7.1.1.3.3.cmml" xref="S5.SS1.p2.7.m7.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.1c">4\Psi+\frac{12\Psi}{N_{d}}\approx 4\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.7.m7.1d">4 roman_Î¨ + divide start_ARG 12 roman_Î¨ end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG â‰ˆ 4 roman_Î¨</annotation></semantics></math> bytes, leading to a 4x reduction.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>P<math id="S5.SS2.1.m1.1" class="ltx_Math" alttext="{}_{g}" display="inline"><semantics id="S5.SS2.1.m1.1b"><msub id="S5.SS2.1.m1.1.1" xref="S5.SS2.1.m1.1.1.cmml"><mi id="S5.SS2.1.m1.1.1b" xref="S5.SS2.1.m1.1.1.cmml"></mi><mi id="S5.SS2.1.m1.1.1.1" xref="S5.SS2.1.m1.1.1.1.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.1.m1.1c"><apply id="S5.SS2.1.m1.1.1.cmml" xref="S5.SS2.1.m1.1.1"><ci id="S5.SS2.1.m1.1.1.1.cmml" xref="S5.SS2.1.m1.1.1.1">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.1.m1.1d">{}_{g}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.1.m1.1e">start_FLOATSUBSCRIPT italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>: Gradient Partitioning</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.2" class="ltx_p">As each data parallel process only updates its corresponding parameter partition, it only needs the reduced gradients for the corresponding parameters. Therefore, as each gradient of each layer becomes available during the backward propagation, we only reduce them on the data parallel process responsible for updating the corresponding parameters. After the reduction we no longer need the gradients and their memory can be released. This reduces the memory footprint required to hold the gradients from <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="2\Psi" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mn id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">2</mn><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><times id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"></times><cn type="integer" id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">2</cn><ci id="S5.SS2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.p1.1.m1.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">2\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">2 roman_Î¨</annotation></semantics></math> bytes to <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\frac{2\Psi}{N_{d}}" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mfrac id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mrow id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml"><mn id="S5.SS2.p1.2.m2.1.1.2.2" xref="S5.SS2.p1.2.m2.1.1.2.2.cmml">2</mn><mo id="S5.SS2.p1.2.m2.1.1.2.1" xref="S5.SS2.p1.2.m2.1.1.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p1.2.m2.1.1.2.3" xref="S5.SS2.p1.2.m2.1.1.2.3.cmml">Î¨</mi></mrow><msub id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml"><mi id="S5.SS2.p1.2.m2.1.1.3.2" xref="S5.SS2.p1.2.m2.1.1.3.2.cmml">N</mi><mi id="S5.SS2.p1.2.m2.1.1.3.3" xref="S5.SS2.p1.2.m2.1.1.3.3.cmml">d</mi></msub></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><divide id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"></divide><apply id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2"><times id="S5.SS2.p1.2.m2.1.1.2.1.cmml" xref="S5.SS2.p1.2.m2.1.1.2.1"></times><cn type="integer" id="S5.SS2.p1.2.m2.1.1.2.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2.2">2</cn><ci id="S5.SS2.p1.2.m2.1.1.2.3.cmml" xref="S5.SS2.p1.2.m2.1.1.2.3">Î¨</ci></apply><apply id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.3.1.cmml" xref="S5.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.3.2.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2">ğ‘</ci><ci id="S5.SS2.p1.2.m2.1.1.3.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\frac{2\Psi}{N_{d}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">divide start_ARG 2 roman_Î¨ end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Effectively this is a Reduce-Scatter operation, where gradients corresponding to different parameters are reduced to different process. To make this more efficient in practice, we use a bucketization strategy, where we bucketize all the gradients corresponding to a particular partition, and perform reduction on the entire bucket at once.
This is similar in spirit to how NVIDIAâ€™s AMP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> optimizer bucketizes the all-reduce gradient computation to overlap communication and computation. In our case we perform a reduction instead of an all-reduce at the partition boundaries to reduce memory footprint and overlap computation and communication. </p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.6" class="ltx_p"><span id="S5.SS2.p3.6.1" class="ltx_text ltx_font_bold">Memory Savings:</span> By removing both gradient and optimizer state redundancy, we reduce the memory footprint further down to <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="2\Psi+\frac{14\Psi}{N_{d}}\approx 2\Psi" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mrow id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mrow id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml"><mrow id="S5.SS2.p3.1.m1.1.1.2.2" xref="S5.SS2.p3.1.m1.1.1.2.2.cmml"><mn id="S5.SS2.p3.1.m1.1.1.2.2.2" xref="S5.SS2.p3.1.m1.1.1.2.2.2.cmml">2</mn><mo id="S5.SS2.p3.1.m1.1.1.2.2.1" xref="S5.SS2.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.1.m1.1.1.2.2.3" xref="S5.SS2.p3.1.m1.1.1.2.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS2.p3.1.m1.1.1.2.1" xref="S5.SS2.p3.1.m1.1.1.2.1.cmml">+</mo><mfrac id="S5.SS2.p3.1.m1.1.1.2.3" xref="S5.SS2.p3.1.m1.1.1.2.3.cmml"><mrow id="S5.SS2.p3.1.m1.1.1.2.3.2" xref="S5.SS2.p3.1.m1.1.1.2.3.2.cmml"><mn id="S5.SS2.p3.1.m1.1.1.2.3.2.2" xref="S5.SS2.p3.1.m1.1.1.2.3.2.2.cmml">14</mn><mo id="S5.SS2.p3.1.m1.1.1.2.3.2.1" xref="S5.SS2.p3.1.m1.1.1.2.3.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.1.m1.1.1.2.3.2.3" xref="S5.SS2.p3.1.m1.1.1.2.3.2.3.cmml">Î¨</mi></mrow><msub id="S5.SS2.p3.1.m1.1.1.2.3.3" xref="S5.SS2.p3.1.m1.1.1.2.3.3.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2.3.3.2" xref="S5.SS2.p3.1.m1.1.1.2.3.3.2.cmml">N</mi><mi id="S5.SS2.p3.1.m1.1.1.2.3.3.3" xref="S5.SS2.p3.1.m1.1.1.2.3.3.3.cmml">d</mi></msub></mfrac></mrow><mo id="S5.SS2.p3.1.m1.1.1.1" xref="S5.SS2.p3.1.m1.1.1.1.cmml">â‰ˆ</mo><mrow id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml"><mn id="S5.SS2.p3.1.m1.1.1.3.2" xref="S5.SS2.p3.1.m1.1.1.3.2.cmml">2</mn><mo id="S5.SS2.p3.1.m1.1.1.3.1" xref="S5.SS2.p3.1.m1.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.1.m1.1.1.3.3" xref="S5.SS2.p3.1.m1.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><approx id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1.1"></approx><apply id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2"><plus id="S5.SS2.p3.1.m1.1.1.2.1.cmml" xref="S5.SS2.p3.1.m1.1.1.2.1"></plus><apply id="S5.SS2.p3.1.m1.1.1.2.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2.2"><times id="S5.SS2.p3.1.m1.1.1.2.2.1.cmml" xref="S5.SS2.p3.1.m1.1.1.2.2.1"></times><cn type="integer" id="S5.SS2.p3.1.m1.1.1.2.2.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2.2.2">2</cn><ci id="S5.SS2.p3.1.m1.1.1.2.2.3.cmml" xref="S5.SS2.p3.1.m1.1.1.2.2.3">Î¨</ci></apply><apply id="S5.SS2.p3.1.m1.1.1.2.3.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3"><divide id="S5.SS2.p3.1.m1.1.1.2.3.1.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3"></divide><apply id="S5.SS2.p3.1.m1.1.1.2.3.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.2"><times id="S5.SS2.p3.1.m1.1.1.2.3.2.1.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.2.1"></times><cn type="integer" id="S5.SS2.p3.1.m1.1.1.2.3.2.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.2.2">14</cn><ci id="S5.SS2.p3.1.m1.1.1.2.3.2.3.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.2.3">Î¨</ci></apply><apply id="S5.SS2.p3.1.m1.1.1.2.3.3.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.2.3.3.1.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.3">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.3.3.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.3.2">ğ‘</ci><ci id="S5.SS2.p3.1.m1.1.1.2.3.3.3.cmml" xref="S5.SS2.p3.1.m1.1.1.2.3.3.3">ğ‘‘</ci></apply></apply></apply><apply id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3"><times id="S5.SS2.p3.1.m1.1.1.3.1.cmml" xref="S5.SS2.p3.1.m1.1.1.3.1"></times><cn type="integer" id="S5.SS2.p3.1.m1.1.1.3.2.cmml" xref="S5.SS2.p3.1.m1.1.1.3.2">2</cn><ci id="S5.SS2.p3.1.m1.1.1.3.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">2\Psi+\frac{14\Psi}{N_{d}}\approx 2\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">2 roman_Î¨ + divide start_ARG 14 roman_Î¨ end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG â‰ˆ 2 roman_Î¨</annotation></semantics></math>.
As the example in Figure 1, a 7.5 B parameter model requires only 16.6 GB of memory using <math id="S5.SS2.p3.2.m2.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S5.SS2.p3.2.m2.1a"><msub id="S5.SS2.p3.2.m2.1.1" xref="S5.SS2.p3.2.m2.1.1.cmml"><mi id="S5.SS2.p3.2.m2.1.1.2" xref="S5.SS2.p3.2.m2.1.1.2.cmml">P</mi><mrow id="S5.SS2.p3.2.m2.1.1.3" xref="S5.SS2.p3.2.m2.1.1.3.cmml"><mrow id="S5.SS2.p3.2.m2.1.1.3.2" xref="S5.SS2.p3.2.m2.1.1.3.2.cmml"><mi id="S5.SS2.p3.2.m2.1.1.3.2.2" xref="S5.SS2.p3.2.m2.1.1.3.2.2.cmml">o</mi><mo id="S5.SS2.p3.2.m2.1.1.3.2.1" xref="S5.SS2.p3.2.m2.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS2.p3.2.m2.1.1.3.2.3" xref="S5.SS2.p3.2.m2.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS2.p3.2.m2.1.1.3.1" xref="S5.SS2.p3.2.m2.1.1.3.1.cmml">+</mo><mi id="S5.SS2.p3.2.m2.1.1.3.3" xref="S5.SS2.p3.2.m2.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.m2.1b"><apply id="S5.SS2.p3.2.m2.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.2.m2.1.1.1.cmml" xref="S5.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p3.2.m2.1.1.2.cmml" xref="S5.SS2.p3.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S5.SS2.p3.2.m2.1.1.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3"><plus id="S5.SS2.p3.2.m2.1.1.3.1.cmml" xref="S5.SS2.p3.2.m2.1.1.3.1"></plus><apply id="S5.SS2.p3.2.m2.1.1.3.2.cmml" xref="S5.SS2.p3.2.m2.1.1.3.2"><times id="S5.SS2.p3.2.m2.1.1.3.2.1.cmml" xref="S5.SS2.p3.2.m2.1.1.3.2.1"></times><ci id="S5.SS2.p3.2.m2.1.1.3.2.2.cmml" xref="S5.SS2.p3.2.m2.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS2.p3.2.m2.1.1.3.2.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS2.p3.2.m2.1.1.3.3.cmml" xref="S5.SS2.p3.2.m2.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.m2.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> with 64-way DP (<math id="S5.SS2.p3.3.m3.1" class="ltx_Math" alttext="N_{d}=64" display="inline"><semantics id="S5.SS2.p3.3.m3.1a"><mrow id="S5.SS2.p3.3.m3.1.1" xref="S5.SS2.p3.3.m3.1.1.cmml"><msub id="S5.SS2.p3.3.m3.1.1.2" xref="S5.SS2.p3.3.m3.1.1.2.cmml"><mi id="S5.SS2.p3.3.m3.1.1.2.2" xref="S5.SS2.p3.3.m3.1.1.2.2.cmml">N</mi><mi id="S5.SS2.p3.3.m3.1.1.2.3" xref="S5.SS2.p3.3.m3.1.1.2.3.cmml">d</mi></msub><mo id="S5.SS2.p3.3.m3.1.1.1" xref="S5.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.p3.3.m3.1.1.3" xref="S5.SS2.p3.3.m3.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m3.1b"><apply id="S5.SS2.p3.3.m3.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1"><eq id="S5.SS2.p3.3.m3.1.1.1.cmml" xref="S5.SS2.p3.3.m3.1.1.1"></eq><apply id="S5.SS2.p3.3.m3.1.1.2.cmml" xref="S5.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p3.3.m3.1.1.2.1.cmml" xref="S5.SS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S5.SS2.p3.3.m3.1.1.2.2.cmml" xref="S5.SS2.p3.3.m3.1.1.2.2">ğ‘</ci><ci id="S5.SS2.p3.3.m3.1.1.2.3.cmml" xref="S5.SS2.p3.3.m3.1.1.2.3">ğ‘‘</ci></apply><cn type="integer" id="S5.SS2.p3.3.m3.1.1.3.cmml" xref="S5.SS2.p3.3.m3.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m3.1c">N_{d}=64</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 64</annotation></semantics></math>), while requiring 120 GB with standard DP.
When <math id="S5.SS2.p3.4.m4.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S5.SS2.p3.4.m4.1a"><msub id="S5.SS2.p3.4.m4.1.1" xref="S5.SS2.p3.4.m4.1.1.cmml"><mi id="S5.SS2.p3.4.m4.1.1.2" xref="S5.SS2.p3.4.m4.1.1.2.cmml">N</mi><mi id="S5.SS2.p3.4.m4.1.1.3" xref="S5.SS2.p3.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.4.m4.1b"><apply id="S5.SS2.p3.4.m4.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.4.m4.1.1.1.cmml" xref="S5.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.p3.4.m4.1.1.2.cmml" xref="S5.SS2.p3.4.m4.1.1.2">ğ‘</ci><ci id="S5.SS2.p3.4.m4.1.1.3.cmml" xref="S5.SS2.p3.4.m4.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.4.m4.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is large, the memory requirement of model states reduces from <math id="S5.SS2.p3.5.m5.1" class="ltx_Math" alttext="2\Psi+14\Psi=16\Psi" display="inline"><semantics id="S5.SS2.p3.5.m5.1a"><mrow id="S5.SS2.p3.5.m5.1.1" xref="S5.SS2.p3.5.m5.1.1.cmml"><mrow id="S5.SS2.p3.5.m5.1.1.2" xref="S5.SS2.p3.5.m5.1.1.2.cmml"><mrow id="S5.SS2.p3.5.m5.1.1.2.2" xref="S5.SS2.p3.5.m5.1.1.2.2.cmml"><mn id="S5.SS2.p3.5.m5.1.1.2.2.2" xref="S5.SS2.p3.5.m5.1.1.2.2.2.cmml">2</mn><mo id="S5.SS2.p3.5.m5.1.1.2.2.1" xref="S5.SS2.p3.5.m5.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.5.m5.1.1.2.2.3" xref="S5.SS2.p3.5.m5.1.1.2.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS2.p3.5.m5.1.1.2.1" xref="S5.SS2.p3.5.m5.1.1.2.1.cmml">+</mo><mrow id="S5.SS2.p3.5.m5.1.1.2.3" xref="S5.SS2.p3.5.m5.1.1.2.3.cmml"><mn id="S5.SS2.p3.5.m5.1.1.2.3.2" xref="S5.SS2.p3.5.m5.1.1.2.3.2.cmml">14</mn><mo id="S5.SS2.p3.5.m5.1.1.2.3.1" xref="S5.SS2.p3.5.m5.1.1.2.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.5.m5.1.1.2.3.3" xref="S5.SS2.p3.5.m5.1.1.2.3.3.cmml">Î¨</mi></mrow></mrow><mo id="S5.SS2.p3.5.m5.1.1.1" xref="S5.SS2.p3.5.m5.1.1.1.cmml">=</mo><mrow id="S5.SS2.p3.5.m5.1.1.3" xref="S5.SS2.p3.5.m5.1.1.3.cmml"><mn id="S5.SS2.p3.5.m5.1.1.3.2" xref="S5.SS2.p3.5.m5.1.1.3.2.cmml">16</mn><mo id="S5.SS2.p3.5.m5.1.1.3.1" xref="S5.SS2.p3.5.m5.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.5.m5.1.1.3.3" xref="S5.SS2.p3.5.m5.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.5.m5.1b"><apply id="S5.SS2.p3.5.m5.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1"><eq id="S5.SS2.p3.5.m5.1.1.1.cmml" xref="S5.SS2.p3.5.m5.1.1.1"></eq><apply id="S5.SS2.p3.5.m5.1.1.2.cmml" xref="S5.SS2.p3.5.m5.1.1.2"><plus id="S5.SS2.p3.5.m5.1.1.2.1.cmml" xref="S5.SS2.p3.5.m5.1.1.2.1"></plus><apply id="S5.SS2.p3.5.m5.1.1.2.2.cmml" xref="S5.SS2.p3.5.m5.1.1.2.2"><times id="S5.SS2.p3.5.m5.1.1.2.2.1.cmml" xref="S5.SS2.p3.5.m5.1.1.2.2.1"></times><cn type="integer" id="S5.SS2.p3.5.m5.1.1.2.2.2.cmml" xref="S5.SS2.p3.5.m5.1.1.2.2.2">2</cn><ci id="S5.SS2.p3.5.m5.1.1.2.2.3.cmml" xref="S5.SS2.p3.5.m5.1.1.2.2.3">Î¨</ci></apply><apply id="S5.SS2.p3.5.m5.1.1.2.3.cmml" xref="S5.SS2.p3.5.m5.1.1.2.3"><times id="S5.SS2.p3.5.m5.1.1.2.3.1.cmml" xref="S5.SS2.p3.5.m5.1.1.2.3.1"></times><cn type="integer" id="S5.SS2.p3.5.m5.1.1.2.3.2.cmml" xref="S5.SS2.p3.5.m5.1.1.2.3.2">14</cn><ci id="S5.SS2.p3.5.m5.1.1.2.3.3.cmml" xref="S5.SS2.p3.5.m5.1.1.2.3.3">Î¨</ci></apply></apply><apply id="S5.SS2.p3.5.m5.1.1.3.cmml" xref="S5.SS2.p3.5.m5.1.1.3"><times id="S5.SS2.p3.5.m5.1.1.3.1.cmml" xref="S5.SS2.p3.5.m5.1.1.3.1"></times><cn type="integer" id="S5.SS2.p3.5.m5.1.1.3.2.cmml" xref="S5.SS2.p3.5.m5.1.1.3.2">16</cn><ci id="S5.SS2.p3.5.m5.1.1.3.3.cmml" xref="S5.SS2.p3.5.m5.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.5.m5.1c">2\Psi+14\Psi=16\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.5.m5.1d">2 roman_Î¨ + 14 roman_Î¨ = 16 roman_Î¨</annotation></semantics></math> bytes to <math id="S5.SS2.p3.6.m6.1" class="ltx_Math" alttext="2\Psi+\frac{14\Psi}{N_{d}}\approx 2\Psi" display="inline"><semantics id="S5.SS2.p3.6.m6.1a"><mrow id="S5.SS2.p3.6.m6.1.1" xref="S5.SS2.p3.6.m6.1.1.cmml"><mrow id="S5.SS2.p3.6.m6.1.1.2" xref="S5.SS2.p3.6.m6.1.1.2.cmml"><mrow id="S5.SS2.p3.6.m6.1.1.2.2" xref="S5.SS2.p3.6.m6.1.1.2.2.cmml"><mn id="S5.SS2.p3.6.m6.1.1.2.2.2" xref="S5.SS2.p3.6.m6.1.1.2.2.2.cmml">2</mn><mo id="S5.SS2.p3.6.m6.1.1.2.2.1" xref="S5.SS2.p3.6.m6.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.6.m6.1.1.2.2.3" xref="S5.SS2.p3.6.m6.1.1.2.2.3.cmml">Î¨</mi></mrow><mo id="S5.SS2.p3.6.m6.1.1.2.1" xref="S5.SS2.p3.6.m6.1.1.2.1.cmml">+</mo><mfrac id="S5.SS2.p3.6.m6.1.1.2.3" xref="S5.SS2.p3.6.m6.1.1.2.3.cmml"><mrow id="S5.SS2.p3.6.m6.1.1.2.3.2" xref="S5.SS2.p3.6.m6.1.1.2.3.2.cmml"><mn id="S5.SS2.p3.6.m6.1.1.2.3.2.2" xref="S5.SS2.p3.6.m6.1.1.2.3.2.2.cmml">14</mn><mo id="S5.SS2.p3.6.m6.1.1.2.3.2.1" xref="S5.SS2.p3.6.m6.1.1.2.3.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.6.m6.1.1.2.3.2.3" xref="S5.SS2.p3.6.m6.1.1.2.3.2.3.cmml">Î¨</mi></mrow><msub id="S5.SS2.p3.6.m6.1.1.2.3.3" xref="S5.SS2.p3.6.m6.1.1.2.3.3.cmml"><mi id="S5.SS2.p3.6.m6.1.1.2.3.3.2" xref="S5.SS2.p3.6.m6.1.1.2.3.3.2.cmml">N</mi><mi id="S5.SS2.p3.6.m6.1.1.2.3.3.3" xref="S5.SS2.p3.6.m6.1.1.2.3.3.3.cmml">d</mi></msub></mfrac></mrow><mo id="S5.SS2.p3.6.m6.1.1.1" xref="S5.SS2.p3.6.m6.1.1.1.cmml">â‰ˆ</mo><mrow id="S5.SS2.p3.6.m6.1.1.3" xref="S5.SS2.p3.6.m6.1.1.3.cmml"><mn id="S5.SS2.p3.6.m6.1.1.3.2" xref="S5.SS2.p3.6.m6.1.1.3.2.cmml">2</mn><mo id="S5.SS2.p3.6.m6.1.1.3.1" xref="S5.SS2.p3.6.m6.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS2.p3.6.m6.1.1.3.3" xref="S5.SS2.p3.6.m6.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.6.m6.1b"><apply id="S5.SS2.p3.6.m6.1.1.cmml" xref="S5.SS2.p3.6.m6.1.1"><approx id="S5.SS2.p3.6.m6.1.1.1.cmml" xref="S5.SS2.p3.6.m6.1.1.1"></approx><apply id="S5.SS2.p3.6.m6.1.1.2.cmml" xref="S5.SS2.p3.6.m6.1.1.2"><plus id="S5.SS2.p3.6.m6.1.1.2.1.cmml" xref="S5.SS2.p3.6.m6.1.1.2.1"></plus><apply id="S5.SS2.p3.6.m6.1.1.2.2.cmml" xref="S5.SS2.p3.6.m6.1.1.2.2"><times id="S5.SS2.p3.6.m6.1.1.2.2.1.cmml" xref="S5.SS2.p3.6.m6.1.1.2.2.1"></times><cn type="integer" id="S5.SS2.p3.6.m6.1.1.2.2.2.cmml" xref="S5.SS2.p3.6.m6.1.1.2.2.2">2</cn><ci id="S5.SS2.p3.6.m6.1.1.2.2.3.cmml" xref="S5.SS2.p3.6.m6.1.1.2.2.3">Î¨</ci></apply><apply id="S5.SS2.p3.6.m6.1.1.2.3.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3"><divide id="S5.SS2.p3.6.m6.1.1.2.3.1.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3"></divide><apply id="S5.SS2.p3.6.m6.1.1.2.3.2.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.2"><times id="S5.SS2.p3.6.m6.1.1.2.3.2.1.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.2.1"></times><cn type="integer" id="S5.SS2.p3.6.m6.1.1.2.3.2.2.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.2.2">14</cn><ci id="S5.SS2.p3.6.m6.1.1.2.3.2.3.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.2.3">Î¨</ci></apply><apply id="S5.SS2.p3.6.m6.1.1.2.3.3.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.SS2.p3.6.m6.1.1.2.3.3.1.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.3">subscript</csymbol><ci id="S5.SS2.p3.6.m6.1.1.2.3.3.2.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.3.2">ğ‘</ci><ci id="S5.SS2.p3.6.m6.1.1.2.3.3.3.cmml" xref="S5.SS2.p3.6.m6.1.1.2.3.3.3">ğ‘‘</ci></apply></apply></apply><apply id="S5.SS2.p3.6.m6.1.1.3.cmml" xref="S5.SS2.p3.6.m6.1.1.3"><times id="S5.SS2.p3.6.m6.1.1.3.1.cmml" xref="S5.SS2.p3.6.m6.1.1.3.1"></times><cn type="integer" id="S5.SS2.p3.6.m6.1.1.3.2.cmml" xref="S5.SS2.p3.6.m6.1.1.3.2">2</cn><ci id="S5.SS2.p3.6.m6.1.1.3.3.cmml" xref="S5.SS2.p3.6.m6.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.6.m6.1c">2\Psi+\frac{14\Psi}{N_{d}}\approx 2\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.6.m6.1d">2 roman_Î¨ + divide start_ARG 14 roman_Î¨ end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG â‰ˆ 2 roman_Î¨</annotation></semantics></math> bytes, leading to a 8x reduction.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.9" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.9.10.1" class="ltx_tr">
<th id="S5.T1.9.10.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_t" rowspan="2"><span id="S5.T1.9.10.1.1.1" class="ltx_text">DP</span></th>
<th id="S5.T1.9.10.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_ll ltx_border_t" colspan="3">
<span id="S5.T1.9.10.1.2.1" class="ltx_text ltx_font_bold">7.5B Model</span> (GB)</th>
<th id="S5.T1.9.10.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_ll ltx_border_t" colspan="3">
<span id="S5.T1.9.10.1.3.1" class="ltx_text ltx_font_bold">128B Model</span> (GB)</th>
<th id="S5.T1.9.10.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_ll ltx_border_r ltx_border_t" colspan="3">
<span id="S5.T1.9.10.1.4.1" class="ltx_text ltx_font_bold">1T Model</span> (GB)</th>
</tr>
<tr id="S5.T1.9.9" class="ltx_tr">
<th id="S5.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S5.T1.1.1.1.m1.1a"><msub id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml"><mi id="S5.T1.1.1.1.m1.1.1a" xref="S5.T1.1.1.1.m1.1.1.cmml"></mi><mrow id="S5.T1.1.1.1.m1.1.1.1" xref="S5.T1.1.1.1.m1.1.1.1.cmml"><mi id="S5.T1.1.1.1.m1.1.1.1.2" xref="S5.T1.1.1.1.m1.1.1.1.2.cmml">o</mi><mo id="S5.T1.1.1.1.m1.1.1.1.1" xref="S5.T1.1.1.1.m1.1.1.1.1.cmml">â¢</mo><mi id="S5.T1.1.1.1.m1.1.1.1.3" xref="S5.T1.1.1.1.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><apply id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1"><apply id="S5.T1.1.1.1.m1.1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1.1"><times id="S5.T1.1.1.1.m1.1.1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1.1.1"></times><ci id="S5.T1.1.1.1.m1.1.1.1.2.cmml" xref="S5.T1.1.1.1.m1.1.1.1.2">ğ‘œ</ci><ci id="S5.T1.1.1.1.m1.1.1.1.3.cmml" xref="S5.T1.1.1.1.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.2.2.2.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S5.T1.2.2.2.m1.1a"><msub id="S5.T1.2.2.2.m1.1.1" xref="S5.T1.2.2.2.m1.1.1.cmml"><mi id="S5.T1.2.2.2.m1.1.1a" xref="S5.T1.2.2.2.m1.1.1.cmml"></mi><mrow id="S5.T1.2.2.2.m1.1.1.1" xref="S5.T1.2.2.2.m1.1.1.1.cmml"><mrow id="S5.T1.2.2.2.m1.1.1.1.2" xref="S5.T1.2.2.2.m1.1.1.1.2.cmml"><mi id="S5.T1.2.2.2.m1.1.1.1.2.2" xref="S5.T1.2.2.2.m1.1.1.1.2.2.cmml">o</mi><mo id="S5.T1.2.2.2.m1.1.1.1.2.1" xref="S5.T1.2.2.2.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S5.T1.2.2.2.m1.1.1.1.2.3" xref="S5.T1.2.2.2.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S5.T1.2.2.2.m1.1.1.1.1" xref="S5.T1.2.2.2.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.2.2.2.m1.1.1.1.3" xref="S5.T1.2.2.2.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.m1.1b"><apply id="S5.T1.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1"><apply id="S5.T1.2.2.2.m1.1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1.1"><plus id="S5.T1.2.2.2.m1.1.1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1.1.1"></plus><apply id="S5.T1.2.2.2.m1.1.1.1.2.cmml" xref="S5.T1.2.2.2.m1.1.1.1.2"><times id="S5.T1.2.2.2.m1.1.1.1.2.1.cmml" xref="S5.T1.2.2.2.m1.1.1.1.2.1"></times><ci id="S5.T1.2.2.2.m1.1.1.1.2.2.cmml" xref="S5.T1.2.2.2.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S5.T1.2.2.2.m1.1.1.1.2.3.cmml" xref="S5.T1.2.2.2.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S5.T1.2.2.2.m1.1.1.1.3.cmml" xref="S5.T1.2.2.2.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_rr ltx_border_t">P<math id="S5.T1.3.3.3.m1.1" class="ltx_Math" alttext="{}_{os+g+p}" display="inline"><semantics id="S5.T1.3.3.3.m1.1a"><msub id="S5.T1.3.3.3.m1.1.1" xref="S5.T1.3.3.3.m1.1.1.cmml"><mi id="S5.T1.3.3.3.m1.1.1a" xref="S5.T1.3.3.3.m1.1.1.cmml"></mi><mrow id="S5.T1.3.3.3.m1.1.1.1" xref="S5.T1.3.3.3.m1.1.1.1.cmml"><mrow id="S5.T1.3.3.3.m1.1.1.1.2" xref="S5.T1.3.3.3.m1.1.1.1.2.cmml"><mi id="S5.T1.3.3.3.m1.1.1.1.2.2" xref="S5.T1.3.3.3.m1.1.1.1.2.2.cmml">o</mi><mo id="S5.T1.3.3.3.m1.1.1.1.2.1" xref="S5.T1.3.3.3.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S5.T1.3.3.3.m1.1.1.1.2.3" xref="S5.T1.3.3.3.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S5.T1.3.3.3.m1.1.1.1.1" xref="S5.T1.3.3.3.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.3.3.3.m1.1.1.1.3" xref="S5.T1.3.3.3.m1.1.1.1.3.cmml">g</mi><mo id="S5.T1.3.3.3.m1.1.1.1.1a" xref="S5.T1.3.3.3.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.3.3.3.m1.1.1.1.4" xref="S5.T1.3.3.3.m1.1.1.1.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.m1.1b"><apply id="S5.T1.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.m1.1.1"><apply id="S5.T1.3.3.3.m1.1.1.1.cmml" xref="S5.T1.3.3.3.m1.1.1.1"><plus id="S5.T1.3.3.3.m1.1.1.1.1.cmml" xref="S5.T1.3.3.3.m1.1.1.1.1"></plus><apply id="S5.T1.3.3.3.m1.1.1.1.2.cmml" xref="S5.T1.3.3.3.m1.1.1.1.2"><times id="S5.T1.3.3.3.m1.1.1.1.2.1.cmml" xref="S5.T1.3.3.3.m1.1.1.1.2.1"></times><ci id="S5.T1.3.3.3.m1.1.1.1.2.2.cmml" xref="S5.T1.3.3.3.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S5.T1.3.3.3.m1.1.1.1.2.3.cmml" xref="S5.T1.3.3.3.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S5.T1.3.3.3.m1.1.1.1.3.cmml" xref="S5.T1.3.3.3.m1.1.1.1.3">ğ‘”</ci><ci id="S5.T1.3.3.3.m1.1.1.1.4.cmml" xref="S5.T1.3.3.3.m1.1.1.1.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.m1.1c">{}_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.3.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g + italic_p end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.4.4.4.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S5.T1.4.4.4.m1.1a"><msub id="S5.T1.4.4.4.m1.1.1" xref="S5.T1.4.4.4.m1.1.1.cmml"><mi id="S5.T1.4.4.4.m1.1.1a" xref="S5.T1.4.4.4.m1.1.1.cmml"></mi><mrow id="S5.T1.4.4.4.m1.1.1.1" xref="S5.T1.4.4.4.m1.1.1.1.cmml"><mi id="S5.T1.4.4.4.m1.1.1.1.2" xref="S5.T1.4.4.4.m1.1.1.1.2.cmml">o</mi><mo id="S5.T1.4.4.4.m1.1.1.1.1" xref="S5.T1.4.4.4.m1.1.1.1.1.cmml">â¢</mo><mi id="S5.T1.4.4.4.m1.1.1.1.3" xref="S5.T1.4.4.4.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.m1.1b"><apply id="S5.T1.4.4.4.m1.1.1.cmml" xref="S5.T1.4.4.4.m1.1.1"><apply id="S5.T1.4.4.4.m1.1.1.1.cmml" xref="S5.T1.4.4.4.m1.1.1.1"><times id="S5.T1.4.4.4.m1.1.1.1.1.cmml" xref="S5.T1.4.4.4.m1.1.1.1.1"></times><ci id="S5.T1.4.4.4.m1.1.1.1.2.cmml" xref="S5.T1.4.4.4.m1.1.1.1.2">ğ‘œ</ci><ci id="S5.T1.4.4.4.m1.1.1.1.3.cmml" xref="S5.T1.4.4.4.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.4.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.5.5.5.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S5.T1.5.5.5.m1.1a"><msub id="S5.T1.5.5.5.m1.1.1" xref="S5.T1.5.5.5.m1.1.1.cmml"><mi id="S5.T1.5.5.5.m1.1.1a" xref="S5.T1.5.5.5.m1.1.1.cmml"></mi><mrow id="S5.T1.5.5.5.m1.1.1.1" xref="S5.T1.5.5.5.m1.1.1.1.cmml"><mrow id="S5.T1.5.5.5.m1.1.1.1.2" xref="S5.T1.5.5.5.m1.1.1.1.2.cmml"><mi id="S5.T1.5.5.5.m1.1.1.1.2.2" xref="S5.T1.5.5.5.m1.1.1.1.2.2.cmml">o</mi><mo id="S5.T1.5.5.5.m1.1.1.1.2.1" xref="S5.T1.5.5.5.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S5.T1.5.5.5.m1.1.1.1.2.3" xref="S5.T1.5.5.5.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S5.T1.5.5.5.m1.1.1.1.1" xref="S5.T1.5.5.5.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.5.5.5.m1.1.1.1.3" xref="S5.T1.5.5.5.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.5.m1.1b"><apply id="S5.T1.5.5.5.m1.1.1.cmml" xref="S5.T1.5.5.5.m1.1.1"><apply id="S5.T1.5.5.5.m1.1.1.1.cmml" xref="S5.T1.5.5.5.m1.1.1.1"><plus id="S5.T1.5.5.5.m1.1.1.1.1.cmml" xref="S5.T1.5.5.5.m1.1.1.1.1"></plus><apply id="S5.T1.5.5.5.m1.1.1.1.2.cmml" xref="S5.T1.5.5.5.m1.1.1.1.2"><times id="S5.T1.5.5.5.m1.1.1.1.2.1.cmml" xref="S5.T1.5.5.5.m1.1.1.1.2.1"></times><ci id="S5.T1.5.5.5.m1.1.1.1.2.2.cmml" xref="S5.T1.5.5.5.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S5.T1.5.5.5.m1.1.1.1.2.3.cmml" xref="S5.T1.5.5.5.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S5.T1.5.5.5.m1.1.1.1.3.cmml" xref="S5.T1.5.5.5.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.5.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.5.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_rr ltx_border_t">P<math id="S5.T1.6.6.6.m1.1" class="ltx_Math" alttext="{}_{os+g+p}" display="inline"><semantics id="S5.T1.6.6.6.m1.1a"><msub id="S5.T1.6.6.6.m1.1.1" xref="S5.T1.6.6.6.m1.1.1.cmml"><mi id="S5.T1.6.6.6.m1.1.1a" xref="S5.T1.6.6.6.m1.1.1.cmml"></mi><mrow id="S5.T1.6.6.6.m1.1.1.1" xref="S5.T1.6.6.6.m1.1.1.1.cmml"><mrow id="S5.T1.6.6.6.m1.1.1.1.2" xref="S5.T1.6.6.6.m1.1.1.1.2.cmml"><mi id="S5.T1.6.6.6.m1.1.1.1.2.2" xref="S5.T1.6.6.6.m1.1.1.1.2.2.cmml">o</mi><mo id="S5.T1.6.6.6.m1.1.1.1.2.1" xref="S5.T1.6.6.6.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S5.T1.6.6.6.m1.1.1.1.2.3" xref="S5.T1.6.6.6.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S5.T1.6.6.6.m1.1.1.1.1" xref="S5.T1.6.6.6.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.6.6.6.m1.1.1.1.3" xref="S5.T1.6.6.6.m1.1.1.1.3.cmml">g</mi><mo id="S5.T1.6.6.6.m1.1.1.1.1a" xref="S5.T1.6.6.6.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.6.6.6.m1.1.1.1.4" xref="S5.T1.6.6.6.m1.1.1.1.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.6.m1.1b"><apply id="S5.T1.6.6.6.m1.1.1.cmml" xref="S5.T1.6.6.6.m1.1.1"><apply id="S5.T1.6.6.6.m1.1.1.1.cmml" xref="S5.T1.6.6.6.m1.1.1.1"><plus id="S5.T1.6.6.6.m1.1.1.1.1.cmml" xref="S5.T1.6.6.6.m1.1.1.1.1"></plus><apply id="S5.T1.6.6.6.m1.1.1.1.2.cmml" xref="S5.T1.6.6.6.m1.1.1.1.2"><times id="S5.T1.6.6.6.m1.1.1.1.2.1.cmml" xref="S5.T1.6.6.6.m1.1.1.1.2.1"></times><ci id="S5.T1.6.6.6.m1.1.1.1.2.2.cmml" xref="S5.T1.6.6.6.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S5.T1.6.6.6.m1.1.1.1.2.3.cmml" xref="S5.T1.6.6.6.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S5.T1.6.6.6.m1.1.1.1.3.cmml" xref="S5.T1.6.6.6.m1.1.1.1.3">ğ‘”</ci><ci id="S5.T1.6.6.6.m1.1.1.1.4.cmml" xref="S5.T1.6.6.6.m1.1.1.1.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.6.m1.1c">{}_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.6.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g + italic_p end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.7.7.7.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S5.T1.7.7.7.m1.1a"><msub id="S5.T1.7.7.7.m1.1.1" xref="S5.T1.7.7.7.m1.1.1.cmml"><mi id="S5.T1.7.7.7.m1.1.1a" xref="S5.T1.7.7.7.m1.1.1.cmml"></mi><mrow id="S5.T1.7.7.7.m1.1.1.1" xref="S5.T1.7.7.7.m1.1.1.1.cmml"><mi id="S5.T1.7.7.7.m1.1.1.1.2" xref="S5.T1.7.7.7.m1.1.1.1.2.cmml">o</mi><mo id="S5.T1.7.7.7.m1.1.1.1.1" xref="S5.T1.7.7.7.m1.1.1.1.1.cmml">â¢</mo><mi id="S5.T1.7.7.7.m1.1.1.1.3" xref="S5.T1.7.7.7.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.7.m1.1b"><apply id="S5.T1.7.7.7.m1.1.1.cmml" xref="S5.T1.7.7.7.m1.1.1"><apply id="S5.T1.7.7.7.m1.1.1.1.cmml" xref="S5.T1.7.7.7.m1.1.1.1"><times id="S5.T1.7.7.7.m1.1.1.1.1.cmml" xref="S5.T1.7.7.7.m1.1.1.1.1"></times><ci id="S5.T1.7.7.7.m1.1.1.1.2.cmml" xref="S5.T1.7.7.7.m1.1.1.1.2">ğ‘œ</ci><ci id="S5.T1.7.7.7.m1.1.1.1.3.cmml" xref="S5.T1.7.7.7.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.7.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.7.7.7.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.8.8.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.8.8.8.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S5.T1.8.8.8.m1.1a"><msub id="S5.T1.8.8.8.m1.1.1" xref="S5.T1.8.8.8.m1.1.1.cmml"><mi id="S5.T1.8.8.8.m1.1.1a" xref="S5.T1.8.8.8.m1.1.1.cmml"></mi><mrow id="S5.T1.8.8.8.m1.1.1.1" xref="S5.T1.8.8.8.m1.1.1.1.cmml"><mrow id="S5.T1.8.8.8.m1.1.1.1.2" xref="S5.T1.8.8.8.m1.1.1.1.2.cmml"><mi id="S5.T1.8.8.8.m1.1.1.1.2.2" xref="S5.T1.8.8.8.m1.1.1.1.2.2.cmml">o</mi><mo id="S5.T1.8.8.8.m1.1.1.1.2.1" xref="S5.T1.8.8.8.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S5.T1.8.8.8.m1.1.1.1.2.3" xref="S5.T1.8.8.8.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S5.T1.8.8.8.m1.1.1.1.1" xref="S5.T1.8.8.8.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.8.8.8.m1.1.1.1.3" xref="S5.T1.8.8.8.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.8.m1.1b"><apply id="S5.T1.8.8.8.m1.1.1.cmml" xref="S5.T1.8.8.8.m1.1.1"><apply id="S5.T1.8.8.8.m1.1.1.1.cmml" xref="S5.T1.8.8.8.m1.1.1.1"><plus id="S5.T1.8.8.8.m1.1.1.1.1.cmml" xref="S5.T1.8.8.8.m1.1.1.1.1"></plus><apply id="S5.T1.8.8.8.m1.1.1.1.2.cmml" xref="S5.T1.8.8.8.m1.1.1.1.2"><times id="S5.T1.8.8.8.m1.1.1.1.2.1.cmml" xref="S5.T1.8.8.8.m1.1.1.1.2.1"></times><ci id="S5.T1.8.8.8.m1.1.1.1.2.2.cmml" xref="S5.T1.8.8.8.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S5.T1.8.8.8.m1.1.1.1.2.3.cmml" xref="S5.T1.8.8.8.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S5.T1.8.8.8.m1.1.1.1.3.cmml" xref="S5.T1.8.8.8.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.8.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.8.8.8.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
<th id="S5.T1.9.9.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">P<math id="S5.T1.9.9.9.m1.1" class="ltx_Math" alttext="{}_{os+g+p}" display="inline"><semantics id="S5.T1.9.9.9.m1.1a"><msub id="S5.T1.9.9.9.m1.1.1" xref="S5.T1.9.9.9.m1.1.1.cmml"><mi id="S5.T1.9.9.9.m1.1.1a" xref="S5.T1.9.9.9.m1.1.1.cmml"></mi><mrow id="S5.T1.9.9.9.m1.1.1.1" xref="S5.T1.9.9.9.m1.1.1.1.cmml"><mrow id="S5.T1.9.9.9.m1.1.1.1.2" xref="S5.T1.9.9.9.m1.1.1.1.2.cmml"><mi id="S5.T1.9.9.9.m1.1.1.1.2.2" xref="S5.T1.9.9.9.m1.1.1.1.2.2.cmml">o</mi><mo id="S5.T1.9.9.9.m1.1.1.1.2.1" xref="S5.T1.9.9.9.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S5.T1.9.9.9.m1.1.1.1.2.3" xref="S5.T1.9.9.9.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S5.T1.9.9.9.m1.1.1.1.1" xref="S5.T1.9.9.9.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.9.9.9.m1.1.1.1.3" xref="S5.T1.9.9.9.m1.1.1.1.3.cmml">g</mi><mo id="S5.T1.9.9.9.m1.1.1.1.1a" xref="S5.T1.9.9.9.m1.1.1.1.1.cmml">+</mo><mi id="S5.T1.9.9.9.m1.1.1.1.4" xref="S5.T1.9.9.9.m1.1.1.1.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.9.m1.1b"><apply id="S5.T1.9.9.9.m1.1.1.cmml" xref="S5.T1.9.9.9.m1.1.1"><apply id="S5.T1.9.9.9.m1.1.1.1.cmml" xref="S5.T1.9.9.9.m1.1.1.1"><plus id="S5.T1.9.9.9.m1.1.1.1.1.cmml" xref="S5.T1.9.9.9.m1.1.1.1.1"></plus><apply id="S5.T1.9.9.9.m1.1.1.1.2.cmml" xref="S5.T1.9.9.9.m1.1.1.1.2"><times id="S5.T1.9.9.9.m1.1.1.1.2.1.cmml" xref="S5.T1.9.9.9.m1.1.1.1.2.1"></times><ci id="S5.T1.9.9.9.m1.1.1.1.2.2.cmml" xref="S5.T1.9.9.9.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S5.T1.9.9.9.m1.1.1.1.2.3.cmml" xref="S5.T1.9.9.9.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S5.T1.9.9.9.m1.1.1.1.3.cmml" xref="S5.T1.9.9.9.m1.1.1.1.3">ğ‘”</ci><ci id="S5.T1.9.9.9.m1.1.1.1.4.cmml" xref="S5.T1.9.9.9.m1.1.1.1.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.9.m1.1c">{}_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.9.9.9.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g + italic_p end_FLOATSUBSCRIPT</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.9.11.1" class="ltx_tr">
<td id="S5.T1.9.11.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_rr ltx_border_t">1</td>
<td id="S5.T1.9.11.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">120</td>
<td id="S5.T1.9.11.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">120</td>
<td id="S5.T1.9.11.1.4" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">120</td>
<td id="S5.T1.9.11.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2048</td>
<td id="S5.T1.9.11.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2048</td>
<td id="S5.T1.9.11.1.7" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">2048</td>
<td id="S5.T1.9.11.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16000</td>
<td id="S5.T1.9.11.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16000</td>
<td id="S5.T1.9.11.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16000</td>
</tr>
<tr id="S5.T1.9.12.2" class="ltx_tr">
<td id="S5.T1.9.12.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_rr">4</td>
<td id="S5.T1.9.12.2.2" class="ltx_td ltx_align_center ltx_border_r">52.5</td>
<td id="S5.T1.9.12.2.3" class="ltx_td ltx_align_center ltx_border_r">41.3</td>
<td id="S5.T1.9.12.2.4" class="ltx_td ltx_align_center ltx_border_rr"><span id="S5.T1.9.12.2.4.1" class="ltx_text ltx_font_bold">30</span></td>
<td id="S5.T1.9.12.2.5" class="ltx_td ltx_align_center ltx_border_r">896</td>
<td id="S5.T1.9.12.2.6" class="ltx_td ltx_align_center ltx_border_r">704</td>
<td id="S5.T1.9.12.2.7" class="ltx_td ltx_align_center ltx_border_rr">512</td>
<td id="S5.T1.9.12.2.8" class="ltx_td ltx_align_center ltx_border_r">7000</td>
<td id="S5.T1.9.12.2.9" class="ltx_td ltx_align_center ltx_border_r">5500</td>
<td id="S5.T1.9.12.2.10" class="ltx_td ltx_align_center ltx_border_r">4000</td>
</tr>
<tr id="S5.T1.9.13.3" class="ltx_tr">
<td id="S5.T1.9.13.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_rr">16</td>
<td id="S5.T1.9.13.3.2" class="ltx_td ltx_align_center ltx_border_r">35.6</td>
<td id="S5.T1.9.13.3.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.9.13.3.3.1" class="ltx_text ltx_font_bold">21.6</span></td>
<td id="S5.T1.9.13.3.4" class="ltx_td ltx_align_center ltx_border_rr">7.5</td>
<td id="S5.T1.9.13.3.5" class="ltx_td ltx_align_center ltx_border_r">608</td>
<td id="S5.T1.9.13.3.6" class="ltx_td ltx_align_center ltx_border_r">368</td>
<td id="S5.T1.9.13.3.7" class="ltx_td ltx_align_center ltx_border_rr">128</td>
<td id="S5.T1.9.13.3.8" class="ltx_td ltx_align_center ltx_border_r">4750</td>
<td id="S5.T1.9.13.3.9" class="ltx_td ltx_align_center ltx_border_r">2875</td>
<td id="S5.T1.9.13.3.10" class="ltx_td ltx_align_center ltx_border_r">1000</td>
</tr>
<tr id="S5.T1.9.14.4" class="ltx_tr">
<td id="S5.T1.9.14.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_rr">64</td>
<td id="S5.T1.9.14.4.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T1.9.14.4.2.1" class="ltx_text ltx_font_bold">31.4</span></td>
<td id="S5.T1.9.14.4.3" class="ltx_td ltx_align_center ltx_border_r">16.6</td>
<td id="S5.T1.9.14.4.4" class="ltx_td ltx_align_center ltx_border_rr">1.88</td>
<td id="S5.T1.9.14.4.5" class="ltx_td ltx_align_center ltx_border_r">536</td>
<td id="S5.T1.9.14.4.6" class="ltx_td ltx_align_center ltx_border_r">284</td>
<td id="S5.T1.9.14.4.7" class="ltx_td ltx_align_center ltx_border_rr"><span id="S5.T1.9.14.4.7.1" class="ltx_text ltx_font_bold">32</span></td>
<td id="S5.T1.9.14.4.8" class="ltx_td ltx_align_center ltx_border_r">4187</td>
<td id="S5.T1.9.14.4.9" class="ltx_td ltx_align_center ltx_border_r">2218</td>
<td id="S5.T1.9.14.4.10" class="ltx_td ltx_align_center ltx_border_r">250</td>
</tr>
<tr id="S5.T1.9.15.5" class="ltx_tr">
<td id="S5.T1.9.15.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_rr">256</td>
<td id="S5.T1.9.15.5.2" class="ltx_td ltx_align_center ltx_border_r">30.4</td>
<td id="S5.T1.9.15.5.3" class="ltx_td ltx_align_center ltx_border_r">15.4</td>
<td id="S5.T1.9.15.5.4" class="ltx_td ltx_align_center ltx_border_rr">0.47</td>
<td id="S5.T1.9.15.5.5" class="ltx_td ltx_align_center ltx_border_r">518</td>
<td id="S5.T1.9.15.5.6" class="ltx_td ltx_align_center ltx_border_r">263</td>
<td id="S5.T1.9.15.5.7" class="ltx_td ltx_align_center ltx_border_rr">8</td>
<td id="S5.T1.9.15.5.8" class="ltx_td ltx_align_center ltx_border_r">4046</td>
<td id="S5.T1.9.15.5.9" class="ltx_td ltx_align_center ltx_border_r">2054</td>
<td id="S5.T1.9.15.5.10" class="ltx_td ltx_align_center ltx_border_r">62.5</td>
</tr>
<tr id="S5.T1.9.16.6" class="ltx_tr">
<td id="S5.T1.9.16.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_rr">1024</td>
<td id="S5.T1.9.16.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">30.1</td>
<td id="S5.T1.9.16.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">15.1</td>
<td id="S5.T1.9.16.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr">0.12</td>
<td id="S5.T1.9.16.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">513</td>
<td id="S5.T1.9.16.6.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">257</td>
<td id="S5.T1.9.16.6.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr">2</td>
<td id="S5.T1.9.16.6.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">4011</td>
<td id="S5.T1.9.16.6.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">2013</td>
<td id="S5.T1.9.16.6.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T1.9.16.6.10.1" class="ltx_text ltx_font_bold">15.6</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.12.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.13.2" class="ltx_text" style="font-size:90%;">Per-device memory consumption of different optimizations in <em id="S5.T1.13.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP as a function of DP degree . Bold-faced text are the combinations for which the model can fit into a cluster of 32GB V100 GPUs.</span></figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>P<math id="S5.SS3.1.m1.1" class="ltx_Math" alttext="{}_{p}" display="inline"><semantics id="S5.SS3.1.m1.1b"><msub id="S5.SS3.1.m1.1.1" xref="S5.SS3.1.m1.1.1.cmml"><mi id="S5.SS3.1.m1.1.1b" xref="S5.SS3.1.m1.1.1.cmml"></mi><mi id="S5.SS3.1.m1.1.1.1" xref="S5.SS3.1.m1.1.1.1.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.1.m1.1c"><apply id="S5.SS3.1.m1.1.1.cmml" xref="S5.SS3.1.m1.1.1"><ci id="S5.SS3.1.m1.1.1.1.cmml" xref="S5.SS3.1.m1.1.1.1">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.1.m1.1d">{}_{p}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.1.m1.1e">start_FLOATSUBSCRIPT italic_p end_FLOATSUBSCRIPT</annotation></semantics></math>: Parameter Partitioning</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.2" class="ltx_p">Just as with the optimizer states, and the gradients, each process only stores the parameters corresponding to its partition. When the parameters outside of its partition are required for forward and backward propagation, they are received from the appropriate data parallel process through broadcast. While this may seem to incur significant communication overhead at first glance, we show that this approach only increases the total communication volume of a baseline DP system to <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="1.5" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mn id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">1.5</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><cn type="float" id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">1.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">1.5</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">1.5</annotation></semantics></math>x, while enabling memory reduction proportional to <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">N</mi><mi id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">ğ‘</ci><ci id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.5" class="ltx_p"><span id="S5.SS3.p2.5.1" class="ltx_text ltx_font_bold">Memory Savings:</span> With parameter partitioning, we reduce the memory consumption of an <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mi mathvariant="normal" id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">roman_Î¨</annotation></semantics></math> parameter model from <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="16\Psi" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">16</mn><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><times id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1"></times><cn type="integer" id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">16</cn><ci id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">16\Psi</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">16 roman_Î¨</annotation></semantics></math> to <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="\frac{16\Psi}{N_{d}}" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mfrac id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mrow id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml"><mn id="S5.SS3.p2.3.m3.1.1.2.2" xref="S5.SS3.p2.3.m3.1.1.2.2.cmml">16</mn><mo id="S5.SS3.p2.3.m3.1.1.2.1" xref="S5.SS3.p2.3.m3.1.1.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S5.SS3.p2.3.m3.1.1.2.3" xref="S5.SS3.p2.3.m3.1.1.2.3.cmml">Î¨</mi></mrow><msub id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml"><mi id="S5.SS3.p2.3.m3.1.1.3.2" xref="S5.SS3.p2.3.m3.1.1.3.2.cmml">N</mi><mi id="S5.SS3.p2.3.m3.1.1.3.3" xref="S5.SS3.p2.3.m3.1.1.3.3.cmml">d</mi></msub></mfrac><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><divide id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"></divide><apply id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2"><times id="S5.SS3.p2.3.m3.1.1.2.1.cmml" xref="S5.SS3.p2.3.m3.1.1.2.1"></times><cn type="integer" id="S5.SS3.p2.3.m3.1.1.2.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2.2">16</cn><ci id="S5.SS3.p2.3.m3.1.1.2.3.cmml" xref="S5.SS3.p2.3.m3.1.1.2.3">Î¨</ci></apply><apply id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.3.1.cmml" xref="S5.SS3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.3.2.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2">ğ‘</ci><ci id="S5.SS3.p2.3.m3.1.1.3.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3">ğ‘‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">\frac{16\Psi}{N_{d}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.1d">divide start_ARG 16 roman_Î¨ end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. As the example in Figure 1, a 7.5 B parameter model requires 1.9 GB of model-state memory using <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="P_{os+p+g}" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><msub id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">P</mi><mrow id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml"><mrow id="S5.SS3.p2.4.m4.1.1.3.2" xref="S5.SS3.p2.4.m4.1.1.3.2.cmml"><mi id="S5.SS3.p2.4.m4.1.1.3.2.2" xref="S5.SS3.p2.4.m4.1.1.3.2.2.cmml">o</mi><mo id="S5.SS3.p2.4.m4.1.1.3.2.1" xref="S5.SS3.p2.4.m4.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS3.p2.4.m4.1.1.3.2.3" xref="S5.SS3.p2.4.m4.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS3.p2.4.m4.1.1.3.1" xref="S5.SS3.p2.4.m4.1.1.3.1.cmml">+</mo><mi id="S5.SS3.p2.4.m4.1.1.3.3" xref="S5.SS3.p2.4.m4.1.1.3.3.cmml">p</mi><mo id="S5.SS3.p2.4.m4.1.1.3.1a" xref="S5.SS3.p2.4.m4.1.1.3.1.cmml">+</mo><mi id="S5.SS3.p2.4.m4.1.1.3.4" xref="S5.SS3.p2.4.m4.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">ğ‘ƒ</ci><apply id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3"><plus id="S5.SS3.p2.4.m4.1.1.3.1.cmml" xref="S5.SS3.p2.4.m4.1.1.3.1"></plus><apply id="S5.SS3.p2.4.m4.1.1.3.2.cmml" xref="S5.SS3.p2.4.m4.1.1.3.2"><times id="S5.SS3.p2.4.m4.1.1.3.2.1.cmml" xref="S5.SS3.p2.4.m4.1.1.3.2.1"></times><ci id="S5.SS3.p2.4.m4.1.1.3.2.2.cmml" xref="S5.SS3.p2.4.m4.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS3.p2.4.m4.1.1.3.2.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS3.p2.4.m4.1.1.3.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3.3">ğ‘</ci><ci id="S5.SS3.p2.4.m4.1.1.3.4.cmml" xref="S5.SS3.p2.4.m4.1.1.3.4">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">P_{os+p+g}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_p + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> with 64-way DP (<math id="S5.SS3.p2.5.m5.1" class="ltx_Math" alttext="N_{d}=64" display="inline"><semantics id="S5.SS3.p2.5.m5.1a"><mrow id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml"><msub id="S5.SS3.p2.5.m5.1.1.2" xref="S5.SS3.p2.5.m5.1.1.2.cmml"><mi id="S5.SS3.p2.5.m5.1.1.2.2" xref="S5.SS3.p2.5.m5.1.1.2.2.cmml">N</mi><mi id="S5.SS3.p2.5.m5.1.1.2.3" xref="S5.SS3.p2.5.m5.1.1.2.3.cmml">d</mi></msub><mo id="S5.SS3.p2.5.m5.1.1.1" xref="S5.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.5.m5.1.1.3" xref="S5.SS3.p2.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1"><eq id="S5.SS3.p2.5.m5.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1"></eq><apply id="S5.SS3.p2.5.m5.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.1.1.2.1.cmml" xref="S5.SS3.p2.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.5.m5.1.1.2.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2.2">ğ‘</ci><ci id="S5.SS3.p2.5.m5.1.1.2.3.cmml" xref="S5.SS3.p2.5.m5.1.1.2.3">ğ‘‘</ci></apply><cn type="integer" id="S5.SS3.p2.5.m5.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">N_{d}=64</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 64</annotation></semantics></math>), while requiring 120 GB with standard DP. This has a profound implication: <em id="S5.SS3.p2.5.2" class="ltx_emph ltx_font_italic"><em id="S5.SS3.p2.5.2.1" class="ltx_emph ltx_font_upright">ZeRO</em> powers DP to fit models with arbitrary sizeâ€” as long as there are sufficient number of devices to share the model states</em>.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Implication on Model Size</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.10" class="ltx_p">The three phases of partitioning <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><times id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.1"></times><ci id="S5.SS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">ğ‘œ</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S5.SS4.p1.2.m2.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S5.SS4.p1.2.m2.1a"><msub id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.p1.2.m2.1.1.2" xref="S5.SS4.p1.2.m2.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3.cmml"><mrow id="S5.SS4.p1.2.m2.1.1.3.2" xref="S5.SS4.p1.2.m2.1.1.3.2.cmml"><mi id="S5.SS4.p1.2.m2.1.1.3.2.2" xref="S5.SS4.p1.2.m2.1.1.3.2.2.cmml">o</mi><mo id="S5.SS4.p1.2.m2.1.1.3.2.1" xref="S5.SS4.p1.2.m2.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS4.p1.2.m2.1.1.3.2.3" xref="S5.SS4.p1.2.m2.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS4.p1.2.m2.1.1.3.1" xref="S5.SS4.p1.2.m2.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.2.m2.1.1.3.3" xref="S5.SS4.p1.2.m2.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3"><plus id="S5.SS4.p1.2.m2.1.1.3.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3.1"></plus><apply id="S5.SS4.p1.2.m2.1.1.3.2.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2"><times id="S5.SS4.p1.2.m2.1.1.3.2.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.1"></times><ci id="S5.SS4.p1.2.m2.1.1.3.2.2.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS4.p1.2.m2.1.1.3.2.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS4.p1.2.m2.1.1.3.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, and <math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="P_{os+g+p}" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><msub id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml"><mi id="S5.SS4.p1.3.m3.1.1.2" xref="S5.SS4.p1.3.m3.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.3.m3.1.1.3" xref="S5.SS4.p1.3.m3.1.1.3.cmml"><mrow id="S5.SS4.p1.3.m3.1.1.3.2" xref="S5.SS4.p1.3.m3.1.1.3.2.cmml"><mi id="S5.SS4.p1.3.m3.1.1.3.2.2" xref="S5.SS4.p1.3.m3.1.1.3.2.2.cmml">o</mi><mo id="S5.SS4.p1.3.m3.1.1.3.2.1" xref="S5.SS4.p1.3.m3.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS4.p1.3.m3.1.1.3.2.3" xref="S5.SS4.p1.3.m3.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS4.p1.3.m3.1.1.3.1" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.3.m3.1.1.3.3" xref="S5.SS4.p1.3.m3.1.1.3.3.cmml">g</mi><mo id="S5.SS4.p1.3.m3.1.1.3.1a" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.3.m3.1.1.3.4" xref="S5.SS4.p1.3.m3.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><apply id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.3.m3.1.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p1.3.m3.1.1.2.cmml" xref="S5.SS4.p1.3.m3.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.3.m3.1.1.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3"><plus id="S5.SS4.p1.3.m3.1.1.3.1.cmml" xref="S5.SS4.p1.3.m3.1.1.3.1"></plus><apply id="S5.SS4.p1.3.m3.1.1.3.2.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2"><times id="S5.SS4.p1.3.m3.1.1.3.2.1.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2.1"></times><ci id="S5.SS4.p1.3.m3.1.1.3.2.2.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS4.p1.3.m3.1.1.3.2.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS4.p1.3.m3.1.1.3.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3">ğ‘”</ci><ci id="S5.SS4.p1.3.m3.1.1.3.4.cmml" xref="S5.SS4.p1.3.m3.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">P_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g + italic_p end_POSTSUBSCRIPT</annotation></semantics></math> reduces the memory consumption of each data parallel process on model states by up to 4x, 8x, and <math id="S5.SS4.p1.4.m4.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S5.SS4.p1.4.m4.1a"><msub id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml"><mi id="S5.SS4.p1.4.m4.1.1.2" xref="S5.SS4.p1.4.m4.1.1.2.cmml">N</mi><mi id="S5.SS4.p1.4.m4.1.1.3" xref="S5.SS4.p1.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><apply id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.4.m4.1.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS4.p1.4.m4.1.1.2.cmml" xref="S5.SS4.p1.4.m4.1.1.2">ğ‘</ci><ci id="S5.SS4.p1.4.m4.1.1.3.cmml" xref="S5.SS4.p1.4.m4.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> respectively.
Table <a href="#S5.T1" title="Table 1 â€£ 5.2 P_ğ‘”: Gradient Partitioning â€£ 5 Deep Dive into ZeRO-DP â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> analyzes model-state memory consumption of a few example models under the 3 stages of <em id="S5.SS4.p1.10.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP optimizations for varying DP degree. Without <em id="S5.SS4.p1.10.2" class="ltx_emph ltx_font_italic">ZeRO</em>, the memory consumption is equal to the first row in the table, regardless of the DP degree. Note that, with <math id="S5.SS4.p1.5.m5.1" class="ltx_Math" alttext="N_{d}=64" display="inline"><semantics id="S5.SS4.p1.5.m5.1a"><mrow id="S5.SS4.p1.5.m5.1.1" xref="S5.SS4.p1.5.m5.1.1.cmml"><msub id="S5.SS4.p1.5.m5.1.1.2" xref="S5.SS4.p1.5.m5.1.1.2.cmml"><mi id="S5.SS4.p1.5.m5.1.1.2.2" xref="S5.SS4.p1.5.m5.1.1.2.2.cmml">N</mi><mi id="S5.SS4.p1.5.m5.1.1.2.3" xref="S5.SS4.p1.5.m5.1.1.2.3.cmml">d</mi></msub><mo id="S5.SS4.p1.5.m5.1.1.1" xref="S5.SS4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.5.m5.1.1.3" xref="S5.SS4.p1.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m5.1b"><apply id="S5.SS4.p1.5.m5.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1"><eq id="S5.SS4.p1.5.m5.1.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1.1"></eq><apply id="S5.SS4.p1.5.m5.1.1.2.cmml" xref="S5.SS4.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.5.m5.1.1.2.1.cmml" xref="S5.SS4.p1.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS4.p1.5.m5.1.1.2.2.cmml" xref="S5.SS4.p1.5.m5.1.1.2.2">ğ‘</ci><ci id="S5.SS4.p1.5.m5.1.1.2.3.cmml" xref="S5.SS4.p1.5.m5.1.1.2.3">ğ‘‘</ci></apply><cn type="integer" id="S5.SS4.p1.5.m5.1.1.3.cmml" xref="S5.SS4.p1.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m5.1c">N_{d}=64</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 64</annotation></semantics></math>, <em id="S5.SS4.p1.10.3" class="ltx_emph ltx_font_italic">ZeRO</em> can train models with up to 7.5B, 14B, and 128B parameters using <math id="S5.SS4.p1.6.m6.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S5.SS4.p1.6.m6.1a"><msub id="S5.SS4.p1.6.m6.1.1" xref="S5.SS4.p1.6.m6.1.1.cmml"><mi id="S5.SS4.p1.6.m6.1.1.2" xref="S5.SS4.p1.6.m6.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.6.m6.1.1.3" xref="S5.SS4.p1.6.m6.1.1.3.cmml"><mi id="S5.SS4.p1.6.m6.1.1.3.2" xref="S5.SS4.p1.6.m6.1.1.3.2.cmml">o</mi><mo id="S5.SS4.p1.6.m6.1.1.3.1" xref="S5.SS4.p1.6.m6.1.1.3.1.cmml">â¢</mo><mi id="S5.SS4.p1.6.m6.1.1.3.3" xref="S5.SS4.p1.6.m6.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.6.m6.1b"><apply id="S5.SS4.p1.6.m6.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.6.m6.1.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS4.p1.6.m6.1.1.2.cmml" xref="S5.SS4.p1.6.m6.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.6.m6.1.1.3.cmml" xref="S5.SS4.p1.6.m6.1.1.3"><times id="S5.SS4.p1.6.m6.1.1.3.1.cmml" xref="S5.SS4.p1.6.m6.1.1.3.1"></times><ci id="S5.SS4.p1.6.m6.1.1.3.2.cmml" xref="S5.SS4.p1.6.m6.1.1.3.2">ğ‘œ</ci><ci id="S5.SS4.p1.6.m6.1.1.3.3.cmml" xref="S5.SS4.p1.6.m6.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.6.m6.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S5.SS4.p1.7.m7.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S5.SS4.p1.7.m7.1a"><msub id="S5.SS4.p1.7.m7.1.1" xref="S5.SS4.p1.7.m7.1.1.cmml"><mi id="S5.SS4.p1.7.m7.1.1.2" xref="S5.SS4.p1.7.m7.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.7.m7.1.1.3" xref="S5.SS4.p1.7.m7.1.1.3.cmml"><mrow id="S5.SS4.p1.7.m7.1.1.3.2" xref="S5.SS4.p1.7.m7.1.1.3.2.cmml"><mi id="S5.SS4.p1.7.m7.1.1.3.2.2" xref="S5.SS4.p1.7.m7.1.1.3.2.2.cmml">o</mi><mo id="S5.SS4.p1.7.m7.1.1.3.2.1" xref="S5.SS4.p1.7.m7.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS4.p1.7.m7.1.1.3.2.3" xref="S5.SS4.p1.7.m7.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS4.p1.7.m7.1.1.3.1" xref="S5.SS4.p1.7.m7.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.7.m7.1.1.3.3" xref="S5.SS4.p1.7.m7.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.7.m7.1b"><apply id="S5.SS4.p1.7.m7.1.1.cmml" xref="S5.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.7.m7.1.1.1.cmml" xref="S5.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S5.SS4.p1.7.m7.1.1.2.cmml" xref="S5.SS4.p1.7.m7.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.7.m7.1.1.3.cmml" xref="S5.SS4.p1.7.m7.1.1.3"><plus id="S5.SS4.p1.7.m7.1.1.3.1.cmml" xref="S5.SS4.p1.7.m7.1.1.3.1"></plus><apply id="S5.SS4.p1.7.m7.1.1.3.2.cmml" xref="S5.SS4.p1.7.m7.1.1.3.2"><times id="S5.SS4.p1.7.m7.1.1.3.2.1.cmml" xref="S5.SS4.p1.7.m7.1.1.3.2.1"></times><ci id="S5.SS4.p1.7.m7.1.1.3.2.2.cmml" xref="S5.SS4.p1.7.m7.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS4.p1.7.m7.1.1.3.2.3.cmml" xref="S5.SS4.p1.7.m7.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS4.p1.7.m7.1.1.3.3.cmml" xref="S5.SS4.p1.7.m7.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.7.m7.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.7.m7.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, and <math id="S5.SS4.p1.8.m8.1" class="ltx_Math" alttext="P_{os+g+p}" display="inline"><semantics id="S5.SS4.p1.8.m8.1a"><msub id="S5.SS4.p1.8.m8.1.1" xref="S5.SS4.p1.8.m8.1.1.cmml"><mi id="S5.SS4.p1.8.m8.1.1.2" xref="S5.SS4.p1.8.m8.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.8.m8.1.1.3" xref="S5.SS4.p1.8.m8.1.1.3.cmml"><mrow id="S5.SS4.p1.8.m8.1.1.3.2" xref="S5.SS4.p1.8.m8.1.1.3.2.cmml"><mi id="S5.SS4.p1.8.m8.1.1.3.2.2" xref="S5.SS4.p1.8.m8.1.1.3.2.2.cmml">o</mi><mo id="S5.SS4.p1.8.m8.1.1.3.2.1" xref="S5.SS4.p1.8.m8.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS4.p1.8.m8.1.1.3.2.3" xref="S5.SS4.p1.8.m8.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS4.p1.8.m8.1.1.3.1" xref="S5.SS4.p1.8.m8.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.8.m8.1.1.3.3" xref="S5.SS4.p1.8.m8.1.1.3.3.cmml">g</mi><mo id="S5.SS4.p1.8.m8.1.1.3.1a" xref="S5.SS4.p1.8.m8.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.8.m8.1.1.3.4" xref="S5.SS4.p1.8.m8.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.8.m8.1b"><apply id="S5.SS4.p1.8.m8.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.1.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S5.SS4.p1.8.m8.1.1.2.cmml" xref="S5.SS4.p1.8.m8.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.8.m8.1.1.3.cmml" xref="S5.SS4.p1.8.m8.1.1.3"><plus id="S5.SS4.p1.8.m8.1.1.3.1.cmml" xref="S5.SS4.p1.8.m8.1.1.3.1"></plus><apply id="S5.SS4.p1.8.m8.1.1.3.2.cmml" xref="S5.SS4.p1.8.m8.1.1.3.2"><times id="S5.SS4.p1.8.m8.1.1.3.2.1.cmml" xref="S5.SS4.p1.8.m8.1.1.3.2.1"></times><ci id="S5.SS4.p1.8.m8.1.1.3.2.2.cmml" xref="S5.SS4.p1.8.m8.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS4.p1.8.m8.1.1.3.2.3.cmml" xref="S5.SS4.p1.8.m8.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS4.p1.8.m8.1.1.3.3.cmml" xref="S5.SS4.p1.8.m8.1.1.3.3">ğ‘”</ci><ci id="S5.SS4.p1.8.m8.1.1.3.4.cmml" xref="S5.SS4.p1.8.m8.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.8.m8.1c">P_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.8.m8.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g + italic_p end_POSTSUBSCRIPT</annotation></semantics></math>, respectively. When <math id="S5.SS4.p1.9.m9.1" class="ltx_Math" alttext="N_{d}=1024" display="inline"><semantics id="S5.SS4.p1.9.m9.1a"><mrow id="S5.SS4.p1.9.m9.1.1" xref="S5.SS4.p1.9.m9.1.1.cmml"><msub id="S5.SS4.p1.9.m9.1.1.2" xref="S5.SS4.p1.9.m9.1.1.2.cmml"><mi id="S5.SS4.p1.9.m9.1.1.2.2" xref="S5.SS4.p1.9.m9.1.1.2.2.cmml">N</mi><mi id="S5.SS4.p1.9.m9.1.1.2.3" xref="S5.SS4.p1.9.m9.1.1.2.3.cmml">d</mi></msub><mo id="S5.SS4.p1.9.m9.1.1.1" xref="S5.SS4.p1.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.9.m9.1.1.3" xref="S5.SS4.p1.9.m9.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.9.m9.1b"><apply id="S5.SS4.p1.9.m9.1.1.cmml" xref="S5.SS4.p1.9.m9.1.1"><eq id="S5.SS4.p1.9.m9.1.1.1.cmml" xref="S5.SS4.p1.9.m9.1.1.1"></eq><apply id="S5.SS4.p1.9.m9.1.1.2.cmml" xref="S5.SS4.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.p1.9.m9.1.1.2.1.cmml" xref="S5.SS4.p1.9.m9.1.1.2">subscript</csymbol><ci id="S5.SS4.p1.9.m9.1.1.2.2.cmml" xref="S5.SS4.p1.9.m9.1.1.2.2">ğ‘</ci><ci id="S5.SS4.p1.9.m9.1.1.2.3.cmml" xref="S5.SS4.p1.9.m9.1.1.2.3">ğ‘‘</ci></apply><cn type="integer" id="S5.SS4.p1.9.m9.1.1.3.cmml" xref="S5.SS4.p1.9.m9.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.9.m9.1c">N_{d}=1024</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.9.m9.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 1024</annotation></semantics></math>, <em id="S5.SS4.p1.10.4" class="ltx_emph ltx_font_italic">ZeRO</em> with all of its optimizations enabled (<math id="S5.SS4.p1.10.m10.1" class="ltx_Math" alttext="P_{os+g+p}" display="inline"><semantics id="S5.SS4.p1.10.m10.1a"><msub id="S5.SS4.p1.10.m10.1.1" xref="S5.SS4.p1.10.m10.1.1.cmml"><mi id="S5.SS4.p1.10.m10.1.1.2" xref="S5.SS4.p1.10.m10.1.1.2.cmml">P</mi><mrow id="S5.SS4.p1.10.m10.1.1.3" xref="S5.SS4.p1.10.m10.1.1.3.cmml"><mrow id="S5.SS4.p1.10.m10.1.1.3.2" xref="S5.SS4.p1.10.m10.1.1.3.2.cmml"><mi id="S5.SS4.p1.10.m10.1.1.3.2.2" xref="S5.SS4.p1.10.m10.1.1.3.2.2.cmml">o</mi><mo id="S5.SS4.p1.10.m10.1.1.3.2.1" xref="S5.SS4.p1.10.m10.1.1.3.2.1.cmml">â¢</mo><mi id="S5.SS4.p1.10.m10.1.1.3.2.3" xref="S5.SS4.p1.10.m10.1.1.3.2.3.cmml">s</mi></mrow><mo id="S5.SS4.p1.10.m10.1.1.3.1" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.10.m10.1.1.3.3" xref="S5.SS4.p1.10.m10.1.1.3.3.cmml">g</mi><mo id="S5.SS4.p1.10.m10.1.1.3.1a" xref="S5.SS4.p1.10.m10.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p1.10.m10.1.1.3.4" xref="S5.SS4.p1.10.m10.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.10.m10.1b"><apply id="S5.SS4.p1.10.m10.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.10.m10.1.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1">subscript</csymbol><ci id="S5.SS4.p1.10.m10.1.1.2.cmml" xref="S5.SS4.p1.10.m10.1.1.2">ğ‘ƒ</ci><apply id="S5.SS4.p1.10.m10.1.1.3.cmml" xref="S5.SS4.p1.10.m10.1.1.3"><plus id="S5.SS4.p1.10.m10.1.1.3.1.cmml" xref="S5.SS4.p1.10.m10.1.1.3.1"></plus><apply id="S5.SS4.p1.10.m10.1.1.3.2.cmml" xref="S5.SS4.p1.10.m10.1.1.3.2"><times id="S5.SS4.p1.10.m10.1.1.3.2.1.cmml" xref="S5.SS4.p1.10.m10.1.1.3.2.1"></times><ci id="S5.SS4.p1.10.m10.1.1.3.2.2.cmml" xref="S5.SS4.p1.10.m10.1.1.3.2.2">ğ‘œ</ci><ci id="S5.SS4.p1.10.m10.1.1.3.2.3.cmml" xref="S5.SS4.p1.10.m10.1.1.3.2.3">ğ‘ </ci></apply><ci id="S5.SS4.p1.10.m10.1.1.3.3.cmml" xref="S5.SS4.p1.10.m10.1.1.3.3">ğ‘”</ci><ci id="S5.SS4.p1.10.m10.1.1.3.4.cmml" xref="S5.SS4.p1.10.m10.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.10.m10.1c">P_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.10.m10.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g + italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) could train models with 1 <span id="S5.SS4.p1.10.5" class="ltx_text ltx_font_smallcaps">Trillion</span> parameters! Or potentially, models with <span id="S5.SS4.p1.10.6" class="ltx_text ltx_font_smallcaps">Arbitrary</span> size! Without <em id="S5.SS4.p1.10.7" class="ltx_emph ltx_font_italic">ZeRO</em>, the largest model DP alone can run has less than 1.5 Billion parameters.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Deep Dive into <em id="S6.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R</h2>

<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span><math id="S6.SS1.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S6.SS1.1.m1.1b"><msub id="S6.SS1.1.m1.1.1" xref="S6.SS1.1.m1.1.1.cmml"><mi id="S6.SS1.1.m1.1.1.2" xref="S6.SS1.1.m1.1.1.2.cmml">P</mi><mi id="S6.SS1.1.m1.1.1.3" xref="S6.SS1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.1.m1.1c"><apply id="S6.SS1.1.m1.1.1.cmml" xref="S6.SS1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.1.m1.1.1.1.cmml" xref="S6.SS1.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.1.m1.1.1.2.cmml" xref="S6.SS1.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S6.SS1.1.m1.1.1.3.cmml" xref="S6.SS1.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.1.m1.1d">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.1.m1.1e">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>: Partitioned Activation Checkpointing</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.2" class="ltx_p">As discussed in <a href="#S4.SS2" title="4.2 Insights and Overview: ZeRO-R â€£ 4 ZeRO: Insights and Overview â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, MP by design requires a replication of the activations, resulting in redundant copies of the activations across model parallel GPUs. <em id="S6.SS1.p1.2.1" class="ltx_emph ltx_font_italic">ZeRO</em> eliminates this redundancy by partitioning the activations, and only materializes them in a replicated form one activation layer at a time, right before the activation is used in computation. More specifically, once the forward propagation for a layer of a model is computed, the input activations are partitioned across all the model parallel process, until it is needed again during the backprogation. At this point, <em id="S6.SS1.p1.2.2" class="ltx_emph ltx_font_italic">ZeRO</em> uses an all-gather operation to re-materialize a replicated copy of the activations. We refer to this optimization as <math id="S6.SS1.p1.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S6.SS1.p1.1.m1.1a"><msub id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mi id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml">P</mi><mi id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S6.SS1.p1.1.m1.1.1.3.cmml" xref="S6.SS1.p1.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>. It works in conjunction with activation checkpointing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, storing partitioned activation checkpoints only instead of replicated copies. Furthermore, in the case of very large models and very limited device memory, these partitioned activation checkpoints can also be offloaded to the CPU reducing the activation memory overhead to nearly zero at an additional communication cost, which we will discuss in <a href="#S7" title="7 Communication Analysis of ZeRO-DP â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. We refer to this as <math id="S6.SS1.p1.2.m2.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S6.SS1.p1.2.m2.1a"><msub id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mi id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml">P</mi><mrow id="S6.SS1.p1.2.m2.1.1.3" xref="S6.SS1.p1.2.m2.1.1.3.cmml"><mi id="S6.SS1.p1.2.m2.1.1.3.2" xref="S6.SS1.p1.2.m2.1.1.3.2.cmml">a</mi><mo id="S6.SS1.p1.2.m2.1.1.3.1" xref="S6.SS1.p1.2.m2.1.1.3.1.cmml">+</mo><mrow id="S6.SS1.p1.2.m2.1.1.3.3" xref="S6.SS1.p1.2.m2.1.1.3.3.cmml"><mi id="S6.SS1.p1.2.m2.1.1.3.3.2" xref="S6.SS1.p1.2.m2.1.1.3.3.2.cmml">c</mi><mo id="S6.SS1.p1.2.m2.1.1.3.3.1" xref="S6.SS1.p1.2.m2.1.1.3.3.1.cmml">â¢</mo><mi id="S6.SS1.p1.2.m2.1.1.3.3.3" xref="S6.SS1.p1.2.m2.1.1.3.3.3.cmml">p</mi><mo id="S6.SS1.p1.2.m2.1.1.3.3.1a" xref="S6.SS1.p1.2.m2.1.1.3.3.1.cmml">â¢</mo><mi id="S6.SS1.p1.2.m2.1.1.3.3.4" xref="S6.SS1.p1.2.m2.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S6.SS1.p1.2.m2.1.1.2.cmml" xref="S6.SS1.p1.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S6.SS1.p1.2.m2.1.1.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3"><plus id="S6.SS1.p1.2.m2.1.1.3.1.cmml" xref="S6.SS1.p1.2.m2.1.1.3.1"></plus><ci id="S6.SS1.p1.2.m2.1.1.3.2.cmml" xref="S6.SS1.p1.2.m2.1.1.3.2">ğ‘</ci><apply id="S6.SS1.p1.2.m2.1.1.3.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3.3"><times id="S6.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S6.SS1.p1.2.m2.1.1.3.3.1"></times><ci id="S6.SS1.p1.2.m2.1.1.3.3.2.cmml" xref="S6.SS1.p1.2.m2.1.1.3.3.2">ğ‘</ci><ci id="S6.SS1.p1.2.m2.1.1.3.3.3.cmml" xref="S6.SS1.p1.2.m2.1.1.3.3.3">ğ‘</ci><ci id="S6.SS1.p1.2.m2.1.1.3.3.4.cmml" xref="S6.SS1.p1.2.m2.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p"><span id="S6.SS1.p2.1.1" class="ltx_text ltx_font_bold">Memory Saving</span> With partitioned activation checkpointing, <em id="S6.SS1.p2.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> reduces the activation footprint by a factor proportional to the MP degree. Consider training a 100B model shown in TableÂ <a href="#S10.T4" title="Table 4 â€£ Max Cached Memory â€£ 10.5 Memory and Performance Analysis â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> with a batch size of 32, sequence length of 1024 and a MP degree of 16. If we checkpoint a single activation for each transformer layer, it would require about 33 GB of memory per GPU just to store the activation checkpoints. But with P<math id="S6.SS1.p2.1.m1.1" class="ltx_Math" alttext="{}_{a}" display="inline"><semantics id="S6.SS1.p2.1.m1.1a"><msub id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml"><mi id="S6.SS1.p2.1.m1.1.1a" xref="S6.SS1.p2.1.m1.1.1.cmml"></mi><mi id="S6.SS1.p2.1.m1.1.1.1" xref="S6.SS1.p2.1.m1.1.1.1.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><apply id="S6.SS1.p2.1.m1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1"><ci id="S6.SS1.p2.1.m1.1.1.1.cmml" xref="S6.SS1.p2.1.m1.1.1.1">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">{}_{a}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.1.m1.1d">start_FLOATSUBSCRIPT italic_a end_FLOATSUBSCRIPT</annotation></semantics></math> in <em id="S6.SS1.p2.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>, it can be reduced to about 2 GB per GPU. Furthermore, this 2GB can be offloaded to the CPU reducing the memory footprint for activations to nearly zero.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>C<math id="S6.SS2.1.m1.1" class="ltx_Math" alttext="{}_{B}" display="inline"><semantics id="S6.SS2.1.m1.1b"><msub id="S6.SS2.1.m1.1.1" xref="S6.SS2.1.m1.1.1.cmml"><mi id="S6.SS2.1.m1.1.1b" xref="S6.SS2.1.m1.1.1.cmml"></mi><mi id="S6.SS2.1.m1.1.1.1" xref="S6.SS2.1.m1.1.1.1.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.1.m1.1c"><apply id="S6.SS2.1.m1.1.1.cmml" xref="S6.SS2.1.m1.1.1"><ci id="S6.SS2.1.m1.1.1.1.cmml" xref="S6.SS2.1.m1.1.1.1">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.1.m1.1d">{}_{B}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.1.m1.1e">start_FLOATSUBSCRIPT italic_B end_FLOATSUBSCRIPT</annotation></semantics></math>: Constant Size Buffers</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p"><em id="S6.SS2.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> carefully selects the sizes of the temporal-data buffers to balance memory and compute efficiency.
During training, the computational efficiency of some operations can be highly dependent on the input size, with larger inputs achieving higher efficiency. For example, a large all-reduce operation achieves much higher bandwidth than a smaller one. Hence, to get better efficiency, high performance libraries such as NVIDIA Apex or Megatron fuses all the parameters into a single buffer before applying these operations. However, the memory overhead of the fused buffers is proportional to the model size, and can become inhibiting. For example, for a 3B parameter model, a 32-bit fused buffer will require 12 GB of memory. To address this issue, we simply use a performance-efficient constant-size fused buffer when the model becomes too large. By doing so, the buffer size does not depend on the model size, and by keeping the buffer size large enough, we can still achieve good efficiency.</p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>M<math id="S6.SS3.1.m1.1" class="ltx_Math" alttext="{}_{D}" display="inline"><semantics id="S6.SS3.1.m1.1b"><msub id="S6.SS3.1.m1.1.1" xref="S6.SS3.1.m1.1.1.cmml"><mi id="S6.SS3.1.m1.1.1b" xref="S6.SS3.1.m1.1.1.cmml"></mi><mi id="S6.SS3.1.m1.1.1.1" xref="S6.SS3.1.m1.1.1.1.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.1.m1.1c"><apply id="S6.SS3.1.m1.1.1.cmml" xref="S6.SS3.1.m1.1.1"><ci id="S6.SS3.1.m1.1.1.1.cmml" xref="S6.SS3.1.m1.1.1.1">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.1.m1.1d">{}_{D}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.1.m1.1e">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT</annotation></semantics></math>: Memory Defragmentation</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">Memory fragmentation in model training occurs as a result of activation checkpointing and gradient computation. During the forward propagation with activation checkpointing, only selected activations are stored for back propagation while most activations are discarded as they can be recomputed again during the back propagation. This creates an interleaving of short lived memory (discarded activations) and long lived memory (checkpointed activation), leading to memory fragmentation. Similarly, during the backward propagation, the parameter gradients are long lived, while activation gradients and any other buffers required to compute the parameter gradients are short lived. Once again, this interleaving of short term and long term memory causes memory fragmentation.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.1" class="ltx_p">Limited memory fragmentation is generally not an issue, when there is plenty of memory to spare, but for large model training running with limited memory, memory fragmentation leads to two issues, i) OOM due to lack of contiguous memory even when there is enough available memory, ii) poor efficiency as a result of the memory allocator spending significant time to search for a contiguous piece of memory to satisfy a memory request.</p>
</div>
<div id="S6.SS3.p3" class="ltx_para">
<p id="S6.SS3.p3.1" class="ltx_p"><em id="S6.SS3.p3.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> does memory defragmentation on-the-fly by pre-allocating contiguous memory chunks for activation checkpoints and gradients, and copying them over to the pre-allocated memory as they are produced. M<math id="S6.SS3.p3.1.m1.1" class="ltx_Math" alttext="{}_{D}" display="inline"><semantics id="S6.SS3.p3.1.m1.1a"><msub id="S6.SS3.p3.1.m1.1.1" xref="S6.SS3.p3.1.m1.1.1.cmml"><mi id="S6.SS3.p3.1.m1.1.1a" xref="S6.SS3.p3.1.m1.1.1.cmml"></mi><mi id="S6.SS3.p3.1.m1.1.1.1" xref="S6.SS3.p3.1.m1.1.1.1.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.1.m1.1b"><apply id="S6.SS3.p3.1.m1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1"><ci id="S6.SS3.p3.1.m1.1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1.1">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.1.m1.1c">{}_{D}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p3.1.m1.1d">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT</annotation></semantics></math> not only enables <em id="S6.SS3.p3.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> to train larger models with larger batch sizes, but also improves efficiency when training with limited memory.</p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Communication Analysis of <em id="S7.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.7" class="ltx_p">As <em id="S7.p1.7.1" class="ltx_emph ltx_font_italic">ZeRO</em> boosts model size by removing memory redundancy, it is only natural to ask if we are trading communication volume for memory efficiency. In other words, what is the communication volume of <em id="S7.p1.7.2" class="ltx_emph ltx_font_italic">ZeRO</em>-powered DP approach compared to a baseline DP approach?
The answer is in two parts: i) <em id="S7.p1.7.3" class="ltx_emph ltx_font_italic">ZeRO</em>-DP incurs no additional communication using <math id="S7.p1.1.m1.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S7.p1.1.m1.1a"><msub id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml"><mi id="S7.p1.1.m1.1.1.2" xref="S7.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S7.p1.1.m1.1.1.3" xref="S7.p1.1.m1.1.1.3.cmml"><mi id="S7.p1.1.m1.1.1.3.2" xref="S7.p1.1.m1.1.1.3.2.cmml">o</mi><mo id="S7.p1.1.m1.1.1.3.1" xref="S7.p1.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S7.p1.1.m1.1.1.3.3" xref="S7.p1.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><apply id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.p1.1.m1.1.1.1.cmml" xref="S7.p1.1.m1.1.1">subscript</csymbol><ci id="S7.p1.1.m1.1.1.2.cmml" xref="S7.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S7.p1.1.m1.1.1.3.cmml" xref="S7.p1.1.m1.1.1.3"><times id="S7.p1.1.m1.1.1.3.1.cmml" xref="S7.p1.1.m1.1.1.3.1"></times><ci id="S7.p1.1.m1.1.1.3.2.cmml" xref="S7.p1.1.m1.1.1.3.2">ğ‘œ</ci><ci id="S7.p1.1.m1.1.1.3.3.cmml" xref="S7.p1.1.m1.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S7.p1.2.m2.1" class="ltx_Math" alttext="P_{g}" display="inline"><semantics id="S7.p1.2.m2.1a"><msub id="S7.p1.2.m2.1.1" xref="S7.p1.2.m2.1.1.cmml"><mi id="S7.p1.2.m2.1.1.2" xref="S7.p1.2.m2.1.1.2.cmml">P</mi><mi id="S7.p1.2.m2.1.1.3" xref="S7.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S7.p1.2.m2.1b"><apply id="S7.p1.2.m2.1.1.cmml" xref="S7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S7.p1.2.m2.1.1.1.cmml" xref="S7.p1.2.m2.1.1">subscript</csymbol><ci id="S7.p1.2.m2.1.1.2.cmml" xref="S7.p1.2.m2.1.1.2">ğ‘ƒ</ci><ci id="S7.p1.2.m2.1.1.3.cmml" xref="S7.p1.2.m2.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.2.m2.1c">P_{g}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, while enabling up to 8x memory reduction,
ii) <em id="S7.p1.7.4" class="ltx_emph ltx_font_italic">ZeRO</em>-DP incurs a maximum of <math id="S7.p1.3.m3.1" class="ltx_Math" alttext="1.5" display="inline"><semantics id="S7.p1.3.m3.1a"><mn id="S7.p1.3.m3.1.1" xref="S7.p1.3.m3.1.1.cmml">1.5</mn><annotation-xml encoding="MathML-Content" id="S7.p1.3.m3.1b"><cn type="float" id="S7.p1.3.m3.1.1.cmml" xref="S7.p1.3.m3.1.1">1.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.3.m3.1c">1.5</annotation><annotation encoding="application/x-llamapun" id="S7.p1.3.m3.1d">1.5</annotation></semantics></math>x communication when using <math id="S7.p1.4.m4.1" class="ltx_Math" alttext="P_{p}" display="inline"><semantics id="S7.p1.4.m4.1a"><msub id="S7.p1.4.m4.1.1" xref="S7.p1.4.m4.1.1.cmml"><mi id="S7.p1.4.m4.1.1.2" xref="S7.p1.4.m4.1.1.2.cmml">P</mi><mi id="S7.p1.4.m4.1.1.3" xref="S7.p1.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S7.p1.4.m4.1b"><apply id="S7.p1.4.m4.1.1.cmml" xref="S7.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S7.p1.4.m4.1.1.1.cmml" xref="S7.p1.4.m4.1.1">subscript</csymbol><ci id="S7.p1.4.m4.1.1.2.cmml" xref="S7.p1.4.m4.1.1.2">ğ‘ƒ</ci><ci id="S7.p1.4.m4.1.1.3.cmml" xref="S7.p1.4.m4.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.4.m4.1c">P_{p}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> in addition to <math id="S7.p1.5.m5.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S7.p1.5.m5.1a"><msub id="S7.p1.5.m5.1.1" xref="S7.p1.5.m5.1.1.cmml"><mi id="S7.p1.5.m5.1.1.2" xref="S7.p1.5.m5.1.1.2.cmml">P</mi><mrow id="S7.p1.5.m5.1.1.3" xref="S7.p1.5.m5.1.1.3.cmml"><mi id="S7.p1.5.m5.1.1.3.2" xref="S7.p1.5.m5.1.1.3.2.cmml">o</mi><mo id="S7.p1.5.m5.1.1.3.1" xref="S7.p1.5.m5.1.1.3.1.cmml">â¢</mo><mi id="S7.p1.5.m5.1.1.3.3" xref="S7.p1.5.m5.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.p1.5.m5.1b"><apply id="S7.p1.5.m5.1.1.cmml" xref="S7.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S7.p1.5.m5.1.1.1.cmml" xref="S7.p1.5.m5.1.1">subscript</csymbol><ci id="S7.p1.5.m5.1.1.2.cmml" xref="S7.p1.5.m5.1.1.2">ğ‘ƒ</ci><apply id="S7.p1.5.m5.1.1.3.cmml" xref="S7.p1.5.m5.1.1.3"><times id="S7.p1.5.m5.1.1.3.1.cmml" xref="S7.p1.5.m5.1.1.3.1"></times><ci id="S7.p1.5.m5.1.1.3.2.cmml" xref="S7.p1.5.m5.1.1.3.2">ğ‘œ</ci><ci id="S7.p1.5.m5.1.1.3.3.cmml" xref="S7.p1.5.m5.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.5.m5.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.5.m5.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S7.p1.6.m6.1" class="ltx_Math" alttext="P_{g}" display="inline"><semantics id="S7.p1.6.m6.1a"><msub id="S7.p1.6.m6.1.1" xref="S7.p1.6.m6.1.1.cmml"><mi id="S7.p1.6.m6.1.1.2" xref="S7.p1.6.m6.1.1.2.cmml">P</mi><mi id="S7.p1.6.m6.1.1.3" xref="S7.p1.6.m6.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S7.p1.6.m6.1b"><apply id="S7.p1.6.m6.1.1.cmml" xref="S7.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S7.p1.6.m6.1.1.1.cmml" xref="S7.p1.6.m6.1.1">subscript</csymbol><ci id="S7.p1.6.m6.1.1.2.cmml" xref="S7.p1.6.m6.1.1.2">ğ‘ƒ</ci><ci id="S7.p1.6.m6.1.1.3.cmml" xref="S7.p1.6.m6.1.1.3">ğ‘”</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.6.m6.1c">P_{g}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, while further reducing the memory footprint by <math id="S7.p1.7.m7.1" class="ltx_Math" alttext="N_{d}" display="inline"><semantics id="S7.p1.7.m7.1a"><msub id="S7.p1.7.m7.1.1" xref="S7.p1.7.m7.1.1.cmml"><mi id="S7.p1.7.m7.1.1.2" xref="S7.p1.7.m7.1.1.2.cmml">N</mi><mi id="S7.p1.7.m7.1.1.3" xref="S7.p1.7.m7.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S7.p1.7.m7.1b"><apply id="S7.p1.7.m7.1.1.cmml" xref="S7.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S7.p1.7.m7.1.1.1.cmml" xref="S7.p1.7.m7.1.1">subscript</csymbol><ci id="S7.p1.7.m7.1.1.2.cmml" xref="S7.p1.7.m7.1.1.2">ğ‘</ci><ci id="S7.p1.7.m7.1.1.3.cmml" xref="S7.p1.7.m7.1.1.3">ğ‘‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.7.m7.1c">N_{d}</annotation><annotation encoding="application/x-llamapun" id="S7.p1.7.m7.1d">italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> times.
We present the analysis in this section.
We begin by first presenting a brief overview of the communication volume for standard DP.</p>
</div>
<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Data Parallel Communication Volume</h3>

<div id="S7.SS1.p1" class="ltx_para">
<p id="S7.SS1.p1.1" class="ltx_p">During data parallel training, gradients across all data parallel processes are averaged at the end of the backward propagation before computing the updates for the next step. The averaging is performed using an all-reduce communication collective. For a large model size, the all-reduce communication is entirely communication bandwidth bound, and therefore, we limit our analysis to the total communication volume send to and from each data parallel process.</p>
</div>
<div id="S7.SS1.p2" class="ltx_para">
<p id="S7.SS1.p2.3" class="ltx_p">State-of-art implementation of all-reduce uses a two-step approach, where the first step is a reduce-scatter operation, which reduces different part of the data on different process. The next step is an all-gather operation where each process gathers the reduced data on all the process. The result of these two steps is an all-reduce.
Both reduce-scatter and all-gather are implemented using a pipelined approach, that results in a total data movement of <math id="S7.SS1.p2.1.m1.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S7.SS1.p2.1.m1.1a"><mi mathvariant="normal" id="S7.SS1.p2.1.m1.1.1" xref="S7.SS1.p2.1.m1.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.1.m1.1b"><ci id="S7.SS1.p2.1.m1.1.1.cmml" xref="S7.SS1.p2.1.m1.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.1.m1.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.1.m1.1d">roman_Î¨</annotation></semantics></math> elements (for a data with <math id="S7.SS1.p2.2.m2.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S7.SS1.p2.2.m2.1a"><mi mathvariant="normal" id="S7.SS1.p2.2.m2.1.1" xref="S7.SS1.p2.2.m2.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.2.m2.1b"><ci id="S7.SS1.p2.2.m2.1.1.cmml" xref="S7.SS1.p2.2.m2.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.2.m2.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.2.m2.1d">roman_Î¨</annotation></semantics></math> elements) for each. Therefore, the standard DP incurs 2<math id="S7.SS1.p2.3.m3.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S7.SS1.p2.3.m3.1a"><mi mathvariant="normal" id="S7.SS1.p2.3.m3.1.1" xref="S7.SS1.p2.3.m3.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S7.SS1.p2.3.m3.1b"><ci id="S7.SS1.p2.3.m3.1.1.cmml" xref="S7.SS1.p2.3.m3.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS1.p2.3.m3.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS1.p2.3.m3.1d">roman_Î¨</annotation></semantics></math> data movement during each training step.
</p>
</div>
<figure id="S7.T2" class="ltx_table">
<table id="S7.T2.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S7.T2.4.5.1" class="ltx_tr">
<td id="S7.T2.4.5.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_t" rowspan="2"><span id="S7.T2.4.5.1.1.1" class="ltx_text">MP</span></td>
<td id="S7.T2.4.5.1.2" class="ltx_td ltx_align_center ltx_border_l ltx_border_t" rowspan="2">
<span id="S7.T2.4.5.1.2.1" class="ltx_text">GPUs</span></td>
<td id="S7.T2.4.5.1.3" class="ltx_td ltx_align_center ltx_border_ll ltx_border_r ltx_border_t" colspan="4"><span id="S7.T2.4.5.1.3.1" class="ltx_text ltx_font_bold">Max Theoretical Model Size</span></td>
<td id="S7.T2.4.5.1.4" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="2"><span id="S7.T2.4.5.1.4.1" class="ltx_text ltx_font_bold">Measured Model Size</span></td>
</tr>
<tr id="S7.T2.4.4" class="ltx_tr">
<td id="S7.T2.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Baseline</td>
<td id="S7.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">P<math id="S7.T2.1.1.1.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S7.T2.1.1.1.m1.1a"><msub id="S7.T2.1.1.1.m1.1.1" xref="S7.T2.1.1.1.m1.1.1.cmml"><mi id="S7.T2.1.1.1.m1.1.1a" xref="S7.T2.1.1.1.m1.1.1.cmml"></mi><mrow id="S7.T2.1.1.1.m1.1.1.1" xref="S7.T2.1.1.1.m1.1.1.1.cmml"><mi id="S7.T2.1.1.1.m1.1.1.1.2" xref="S7.T2.1.1.1.m1.1.1.1.2.cmml">o</mi><mo id="S7.T2.1.1.1.m1.1.1.1.1" xref="S7.T2.1.1.1.m1.1.1.1.1.cmml">â¢</mo><mi id="S7.T2.1.1.1.m1.1.1.1.3" xref="S7.T2.1.1.1.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T2.1.1.1.m1.1b"><apply id="S7.T2.1.1.1.m1.1.1.cmml" xref="S7.T2.1.1.1.m1.1.1"><apply id="S7.T2.1.1.1.m1.1.1.1.cmml" xref="S7.T2.1.1.1.m1.1.1.1"><times id="S7.T2.1.1.1.m1.1.1.1.1.cmml" xref="S7.T2.1.1.1.m1.1.1.1.1"></times><ci id="S7.T2.1.1.1.m1.1.1.1.2.cmml" xref="S7.T2.1.1.1.m1.1.1.1.2">ğ‘œ</ci><ci id="S7.T2.1.1.1.m1.1.1.1.3.cmml" xref="S7.T2.1.1.1.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T2.1.1.1.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S7.T2.1.1.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S7.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">P<math id="S7.T2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S7.T2.2.2.2.m1.1a"><msub id="S7.T2.2.2.2.m1.1.1" xref="S7.T2.2.2.2.m1.1.1.cmml"><mi id="S7.T2.2.2.2.m1.1.1a" xref="S7.T2.2.2.2.m1.1.1.cmml"></mi><mrow id="S7.T2.2.2.2.m1.1.1.1" xref="S7.T2.2.2.2.m1.1.1.1.cmml"><mrow id="S7.T2.2.2.2.m1.1.1.1.2" xref="S7.T2.2.2.2.m1.1.1.1.2.cmml"><mi id="S7.T2.2.2.2.m1.1.1.1.2.2" xref="S7.T2.2.2.2.m1.1.1.1.2.2.cmml">o</mi><mo id="S7.T2.2.2.2.m1.1.1.1.2.1" xref="S7.T2.2.2.2.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S7.T2.2.2.2.m1.1.1.1.2.3" xref="S7.T2.2.2.2.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S7.T2.2.2.2.m1.1.1.1.1" xref="S7.T2.2.2.2.m1.1.1.1.1.cmml">+</mo><mi id="S7.T2.2.2.2.m1.1.1.1.3" xref="S7.T2.2.2.2.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T2.2.2.2.m1.1b"><apply id="S7.T2.2.2.2.m1.1.1.cmml" xref="S7.T2.2.2.2.m1.1.1"><apply id="S7.T2.2.2.2.m1.1.1.1.cmml" xref="S7.T2.2.2.2.m1.1.1.1"><plus id="S7.T2.2.2.2.m1.1.1.1.1.cmml" xref="S7.T2.2.2.2.m1.1.1.1.1"></plus><apply id="S7.T2.2.2.2.m1.1.1.1.2.cmml" xref="S7.T2.2.2.2.m1.1.1.1.2"><times id="S7.T2.2.2.2.m1.1.1.1.2.1.cmml" xref="S7.T2.2.2.2.m1.1.1.1.2.1"></times><ci id="S7.T2.2.2.2.m1.1.1.1.2.2.cmml" xref="S7.T2.2.2.2.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S7.T2.2.2.2.m1.1.1.1.2.3.cmml" xref="S7.T2.2.2.2.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S7.T2.2.2.2.m1.1.1.1.3.cmml" xref="S7.T2.2.2.2.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T2.2.2.2.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S7.T2.2.2.2.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S7.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">P<math id="S7.T2.3.3.3.m1.1" class="ltx_Math" alttext="{}_{os+g+p}" display="inline"><semantics id="S7.T2.3.3.3.m1.1a"><msub id="S7.T2.3.3.3.m1.1.1" xref="S7.T2.3.3.3.m1.1.1.cmml"><mi id="S7.T2.3.3.3.m1.1.1a" xref="S7.T2.3.3.3.m1.1.1.cmml"></mi><mrow id="S7.T2.3.3.3.m1.1.1.1" xref="S7.T2.3.3.3.m1.1.1.1.cmml"><mrow id="S7.T2.3.3.3.m1.1.1.1.2" xref="S7.T2.3.3.3.m1.1.1.1.2.cmml"><mi id="S7.T2.3.3.3.m1.1.1.1.2.2" xref="S7.T2.3.3.3.m1.1.1.1.2.2.cmml">o</mi><mo id="S7.T2.3.3.3.m1.1.1.1.2.1" xref="S7.T2.3.3.3.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S7.T2.3.3.3.m1.1.1.1.2.3" xref="S7.T2.3.3.3.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S7.T2.3.3.3.m1.1.1.1.1" xref="S7.T2.3.3.3.m1.1.1.1.1.cmml">+</mo><mi id="S7.T2.3.3.3.m1.1.1.1.3" xref="S7.T2.3.3.3.m1.1.1.1.3.cmml">g</mi><mo id="S7.T2.3.3.3.m1.1.1.1.1a" xref="S7.T2.3.3.3.m1.1.1.1.1.cmml">+</mo><mi id="S7.T2.3.3.3.m1.1.1.1.4" xref="S7.T2.3.3.3.m1.1.1.1.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T2.3.3.3.m1.1b"><apply id="S7.T2.3.3.3.m1.1.1.cmml" xref="S7.T2.3.3.3.m1.1.1"><apply id="S7.T2.3.3.3.m1.1.1.1.cmml" xref="S7.T2.3.3.3.m1.1.1.1"><plus id="S7.T2.3.3.3.m1.1.1.1.1.cmml" xref="S7.T2.3.3.3.m1.1.1.1.1"></plus><apply id="S7.T2.3.3.3.m1.1.1.1.2.cmml" xref="S7.T2.3.3.3.m1.1.1.1.2"><times id="S7.T2.3.3.3.m1.1.1.1.2.1.cmml" xref="S7.T2.3.3.3.m1.1.1.1.2.1"></times><ci id="S7.T2.3.3.3.m1.1.1.1.2.2.cmml" xref="S7.T2.3.3.3.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S7.T2.3.3.3.m1.1.1.1.2.3.cmml" xref="S7.T2.3.3.3.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S7.T2.3.3.3.m1.1.1.1.3.cmml" xref="S7.T2.3.3.3.m1.1.1.1.3">ğ‘”</ci><ci id="S7.T2.3.3.3.m1.1.1.1.4.cmml" xref="S7.T2.3.3.3.m1.1.1.1.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T2.3.3.3.m1.1c">{}_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S7.T2.3.3.3.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g + italic_p end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S7.T2.4.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Baseline</td>
<td id="S7.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<em id="S7.T2.4.4.4.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP (P<math id="S7.T2.4.4.4.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S7.T2.4.4.4.m1.1a"><msub id="S7.T2.4.4.4.m1.1.1" xref="S7.T2.4.4.4.m1.1.1.cmml"><mi id="S7.T2.4.4.4.m1.1.1a" xref="S7.T2.4.4.4.m1.1.1.cmml"></mi><mrow id="S7.T2.4.4.4.m1.1.1.1" xref="S7.T2.4.4.4.m1.1.1.1.cmml"><mi id="S7.T2.4.4.4.m1.1.1.1.2" xref="S7.T2.4.4.4.m1.1.1.1.2.cmml">o</mi><mo id="S7.T2.4.4.4.m1.1.1.1.1" xref="S7.T2.4.4.4.m1.1.1.1.1.cmml">â¢</mo><mi id="S7.T2.4.4.4.m1.1.1.1.3" xref="S7.T2.4.4.4.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T2.4.4.4.m1.1b"><apply id="S7.T2.4.4.4.m1.1.1.cmml" xref="S7.T2.4.4.4.m1.1.1"><apply id="S7.T2.4.4.4.m1.1.1.1.cmml" xref="S7.T2.4.4.4.m1.1.1.1"><times id="S7.T2.4.4.4.m1.1.1.1.1.cmml" xref="S7.T2.4.4.4.m1.1.1.1.1"></times><ci id="S7.T2.4.4.4.m1.1.1.1.2.cmml" xref="S7.T2.4.4.4.m1.1.1.1.2">ğ‘œ</ci><ci id="S7.T2.4.4.4.m1.1.1.1.3.cmml" xref="S7.T2.4.4.4.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T2.4.4.4.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S7.T2.4.4.4.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>)</td>
</tr>
<tr id="S7.T2.4.6.2" class="ltx_tr">
<td id="S7.T2.4.6.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">1</td>
<td id="S7.T2.4.6.2.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">64</td>
<td id="S7.T2.4.6.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2B</td>
<td id="S7.T2.4.6.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.6.2.4.1" class="ltx_text ltx_font_bold">7.6B</span></td>
<td id="S7.T2.4.6.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">14.4B</td>
<td id="S7.T2.4.6.2.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">128B</td>
<td id="S7.T2.4.6.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.3B</td>
<td id="S7.T2.4.6.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.6.2.8.1" class="ltx_text ltx_font_bold">6.2B</span></td>
</tr>
<tr id="S7.T2.4.7.3" class="ltx_tr">
<td id="S7.T2.4.7.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">2</td>
<td id="S7.T2.4.7.3.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">128</td>
<td id="S7.T2.4.7.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4B</td>
<td id="S7.T2.4.7.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.7.3.4.1" class="ltx_text ltx_font_bold">15.2B</span></td>
<td id="S7.T2.4.7.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">28.8B</td>
<td id="S7.T2.4.7.3.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">256B</td>
<td id="S7.T2.4.7.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.5B</td>
<td id="S7.T2.4.7.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.7.3.8.1" class="ltx_text ltx_font_bold">12.5B</span></td>
</tr>
<tr id="S7.T2.4.8.4" class="ltx_tr">
<td id="S7.T2.4.8.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">4</td>
<td id="S7.T2.4.8.4.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">256</td>
<td id="S7.T2.4.8.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8B</td>
<td id="S7.T2.4.8.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.8.4.4.1" class="ltx_text ltx_font_bold">30.4B</span></td>
<td id="S7.T2.4.8.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.6B</td>
<td id="S7.T2.4.8.4.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">0.5T</td>
<td id="S7.T2.4.8.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5B</td>
<td id="S7.T2.4.8.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.8.4.8.1" class="ltx_text ltx_font_bold">25B</span></td>
</tr>
<tr id="S7.T2.4.9.5" class="ltx_tr">
<td id="S7.T2.4.9.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">8</td>
<td id="S7.T2.4.9.5.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">512</td>
<td id="S7.T2.4.9.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16B</td>
<td id="S7.T2.4.9.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.9.5.4.1" class="ltx_text ltx_font_bold">60.8B</span></td>
<td id="S7.T2.4.9.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">115.2B</td>
<td id="S7.T2.4.9.5.6" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">1T</td>
<td id="S7.T2.4.9.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.9.5.7.1" class="ltx_text ltx_font_italic">10B</span></td>
<td id="S7.T2.4.9.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S7.T2.4.9.5.8.1" class="ltx_text ltx_font_bold">50B</span></td>
</tr>
<tr id="S7.T2.4.10.6" class="ltx_tr">
<td id="S7.T2.4.10.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">16</td>
<td id="S7.T2.4.10.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr ltx_border_t">1024</td>
<td id="S7.T2.4.10.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">32B</td>
<td id="S7.T2.4.10.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S7.T2.4.10.6.4.1" class="ltx_text ltx_font_bold">121.6B</span></td>
<td id="S7.T2.4.10.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">230.4B</td>
<td id="S7.T2.4.10.6.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr ltx_border_t"><span id="S7.T2.4.10.6.6.1" class="ltx_text ltx_font_italic">2T</span></td>
<td id="S7.T2.4.10.6.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">20B</td>
<td id="S7.T2.4.10.6.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S7.T2.4.10.6.8.1" class="ltx_text ltx_font_bold">100B</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S7.T2.9.2.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S7.T2.6.1" class="ltx_text" style="font-size:90%;">Maximum model size through memory analysis (left) and the measured model size when running with <em id="S7.T2.6.1.1" class="ltx_emph ltx_font_italic">ZeRO-OS</em> (right). The measured model size with <math id="S7.T2.6.1.m1.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S7.T2.6.1.m1.1b"><msub id="S7.T2.6.1.m1.1.1" xref="S7.T2.6.1.m1.1.1.cmml"><mi id="S7.T2.6.1.m1.1.1.2" xref="S7.T2.6.1.m1.1.1.2.cmml">P</mi><mrow id="S7.T2.6.1.m1.1.1.3" xref="S7.T2.6.1.m1.1.1.3.cmml"><mi id="S7.T2.6.1.m1.1.1.3.2" xref="S7.T2.6.1.m1.1.1.3.2.cmml">o</mi><mo id="S7.T2.6.1.m1.1.1.3.1" xref="S7.T2.6.1.m1.1.1.3.1.cmml">â¢</mo><mi id="S7.T2.6.1.m1.1.1.3.3" xref="S7.T2.6.1.m1.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.T2.6.1.m1.1c"><apply id="S7.T2.6.1.m1.1.1.cmml" xref="S7.T2.6.1.m1.1.1"><csymbol cd="ambiguous" id="S7.T2.6.1.m1.1.1.1.cmml" xref="S7.T2.6.1.m1.1.1">subscript</csymbol><ci id="S7.T2.6.1.m1.1.1.2.cmml" xref="S7.T2.6.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S7.T2.6.1.m1.1.1.3.cmml" xref="S7.T2.6.1.m1.1.1.3"><times id="S7.T2.6.1.m1.1.1.3.1.cmml" xref="S7.T2.6.1.m1.1.1.3.1"></times><ci id="S7.T2.6.1.m1.1.1.3.2.cmml" xref="S7.T2.6.1.m1.1.1.3.2">ğ‘œ</ci><ci id="S7.T2.6.1.m1.1.1.3.3.cmml" xref="S7.T2.6.1.m1.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T2.6.1.m1.1d">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S7.T2.6.1.m1.1e">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> matches the theoretical maximum, demonstrating that our memory analysis provides realistic upper bounds on model sizes.</span></figcaption>
</figure>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span><em id="S7.SS2.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP Communication Volume</h3>

<section id="S7.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.1 </span>Communication Volume with <math id="S7.SS2.SSS1.1.m1.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S7.SS2.SSS1.1.m1.1b"><msub id="S7.SS2.SSS1.1.m1.1.1" xref="S7.SS2.SSS1.1.m1.1.1.cmml"><mi id="S7.SS2.SSS1.1.m1.1.1.2" xref="S7.SS2.SSS1.1.m1.1.1.2.cmml">P</mi><mrow id="S7.SS2.SSS1.1.m1.1.1.3" xref="S7.SS2.SSS1.1.m1.1.1.3.cmml"><mrow id="S7.SS2.SSS1.1.m1.1.1.3.2" xref="S7.SS2.SSS1.1.m1.1.1.3.2.cmml"><mi id="S7.SS2.SSS1.1.m1.1.1.3.2.2" xref="S7.SS2.SSS1.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S7.SS2.SSS1.1.m1.1.1.3.2.1" xref="S7.SS2.SSS1.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S7.SS2.SSS1.1.m1.1.1.3.2.3" xref="S7.SS2.SSS1.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S7.SS2.SSS1.1.m1.1.1.3.1" xref="S7.SS2.SSS1.1.m1.1.1.3.1.cmml">+</mo><mi id="S7.SS2.SSS1.1.m1.1.1.3.3" xref="S7.SS2.SSS1.1.m1.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.1.m1.1c"><apply id="S7.SS2.SSS1.1.m1.1.1.cmml" xref="S7.SS2.SSS1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS2.SSS1.1.m1.1.1.1.cmml" xref="S7.SS2.SSS1.1.m1.1.1">subscript</csymbol><ci id="S7.SS2.SSS1.1.m1.1.1.2.cmml" xref="S7.SS2.SSS1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S7.SS2.SSS1.1.m1.1.1.3.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3"><plus id="S7.SS2.SSS1.1.m1.1.1.3.1.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3.1"></plus><apply id="S7.SS2.SSS1.1.m1.1.1.3.2.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3.2"><times id="S7.SS2.SSS1.1.m1.1.1.3.2.1.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3.2.1"></times><ci id="S7.SS2.SSS1.1.m1.1.1.3.2.2.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S7.SS2.SSS1.1.m1.1.1.3.2.3.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S7.SS2.SSS1.1.m1.1.1.3.3.cmml" xref="S7.SS2.SSS1.1.m1.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.1.m1.1d">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.1.m1.1e">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math>
</h4>

<div id="S7.SS2.SSS1.p1" class="ltx_para">
<p id="S7.SS2.SSS1.p1.3" class="ltx_p">With gradient partitioning, each process only stores the portion of the gradients, that is required to update its corresponding parameter partition. As such, instead of an all-reduce, <em id="S7.SS2.SSS1.p1.3.1" class="ltx_emph ltx_font_italic">ZeRO</em> only requires a scatter-reduce operation on the gradients, incurring communication volume of <math id="S7.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S7.SS2.SSS1.p1.1.m1.1a"><mi mathvariant="normal" id="S7.SS2.SSS1.p1.1.m1.1.1" xref="S7.SS2.SSS1.p1.1.m1.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p1.1.m1.1b"><ci id="S7.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S7.SS2.SSS1.p1.1.m1.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p1.1.m1.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p1.1.m1.1d">roman_Î¨</annotation></semantics></math>. After each process updates the partition of the parameters that it is responsible for, an all-gather is performed to collect all the updated parameters from all the data parallel process. This also incurs a communication volume of <math id="S7.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S7.SS2.SSS1.p1.2.m2.1a"><mi mathvariant="normal" id="S7.SS2.SSS1.p1.2.m2.1.1" xref="S7.SS2.SSS1.p1.2.m2.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p1.2.m2.1b"><ci id="S7.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S7.SS2.SSS1.p1.2.m2.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p1.2.m2.1c">\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p1.2.m2.1d">roman_Î¨</annotation></semantics></math>. So the total communication volume per training step is <math id="S7.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\Psi+\Psi=2\Psi" display="inline"><semantics id="S7.SS2.SSS1.p1.3.m3.1a"><mrow id="S7.SS2.SSS1.p1.3.m3.1.1" xref="S7.SS2.SSS1.p1.3.m3.1.1.cmml"><mrow id="S7.SS2.SSS1.p1.3.m3.1.1.2" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="S7.SS2.SSS1.p1.3.m3.1.1.2.2" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.2.cmml">Î¨</mi><mo id="S7.SS2.SSS1.p1.3.m3.1.1.2.1" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.1.cmml">+</mo><mi mathvariant="normal" id="S7.SS2.SSS1.p1.3.m3.1.1.2.3" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.3.cmml">Î¨</mi></mrow><mo id="S7.SS2.SSS1.p1.3.m3.1.1.1" xref="S7.SS2.SSS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S7.SS2.SSS1.p1.3.m3.1.1.3" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.cmml"><mn id="S7.SS2.SSS1.p1.3.m3.1.1.3.2" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.2.cmml">2</mn><mo id="S7.SS2.SSS1.p1.3.m3.1.1.3.1" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.1.cmml">â¢</mo><mi mathvariant="normal" id="S7.SS2.SSS1.p1.3.m3.1.1.3.3" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.3.cmml">Î¨</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS1.p1.3.m3.1b"><apply id="S7.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1"><eq id="S7.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.1"></eq><apply id="S7.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.2"><plus id="S7.SS2.SSS1.p1.3.m3.1.1.2.1.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.1"></plus><ci id="S7.SS2.SSS1.p1.3.m3.1.1.2.2.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.2">Î¨</ci><ci id="S7.SS2.SSS1.p1.3.m3.1.1.2.3.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.2.3">Î¨</ci></apply><apply id="S7.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.3"><times id="S7.SS2.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.1"></times><cn type="integer" id="S7.SS2.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.2">2</cn><ci id="S7.SS2.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S7.SS2.SSS1.p1.3.m3.1.1.3.3">Î¨</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS1.p1.3.m3.1c">\Psi+\Psi=2\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS1.p1.3.m3.1d">roman_Î¨ + roman_Î¨ = 2 roman_Î¨</annotation></semantics></math>, exactly the same as the baseline DP.</p>
</div>
</section>
<section id="S7.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.2.2 </span>Communication Volume with <math id="S7.SS2.SSS2.1.m1.1" class="ltx_Math" alttext="P_{os+g+p}" display="inline"><semantics id="S7.SS2.SSS2.1.m1.1b"><msub id="S7.SS2.SSS2.1.m1.1.1" xref="S7.SS2.SSS2.1.m1.1.1.cmml"><mi id="S7.SS2.SSS2.1.m1.1.1.2" xref="S7.SS2.SSS2.1.m1.1.1.2.cmml">P</mi><mrow id="S7.SS2.SSS2.1.m1.1.1.3" xref="S7.SS2.SSS2.1.m1.1.1.3.cmml"><mrow id="S7.SS2.SSS2.1.m1.1.1.3.2" xref="S7.SS2.SSS2.1.m1.1.1.3.2.cmml"><mi id="S7.SS2.SSS2.1.m1.1.1.3.2.2" xref="S7.SS2.SSS2.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S7.SS2.SSS2.1.m1.1.1.3.2.1" xref="S7.SS2.SSS2.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S7.SS2.SSS2.1.m1.1.1.3.2.3" xref="S7.SS2.SSS2.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S7.SS2.SSS2.1.m1.1.1.3.1" xref="S7.SS2.SSS2.1.m1.1.1.3.1.cmml">+</mo><mi id="S7.SS2.SSS2.1.m1.1.1.3.3" xref="S7.SS2.SSS2.1.m1.1.1.3.3.cmml">g</mi><mo id="S7.SS2.SSS2.1.m1.1.1.3.1b" xref="S7.SS2.SSS2.1.m1.1.1.3.1.cmml">+</mo><mi id="S7.SS2.SSS2.1.m1.1.1.3.4" xref="S7.SS2.SSS2.1.m1.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.1.m1.1c"><apply id="S7.SS2.SSS2.1.m1.1.1.cmml" xref="S7.SS2.SSS2.1.m1.1.1"><csymbol cd="ambiguous" id="S7.SS2.SSS2.1.m1.1.1.1.cmml" xref="S7.SS2.SSS2.1.m1.1.1">subscript</csymbol><ci id="S7.SS2.SSS2.1.m1.1.1.2.cmml" xref="S7.SS2.SSS2.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S7.SS2.SSS2.1.m1.1.1.3.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3"><plus id="S7.SS2.SSS2.1.m1.1.1.3.1.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.1"></plus><apply id="S7.SS2.SSS2.1.m1.1.1.3.2.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.2"><times id="S7.SS2.SSS2.1.m1.1.1.3.2.1.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.2.1"></times><ci id="S7.SS2.SSS2.1.m1.1.1.3.2.2.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S7.SS2.SSS2.1.m1.1.1.3.2.3.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S7.SS2.SSS2.1.m1.1.1.3.3.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.3">ğ‘”</ci><ci id="S7.SS2.SSS2.1.m1.1.1.3.4.cmml" xref="S7.SS2.SSS2.1.m1.1.1.3.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.1.m1.1d">P_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.1.m1.1e">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g + italic_p end_POSTSUBSCRIPT</annotation></semantics></math> </h4>

<div id="S7.SS2.SSS2.p1" class="ltx_para">
<p id="S7.SS2.SSS2.p1.1" class="ltx_p">After parameter partitioning, each data parallel process only stores the parameters that it updates. Therefore, during the forward propagation it needs to receives the parameters for all the other partitions. However, this can be pipelined to avoid the memory overhead. Before computing the forward propagation on the part of the model corresponding to a particular partition, the data parallel process responsible for that partition can broadcast the weights to all the data parallel processes. Once the forward propagation for that partition is done, the parameters can be discarded. The total communication volume is thus <math id="S7.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\frac{\Psi\times N_{d}}{N_{d}}=\Psi" display="inline"><semantics id="S7.SS2.SSS2.p1.1.m1.1a"><mrow id="S7.SS2.SSS2.p1.1.m1.1.1" xref="S7.SS2.SSS2.p1.1.m1.1.1.cmml"><mfrac id="S7.SS2.SSS2.p1.1.m1.1.1.2" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.cmml"><mrow id="S7.SS2.SSS2.p1.1.m1.1.1.2.2" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.cmml"><mi mathvariant="normal" id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.2" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.2.cmml">Î¨</mi><mo lspace="0.222em" rspace="0.222em" id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.1" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.1.cmml">Ã—</mo><msub id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.cmml"><mi id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.2" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.2.cmml">N</mi><mi id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.3" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.3.cmml">d</mi></msub></mrow><msub id="S7.SS2.SSS2.p1.1.m1.1.1.2.3" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3.cmml"><mi id="S7.SS2.SSS2.p1.1.m1.1.1.2.3.2" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3.2.cmml">N</mi><mi id="S7.SS2.SSS2.p1.1.m1.1.1.2.3.3" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3.3.cmml">d</mi></msub></mfrac><mo id="S7.SS2.SSS2.p1.1.m1.1.1.1" xref="S7.SS2.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S7.SS2.SSS2.p1.1.m1.1.1.3" xref="S7.SS2.SSS2.p1.1.m1.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p1.1.m1.1b"><apply id="S7.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1"><eq id="S7.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.1"></eq><apply id="S7.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2"><divide id="S7.SS2.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2"></divide><apply id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2"><times id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.1"></times><ci id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.2.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.2">Î¨</ci><apply id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3">subscript</csymbol><ci id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.2.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.2">ğ‘</ci><ci id="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.3.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.2.3.3">ğ‘‘</ci></apply></apply><apply id="S7.SS2.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S7.SS2.SSS2.p1.1.m1.1.1.2.3.1.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3">subscript</csymbol><ci id="S7.SS2.SSS2.p1.1.m1.1.1.2.3.2.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3.2">ğ‘</ci><ci id="S7.SS2.SSS2.p1.1.m1.1.1.2.3.3.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.2.3.3">ğ‘‘</ci></apply></apply><ci id="S7.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S7.SS2.SSS2.p1.1.m1.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p1.1.m1.1c">\frac{\Psi\times N_{d}}{N_{d}}=\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p1.1.m1.1d">divide start_ARG roman_Î¨ Ã— italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_ARG = roman_Î¨</annotation></semantics></math>. In other words, we reschedule the parameter all-gather by spreading it across the entire forward propagation, and discarding the parameters once they have been used. Note however that this all-gather needs to happen once again for the backward propagation in the reverse order.</p>
</div>
<div id="S7.SS2.SSS2.p2" class="ltx_para">
<p id="S7.SS2.SSS2.p2.1" class="ltx_p">The total communication volume is therefore the sum of the communication volumes incurred by these all-gathers in addition to the communication volume incurred by the reduce-scatter of the gradients. The total volume is therefore <math id="S7.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="3\Psi" display="inline"><semantics id="S7.SS2.SSS2.p2.1.m1.1a"><mrow id="S7.SS2.SSS2.p2.1.m1.1.1" xref="S7.SS2.SSS2.p2.1.m1.1.1.cmml"><mn id="S7.SS2.SSS2.p2.1.m1.1.1.2" xref="S7.SS2.SSS2.p2.1.m1.1.1.2.cmml">3</mn><mo id="S7.SS2.SSS2.p2.1.m1.1.1.1" xref="S7.SS2.SSS2.p2.1.m1.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S7.SS2.SSS2.p2.1.m1.1.1.3" xref="S7.SS2.SSS2.p2.1.m1.1.1.3.cmml">Î¨</mi></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.SSS2.p2.1.m1.1b"><apply id="S7.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1"><times id="S7.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.1"></times><cn type="integer" id="S7.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.2">3</cn><ci id="S7.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S7.SS2.SSS2.p2.1.m1.1.1.3">Î¨</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.SSS2.p2.1.m1.1c">3\Psi</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.SSS2.p2.1.m1.1d">3 roman_Î¨</annotation></semantics></math> which is 1.5x compared to the baseline. Both gradient and parameter partitioning leverage the insight that â€” not all states of gradients and parameters are needed all the time â€” to optimize memory by communicating the states judiciously.</p>
</div>
</section>
</section>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Communication Analysis of <em id="S8.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.6" class="ltx_p">We compare the communication volume of partitioned activation checkpointing (<math id="S8.p1.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p1.1.m1.1a"><msub id="S8.p1.1.m1.1.1" xref="S8.p1.1.m1.1.1.cmml"><mi id="S8.p1.1.m1.1.1.2" xref="S8.p1.1.m1.1.1.2.cmml">P</mi><mi id="S8.p1.1.m1.1.1.3" xref="S8.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p1.1.m1.1b"><apply id="S8.p1.1.m1.1.1.cmml" xref="S8.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S8.p1.1.m1.1.1.1.cmml" xref="S8.p1.1.m1.1.1">subscript</csymbol><ci id="S8.p1.1.m1.1.1.2.cmml" xref="S8.p1.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S8.p1.1.m1.1.1.3.cmml" xref="S8.p1.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.1.m1.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>) in <em id="S8.p1.6.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R with baseline MP, and show that <math id="S8.p1.2.m2.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p1.2.m2.1a"><msub id="S8.p1.2.m2.1.1" xref="S8.p1.2.m2.1.1.cmml"><mi id="S8.p1.2.m2.1.1.2" xref="S8.p1.2.m2.1.1.2.cmml">P</mi><mi id="S8.p1.2.m2.1.1.3" xref="S8.p1.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p1.2.m2.1b"><apply id="S8.p1.2.m2.1.1.cmml" xref="S8.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S8.p1.2.m2.1.1.1.cmml" xref="S8.p1.2.m2.1.1">subscript</csymbol><ci id="S8.p1.2.m2.1.1.2.cmml" xref="S8.p1.2.m2.1.1.2">ğ‘ƒ</ci><ci id="S8.p1.2.m2.1.1.3.cmml" xref="S8.p1.2.m2.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.2.m2.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> incurs a communication volume increase that is in general less than one tenth of the baseline MP. Furthermore, we analyze the communication overhead of <math id="S8.p1.3.m3.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p1.3.m3.1a"><msub id="S8.p1.3.m3.1.1" xref="S8.p1.3.m3.1.1.cmml"><mi id="S8.p1.3.m3.1.1.2" xref="S8.p1.3.m3.1.1.2.cmml">P</mi><mi id="S8.p1.3.m3.1.1.3" xref="S8.p1.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p1.3.m3.1b"><apply id="S8.p1.3.m3.1.1.cmml" xref="S8.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S8.p1.3.m3.1.1.1.cmml" xref="S8.p1.3.m3.1.1">subscript</csymbol><ci id="S8.p1.3.m3.1.1.2.cmml" xref="S8.p1.3.m3.1.1.2">ğ‘ƒ</ci><ci id="S8.p1.3.m3.1.1.3.cmml" xref="S8.p1.3.m3.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.3.m3.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> in relation to DP communication volume to identify scenarios when <math id="S8.p1.4.m4.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p1.4.m4.1a"><msub id="S8.p1.4.m4.1.1" xref="S8.p1.4.m4.1.1.cmml"><mi id="S8.p1.4.m4.1.1.2" xref="S8.p1.4.m4.1.1.2.cmml">P</mi><mi id="S8.p1.4.m4.1.1.3" xref="S8.p1.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p1.4.m4.1b"><apply id="S8.p1.4.m4.1.1.cmml" xref="S8.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S8.p1.4.m4.1.1.1.cmml" xref="S8.p1.4.m4.1.1">subscript</csymbol><ci id="S8.p1.4.m4.1.1.2.cmml" xref="S8.p1.4.m4.1.1.2">ğ‘ƒ</ci><ci id="S8.p1.4.m4.1.1.3.cmml" xref="S8.p1.4.m4.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.4.m4.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> improves efficiency by allowing for a larger batch size and reducing DP communication. We leverage such analysis to decide if and when to apply <math id="S8.p1.5.m5.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p1.5.m5.1a"><msub id="S8.p1.5.m5.1.1" xref="S8.p1.5.m5.1.1.cmml"><mi id="S8.p1.5.m5.1.1.2" xref="S8.p1.5.m5.1.1.2.cmml">P</mi><mi id="S8.p1.5.m5.1.1.3" xref="S8.p1.5.m5.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p1.5.m5.1b"><apply id="S8.p1.5.m5.1.1.cmml" xref="S8.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S8.p1.5.m5.1.1.1.cmml" xref="S8.p1.5.m5.1.1">subscript</csymbol><ci id="S8.p1.5.m5.1.1.2.cmml" xref="S8.p1.5.m5.1.1.2">ğ‘ƒ</ci><ci id="S8.p1.5.m5.1.1.3.cmml" xref="S8.p1.5.m5.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.5.m5.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.5.m5.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> as well as <math id="S8.p1.6.m6.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S8.p1.6.m6.1a"><msub id="S8.p1.6.m6.1.1" xref="S8.p1.6.m6.1.1.cmml"><mi id="S8.p1.6.m6.1.1.2" xref="S8.p1.6.m6.1.1.2.cmml">P</mi><mrow id="S8.p1.6.m6.1.1.3" xref="S8.p1.6.m6.1.1.3.cmml"><mi id="S8.p1.6.m6.1.1.3.2" xref="S8.p1.6.m6.1.1.3.2.cmml">a</mi><mo id="S8.p1.6.m6.1.1.3.1" xref="S8.p1.6.m6.1.1.3.1.cmml">+</mo><mrow id="S8.p1.6.m6.1.1.3.3" xref="S8.p1.6.m6.1.1.3.3.cmml"><mi id="S8.p1.6.m6.1.1.3.3.2" xref="S8.p1.6.m6.1.1.3.3.2.cmml">c</mi><mo id="S8.p1.6.m6.1.1.3.3.1" xref="S8.p1.6.m6.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p1.6.m6.1.1.3.3.3" xref="S8.p1.6.m6.1.1.3.3.3.cmml">p</mi><mo id="S8.p1.6.m6.1.1.3.3.1a" xref="S8.p1.6.m6.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p1.6.m6.1.1.3.3.4" xref="S8.p1.6.m6.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p1.6.m6.1b"><apply id="S8.p1.6.m6.1.1.cmml" xref="S8.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S8.p1.6.m6.1.1.1.cmml" xref="S8.p1.6.m6.1.1">subscript</csymbol><ci id="S8.p1.6.m6.1.1.2.cmml" xref="S8.p1.6.m6.1.1.2">ğ‘ƒ</ci><apply id="S8.p1.6.m6.1.1.3.cmml" xref="S8.p1.6.m6.1.1.3"><plus id="S8.p1.6.m6.1.1.3.1.cmml" xref="S8.p1.6.m6.1.1.3.1"></plus><ci id="S8.p1.6.m6.1.1.3.2.cmml" xref="S8.p1.6.m6.1.1.3.2">ğ‘</ci><apply id="S8.p1.6.m6.1.1.3.3.cmml" xref="S8.p1.6.m6.1.1.3.3"><times id="S8.p1.6.m6.1.1.3.3.1.cmml" xref="S8.p1.6.m6.1.1.3.3.1"></times><ci id="S8.p1.6.m6.1.1.3.3.2.cmml" xref="S8.p1.6.m6.1.1.3.3.2">ğ‘</ci><ci id="S8.p1.6.m6.1.1.3.3.3.cmml" xref="S8.p1.6.m6.1.1.3.3.3">ğ‘</ci><ci id="S8.p1.6.m6.1.1.3.3.4.cmml" xref="S8.p1.6.m6.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.6.m6.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S8.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S8.p2" class="ltx_para">
<p id="S8.p2.1" class="ltx_p">Communication volume trade-off of partitioning activation checkpoints depends on the model size, checkpointing strategy and the MP strategy. To share concrete insights, we perform the analysis in the context of transformer based models implemented using SOTA MP approach, Megatron-LM.</p>
</div>
<div id="S8.p3" class="ltx_para">
<p id="S8.p3.3" class="ltx_p">In Megatron-LM with activation checkpointing, each transformer block performs two all-reduce operations of size <math id="S8.p3.1.m1.1" class="ltx_Math" alttext="batch\times seq\_length\times hidden\_dim" display="inline"><semantics id="S8.p3.1.m1.1a"><mrow id="S8.p3.1.m1.1.1" xref="S8.p3.1.m1.1.1.cmml"><mrow id="S8.p3.1.m1.1.1.2" xref="S8.p3.1.m1.1.1.2.cmml"><mrow id="S8.p3.1.m1.1.1.2.2" xref="S8.p3.1.m1.1.1.2.2.cmml"><mrow id="S8.p3.1.m1.1.1.2.2.2" xref="S8.p3.1.m1.1.1.2.2.2.cmml"><mrow id="S8.p3.1.m1.1.1.2.2.2.2" xref="S8.p3.1.m1.1.1.2.2.2.2.cmml"><mi id="S8.p3.1.m1.1.1.2.2.2.2.2" xref="S8.p3.1.m1.1.1.2.2.2.2.2.cmml">b</mi><mo id="S8.p3.1.m1.1.1.2.2.2.2.1" xref="S8.p3.1.m1.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.2.2.3" xref="S8.p3.1.m1.1.1.2.2.2.2.3.cmml">a</mi><mo id="S8.p3.1.m1.1.1.2.2.2.2.1a" xref="S8.p3.1.m1.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.2.2.4" xref="S8.p3.1.m1.1.1.2.2.2.2.4.cmml">t</mi><mo id="S8.p3.1.m1.1.1.2.2.2.2.1b" xref="S8.p3.1.m1.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.2.2.5" xref="S8.p3.1.m1.1.1.2.2.2.2.5.cmml">c</mi><mo id="S8.p3.1.m1.1.1.2.2.2.2.1c" xref="S8.p3.1.m1.1.1.2.2.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.2.2.6" xref="S8.p3.1.m1.1.1.2.2.2.2.6.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S8.p3.1.m1.1.1.2.2.2.1" xref="S8.p3.1.m1.1.1.2.2.2.1.cmml">Ã—</mo><mi id="S8.p3.1.m1.1.1.2.2.2.3" xref="S8.p3.1.m1.1.1.2.2.2.3.cmml">s</mi></mrow><mo id="S8.p3.1.m1.1.1.2.2.1" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.3" xref="S8.p3.1.m1.1.1.2.2.3.cmml">e</mi><mo id="S8.p3.1.m1.1.1.2.2.1a" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.4" xref="S8.p3.1.m1.1.1.2.2.4.cmml">q</mi><mo id="S8.p3.1.m1.1.1.2.2.1b" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p3.1.m1.1.1.2.2.5" xref="S8.p3.1.m1.1.1.2.2.5.cmml">_</mi><mo id="S8.p3.1.m1.1.1.2.2.1c" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.6" xref="S8.p3.1.m1.1.1.2.2.6.cmml">l</mi><mo id="S8.p3.1.m1.1.1.2.2.1d" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.7" xref="S8.p3.1.m1.1.1.2.2.7.cmml">e</mi><mo id="S8.p3.1.m1.1.1.2.2.1e" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.8" xref="S8.p3.1.m1.1.1.2.2.8.cmml">n</mi><mo id="S8.p3.1.m1.1.1.2.2.1f" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.9" xref="S8.p3.1.m1.1.1.2.2.9.cmml">g</mi><mo id="S8.p3.1.m1.1.1.2.2.1g" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.10" xref="S8.p3.1.m1.1.1.2.2.10.cmml">t</mi><mo id="S8.p3.1.m1.1.1.2.2.1h" xref="S8.p3.1.m1.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.2.2.11" xref="S8.p3.1.m1.1.1.2.2.11.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S8.p3.1.m1.1.1.2.1" xref="S8.p3.1.m1.1.1.2.1.cmml">Ã—</mo><mi id="S8.p3.1.m1.1.1.2.3" xref="S8.p3.1.m1.1.1.2.3.cmml">h</mi></mrow><mo id="S8.p3.1.m1.1.1.1" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.3" xref="S8.p3.1.m1.1.1.3.cmml">i</mi><mo id="S8.p3.1.m1.1.1.1a" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.4" xref="S8.p3.1.m1.1.1.4.cmml">d</mi><mo id="S8.p3.1.m1.1.1.1b" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.5" xref="S8.p3.1.m1.1.1.5.cmml">d</mi><mo id="S8.p3.1.m1.1.1.1c" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.6" xref="S8.p3.1.m1.1.1.6.cmml">e</mi><mo id="S8.p3.1.m1.1.1.1d" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.7" xref="S8.p3.1.m1.1.1.7.cmml">n</mi><mo id="S8.p3.1.m1.1.1.1e" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p3.1.m1.1.1.8" xref="S8.p3.1.m1.1.1.8.cmml">_</mi><mo id="S8.p3.1.m1.1.1.1f" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.9" xref="S8.p3.1.m1.1.1.9.cmml">d</mi><mo id="S8.p3.1.m1.1.1.1g" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.10" xref="S8.p3.1.m1.1.1.10.cmml">i</mi><mo id="S8.p3.1.m1.1.1.1h" xref="S8.p3.1.m1.1.1.1.cmml">â¢</mo><mi id="S8.p3.1.m1.1.1.11" xref="S8.p3.1.m1.1.1.11.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S8.p3.1.m1.1b"><apply id="S8.p3.1.m1.1.1.cmml" xref="S8.p3.1.m1.1.1"><times id="S8.p3.1.m1.1.1.1.cmml" xref="S8.p3.1.m1.1.1.1"></times><apply id="S8.p3.1.m1.1.1.2.cmml" xref="S8.p3.1.m1.1.1.2"><times id="S8.p3.1.m1.1.1.2.1.cmml" xref="S8.p3.1.m1.1.1.2.1"></times><apply id="S8.p3.1.m1.1.1.2.2.cmml" xref="S8.p3.1.m1.1.1.2.2"><times id="S8.p3.1.m1.1.1.2.2.1.cmml" xref="S8.p3.1.m1.1.1.2.2.1"></times><apply id="S8.p3.1.m1.1.1.2.2.2.cmml" xref="S8.p3.1.m1.1.1.2.2.2"><times id="S8.p3.1.m1.1.1.2.2.2.1.cmml" xref="S8.p3.1.m1.1.1.2.2.2.1"></times><apply id="S8.p3.1.m1.1.1.2.2.2.2.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2"><times id="S8.p3.1.m1.1.1.2.2.2.2.1.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2.1"></times><ci id="S8.p3.1.m1.1.1.2.2.2.2.2.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2.2">ğ‘</ci><ci id="S8.p3.1.m1.1.1.2.2.2.2.3.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2.3">ğ‘</ci><ci id="S8.p3.1.m1.1.1.2.2.2.2.4.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2.4">ğ‘¡</ci><ci id="S8.p3.1.m1.1.1.2.2.2.2.5.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2.5">ğ‘</ci><ci id="S8.p3.1.m1.1.1.2.2.2.2.6.cmml" xref="S8.p3.1.m1.1.1.2.2.2.2.6">â„</ci></apply><ci id="S8.p3.1.m1.1.1.2.2.2.3.cmml" xref="S8.p3.1.m1.1.1.2.2.2.3">ğ‘ </ci></apply><ci id="S8.p3.1.m1.1.1.2.2.3.cmml" xref="S8.p3.1.m1.1.1.2.2.3">ğ‘’</ci><ci id="S8.p3.1.m1.1.1.2.2.4.cmml" xref="S8.p3.1.m1.1.1.2.2.4">ğ‘</ci><ci id="S8.p3.1.m1.1.1.2.2.5.cmml" xref="S8.p3.1.m1.1.1.2.2.5">_</ci><ci id="S8.p3.1.m1.1.1.2.2.6.cmml" xref="S8.p3.1.m1.1.1.2.2.6">ğ‘™</ci><ci id="S8.p3.1.m1.1.1.2.2.7.cmml" xref="S8.p3.1.m1.1.1.2.2.7">ğ‘’</ci><ci id="S8.p3.1.m1.1.1.2.2.8.cmml" xref="S8.p3.1.m1.1.1.2.2.8">ğ‘›</ci><ci id="S8.p3.1.m1.1.1.2.2.9.cmml" xref="S8.p3.1.m1.1.1.2.2.9">ğ‘”</ci><ci id="S8.p3.1.m1.1.1.2.2.10.cmml" xref="S8.p3.1.m1.1.1.2.2.10">ğ‘¡</ci><ci id="S8.p3.1.m1.1.1.2.2.11.cmml" xref="S8.p3.1.m1.1.1.2.2.11">â„</ci></apply><ci id="S8.p3.1.m1.1.1.2.3.cmml" xref="S8.p3.1.m1.1.1.2.3">â„</ci></apply><ci id="S8.p3.1.m1.1.1.3.cmml" xref="S8.p3.1.m1.1.1.3">ğ‘–</ci><ci id="S8.p3.1.m1.1.1.4.cmml" xref="S8.p3.1.m1.1.1.4">ğ‘‘</ci><ci id="S8.p3.1.m1.1.1.5.cmml" xref="S8.p3.1.m1.1.1.5">ğ‘‘</ci><ci id="S8.p3.1.m1.1.1.6.cmml" xref="S8.p3.1.m1.1.1.6">ğ‘’</ci><ci id="S8.p3.1.m1.1.1.7.cmml" xref="S8.p3.1.m1.1.1.7">ğ‘›</ci><ci id="S8.p3.1.m1.1.1.8.cmml" xref="S8.p3.1.m1.1.1.8">_</ci><ci id="S8.p3.1.m1.1.1.9.cmml" xref="S8.p3.1.m1.1.1.9">ğ‘‘</ci><ci id="S8.p3.1.m1.1.1.10.cmml" xref="S8.p3.1.m1.1.1.10">ğ‘–</ci><ci id="S8.p3.1.m1.1.1.11.cmml" xref="S8.p3.1.m1.1.1.11">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p3.1.m1.1c">batch\times seq\_length\times hidden\_dim</annotation><annotation encoding="application/x-llamapun" id="S8.p3.1.m1.1d">italic_b italic_a italic_t italic_c italic_h Ã— italic_s italic_e italic_q _ italic_l italic_e italic_n italic_g italic_t italic_h Ã— italic_h italic_i italic_d italic_d italic_e italic_n _ italic_d italic_i italic_m</annotation></semantics></math> in the forward propagation, two all-reduce for forward re-computation and two more in the backward propagation. The total communication per block is <math id="S8.p3.2.m2.1" class="ltx_Math" alttext="12\times seq\_length\times hidden\_dim" display="inline"><semantics id="S8.p3.2.m2.1a"><mrow id="S8.p3.2.m2.1.1" xref="S8.p3.2.m2.1.1.cmml"><mrow id="S8.p3.2.m2.1.1.2" xref="S8.p3.2.m2.1.1.2.cmml"><mrow id="S8.p3.2.m2.1.1.2.2" xref="S8.p3.2.m2.1.1.2.2.cmml"><mrow id="S8.p3.2.m2.1.1.2.2.2" xref="S8.p3.2.m2.1.1.2.2.2.cmml"><mn id="S8.p3.2.m2.1.1.2.2.2.2" xref="S8.p3.2.m2.1.1.2.2.2.2.cmml">12</mn><mo lspace="0.222em" rspace="0.222em" id="S8.p3.2.m2.1.1.2.2.2.1" xref="S8.p3.2.m2.1.1.2.2.2.1.cmml">Ã—</mo><mi id="S8.p3.2.m2.1.1.2.2.2.3" xref="S8.p3.2.m2.1.1.2.2.2.3.cmml">s</mi></mrow><mo id="S8.p3.2.m2.1.1.2.2.1" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.3" xref="S8.p3.2.m2.1.1.2.2.3.cmml">e</mi><mo id="S8.p3.2.m2.1.1.2.2.1a" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.4" xref="S8.p3.2.m2.1.1.2.2.4.cmml">q</mi><mo id="S8.p3.2.m2.1.1.2.2.1b" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p3.2.m2.1.1.2.2.5" xref="S8.p3.2.m2.1.1.2.2.5.cmml">_</mi><mo id="S8.p3.2.m2.1.1.2.2.1c" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.6" xref="S8.p3.2.m2.1.1.2.2.6.cmml">l</mi><mo id="S8.p3.2.m2.1.1.2.2.1d" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.7" xref="S8.p3.2.m2.1.1.2.2.7.cmml">e</mi><mo id="S8.p3.2.m2.1.1.2.2.1e" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.8" xref="S8.p3.2.m2.1.1.2.2.8.cmml">n</mi><mo id="S8.p3.2.m2.1.1.2.2.1f" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.9" xref="S8.p3.2.m2.1.1.2.2.9.cmml">g</mi><mo id="S8.p3.2.m2.1.1.2.2.1g" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.10" xref="S8.p3.2.m2.1.1.2.2.10.cmml">t</mi><mo id="S8.p3.2.m2.1.1.2.2.1h" xref="S8.p3.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.2.2.11" xref="S8.p3.2.m2.1.1.2.2.11.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S8.p3.2.m2.1.1.2.1" xref="S8.p3.2.m2.1.1.2.1.cmml">Ã—</mo><mi id="S8.p3.2.m2.1.1.2.3" xref="S8.p3.2.m2.1.1.2.3.cmml">h</mi></mrow><mo id="S8.p3.2.m2.1.1.1" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.3" xref="S8.p3.2.m2.1.1.3.cmml">i</mi><mo id="S8.p3.2.m2.1.1.1a" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.4" xref="S8.p3.2.m2.1.1.4.cmml">d</mi><mo id="S8.p3.2.m2.1.1.1b" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.5" xref="S8.p3.2.m2.1.1.5.cmml">d</mi><mo id="S8.p3.2.m2.1.1.1c" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.6" xref="S8.p3.2.m2.1.1.6.cmml">e</mi><mo id="S8.p3.2.m2.1.1.1d" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.7" xref="S8.p3.2.m2.1.1.7.cmml">n</mi><mo id="S8.p3.2.m2.1.1.1e" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p3.2.m2.1.1.8" xref="S8.p3.2.m2.1.1.8.cmml">_</mi><mo id="S8.p3.2.m2.1.1.1f" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.9" xref="S8.p3.2.m2.1.1.9.cmml">d</mi><mo id="S8.p3.2.m2.1.1.1g" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.10" xref="S8.p3.2.m2.1.1.10.cmml">i</mi><mo id="S8.p3.2.m2.1.1.1h" xref="S8.p3.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p3.2.m2.1.1.11" xref="S8.p3.2.m2.1.1.11.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S8.p3.2.m2.1b"><apply id="S8.p3.2.m2.1.1.cmml" xref="S8.p3.2.m2.1.1"><times id="S8.p3.2.m2.1.1.1.cmml" xref="S8.p3.2.m2.1.1.1"></times><apply id="S8.p3.2.m2.1.1.2.cmml" xref="S8.p3.2.m2.1.1.2"><times id="S8.p3.2.m2.1.1.2.1.cmml" xref="S8.p3.2.m2.1.1.2.1"></times><apply id="S8.p3.2.m2.1.1.2.2.cmml" xref="S8.p3.2.m2.1.1.2.2"><times id="S8.p3.2.m2.1.1.2.2.1.cmml" xref="S8.p3.2.m2.1.1.2.2.1"></times><apply id="S8.p3.2.m2.1.1.2.2.2.cmml" xref="S8.p3.2.m2.1.1.2.2.2"><times id="S8.p3.2.m2.1.1.2.2.2.1.cmml" xref="S8.p3.2.m2.1.1.2.2.2.1"></times><cn type="integer" id="S8.p3.2.m2.1.1.2.2.2.2.cmml" xref="S8.p3.2.m2.1.1.2.2.2.2">12</cn><ci id="S8.p3.2.m2.1.1.2.2.2.3.cmml" xref="S8.p3.2.m2.1.1.2.2.2.3">ğ‘ </ci></apply><ci id="S8.p3.2.m2.1.1.2.2.3.cmml" xref="S8.p3.2.m2.1.1.2.2.3">ğ‘’</ci><ci id="S8.p3.2.m2.1.1.2.2.4.cmml" xref="S8.p3.2.m2.1.1.2.2.4">ğ‘</ci><ci id="S8.p3.2.m2.1.1.2.2.5.cmml" xref="S8.p3.2.m2.1.1.2.2.5">_</ci><ci id="S8.p3.2.m2.1.1.2.2.6.cmml" xref="S8.p3.2.m2.1.1.2.2.6">ğ‘™</ci><ci id="S8.p3.2.m2.1.1.2.2.7.cmml" xref="S8.p3.2.m2.1.1.2.2.7">ğ‘’</ci><ci id="S8.p3.2.m2.1.1.2.2.8.cmml" xref="S8.p3.2.m2.1.1.2.2.8">ğ‘›</ci><ci id="S8.p3.2.m2.1.1.2.2.9.cmml" xref="S8.p3.2.m2.1.1.2.2.9">ğ‘”</ci><ci id="S8.p3.2.m2.1.1.2.2.10.cmml" xref="S8.p3.2.m2.1.1.2.2.10">ğ‘¡</ci><ci id="S8.p3.2.m2.1.1.2.2.11.cmml" xref="S8.p3.2.m2.1.1.2.2.11">â„</ci></apply><ci id="S8.p3.2.m2.1.1.2.3.cmml" xref="S8.p3.2.m2.1.1.2.3">â„</ci></apply><ci id="S8.p3.2.m2.1.1.3.cmml" xref="S8.p3.2.m2.1.1.3">ğ‘–</ci><ci id="S8.p3.2.m2.1.1.4.cmml" xref="S8.p3.2.m2.1.1.4">ğ‘‘</ci><ci id="S8.p3.2.m2.1.1.5.cmml" xref="S8.p3.2.m2.1.1.5">ğ‘‘</ci><ci id="S8.p3.2.m2.1.1.6.cmml" xref="S8.p3.2.m2.1.1.6">ğ‘’</ci><ci id="S8.p3.2.m2.1.1.7.cmml" xref="S8.p3.2.m2.1.1.7">ğ‘›</ci><ci id="S8.p3.2.m2.1.1.8.cmml" xref="S8.p3.2.m2.1.1.8">_</ci><ci id="S8.p3.2.m2.1.1.9.cmml" xref="S8.p3.2.m2.1.1.9">ğ‘‘</ci><ci id="S8.p3.2.m2.1.1.10.cmml" xref="S8.p3.2.m2.1.1.10">ğ‘–</ci><ci id="S8.p3.2.m2.1.1.11.cmml" xref="S8.p3.2.m2.1.1.11">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p3.2.m2.1c">12\times seq\_length\times hidden\_dim</annotation><annotation encoding="application/x-llamapun" id="S8.p3.2.m2.1d">12 Ã— italic_s italic_e italic_q _ italic_l italic_e italic_n italic_g italic_t italic_h Ã— italic_h italic_i italic_d italic_d italic_e italic_n _ italic_d italic_i italic_m</annotation></semantics></math> since communication volume of an all-reduce is <math id="S8.p3.3.m3.1" class="ltx_Math" alttext="2\times message\_size" display="inline"><semantics id="S8.p3.3.m3.1a"><mrow id="S8.p3.3.m3.1.1" xref="S8.p3.3.m3.1.1.cmml"><mrow id="S8.p3.3.m3.1.1.2" xref="S8.p3.3.m3.1.1.2.cmml"><mn id="S8.p3.3.m3.1.1.2.2" xref="S8.p3.3.m3.1.1.2.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="S8.p3.3.m3.1.1.2.1" xref="S8.p3.3.m3.1.1.2.1.cmml">Ã—</mo><mi id="S8.p3.3.m3.1.1.2.3" xref="S8.p3.3.m3.1.1.2.3.cmml">m</mi></mrow><mo id="S8.p3.3.m3.1.1.1" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.3" xref="S8.p3.3.m3.1.1.3.cmml">e</mi><mo id="S8.p3.3.m3.1.1.1a" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.4" xref="S8.p3.3.m3.1.1.4.cmml">s</mi><mo id="S8.p3.3.m3.1.1.1b" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.5" xref="S8.p3.3.m3.1.1.5.cmml">s</mi><mo id="S8.p3.3.m3.1.1.1c" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.6" xref="S8.p3.3.m3.1.1.6.cmml">a</mi><mo id="S8.p3.3.m3.1.1.1d" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.7" xref="S8.p3.3.m3.1.1.7.cmml">g</mi><mo id="S8.p3.3.m3.1.1.1e" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.8" xref="S8.p3.3.m3.1.1.8.cmml">e</mi><mo id="S8.p3.3.m3.1.1.1f" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p3.3.m3.1.1.9" xref="S8.p3.3.m3.1.1.9.cmml">_</mi><mo id="S8.p3.3.m3.1.1.1g" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.10" xref="S8.p3.3.m3.1.1.10.cmml">s</mi><mo id="S8.p3.3.m3.1.1.1h" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.11" xref="S8.p3.3.m3.1.1.11.cmml">i</mi><mo id="S8.p3.3.m3.1.1.1i" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.12" xref="S8.p3.3.m3.1.1.12.cmml">z</mi><mo id="S8.p3.3.m3.1.1.1j" xref="S8.p3.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p3.3.m3.1.1.13" xref="S8.p3.3.m3.1.1.13.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S8.p3.3.m3.1b"><apply id="S8.p3.3.m3.1.1.cmml" xref="S8.p3.3.m3.1.1"><times id="S8.p3.3.m3.1.1.1.cmml" xref="S8.p3.3.m3.1.1.1"></times><apply id="S8.p3.3.m3.1.1.2.cmml" xref="S8.p3.3.m3.1.1.2"><times id="S8.p3.3.m3.1.1.2.1.cmml" xref="S8.p3.3.m3.1.1.2.1"></times><cn type="integer" id="S8.p3.3.m3.1.1.2.2.cmml" xref="S8.p3.3.m3.1.1.2.2">2</cn><ci id="S8.p3.3.m3.1.1.2.3.cmml" xref="S8.p3.3.m3.1.1.2.3">ğ‘š</ci></apply><ci id="S8.p3.3.m3.1.1.3.cmml" xref="S8.p3.3.m3.1.1.3">ğ‘’</ci><ci id="S8.p3.3.m3.1.1.4.cmml" xref="S8.p3.3.m3.1.1.4">ğ‘ </ci><ci id="S8.p3.3.m3.1.1.5.cmml" xref="S8.p3.3.m3.1.1.5">ğ‘ </ci><ci id="S8.p3.3.m3.1.1.6.cmml" xref="S8.p3.3.m3.1.1.6">ğ‘</ci><ci id="S8.p3.3.m3.1.1.7.cmml" xref="S8.p3.3.m3.1.1.7">ğ‘”</ci><ci id="S8.p3.3.m3.1.1.8.cmml" xref="S8.p3.3.m3.1.1.8">ğ‘’</ci><ci id="S8.p3.3.m3.1.1.9.cmml" xref="S8.p3.3.m3.1.1.9">_</ci><ci id="S8.p3.3.m3.1.1.10.cmml" xref="S8.p3.3.m3.1.1.10">ğ‘ </ci><ci id="S8.p3.3.m3.1.1.11.cmml" xref="S8.p3.3.m3.1.1.11">ğ‘–</ci><ci id="S8.p3.3.m3.1.1.12.cmml" xref="S8.p3.3.m3.1.1.12">ğ‘§</ci><ci id="S8.p3.3.m3.1.1.13.cmml" xref="S8.p3.3.m3.1.1.13">ğ‘’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p3.3.m3.1c">2\times message\_size</annotation><annotation encoding="application/x-llamapun" id="S8.p3.3.m3.1d">2 Ã— italic_m italic_e italic_s italic_s italic_a italic_g italic_e _ italic_s italic_i italic_z italic_e</annotation></semantics></math>.</p>
</div>
<div id="S8.p4" class="ltx_para">
<p id="S8.p4.5" class="ltx_p">When <em id="S8.p4.5.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R partitions activation checkpoints, it requires an additional all-gather operation before the forward recomputation of the back-propagation on each activation checkpoint. In general, we checkpoint the input activation for each transformer block, requiring one all-gather per transformer block. The communication overhead <math id="S8.p4.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p4.1.m1.1a"><msub id="S8.p4.1.m1.1.1" xref="S8.p4.1.m1.1.1.cmml"><mi id="S8.p4.1.m1.1.1.2" xref="S8.p4.1.m1.1.1.2.cmml">P</mi><mi id="S8.p4.1.m1.1.1.3" xref="S8.p4.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p4.1.m1.1b"><apply id="S8.p4.1.m1.1.1.cmml" xref="S8.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S8.p4.1.m1.1.1.1.cmml" xref="S8.p4.1.m1.1.1">subscript</csymbol><ci id="S8.p4.1.m1.1.1.2.cmml" xref="S8.p4.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S8.p4.1.m1.1.1.3.cmml" xref="S8.p4.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.1.m1.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p4.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> is therefore <math id="S8.p4.2.m2.1" class="ltx_Math" alttext="seq\_length*hidden\_dim" display="inline"><semantics id="S8.p4.2.m2.1a"><mrow id="S8.p4.2.m2.1.1" xref="S8.p4.2.m2.1.1.cmml"><mrow id="S8.p4.2.m2.1.1.2" xref="S8.p4.2.m2.1.1.2.cmml"><mrow id="S8.p4.2.m2.1.1.2.2" xref="S8.p4.2.m2.1.1.2.2.cmml"><mi id="S8.p4.2.m2.1.1.2.2.2" xref="S8.p4.2.m2.1.1.2.2.2.cmml">s</mi><mo id="S8.p4.2.m2.1.1.2.2.1" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.3" xref="S8.p4.2.m2.1.1.2.2.3.cmml">e</mi><mo id="S8.p4.2.m2.1.1.2.2.1a" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.4" xref="S8.p4.2.m2.1.1.2.2.4.cmml">q</mi><mo id="S8.p4.2.m2.1.1.2.2.1b" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p4.2.m2.1.1.2.2.5" xref="S8.p4.2.m2.1.1.2.2.5.cmml">_</mi><mo id="S8.p4.2.m2.1.1.2.2.1c" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.6" xref="S8.p4.2.m2.1.1.2.2.6.cmml">l</mi><mo id="S8.p4.2.m2.1.1.2.2.1d" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.7" xref="S8.p4.2.m2.1.1.2.2.7.cmml">e</mi><mo id="S8.p4.2.m2.1.1.2.2.1e" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.8" xref="S8.p4.2.m2.1.1.2.2.8.cmml">n</mi><mo id="S8.p4.2.m2.1.1.2.2.1f" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.9" xref="S8.p4.2.m2.1.1.2.2.9.cmml">g</mi><mo id="S8.p4.2.m2.1.1.2.2.1g" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.10" xref="S8.p4.2.m2.1.1.2.2.10.cmml">t</mi><mo id="S8.p4.2.m2.1.1.2.2.1h" xref="S8.p4.2.m2.1.1.2.2.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.2.2.11" xref="S8.p4.2.m2.1.1.2.2.11.cmml">h</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S8.p4.2.m2.1.1.2.1" xref="S8.p4.2.m2.1.1.2.1.cmml">*</mo><mi id="S8.p4.2.m2.1.1.2.3" xref="S8.p4.2.m2.1.1.2.3.cmml">h</mi></mrow><mo id="S8.p4.2.m2.1.1.1" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.3" xref="S8.p4.2.m2.1.1.3.cmml">i</mi><mo id="S8.p4.2.m2.1.1.1a" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.4" xref="S8.p4.2.m2.1.1.4.cmml">d</mi><mo id="S8.p4.2.m2.1.1.1b" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.5" xref="S8.p4.2.m2.1.1.5.cmml">d</mi><mo id="S8.p4.2.m2.1.1.1c" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.6" xref="S8.p4.2.m2.1.1.6.cmml">e</mi><mo id="S8.p4.2.m2.1.1.1d" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.7" xref="S8.p4.2.m2.1.1.7.cmml">n</mi><mo id="S8.p4.2.m2.1.1.1e" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p4.2.m2.1.1.8" xref="S8.p4.2.m2.1.1.8.cmml">_</mi><mo id="S8.p4.2.m2.1.1.1f" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.9" xref="S8.p4.2.m2.1.1.9.cmml">d</mi><mo id="S8.p4.2.m2.1.1.1g" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.10" xref="S8.p4.2.m2.1.1.10.cmml">i</mi><mo id="S8.p4.2.m2.1.1.1h" xref="S8.p4.2.m2.1.1.1.cmml">â¢</mo><mi id="S8.p4.2.m2.1.1.11" xref="S8.p4.2.m2.1.1.11.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S8.p4.2.m2.1b"><apply id="S8.p4.2.m2.1.1.cmml" xref="S8.p4.2.m2.1.1"><times id="S8.p4.2.m2.1.1.1.cmml" xref="S8.p4.2.m2.1.1.1"></times><apply id="S8.p4.2.m2.1.1.2.cmml" xref="S8.p4.2.m2.1.1.2"><times id="S8.p4.2.m2.1.1.2.1.cmml" xref="S8.p4.2.m2.1.1.2.1"></times><apply id="S8.p4.2.m2.1.1.2.2.cmml" xref="S8.p4.2.m2.1.1.2.2"><times id="S8.p4.2.m2.1.1.2.2.1.cmml" xref="S8.p4.2.m2.1.1.2.2.1"></times><ci id="S8.p4.2.m2.1.1.2.2.2.cmml" xref="S8.p4.2.m2.1.1.2.2.2">ğ‘ </ci><ci id="S8.p4.2.m2.1.1.2.2.3.cmml" xref="S8.p4.2.m2.1.1.2.2.3">ğ‘’</ci><ci id="S8.p4.2.m2.1.1.2.2.4.cmml" xref="S8.p4.2.m2.1.1.2.2.4">ğ‘</ci><ci id="S8.p4.2.m2.1.1.2.2.5.cmml" xref="S8.p4.2.m2.1.1.2.2.5">_</ci><ci id="S8.p4.2.m2.1.1.2.2.6.cmml" xref="S8.p4.2.m2.1.1.2.2.6">ğ‘™</ci><ci id="S8.p4.2.m2.1.1.2.2.7.cmml" xref="S8.p4.2.m2.1.1.2.2.7">ğ‘’</ci><ci id="S8.p4.2.m2.1.1.2.2.8.cmml" xref="S8.p4.2.m2.1.1.2.2.8">ğ‘›</ci><ci id="S8.p4.2.m2.1.1.2.2.9.cmml" xref="S8.p4.2.m2.1.1.2.2.9">ğ‘”</ci><ci id="S8.p4.2.m2.1.1.2.2.10.cmml" xref="S8.p4.2.m2.1.1.2.2.10">ğ‘¡</ci><ci id="S8.p4.2.m2.1.1.2.2.11.cmml" xref="S8.p4.2.m2.1.1.2.2.11">â„</ci></apply><ci id="S8.p4.2.m2.1.1.2.3.cmml" xref="S8.p4.2.m2.1.1.2.3">â„</ci></apply><ci id="S8.p4.2.m2.1.1.3.cmml" xref="S8.p4.2.m2.1.1.3">ğ‘–</ci><ci id="S8.p4.2.m2.1.1.4.cmml" xref="S8.p4.2.m2.1.1.4">ğ‘‘</ci><ci id="S8.p4.2.m2.1.1.5.cmml" xref="S8.p4.2.m2.1.1.5">ğ‘‘</ci><ci id="S8.p4.2.m2.1.1.6.cmml" xref="S8.p4.2.m2.1.1.6">ğ‘’</ci><ci id="S8.p4.2.m2.1.1.7.cmml" xref="S8.p4.2.m2.1.1.7">ğ‘›</ci><ci id="S8.p4.2.m2.1.1.8.cmml" xref="S8.p4.2.m2.1.1.8">_</ci><ci id="S8.p4.2.m2.1.1.9.cmml" xref="S8.p4.2.m2.1.1.9">ğ‘‘</ci><ci id="S8.p4.2.m2.1.1.10.cmml" xref="S8.p4.2.m2.1.1.10">ğ‘–</ci><ci id="S8.p4.2.m2.1.1.11.cmml" xref="S8.p4.2.m2.1.1.11">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.2.m2.1c">seq\_length*hidden\_dim</annotation><annotation encoding="application/x-llamapun" id="S8.p4.2.m2.1d">italic_s italic_e italic_q _ italic_l italic_e italic_n italic_g italic_t italic_h * italic_h italic_i italic_d italic_d italic_e italic_n _ italic_d italic_i italic_m</annotation></semantics></math>, since the communication volume of an all-gather is <math id="S8.p4.3.m3.1" class="ltx_Math" alttext="message\_size" display="inline"><semantics id="S8.p4.3.m3.1a"><mrow id="S8.p4.3.m3.1.1" xref="S8.p4.3.m3.1.1.cmml"><mi id="S8.p4.3.m3.1.1.2" xref="S8.p4.3.m3.1.1.2.cmml">m</mi><mo id="S8.p4.3.m3.1.1.1" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.3" xref="S8.p4.3.m3.1.1.3.cmml">e</mi><mo id="S8.p4.3.m3.1.1.1a" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.4" xref="S8.p4.3.m3.1.1.4.cmml">s</mi><mo id="S8.p4.3.m3.1.1.1b" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.5" xref="S8.p4.3.m3.1.1.5.cmml">s</mi><mo id="S8.p4.3.m3.1.1.1c" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.6" xref="S8.p4.3.m3.1.1.6.cmml">a</mi><mo id="S8.p4.3.m3.1.1.1d" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.7" xref="S8.p4.3.m3.1.1.7.cmml">g</mi><mo id="S8.p4.3.m3.1.1.1e" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.8" xref="S8.p4.3.m3.1.1.8.cmml">e</mi><mo id="S8.p4.3.m3.1.1.1f" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi mathvariant="normal" id="S8.p4.3.m3.1.1.9" xref="S8.p4.3.m3.1.1.9.cmml">_</mi><mo id="S8.p4.3.m3.1.1.1g" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.10" xref="S8.p4.3.m3.1.1.10.cmml">s</mi><mo id="S8.p4.3.m3.1.1.1h" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.11" xref="S8.p4.3.m3.1.1.11.cmml">i</mi><mo id="S8.p4.3.m3.1.1.1i" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.12" xref="S8.p4.3.m3.1.1.12.cmml">z</mi><mo id="S8.p4.3.m3.1.1.1j" xref="S8.p4.3.m3.1.1.1.cmml">â¢</mo><mi id="S8.p4.3.m3.1.1.13" xref="S8.p4.3.m3.1.1.13.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S8.p4.3.m3.1b"><apply id="S8.p4.3.m3.1.1.cmml" xref="S8.p4.3.m3.1.1"><times id="S8.p4.3.m3.1.1.1.cmml" xref="S8.p4.3.m3.1.1.1"></times><ci id="S8.p4.3.m3.1.1.2.cmml" xref="S8.p4.3.m3.1.1.2">ğ‘š</ci><ci id="S8.p4.3.m3.1.1.3.cmml" xref="S8.p4.3.m3.1.1.3">ğ‘’</ci><ci id="S8.p4.3.m3.1.1.4.cmml" xref="S8.p4.3.m3.1.1.4">ğ‘ </ci><ci id="S8.p4.3.m3.1.1.5.cmml" xref="S8.p4.3.m3.1.1.5">ğ‘ </ci><ci id="S8.p4.3.m3.1.1.6.cmml" xref="S8.p4.3.m3.1.1.6">ğ‘</ci><ci id="S8.p4.3.m3.1.1.7.cmml" xref="S8.p4.3.m3.1.1.7">ğ‘”</ci><ci id="S8.p4.3.m3.1.1.8.cmml" xref="S8.p4.3.m3.1.1.8">ğ‘’</ci><ci id="S8.p4.3.m3.1.1.9.cmml" xref="S8.p4.3.m3.1.1.9">_</ci><ci id="S8.p4.3.m3.1.1.10.cmml" xref="S8.p4.3.m3.1.1.10">ğ‘ </ci><ci id="S8.p4.3.m3.1.1.11.cmml" xref="S8.p4.3.m3.1.1.11">ğ‘–</ci><ci id="S8.p4.3.m3.1.1.12.cmml" xref="S8.p4.3.m3.1.1.12">ğ‘§</ci><ci id="S8.p4.3.m3.1.1.13.cmml" xref="S8.p4.3.m3.1.1.13">ğ‘’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.3.m3.1c">message\_size</annotation><annotation encoding="application/x-llamapun" id="S8.p4.3.m3.1d">italic_m italic_e italic_s italic_s italic_a italic_g italic_e _ italic_s italic_i italic_z italic_e</annotation></semantics></math>. Therefore, the total communication overhead of <math id="S8.p4.4.m4.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p4.4.m4.1a"><msub id="S8.p4.4.m4.1.1" xref="S8.p4.4.m4.1.1.cmml"><mi id="S8.p4.4.m4.1.1.2" xref="S8.p4.4.m4.1.1.2.cmml">P</mi><mi id="S8.p4.4.m4.1.1.3" xref="S8.p4.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p4.4.m4.1b"><apply id="S8.p4.4.m4.1.1.cmml" xref="S8.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S8.p4.4.m4.1.1.1.cmml" xref="S8.p4.4.m4.1.1">subscript</csymbol><ci id="S8.p4.4.m4.1.1.2.cmml" xref="S8.p4.4.m4.1.1.2">ğ‘ƒ</ci><ci id="S8.p4.4.m4.1.1.3.cmml" xref="S8.p4.4.m4.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.4.m4.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p4.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> is less than <math id="S8.p4.5.m5.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S8.p4.5.m5.1a"><mrow id="S8.p4.5.m5.1.1" xref="S8.p4.5.m5.1.1.cmml"><mn id="S8.p4.5.m5.1.1.2" xref="S8.p4.5.m5.1.1.2.cmml">10</mn><mo id="S8.p4.5.m5.1.1.1" xref="S8.p4.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.p4.5.m5.1b"><apply id="S8.p4.5.m5.1.1.cmml" xref="S8.p4.5.m5.1.1"><csymbol cd="latexml" id="S8.p4.5.m5.1.1.1.cmml" xref="S8.p4.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S8.p4.5.m5.1.1.2.cmml" xref="S8.p4.5.m5.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.5.m5.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S8.p4.5.m5.1d">10 %</annotation></semantics></math> of the original communication volume for model parallelism.</p>
</div>
<div id="S8.p5" class="ltx_para">
<p id="S8.p5.4" class="ltx_p">When MP is used in conjunction with DP, <math id="S8.p5.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p5.1.m1.1a"><msub id="S8.p5.1.m1.1.1" xref="S8.p5.1.m1.1.1.cmml"><mi id="S8.p5.1.m1.1.1.2" xref="S8.p5.1.m1.1.1.2.cmml">P</mi><mi id="S8.p5.1.m1.1.1.3" xref="S8.p5.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p5.1.m1.1b"><apply id="S8.p5.1.m1.1.1.cmml" xref="S8.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S8.p5.1.m1.1.1.1.cmml" xref="S8.p5.1.m1.1.1">subscript</csymbol><ci id="S8.p5.1.m1.1.1.2.cmml" xref="S8.p5.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S8.p5.1.m1.1.1.3.cmml" xref="S8.p5.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p5.1.m1.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p5.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> can be used to reduce the data-parallel communication volume by an order of magnitude at the expense of a <math id="S8.p5.2.m2.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S8.p5.2.m2.1a"><mrow id="S8.p5.2.m2.1.1" xref="S8.p5.2.m2.1.1.cmml"><mn id="S8.p5.2.m2.1.1.2" xref="S8.p5.2.m2.1.1.2.cmml">10</mn><mo id="S8.p5.2.m2.1.1.1" xref="S8.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.p5.2.m2.1b"><apply id="S8.p5.2.m2.1.1.cmml" xref="S8.p5.2.m2.1.1"><csymbol cd="latexml" id="S8.p5.2.m2.1.1.1.cmml" xref="S8.p5.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S8.p5.2.m2.1.1.2.cmml" xref="S8.p5.2.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p5.2.m2.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S8.p5.2.m2.1d">10 %</annotation></semantics></math> increase in model-parallel communication volume, and significantly boost efficiency when data-parallel communication is a performance bottleneck. Notice that <math id="S8.p5.3.m3.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p5.3.m3.1a"><msub id="S8.p5.3.m3.1.1" xref="S8.p5.3.m3.1.1.cmml"><mi id="S8.p5.3.m3.1.1.2" xref="S8.p5.3.m3.1.1.2.cmml">P</mi><mi id="S8.p5.3.m3.1.1.3" xref="S8.p5.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p5.3.m3.1b"><apply id="S8.p5.3.m3.1.1.cmml" xref="S8.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S8.p5.3.m3.1.1.1.cmml" xref="S8.p5.3.m3.1.1">subscript</csymbol><ci id="S8.p5.3.m3.1.1.2.cmml" xref="S8.p5.3.m3.1.1.2">ğ‘ƒ</ci><ci id="S8.p5.3.m3.1.1.3.cmml" xref="S8.p5.3.m3.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p5.3.m3.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p5.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> reduces the activation memory consumption by the MP degree allowing for a proportional increase in batch size. For large models, MP can be as large as 16 (#GPUs on a DGX-2 node), allowing for up to 16x increase in the batch size. The communication volume of a data-parallel training is inversely proportional to the batch size. Therefore, an order of magnitude increase in batch size due to <math id="S8.p5.4.m4.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p5.4.m4.1a"><msub id="S8.p5.4.m4.1.1" xref="S8.p5.4.m4.1.1.cmml"><mi id="S8.p5.4.m4.1.1.2" xref="S8.p5.4.m4.1.1.2.cmml">P</mi><mi id="S8.p5.4.m4.1.1.3" xref="S8.p5.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p5.4.m4.1b"><apply id="S8.p5.4.m4.1.1.cmml" xref="S8.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S8.p5.4.m4.1.1.1.cmml" xref="S8.p5.4.m4.1.1">subscript</csymbol><ci id="S8.p5.4.m4.1.1.2.cmml" xref="S8.p5.4.m4.1.1.2">ğ‘ƒ</ci><ci id="S8.p5.4.m4.1.1.3.cmml" xref="S8.p5.4.m4.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p5.4.m4.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p5.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> could result in an order-of-magnitude decrease in data-parallel communication volume.</p>
</div>
<div id="S8.p6" class="ltx_para">
<p id="S8.p6.4" class="ltx_p">Finally if <math id="S8.p6.1.m1.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S8.p6.1.m1.1a"><msub id="S8.p6.1.m1.1.1" xref="S8.p6.1.m1.1.1.cmml"><mi id="S8.p6.1.m1.1.1.2" xref="S8.p6.1.m1.1.1.2.cmml">P</mi><mrow id="S8.p6.1.m1.1.1.3" xref="S8.p6.1.m1.1.1.3.cmml"><mi id="S8.p6.1.m1.1.1.3.2" xref="S8.p6.1.m1.1.1.3.2.cmml">a</mi><mo id="S8.p6.1.m1.1.1.3.1" xref="S8.p6.1.m1.1.1.3.1.cmml">+</mo><mrow id="S8.p6.1.m1.1.1.3.3" xref="S8.p6.1.m1.1.1.3.3.cmml"><mi id="S8.p6.1.m1.1.1.3.3.2" xref="S8.p6.1.m1.1.1.3.3.2.cmml">c</mi><mo id="S8.p6.1.m1.1.1.3.3.1" xref="S8.p6.1.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p6.1.m1.1.1.3.3.3" xref="S8.p6.1.m1.1.1.3.3.3.cmml">p</mi><mo id="S8.p6.1.m1.1.1.3.3.1a" xref="S8.p6.1.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p6.1.m1.1.1.3.3.4" xref="S8.p6.1.m1.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p6.1.m1.1b"><apply id="S8.p6.1.m1.1.1.cmml" xref="S8.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S8.p6.1.m1.1.1.1.cmml" xref="S8.p6.1.m1.1.1">subscript</csymbol><ci id="S8.p6.1.m1.1.1.2.cmml" xref="S8.p6.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S8.p6.1.m1.1.1.3.cmml" xref="S8.p6.1.m1.1.1.3"><plus id="S8.p6.1.m1.1.1.3.1.cmml" xref="S8.p6.1.m1.1.1.3.1"></plus><ci id="S8.p6.1.m1.1.1.3.2.cmml" xref="S8.p6.1.m1.1.1.3.2">ğ‘</ci><apply id="S8.p6.1.m1.1.1.3.3.cmml" xref="S8.p6.1.m1.1.1.3.3"><times id="S8.p6.1.m1.1.1.3.3.1.cmml" xref="S8.p6.1.m1.1.1.3.3.1"></times><ci id="S8.p6.1.m1.1.1.3.3.2.cmml" xref="S8.p6.1.m1.1.1.3.3.2">ğ‘</ci><ci id="S8.p6.1.m1.1.1.3.3.3.cmml" xref="S8.p6.1.m1.1.1.3.3.3">ğ‘</ci><ci id="S8.p6.1.m1.1.1.3.3.4.cmml" xref="S8.p6.1.m1.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p6.1.m1.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S8.p6.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is applied, partitioned activation checkpoints are offloaded to CPU, reducing the activation memory requirement to nearly zero at the expense of 2x added data movement to and from CPU memory compared to <math id="S8.p6.2.m2.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p6.2.m2.1a"><msub id="S8.p6.2.m2.1.1" xref="S8.p6.2.m2.1.1.cmml"><mi id="S8.p6.2.m2.1.1.2" xref="S8.p6.2.m2.1.1.2.cmml">P</mi><mi id="S8.p6.2.m2.1.1.3" xref="S8.p6.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p6.2.m2.1b"><apply id="S8.p6.2.m2.1.1.cmml" xref="S8.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S8.p6.2.m2.1.1.1.cmml" xref="S8.p6.2.m2.1.1">subscript</csymbol><ci id="S8.p6.2.m2.1.1.2.cmml" xref="S8.p6.2.m2.1.1.2">ğ‘ƒ</ci><ci id="S8.p6.2.m2.1.1.3.cmml" xref="S8.p6.2.m2.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p6.2.m2.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p6.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>. In extreme cases where DP communication volume is the major bottleneck due to a small batch size even with <math id="S8.p6.3.m3.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p6.3.m3.1a"><msub id="S8.p6.3.m3.1.1" xref="S8.p6.3.m3.1.1.cmml"><mi id="S8.p6.3.m3.1.1.2" xref="S8.p6.3.m3.1.1.2.cmml">P</mi><mi id="S8.p6.3.m3.1.1.3" xref="S8.p6.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p6.3.m3.1b"><apply id="S8.p6.3.m3.1.1.cmml" xref="S8.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S8.p6.3.m3.1.1.1.cmml" xref="S8.p6.3.m3.1.1">subscript</csymbol><ci id="S8.p6.3.m3.1.1.2.cmml" xref="S8.p6.3.m3.1.1.2">ğ‘ƒ</ci><ci id="S8.p6.3.m3.1.1.3.cmml" xref="S8.p6.3.m3.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p6.3.m3.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p6.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S8.p6.4.m4.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S8.p6.4.m4.1a"><msub id="S8.p6.4.m4.1.1" xref="S8.p6.4.m4.1.1.cmml"><mi id="S8.p6.4.m4.1.1.2" xref="S8.p6.4.m4.1.1.2.cmml">P</mi><mrow id="S8.p6.4.m4.1.1.3" xref="S8.p6.4.m4.1.1.3.cmml"><mi id="S8.p6.4.m4.1.1.3.2" xref="S8.p6.4.m4.1.1.3.2.cmml">a</mi><mo id="S8.p6.4.m4.1.1.3.1" xref="S8.p6.4.m4.1.1.3.1.cmml">+</mo><mrow id="S8.p6.4.m4.1.1.3.3" xref="S8.p6.4.m4.1.1.3.3.cmml"><mi id="S8.p6.4.m4.1.1.3.3.2" xref="S8.p6.4.m4.1.1.3.3.2.cmml">c</mi><mo id="S8.p6.4.m4.1.1.3.3.1" xref="S8.p6.4.m4.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p6.4.m4.1.1.3.3.3" xref="S8.p6.4.m4.1.1.3.3.3.cmml">p</mi><mo id="S8.p6.4.m4.1.1.3.3.1a" xref="S8.p6.4.m4.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p6.4.m4.1.1.3.3.4" xref="S8.p6.4.m4.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p6.4.m4.1b"><apply id="S8.p6.4.m4.1.1.cmml" xref="S8.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S8.p6.4.m4.1.1.1.cmml" xref="S8.p6.4.m4.1.1">subscript</csymbol><ci id="S8.p6.4.m4.1.1.2.cmml" xref="S8.p6.4.m4.1.1.2">ğ‘ƒ</ci><apply id="S8.p6.4.m4.1.1.3.cmml" xref="S8.p6.4.m4.1.1.3"><plus id="S8.p6.4.m4.1.1.3.1.cmml" xref="S8.p6.4.m4.1.1.3.1"></plus><ci id="S8.p6.4.m4.1.1.3.2.cmml" xref="S8.p6.4.m4.1.1.3.2">ğ‘</ci><apply id="S8.p6.4.m4.1.1.3.3.cmml" xref="S8.p6.4.m4.1.1.3.3"><times id="S8.p6.4.m4.1.1.3.3.1.cmml" xref="S8.p6.4.m4.1.1.3.3.1"></times><ci id="S8.p6.4.m4.1.1.3.3.2.cmml" xref="S8.p6.4.m4.1.1.3.3.2">ğ‘</ci><ci id="S8.p6.4.m4.1.1.3.3.3.cmml" xref="S8.p6.4.m4.1.1.3.3.3">ğ‘</ci><ci id="S8.p6.4.m4.1.1.3.3.4.cmml" xref="S8.p6.4.m4.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p6.4.m4.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S8.p6.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> can improve efficiency by increasing the batch size as long as the CPU data transfer overhead is less than the DP communication volume overhead, which is generally true for small batch sizes.</p>
</div>
<div id="S8.p7" class="ltx_para">
<p id="S8.p7.2" class="ltx_p">Given model and hardware characteristics, we leverage the above analysis to decide if and when to apply <math id="S8.p7.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S8.p7.1.m1.1a"><msub id="S8.p7.1.m1.1.1" xref="S8.p7.1.m1.1.1.cmml"><mi id="S8.p7.1.m1.1.1.2" xref="S8.p7.1.m1.1.1.2.cmml">P</mi><mi id="S8.p7.1.m1.1.1.3" xref="S8.p7.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S8.p7.1.m1.1b"><apply id="S8.p7.1.m1.1.1.cmml" xref="S8.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S8.p7.1.m1.1.1.1.cmml" xref="S8.p7.1.m1.1.1">subscript</csymbol><ci id="S8.p7.1.m1.1.1.2.cmml" xref="S8.p7.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S8.p7.1.m1.1.1.3.cmml" xref="S8.p7.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p7.1.m1.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S8.p7.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S8.p7.2.m2.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S8.p7.2.m2.1a"><msub id="S8.p7.2.m2.1.1" xref="S8.p7.2.m2.1.1.cmml"><mi id="S8.p7.2.m2.1.1.2" xref="S8.p7.2.m2.1.1.2.cmml">P</mi><mrow id="S8.p7.2.m2.1.1.3" xref="S8.p7.2.m2.1.1.3.cmml"><mi id="S8.p7.2.m2.1.1.3.2" xref="S8.p7.2.m2.1.1.3.2.cmml">a</mi><mo id="S8.p7.2.m2.1.1.3.1" xref="S8.p7.2.m2.1.1.3.1.cmml">+</mo><mrow id="S8.p7.2.m2.1.1.3.3" xref="S8.p7.2.m2.1.1.3.3.cmml"><mi id="S8.p7.2.m2.1.1.3.3.2" xref="S8.p7.2.m2.1.1.3.3.2.cmml">c</mi><mo id="S8.p7.2.m2.1.1.3.3.1" xref="S8.p7.2.m2.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p7.2.m2.1.1.3.3.3" xref="S8.p7.2.m2.1.1.3.3.3.cmml">p</mi><mo id="S8.p7.2.m2.1.1.3.3.1a" xref="S8.p7.2.m2.1.1.3.3.1.cmml">â¢</mo><mi id="S8.p7.2.m2.1.1.3.3.4" xref="S8.p7.2.m2.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p7.2.m2.1b"><apply id="S8.p7.2.m2.1.1.cmml" xref="S8.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S8.p7.2.m2.1.1.1.cmml" xref="S8.p7.2.m2.1.1">subscript</csymbol><ci id="S8.p7.2.m2.1.1.2.cmml" xref="S8.p7.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S8.p7.2.m2.1.1.3.cmml" xref="S8.p7.2.m2.1.1.3"><plus id="S8.p7.2.m2.1.1.3.1.cmml" xref="S8.p7.2.m2.1.1.3.1"></plus><ci id="S8.p7.2.m2.1.1.3.2.cmml" xref="S8.p7.2.m2.1.1.3.2">ğ‘</ci><apply id="S8.p7.2.m2.1.1.3.3.cmml" xref="S8.p7.2.m2.1.1.3.3"><times id="S8.p7.2.m2.1.1.3.3.1.cmml" xref="S8.p7.2.m2.1.1.3.3.1"></times><ci id="S8.p7.2.m2.1.1.3.3.2.cmml" xref="S8.p7.2.m2.1.1.3.3.2">ğ‘</ci><ci id="S8.p7.2.m2.1.1.3.3.3.cmml" xref="S8.p7.2.m2.1.1.3.3.3">ğ‘</ci><ci id="S8.p7.2.m2.1.1.3.3.4.cmml" xref="S8.p7.2.m2.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p7.2.m2.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S8.p7.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Step Towards 1 Trillion Parameters</h2>

<div id="S9.p1" class="ltx_para">
<p id="S9.p1.1" class="ltx_p">The largest published models today are in the range of 10 billion parameters, which are already challenging to train. Getting to a trillion parameters, 3-orders of magnitude larger, will inevitably happen, but the road will be full of hurdles, surprises and innovations. While we do not claim knowing or addressing all of them, <em id="S9.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> addresses one of the most fundamental challenges from a system perspective: the ability to fit a model of this scale on current hardware while allowing it to train with good system scalability.</p>
</div>
<div id="S9.p2" class="ltx_para">
<p id="S9.p2.1" class="ltx_p"><span id="S9.p2.1.1" class="ltx_text ltx_font_bold">A Leap from State-of-Art</span>
The largest model that the state-of-art framework, Megatron, can train with acceptable throughput is a 16 - 20B parameter model in a DGX-2 system. Scaling further by having model parallelism across multiple DGX nodes results in significant efficiency drop due to limited internode bandwidth.</p>
</div>
<div id="S9.p3" class="ltx_para">
<p id="S9.p3.1" class="ltx_p"><em id="S9.p3.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> vastly increase the efficiently-runnable model size. It enables the current generation of hardware to run significantly larger models without requiring fine-grained model parallelism to go across the node boundaries.
As demonstrated in Table <a href="#S5.T1" title="Table 1 â€£ 5.2 P_ğ‘”: Gradient Partitioning â€£ 5 Deep Dive into ZeRO-DP â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <em id="S9.p3.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>, with all optimizations turned on (P<math id="S9.p3.1.m1.1" class="ltx_Math" alttext="{}_{os+g+p}" display="inline"><semantics id="S9.p3.1.m1.1a"><msub id="S9.p3.1.m1.1.1" xref="S9.p3.1.m1.1.1.cmml"><mi id="S9.p3.1.m1.1.1a" xref="S9.p3.1.m1.1.1.cmml"></mi><mrow id="S9.p3.1.m1.1.1.1" xref="S9.p3.1.m1.1.1.1.cmml"><mrow id="S9.p3.1.m1.1.1.1.2" xref="S9.p3.1.m1.1.1.1.2.cmml"><mi id="S9.p3.1.m1.1.1.1.2.2" xref="S9.p3.1.m1.1.1.1.2.2.cmml">o</mi><mo id="S9.p3.1.m1.1.1.1.2.1" xref="S9.p3.1.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S9.p3.1.m1.1.1.1.2.3" xref="S9.p3.1.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S9.p3.1.m1.1.1.1.1" xref="S9.p3.1.m1.1.1.1.1.cmml">+</mo><mi id="S9.p3.1.m1.1.1.1.3" xref="S9.p3.1.m1.1.1.1.3.cmml">g</mi><mo id="S9.p3.1.m1.1.1.1.1a" xref="S9.p3.1.m1.1.1.1.1.cmml">+</mo><mi id="S9.p3.1.m1.1.1.1.4" xref="S9.p3.1.m1.1.1.1.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S9.p3.1.m1.1b"><apply id="S9.p3.1.m1.1.1.cmml" xref="S9.p3.1.m1.1.1"><apply id="S9.p3.1.m1.1.1.1.cmml" xref="S9.p3.1.m1.1.1.1"><plus id="S9.p3.1.m1.1.1.1.1.cmml" xref="S9.p3.1.m1.1.1.1.1"></plus><apply id="S9.p3.1.m1.1.1.1.2.cmml" xref="S9.p3.1.m1.1.1.1.2"><times id="S9.p3.1.m1.1.1.1.2.1.cmml" xref="S9.p3.1.m1.1.1.1.2.1"></times><ci id="S9.p3.1.m1.1.1.1.2.2.cmml" xref="S9.p3.1.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S9.p3.1.m1.1.1.1.2.3.cmml" xref="S9.p3.1.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S9.p3.1.m1.1.1.1.3.cmml" xref="S9.p3.1.m1.1.1.1.3">ğ‘”</ci><ci id="S9.p3.1.m1.1.1.1.4.cmml" xref="S9.p3.1.m1.1.1.1.4">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p3.1.m1.1c">{}_{os+g+p}</annotation><annotation encoding="application/x-llamapun" id="S9.p3.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g + italic_p end_FLOATSUBSCRIPT</annotation></semantics></math>), could fit more than 1 <em id="S9.p3.1.3" class="ltx_emph ltx_font_italic">Trillion</em> parameters on 1024 GPUs using DP only. Alternatively, when combined with model parallelism (as shown in Table <a href="#S7.T2" title="Table 2 â€£ 7.1 Data Parallel Communication Volume â€£ 7 Communication Analysis of ZeRO-DP â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), <em id="S9.p3.1.4" class="ltx_emph ltx_font_italic">ZeRO</em> could fit more than 1 <em id="S9.p3.1.5" class="ltx_emph ltx_font_italic">Trillion</em> parameters on 1024 GPUs with 16-way model parallelism (within each DGX2 node) and 64-way data parallelism across nodes. Running a model with a trillion parameters efficiently is no longer impossible!</p>
</div>
<div id="S9.p4" class="ltx_para">
<p id="S9.p4.1" class="ltx_p"><span id="S9.p4.1.1" class="ltx_text ltx_font_bold">Compute Power Gap</span> Training a trillion parameter model end-to-end within an acceptable time range, however, could still require significant amount of compute power, which is lacking in todayâ€™s AI clusters.</p>
</div>
<div id="S9.p5" class="ltx_para">
<p id="S9.p5.3" class="ltx_p">To understand the resource requirement, we present a brief comparison with Bert-Large. Bert-Large can be trained in <math id="S9.p5.1.m1.1" class="ltx_Math" alttext="67" display="inline"><semantics id="S9.p5.1.m1.1a"><mn id="S9.p5.1.m1.1.1" xref="S9.p5.1.m1.1.1.cmml">67</mn><annotation-xml encoding="MathML-Content" id="S9.p5.1.m1.1b"><cn type="integer" id="S9.p5.1.m1.1.1.cmml" xref="S9.p5.1.m1.1.1">67</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p5.1.m1.1c">67</annotation><annotation encoding="application/x-llamapun" id="S9.p5.1.m1.1d">67</annotation></semantics></math> minutes on a <math id="S9.p5.2.m2.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S9.p5.2.m2.1a"><mn id="S9.p5.2.m2.1.1" xref="S9.p5.2.m2.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S9.p5.2.m2.1b"><cn type="integer" id="S9.p5.2.m2.1.1.cmml" xref="S9.p5.2.m2.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p5.2.m2.1c">1024</annotation><annotation encoding="application/x-llamapun" id="S9.p5.2.m2.1d">1024</annotation></semantics></math> GPU DGX-2H cluster <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. A 1 Trillion Parameter model can easily contain <math id="S9.p5.3.m3.1" class="ltx_Math" alttext="3000" display="inline"><semantics id="S9.p5.3.m3.1a"><mn id="S9.p5.3.m3.1.1" xref="S9.p5.3.m3.1.1.cmml">3000</mn><annotation-xml encoding="MathML-Content" id="S9.p5.3.m3.1b"><cn type="integer" id="S9.p5.3.m3.1.1.cmml" xref="S9.p5.3.m3.1.1">3000</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p5.3.m3.1c">3000</annotation><annotation encoding="application/x-llamapun" id="S9.p5.3.m3.1d">3000</annotation></semantics></math>x (1 trillion / 330 million) more computation than a Bert-Large model for a data sample. Even if we assume the same sequence length and the total number of samples required to train the model, training a 1T model would take 140 days, assuming the same hardware and similar computational efficiency. In practice, both data samples and sequence length are likely to increase with the increased model size requiring over a year to train. It would require an exa-flop system to train a 1T parameter model in a reasonable time. But when such compute capacity becomes available, we hope <em id="S9.p5.3.1" class="ltx_emph ltx_font_italic">ZeRO</em> will provide the system technology to run the 1T models efficiently.</p>
</div>
<figure id="S9.F5" class="ltx_figure">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S9.F5.5.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S9.F5.6.2" class="ltx_text" style="font-size:90%;">Max model throughput with <em id="S9.F5.6.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP.</span></figcaption><div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="S9.F5.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_bottom" style="width:238.5pt;">
<span id="S9.F5.1.p1" class="ltx_para ltx_align_center"><img src="x4.png" id="S9.F5.1.p1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="350" alt="Refer to caption">
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="S9.F5.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_bottom" style="width:173.4pt;">
<span id="S9.F5.2.p1" class="ltx_para ltx_align_center"><img src="x5.png" id="S9.F5.2.p1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="450" alt="Refer to caption">
</span></span></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S9.F5.5.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S9.F5.6.2" class="ltx_text" style="font-size:90%;">Max model throughput with <em id="S9.F5.6.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP.</span></figcaption>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S9.F5.8.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S9.F5.9.2" class="ltx_text" style="font-size:90%;">SOTA Turing-NLG enabled by <em id="S9.F5.9.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>.</span></figcaption>
</figure>
</section>
<section id="S10" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">10 </span>Implementation and Evaluation</h2>

<div id="S10.p1" class="ltx_para">
<p id="S10.p1.2" class="ltx_p">We focus our implementation on supporting efficient training of models with <math id="S10.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S10.p1.1.m1.1a"><mo id="S10.p1.1.m1.1.1" xref="S10.p1.1.m1.1.1.cmml">âˆ¼</mo><annotation-xml encoding="MathML-Content" id="S10.p1.1.m1.1b"><csymbol cd="latexml" id="S10.p1.1.m1.1.1.cmml" xref="S10.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S10.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S10.p1.1.m1.1d">âˆ¼</annotation></semantics></math>100B parameters, which are an order-of-magnitude larger than the largest published models today (e.g., T5-11BÂ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>) while trainable within a reasonable time frame on current hardware (e.g., with 1K V100 GPUs). We implement and evaluate a subset of optimizations in <em id="S10.p1.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>â€” <math id="S10.p1.2.m2.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S10.p1.2.m2.1a"><msub id="S10.p1.2.m2.1.1" xref="S10.p1.2.m2.1.1.cmml"><mi id="S10.p1.2.m2.1.1.2" xref="S10.p1.2.m2.1.1.2.cmml">P</mi><mrow id="S10.p1.2.m2.1.1.3" xref="S10.p1.2.m2.1.1.3.cmml"><mrow id="S10.p1.2.m2.1.1.3.2" xref="S10.p1.2.m2.1.1.3.2.cmml"><mi id="S10.p1.2.m2.1.1.3.2.2" xref="S10.p1.2.m2.1.1.3.2.2.cmml">o</mi><mo id="S10.p1.2.m2.1.1.3.2.1" xref="S10.p1.2.m2.1.1.3.2.1.cmml">â¢</mo><mi id="S10.p1.2.m2.1.1.3.2.3" xref="S10.p1.2.m2.1.1.3.2.3.cmml">s</mi></mrow><mo id="S10.p1.2.m2.1.1.3.1" xref="S10.p1.2.m2.1.1.3.1.cmml">+</mo><mi id="S10.p1.2.m2.1.1.3.3" xref="S10.p1.2.m2.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.p1.2.m2.1b"><apply id="S10.p1.2.m2.1.1.cmml" xref="S10.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S10.p1.2.m2.1.1.1.cmml" xref="S10.p1.2.m2.1.1">subscript</csymbol><ci id="S10.p1.2.m2.1.1.2.cmml" xref="S10.p1.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S10.p1.2.m2.1.1.3.cmml" xref="S10.p1.2.m2.1.1.3"><plus id="S10.p1.2.m2.1.1.3.1.cmml" xref="S10.p1.2.m2.1.1.3.1"></plus><apply id="S10.p1.2.m2.1.1.3.2.cmml" xref="S10.p1.2.m2.1.1.3.2"><times id="S10.p1.2.m2.1.1.3.2.1.cmml" xref="S10.p1.2.m2.1.1.3.2.1"></times><ci id="S10.p1.2.m2.1.1.3.2.2.cmml" xref="S10.p1.2.m2.1.1.3.2.2">ğ‘œ</ci><ci id="S10.p1.2.m2.1.1.3.2.3.cmml" xref="S10.p1.2.m2.1.1.3.2.3">ğ‘ </ci></apply><ci id="S10.p1.2.m2.1.1.3.3.cmml" xref="S10.p1.2.m2.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.p1.2.m2.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> in <em id="S10.p1.2.2" class="ltx_emph ltx_font_italic">ZeRO</em>-DP plus ZeRO-R â€” that allows us to achieve this goal. We will refer to this implementation as <em id="S10.p1.2.3" class="ltx_emph ltx_font_italic">ZeRO</em>-100B. Our results show that <em id="S10.p1.2.4" class="ltx_emph ltx_font_italic">ZeRO</em>-100B can efficiently train models with up to 170B parameters, 8x bigger than SOTA, up to 10x faster and with improved usability. <em id="S10.p1.2.5" class="ltx_emph ltx_font_italic">ZeRO</em>-100B powers Turing-NLG, the largest published model in the world with new SOTA accuracy.</p>
</div>
<figure id="S10.4" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">

<div class="ltx_flex_cell 
                  ltx_flex_size_3"><span id="S10.2.2" class="ltx_inline-para ltx_minipage ltx_flex_size_3 ltx_align_center ltx_align_bottom" style="width:130.1pt;">
<span id="S10.1.1.p1" class="ltx_para"><img src="x6.png" id="S10.1.1.p1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="455" alt="[Uncaptioned image]">
</span>
<span id="S10.F6" class="ltx_figure">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S10.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S10.F6.3.2" class="ltx_text" style="font-size:90%;">Max model size </span></span>
</span>
<span id="S10.2.2.p2" class="ltx_para">
<span id="S10.2.2.p2.1" class="ltx_p">.</span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_3"><span id="S10.3.3" class="ltx_inline-para ltx_minipage ltx_flex_size_3 ltx_align_center ltx_align_bottom" style="width:130.1pt;">
<span id="S10.3.3.p1" class="ltx_para"><img src="x7.png" id="S10.3.3.p1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="458" alt="[Uncaptioned image]">
</span>
<span id="S10.F7" class="ltx_figure">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S10.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S10.F7.3.2" class="ltx_text" style="font-size:90%;">Max cache allocated.</span></span>
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_3"><span id="S10.4.4" class="ltx_inline-para ltx_minipage ltx_flex_size_3 ltx_align_center ltx_align_bottom" style="width:130.1pt;">
<span id="S10.4.4.p1" class="ltx_para"><img src="x8.png" id="S10.4.4.p1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="453" alt="[Uncaptioned image]">
</span>
<span id="S10.F8" class="ltx_figure">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S10.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S10.F8.4.2" class="ltx_text" style="font-size:90%;">Throughput per GPU.</span></span>
</span></span></div>
</div>
</figure>
<section id="S10.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">10.1 </span>Implementation and Methodology</h3>

<section id="S10.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Implementation</h5>

<div id="S10.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S10.SS1.SSS0.Px1.p1.1" class="ltx_p">We implemented <em id="S10.SS1.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-100B in PyTorch including the full set of optimizations in <math id="S10.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S10.SS1.SSS0.Px1.p1.1.m1.1a"><msub id="S10.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mrow id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.cmml"><mi id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.2" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.1" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.3" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">+</mo><mi id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3"><plus id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.1"></plus><apply id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2"><times id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.1.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.1"></times><ci id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.2.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.3.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S10.SS1.SSS0.Px1.p1.1.m1.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS1.SSS0.Px1.p1.1.m1.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.SS1.SSS0.Px1.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and <em id="S10.SS1.SSS0.Px1.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-R. Its interface is compatible with any model implemented as an <span id="S10.SS1.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_typewriter">torch.nn.module</span>. Users can simply wrap their models using this interface and leverage <em id="S10.SS1.SSS0.Px1.p1.1.4" class="ltx_emph ltx_font_italic">ZeRO</em>-powered DP as they use classic DP. Users do not need to modify their model. <em id="S10.SS1.SSS0.Px1.p1.1.5" class="ltx_emph ltx_font_italic">ZeRO</em>-powered DP can be combined with any form of MP including Megatron-LM.</p>
</div>
</section>
<section id="S10.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hardware</h5>

<div id="S10.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S10.SS1.SSS0.Px2.p1.1" class="ltx_p">We conducted our experiments on a cluster of 400 V100 GPUs (<math id="S10.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="25" display="inline"><semantics id="S10.SS1.SSS0.Px2.p1.1.m1.1a"><mn id="S10.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S10.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="S10.SS1.SSS0.Px2.p1.1.m1.1b"><cn type="integer" id="S10.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S10.SS1.SSS0.Px2.p1.1.m1.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="S10.SS1.SSS0.Px2.p1.1.m1.1c">25</annotation><annotation encoding="application/x-llamapun" id="S10.SS1.SSS0.Px2.p1.1.m1.1d">25</annotation></semantics></math> DGX-2 nodes) with 800 Gbps internode communication bandwidth.
</p>
</div>
</section>
<section id="S10.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baseline</h5>

<div id="S10.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S10.SS1.SSS0.Px3.p1.1" class="ltx_p">For experiments without MP, we use torchâ€™s distributed data parallel (DDP) as baseline. For experiments with MP, we use Megatron-LM because it is, to our knowledge, the state-of-art. We use the open-source version of Megatron-LM from NVIDIAÂ <span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://github.com/nvidia/Megatron-LM</span></span></span> with a date of September 2019. The most recent Megatron-LM results report the ability to scale up to 16B parameter models using 32 DGX-2 nodes (total of 512 32GB V100 GPUs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. </p>
</div>
</section>
<section id="S10.SS1.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">
<em id="S10.SS1.SSS0.Px4.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> </h5>

<div id="S10.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="S10.SS1.SSS0.Px4.p1.1" class="ltx_p">Experiments without MP, use the <em id="S10.SS1.SSS0.Px4.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-powered DP implementation in <em id="S10.SS1.SSS0.Px4.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B.
Experiments with MP, combine <em id="S10.SS1.SSS0.Px4.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>-powered DP with MP of Megatron-LM.</p>
</div>
</section>
<section id="S10.SS1.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Model Configurations</h5>

<div id="S10.SS1.SSS0.Px5.p1" class="ltx_para">
<p id="S10.SS1.SSS0.Px5.p1.1" class="ltx_p">The models presented in this section are GPT-2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> like transformer based models. We vary the hidden dimension and the number of layers to obtain models with different number of parameters. TableÂ <a href="#S10.T4" title="Table 4 â€£ Max Cached Memory â€£ 10.5 Memory and Performance Analysis â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the configuration parameters used in our experiments with additional details in AE Appendix.</p>
</div>
</section>
</section>
<section id="S10.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">10.2 </span>Speed and Model Size</h3>

<div id="S10.SS2.p1" class="ltx_para">
<p id="S10.SS2.p1.1" class="ltx_p"><em id="S10.SS2.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-100B efficiently run models with up to 170B parameters on 400 GPUs, more than 8x bigger than Megatron-LM. FigureÂ <a href="#S1.F2" title="Figure 2 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows throughput per GPU for varying model sizes using <em id="S10.SS2.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B with MP versus using Megatron MP alone. <em id="S10.SS2.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>-100B achieves a sustained throughput of 15 PetaFlops (over 30% of the peak) on average for models with 8B to 100B parameters. In comparison, the baseline MP performance degrades quickly with the increase in model size: MP incurs high communication volume between GPUs, and going beyond a single node to fit larger models causes a communication bandwidth drop from 300GB/sec per link (NVSwitch) to 12.5 GB/sec per link (Infiniband EDR), resulting in a significant performance drop. <em id="S10.SS2.p1.1.4" class="ltx_emph ltx_font_italic">ZeRO</em>-100B achieves up to 10x speedup over baseline, significantly outperforming on large models.</p>
</div>
<div id="S10.SS2.p2" class="ltx_para">
<p id="S10.SS2.p2.1" class="ltx_p">For <em id="S10.SS2.p2.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-100B, the slight reduction in performance beyond 100B is due to lack of enough memory to run larger batch sizes. We expect the performance to improve as we increase the number of GPUs due to super-linear speedup of <em id="S10.SS2.p2.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B as we discuss next.</p>
</div>
<figure id="S10.T3" class="ltx_table">
<table id="S10.T3.18" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S10.T3.18.19.1" class="ltx_tr">
<th id="S10.T3.18.19.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S10.T3.18.19.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<em id="S10.T3.18.19.1.2.1" class="ltx_emph ltx_font_italic">ZeRO</em>-DP</th>
<th id="S10.T3.18.19.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<em id="S10.T3.18.19.1.3.1" class="ltx_emph ltx_font_italic">ZeRO</em>-R</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S10.T3.3.3" class="ltx_tr">
<th id="S10.T3.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">1</th>
<td id="S10.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">P<math id="S10.T3.1.1.1.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S10.T3.1.1.1.m1.1a"><msub id="S10.T3.1.1.1.m1.1.1" xref="S10.T3.1.1.1.m1.1.1.cmml"><mi id="S10.T3.1.1.1.m1.1.1a" xref="S10.T3.1.1.1.m1.1.1.cmml"></mi><mrow id="S10.T3.1.1.1.m1.1.1.1" xref="S10.T3.1.1.1.m1.1.1.1.cmml"><mi id="S10.T3.1.1.1.m1.1.1.1.2" xref="S10.T3.1.1.1.m1.1.1.1.2.cmml">o</mi><mo id="S10.T3.1.1.1.m1.1.1.1.1" xref="S10.T3.1.1.1.m1.1.1.1.1.cmml">â¢</mo><mi id="S10.T3.1.1.1.m1.1.1.1.3" xref="S10.T3.1.1.1.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.T3.1.1.1.m1.1b"><apply id="S10.T3.1.1.1.m1.1.1.cmml" xref="S10.T3.1.1.1.m1.1.1"><apply id="S10.T3.1.1.1.m1.1.1.1.cmml" xref="S10.T3.1.1.1.m1.1.1.1"><times id="S10.T3.1.1.1.m1.1.1.1.1.cmml" xref="S10.T3.1.1.1.m1.1.1.1.1"></times><ci id="S10.T3.1.1.1.m1.1.1.1.2.cmml" xref="S10.T3.1.1.1.m1.1.1.1.2">ğ‘œ</ci><ci id="S10.T3.1.1.1.m1.1.1.1.3.cmml" xref="S10.T3.1.1.1.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.1.1.1.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.1.1.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S10.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">C<math id="S10.T3.2.2.2.m1.1" class="ltx_Math" alttext="{}_{B}" display="inline"><semantics id="S10.T3.2.2.2.m1.1a"><msub id="S10.T3.2.2.2.m1.1.1" xref="S10.T3.2.2.2.m1.1.1.cmml"><mi id="S10.T3.2.2.2.m1.1.1a" xref="S10.T3.2.2.2.m1.1.1.cmml"></mi><mi id="S10.T3.2.2.2.m1.1.1.1" xref="S10.T3.2.2.2.m1.1.1.1.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.2.2.2.m1.1b"><apply id="S10.T3.2.2.2.m1.1.1.cmml" xref="S10.T3.2.2.2.m1.1.1"><ci id="S10.T3.2.2.2.m1.1.1.1.cmml" xref="S10.T3.2.2.2.m1.1.1.1">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.2.2.2.m1.1c">{}_{B}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.2.2.2.m1.1d">start_FLOATSUBSCRIPT italic_B end_FLOATSUBSCRIPT</annotation></semantics></math>+M<math id="S10.T3.3.3.3.m2.1" class="ltx_Math" alttext="{}_{D}" display="inline"><semantics id="S10.T3.3.3.3.m2.1a"><msub id="S10.T3.3.3.3.m2.1.1" xref="S10.T3.3.3.3.m2.1.1.cmml"><mi id="S10.T3.3.3.3.m2.1.1a" xref="S10.T3.3.3.3.m2.1.1.cmml"></mi><mi id="S10.T3.3.3.3.m2.1.1.1" xref="S10.T3.3.3.3.m2.1.1.1.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.3.3.3.m2.1b"><apply id="S10.T3.3.3.3.m2.1.1.cmml" xref="S10.T3.3.3.3.m2.1.1"><ci id="S10.T3.3.3.3.m2.1.1.1.cmml" xref="S10.T3.3.3.3.m2.1.1.1">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.3.3.3.m2.1c">{}_{D}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.3.3.3.m2.1d">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr id="S10.T3.7.7" class="ltx_tr">
<th id="S10.T3.7.7.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">2</th>
<td id="S10.T3.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">P<math id="S10.T3.4.4.1.m1.1" class="ltx_Math" alttext="{}_{os}" display="inline"><semantics id="S10.T3.4.4.1.m1.1a"><msub id="S10.T3.4.4.1.m1.1.1" xref="S10.T3.4.4.1.m1.1.1.cmml"><mi id="S10.T3.4.4.1.m1.1.1a" xref="S10.T3.4.4.1.m1.1.1.cmml"></mi><mrow id="S10.T3.4.4.1.m1.1.1.1" xref="S10.T3.4.4.1.m1.1.1.1.cmml"><mi id="S10.T3.4.4.1.m1.1.1.1.2" xref="S10.T3.4.4.1.m1.1.1.1.2.cmml">o</mi><mo id="S10.T3.4.4.1.m1.1.1.1.1" xref="S10.T3.4.4.1.m1.1.1.1.1.cmml">â¢</mo><mi id="S10.T3.4.4.1.m1.1.1.1.3" xref="S10.T3.4.4.1.m1.1.1.1.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.T3.4.4.1.m1.1b"><apply id="S10.T3.4.4.1.m1.1.1.cmml" xref="S10.T3.4.4.1.m1.1.1"><apply id="S10.T3.4.4.1.m1.1.1.1.cmml" xref="S10.T3.4.4.1.m1.1.1.1"><times id="S10.T3.4.4.1.m1.1.1.1.1.cmml" xref="S10.T3.4.4.1.m1.1.1.1.1"></times><ci id="S10.T3.4.4.1.m1.1.1.1.2.cmml" xref="S10.T3.4.4.1.m1.1.1.1.2">ğ‘œ</ci><ci id="S10.T3.4.4.1.m1.1.1.1.3.cmml" xref="S10.T3.4.4.1.m1.1.1.1.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.4.4.1.m1.1c">{}_{os}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.4.4.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S10.T3.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">C<math id="S10.T3.5.5.2.m1.1" class="ltx_Math" alttext="{}_{B}" display="inline"><semantics id="S10.T3.5.5.2.m1.1a"><msub id="S10.T3.5.5.2.m1.1.1" xref="S10.T3.5.5.2.m1.1.1.cmml"><mi id="S10.T3.5.5.2.m1.1.1a" xref="S10.T3.5.5.2.m1.1.1.cmml"></mi><mi id="S10.T3.5.5.2.m1.1.1.1" xref="S10.T3.5.5.2.m1.1.1.1.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.5.5.2.m1.1b"><apply id="S10.T3.5.5.2.m1.1.1.cmml" xref="S10.T3.5.5.2.m1.1.1"><ci id="S10.T3.5.5.2.m1.1.1.1.cmml" xref="S10.T3.5.5.2.m1.1.1.1">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.5.5.2.m1.1c">{}_{B}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.5.5.2.m1.1d">start_FLOATSUBSCRIPT italic_B end_FLOATSUBSCRIPT</annotation></semantics></math>+M<math id="S10.T3.6.6.3.m2.1" class="ltx_Math" alttext="{}_{D}" display="inline"><semantics id="S10.T3.6.6.3.m2.1a"><msub id="S10.T3.6.6.3.m2.1.1" xref="S10.T3.6.6.3.m2.1.1.cmml"><mi id="S10.T3.6.6.3.m2.1.1a" xref="S10.T3.6.6.3.m2.1.1.cmml"></mi><mi id="S10.T3.6.6.3.m2.1.1.1" xref="S10.T3.6.6.3.m2.1.1.1.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.6.6.3.m2.1b"><apply id="S10.T3.6.6.3.m2.1.1.cmml" xref="S10.T3.6.6.3.m2.1.1"><ci id="S10.T3.6.6.3.m2.1.1.1.cmml" xref="S10.T3.6.6.3.m2.1.1.1">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.6.6.3.m2.1c">{}_{D}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.6.6.3.m2.1d">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT</annotation></semantics></math>+P<math id="S10.T3.7.7.4.m3.1" class="ltx_Math" alttext="{}_{a}" display="inline"><semantics id="S10.T3.7.7.4.m3.1a"><msub id="S10.T3.7.7.4.m3.1.1" xref="S10.T3.7.7.4.m3.1.1.cmml"><mi id="S10.T3.7.7.4.m3.1.1a" xref="S10.T3.7.7.4.m3.1.1.cmml"></mi><mi id="S10.T3.7.7.4.m3.1.1.1" xref="S10.T3.7.7.4.m3.1.1.1.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.7.7.4.m3.1b"><apply id="S10.T3.7.7.4.m3.1.1.cmml" xref="S10.T3.7.7.4.m3.1.1"><ci id="S10.T3.7.7.4.m3.1.1.1.cmml" xref="S10.T3.7.7.4.m3.1.1.1">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.7.7.4.m3.1c">{}_{a}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.7.7.4.m3.1d">start_FLOATSUBSCRIPT italic_a end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr id="S10.T3.10.10" class="ltx_tr">
<th id="S10.T3.10.10.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">3</th>
<td id="S10.T3.8.8.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">P<math id="S10.T3.8.8.1.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S10.T3.8.8.1.m1.1a"><msub id="S10.T3.8.8.1.m1.1.1" xref="S10.T3.8.8.1.m1.1.1.cmml"><mi id="S10.T3.8.8.1.m1.1.1a" xref="S10.T3.8.8.1.m1.1.1.cmml"></mi><mrow id="S10.T3.8.8.1.m1.1.1.1" xref="S10.T3.8.8.1.m1.1.1.1.cmml"><mrow id="S10.T3.8.8.1.m1.1.1.1.2" xref="S10.T3.8.8.1.m1.1.1.1.2.cmml"><mi id="S10.T3.8.8.1.m1.1.1.1.2.2" xref="S10.T3.8.8.1.m1.1.1.1.2.2.cmml">o</mi><mo id="S10.T3.8.8.1.m1.1.1.1.2.1" xref="S10.T3.8.8.1.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S10.T3.8.8.1.m1.1.1.1.2.3" xref="S10.T3.8.8.1.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S10.T3.8.8.1.m1.1.1.1.1" xref="S10.T3.8.8.1.m1.1.1.1.1.cmml">+</mo><mi id="S10.T3.8.8.1.m1.1.1.1.3" xref="S10.T3.8.8.1.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.T3.8.8.1.m1.1b"><apply id="S10.T3.8.8.1.m1.1.1.cmml" xref="S10.T3.8.8.1.m1.1.1"><apply id="S10.T3.8.8.1.m1.1.1.1.cmml" xref="S10.T3.8.8.1.m1.1.1.1"><plus id="S10.T3.8.8.1.m1.1.1.1.1.cmml" xref="S10.T3.8.8.1.m1.1.1.1.1"></plus><apply id="S10.T3.8.8.1.m1.1.1.1.2.cmml" xref="S10.T3.8.8.1.m1.1.1.1.2"><times id="S10.T3.8.8.1.m1.1.1.1.2.1.cmml" xref="S10.T3.8.8.1.m1.1.1.1.2.1"></times><ci id="S10.T3.8.8.1.m1.1.1.1.2.2.cmml" xref="S10.T3.8.8.1.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S10.T3.8.8.1.m1.1.1.1.2.3.cmml" xref="S10.T3.8.8.1.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S10.T3.8.8.1.m1.1.1.1.3.cmml" xref="S10.T3.8.8.1.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.8.8.1.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.8.8.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S10.T3.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">C<math id="S10.T3.9.9.2.m1.1" class="ltx_Math" alttext="{}_{B}" display="inline"><semantics id="S10.T3.9.9.2.m1.1a"><msub id="S10.T3.9.9.2.m1.1.1" xref="S10.T3.9.9.2.m1.1.1.cmml"><mi id="S10.T3.9.9.2.m1.1.1a" xref="S10.T3.9.9.2.m1.1.1.cmml"></mi><mi id="S10.T3.9.9.2.m1.1.1.1" xref="S10.T3.9.9.2.m1.1.1.1.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.9.9.2.m1.1b"><apply id="S10.T3.9.9.2.m1.1.1.cmml" xref="S10.T3.9.9.2.m1.1.1"><ci id="S10.T3.9.9.2.m1.1.1.1.cmml" xref="S10.T3.9.9.2.m1.1.1.1">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.9.9.2.m1.1c">{}_{B}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.9.9.2.m1.1d">start_FLOATSUBSCRIPT italic_B end_FLOATSUBSCRIPT</annotation></semantics></math>+M<math id="S10.T3.10.10.3.m2.1" class="ltx_Math" alttext="{}_{D}" display="inline"><semantics id="S10.T3.10.10.3.m2.1a"><msub id="S10.T3.10.10.3.m2.1.1" xref="S10.T3.10.10.3.m2.1.1.cmml"><mi id="S10.T3.10.10.3.m2.1.1a" xref="S10.T3.10.10.3.m2.1.1.cmml"></mi><mi id="S10.T3.10.10.3.m2.1.1.1" xref="S10.T3.10.10.3.m2.1.1.1.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.10.10.3.m2.1b"><apply id="S10.T3.10.10.3.m2.1.1.cmml" xref="S10.T3.10.10.3.m2.1.1"><ci id="S10.T3.10.10.3.m2.1.1.1.cmml" xref="S10.T3.10.10.3.m2.1.1.1">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.10.10.3.m2.1c">{}_{D}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.10.10.3.m2.1d">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr id="S10.T3.14.14" class="ltx_tr">
<th id="S10.T3.14.14.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">4</th>
<td id="S10.T3.11.11.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">P<math id="S10.T3.11.11.1.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S10.T3.11.11.1.m1.1a"><msub id="S10.T3.11.11.1.m1.1.1" xref="S10.T3.11.11.1.m1.1.1.cmml"><mi id="S10.T3.11.11.1.m1.1.1a" xref="S10.T3.11.11.1.m1.1.1.cmml"></mi><mrow id="S10.T3.11.11.1.m1.1.1.1" xref="S10.T3.11.11.1.m1.1.1.1.cmml"><mrow id="S10.T3.11.11.1.m1.1.1.1.2" xref="S10.T3.11.11.1.m1.1.1.1.2.cmml"><mi id="S10.T3.11.11.1.m1.1.1.1.2.2" xref="S10.T3.11.11.1.m1.1.1.1.2.2.cmml">o</mi><mo id="S10.T3.11.11.1.m1.1.1.1.2.1" xref="S10.T3.11.11.1.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S10.T3.11.11.1.m1.1.1.1.2.3" xref="S10.T3.11.11.1.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S10.T3.11.11.1.m1.1.1.1.1" xref="S10.T3.11.11.1.m1.1.1.1.1.cmml">+</mo><mi id="S10.T3.11.11.1.m1.1.1.1.3" xref="S10.T3.11.11.1.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.T3.11.11.1.m1.1b"><apply id="S10.T3.11.11.1.m1.1.1.cmml" xref="S10.T3.11.11.1.m1.1.1"><apply id="S10.T3.11.11.1.m1.1.1.1.cmml" xref="S10.T3.11.11.1.m1.1.1.1"><plus id="S10.T3.11.11.1.m1.1.1.1.1.cmml" xref="S10.T3.11.11.1.m1.1.1.1.1"></plus><apply id="S10.T3.11.11.1.m1.1.1.1.2.cmml" xref="S10.T3.11.11.1.m1.1.1.1.2"><times id="S10.T3.11.11.1.m1.1.1.1.2.1.cmml" xref="S10.T3.11.11.1.m1.1.1.1.2.1"></times><ci id="S10.T3.11.11.1.m1.1.1.1.2.2.cmml" xref="S10.T3.11.11.1.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S10.T3.11.11.1.m1.1.1.1.2.3.cmml" xref="S10.T3.11.11.1.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S10.T3.11.11.1.m1.1.1.1.3.cmml" xref="S10.T3.11.11.1.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.11.11.1.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.11.11.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S10.T3.14.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">C<math id="S10.T3.12.12.2.m1.1" class="ltx_Math" alttext="{}_{B}" display="inline"><semantics id="S10.T3.12.12.2.m1.1a"><msub id="S10.T3.12.12.2.m1.1.1" xref="S10.T3.12.12.2.m1.1.1.cmml"><mi id="S10.T3.12.12.2.m1.1.1a" xref="S10.T3.12.12.2.m1.1.1.cmml"></mi><mi id="S10.T3.12.12.2.m1.1.1.1" xref="S10.T3.12.12.2.m1.1.1.1.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.12.12.2.m1.1b"><apply id="S10.T3.12.12.2.m1.1.1.cmml" xref="S10.T3.12.12.2.m1.1.1"><ci id="S10.T3.12.12.2.m1.1.1.1.cmml" xref="S10.T3.12.12.2.m1.1.1.1">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.12.12.2.m1.1c">{}_{B}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.12.12.2.m1.1d">start_FLOATSUBSCRIPT italic_B end_FLOATSUBSCRIPT</annotation></semantics></math>+M<math id="S10.T3.13.13.3.m2.1" class="ltx_math_unparsed" alttext="{}_{D}+" display="inline"><semantics id="S10.T3.13.13.3.m2.1a"><mmultiscripts id="S10.T3.13.13.3.m2.1.1"><mo id="S10.T3.13.13.3.m2.1.1.2">+</mo><mprescripts id="S10.T3.13.13.3.m2.1.1a"></mprescripts><mi id="S10.T3.13.13.3.m2.1.1.3">D</mi><mrow id="S10.T3.13.13.3.m2.1.1b"></mrow></mmultiscripts><annotation encoding="application/x-tex" id="S10.T3.13.13.3.m2.1b">{}_{D}+</annotation><annotation encoding="application/x-llamapun" id="S10.T3.13.13.3.m2.1c">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT +</annotation></semantics></math>P<math id="S10.T3.14.14.4.m3.1" class="ltx_Math" alttext="{}_{a}" display="inline"><semantics id="S10.T3.14.14.4.m3.1a"><msub id="S10.T3.14.14.4.m3.1.1" xref="S10.T3.14.14.4.m3.1.1.cmml"><mi id="S10.T3.14.14.4.m3.1.1a" xref="S10.T3.14.14.4.m3.1.1.cmml"></mi><mi id="S10.T3.14.14.4.m3.1.1.1" xref="S10.T3.14.14.4.m3.1.1.1.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.14.14.4.m3.1b"><apply id="S10.T3.14.14.4.m3.1.1.cmml" xref="S10.T3.14.14.4.m3.1.1"><ci id="S10.T3.14.14.4.m3.1.1.1.cmml" xref="S10.T3.14.14.4.m3.1.1.1">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.14.14.4.m3.1c">{}_{a}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.14.14.4.m3.1d">start_FLOATSUBSCRIPT italic_a end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr id="S10.T3.18.18" class="ltx_tr">
<th id="S10.T3.18.18.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">5</th>
<td id="S10.T3.15.15.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">P<math id="S10.T3.15.15.1.m1.1" class="ltx_Math" alttext="{}_{os+g}" display="inline"><semantics id="S10.T3.15.15.1.m1.1a"><msub id="S10.T3.15.15.1.m1.1.1" xref="S10.T3.15.15.1.m1.1.1.cmml"><mi id="S10.T3.15.15.1.m1.1.1a" xref="S10.T3.15.15.1.m1.1.1.cmml"></mi><mrow id="S10.T3.15.15.1.m1.1.1.1" xref="S10.T3.15.15.1.m1.1.1.1.cmml"><mrow id="S10.T3.15.15.1.m1.1.1.1.2" xref="S10.T3.15.15.1.m1.1.1.1.2.cmml"><mi id="S10.T3.15.15.1.m1.1.1.1.2.2" xref="S10.T3.15.15.1.m1.1.1.1.2.2.cmml">o</mi><mo id="S10.T3.15.15.1.m1.1.1.1.2.1" xref="S10.T3.15.15.1.m1.1.1.1.2.1.cmml">â¢</mo><mi id="S10.T3.15.15.1.m1.1.1.1.2.3" xref="S10.T3.15.15.1.m1.1.1.1.2.3.cmml">s</mi></mrow><mo id="S10.T3.15.15.1.m1.1.1.1.1" xref="S10.T3.15.15.1.m1.1.1.1.1.cmml">+</mo><mi id="S10.T3.15.15.1.m1.1.1.1.3" xref="S10.T3.15.15.1.m1.1.1.1.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.T3.15.15.1.m1.1b"><apply id="S10.T3.15.15.1.m1.1.1.cmml" xref="S10.T3.15.15.1.m1.1.1"><apply id="S10.T3.15.15.1.m1.1.1.1.cmml" xref="S10.T3.15.15.1.m1.1.1.1"><plus id="S10.T3.15.15.1.m1.1.1.1.1.cmml" xref="S10.T3.15.15.1.m1.1.1.1.1"></plus><apply id="S10.T3.15.15.1.m1.1.1.1.2.cmml" xref="S10.T3.15.15.1.m1.1.1.1.2"><times id="S10.T3.15.15.1.m1.1.1.1.2.1.cmml" xref="S10.T3.15.15.1.m1.1.1.1.2.1"></times><ci id="S10.T3.15.15.1.m1.1.1.1.2.2.cmml" xref="S10.T3.15.15.1.m1.1.1.1.2.2">ğ‘œ</ci><ci id="S10.T3.15.15.1.m1.1.1.1.2.3.cmml" xref="S10.T3.15.15.1.m1.1.1.1.2.3">ğ‘ </ci></apply><ci id="S10.T3.15.15.1.m1.1.1.1.3.cmml" xref="S10.T3.15.15.1.m1.1.1.1.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.15.15.1.m1.1c">{}_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.15.15.1.m1.1d">start_FLOATSUBSCRIPT italic_o italic_s + italic_g end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
<td id="S10.T3.18.18.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">C<math id="S10.T3.16.16.2.m1.1" class="ltx_Math" alttext="{}_{B}" display="inline"><semantics id="S10.T3.16.16.2.m1.1a"><msub id="S10.T3.16.16.2.m1.1.1" xref="S10.T3.16.16.2.m1.1.1.cmml"><mi id="S10.T3.16.16.2.m1.1.1a" xref="S10.T3.16.16.2.m1.1.1.cmml"></mi><mi id="S10.T3.16.16.2.m1.1.1.1" xref="S10.T3.16.16.2.m1.1.1.1.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.16.16.2.m1.1b"><apply id="S10.T3.16.16.2.m1.1.1.cmml" xref="S10.T3.16.16.2.m1.1.1"><ci id="S10.T3.16.16.2.m1.1.1.1.cmml" xref="S10.T3.16.16.2.m1.1.1.1">ğµ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.16.16.2.m1.1c">{}_{B}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.16.16.2.m1.1d">start_FLOATSUBSCRIPT italic_B end_FLOATSUBSCRIPT</annotation></semantics></math>+M<math id="S10.T3.17.17.3.m2.1" class="ltx_Math" alttext="{}_{D}" display="inline"><semantics id="S10.T3.17.17.3.m2.1a"><msub id="S10.T3.17.17.3.m2.1.1" xref="S10.T3.17.17.3.m2.1.1.cmml"><mi id="S10.T3.17.17.3.m2.1.1a" xref="S10.T3.17.17.3.m2.1.1.cmml"></mi><mi id="S10.T3.17.17.3.m2.1.1.1" xref="S10.T3.17.17.3.m2.1.1.1.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S10.T3.17.17.3.m2.1b"><apply id="S10.T3.17.17.3.m2.1.1.cmml" xref="S10.T3.17.17.3.m2.1.1"><ci id="S10.T3.17.17.3.m2.1.1.1.cmml" xref="S10.T3.17.17.3.m2.1.1.1">ğ·</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.17.17.3.m2.1c">{}_{D}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.17.17.3.m2.1d">start_FLOATSUBSCRIPT italic_D end_FLOATSUBSCRIPT</annotation></semantics></math>+P<math id="S10.T3.18.18.4.m3.1" class="ltx_Math" alttext="{}_{a+cpu}" display="inline"><semantics id="S10.T3.18.18.4.m3.1a"><msub id="S10.T3.18.18.4.m3.1.1" xref="S10.T3.18.18.4.m3.1.1.cmml"><mi id="S10.T3.18.18.4.m3.1.1a" xref="S10.T3.18.18.4.m3.1.1.cmml"></mi><mrow id="S10.T3.18.18.4.m3.1.1.1" xref="S10.T3.18.18.4.m3.1.1.1.cmml"><mi id="S10.T3.18.18.4.m3.1.1.1.2" xref="S10.T3.18.18.4.m3.1.1.1.2.cmml">a</mi><mo id="S10.T3.18.18.4.m3.1.1.1.1" xref="S10.T3.18.18.4.m3.1.1.1.1.cmml">+</mo><mrow id="S10.T3.18.18.4.m3.1.1.1.3" xref="S10.T3.18.18.4.m3.1.1.1.3.cmml"><mi id="S10.T3.18.18.4.m3.1.1.1.3.2" xref="S10.T3.18.18.4.m3.1.1.1.3.2.cmml">c</mi><mo id="S10.T3.18.18.4.m3.1.1.1.3.1" xref="S10.T3.18.18.4.m3.1.1.1.3.1.cmml">â¢</mo><mi id="S10.T3.18.18.4.m3.1.1.1.3.3" xref="S10.T3.18.18.4.m3.1.1.1.3.3.cmml">p</mi><mo id="S10.T3.18.18.4.m3.1.1.1.3.1a" xref="S10.T3.18.18.4.m3.1.1.1.3.1.cmml">â¢</mo><mi id="S10.T3.18.18.4.m3.1.1.1.3.4" xref="S10.T3.18.18.4.m3.1.1.1.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.T3.18.18.4.m3.1b"><apply id="S10.T3.18.18.4.m3.1.1.cmml" xref="S10.T3.18.18.4.m3.1.1"><apply id="S10.T3.18.18.4.m3.1.1.1.cmml" xref="S10.T3.18.18.4.m3.1.1.1"><plus id="S10.T3.18.18.4.m3.1.1.1.1.cmml" xref="S10.T3.18.18.4.m3.1.1.1.1"></plus><ci id="S10.T3.18.18.4.m3.1.1.1.2.cmml" xref="S10.T3.18.18.4.m3.1.1.1.2">ğ‘</ci><apply id="S10.T3.18.18.4.m3.1.1.1.3.cmml" xref="S10.T3.18.18.4.m3.1.1.1.3"><times id="S10.T3.18.18.4.m3.1.1.1.3.1.cmml" xref="S10.T3.18.18.4.m3.1.1.1.3.1"></times><ci id="S10.T3.18.18.4.m3.1.1.1.3.2.cmml" xref="S10.T3.18.18.4.m3.1.1.1.3.2">ğ‘</ci><ci id="S10.T3.18.18.4.m3.1.1.1.3.3.cmml" xref="S10.T3.18.18.4.m3.1.1.1.3.3">ğ‘</ci><ci id="S10.T3.18.18.4.m3.1.1.1.3.4.cmml" xref="S10.T3.18.18.4.m3.1.1.1.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.T3.18.18.4.m3.1c">{}_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S10.T3.18.18.4.m3.1d">start_FLOATSUBSCRIPT italic_a + italic_c italic_p italic_u end_FLOATSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S10.T3.21.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><em id="S10.T3.22.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ZeRO</em><span id="S10.T3.23.3" class="ltx_text" style="font-size:90%;"> configurations</span></figcaption>
</figure>
</section>
<section id="S10.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">10.3 </span>Super-Linear Scalability</h3>

<div id="S10.SS3.p1" class="ltx_para">
<p id="S10.SS3.p1.1" class="ltx_p"><em id="S10.SS3.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-100B demonstrates super-linear scalability for very large model sizes. FigureÂ <a href="#S1.F3" title="Figure 3 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows scalability results for a 60B parameter model going from 64 to 400 GPUs and we expect this trend to continue further for more GPUs. <math id="S10.SS3.p1.1.m1.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S10.SS3.p1.1.m1.1a"><msub id="S10.SS3.p1.1.m1.1.1" xref="S10.SS3.p1.1.m1.1.1.cmml"><mi id="S10.SS3.p1.1.m1.1.1.2" xref="S10.SS3.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S10.SS3.p1.1.m1.1.1.3" xref="S10.SS3.p1.1.m1.1.1.3.cmml"><mrow id="S10.SS3.p1.1.m1.1.1.3.2" xref="S10.SS3.p1.1.m1.1.1.3.2.cmml"><mi id="S10.SS3.p1.1.m1.1.1.3.2.2" xref="S10.SS3.p1.1.m1.1.1.3.2.2.cmml">o</mi><mo id="S10.SS3.p1.1.m1.1.1.3.2.1" xref="S10.SS3.p1.1.m1.1.1.3.2.1.cmml">â¢</mo><mi id="S10.SS3.p1.1.m1.1.1.3.2.3" xref="S10.SS3.p1.1.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S10.SS3.p1.1.m1.1.1.3.1" xref="S10.SS3.p1.1.m1.1.1.3.1.cmml">+</mo><mi id="S10.SS3.p1.1.m1.1.1.3.3" xref="S10.SS3.p1.1.m1.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS3.p1.1.m1.1b"><apply id="S10.SS3.p1.1.m1.1.1.cmml" xref="S10.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S10.SS3.p1.1.m1.1.1.1.cmml" xref="S10.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S10.SS3.p1.1.m1.1.1.2.cmml" xref="S10.SS3.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S10.SS3.p1.1.m1.1.1.3.cmml" xref="S10.SS3.p1.1.m1.1.1.3"><plus id="S10.SS3.p1.1.m1.1.1.3.1.cmml" xref="S10.SS3.p1.1.m1.1.1.3.1"></plus><apply id="S10.SS3.p1.1.m1.1.1.3.2.cmml" xref="S10.SS3.p1.1.m1.1.1.3.2"><times id="S10.SS3.p1.1.m1.1.1.3.2.1.cmml" xref="S10.SS3.p1.1.m1.1.1.3.2.1"></times><ci id="S10.SS3.p1.1.m1.1.1.3.2.2.cmml" xref="S10.SS3.p1.1.m1.1.1.3.2.2">ğ‘œ</ci><ci id="S10.SS3.p1.1.m1.1.1.3.2.3.cmml" xref="S10.SS3.p1.1.m1.1.1.3.2.3">ğ‘ </ci></apply><ci id="S10.SS3.p1.1.m1.1.1.3.3.cmml" xref="S10.SS3.p1.1.m1.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS3.p1.1.m1.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.SS3.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> reduces per GPU memory consumption of <em id="S10.SS3.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B with increase in DP degree, allowing <em id="S10.SS3.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>-100B to fit larger batch sizes per GPU<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Increasing batch size too much can lead to poor convergence, but for these large models, we are still in a regime where batch size is small enough even with 1K GPU and it does not affect convergence rate</span></span></span>, which in turn improves throughput as a result of increasing arithmetic intensity.
</p>
</div>
</section>
<section id="S10.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">10.4 </span>Democratizing Large Model Training</h3>

<div id="S10.SS4.p1" class="ltx_para">
<p id="S10.SS4.p1.1" class="ltx_p">Using MP and PP is challenging for many data scientists, which is a well-known hurdle to train large models. <em id="S10.SS4.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> does not require any changes to the model itself and it can be used as simple as baseline DP while delivering significantly boosted model size and speed. Fig.Â <a href="#S9.F5" title="Figure 5 â€£ 9 Step Towards 1 Trillion Parameters â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that <em id="S10.SS4.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B can train models with up to 13B parameters without MP on 128 GPUs, achieving throughput over 40â€‰TFlops per GPU on average. In comparison, without <em id="S10.SS4.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em>, the largest trainable model with DP alone has 1.4B parameters with throughput less than 20â€‰TFlops per GPU.
Furthermore, in the absence of the communication overhead from MP, these models can be trained with lower-end compute nodes without very fast intra-node interconnect such as NVLINK or NVSwitch, which is required to achieve good efficiency with MP.
</p>
</div>
</section>
<section id="S10.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">10.5 </span>Memory and Performance Analysis</h3>

<div id="S10.SS5.p1" class="ltx_para">
<p id="S10.SS5.p1.1" class="ltx_p">We look into the benefits and impact of different optimizations on maximum model size, memory consumption and performance. These optimizations are referred to as Config 1 to 5 (C1-C5) in Table.Â <a href="#S10.T3" title="Table 3 â€£ 10.2 Speed and Model Size â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<section id="S10.SS5.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Maximum Model Size</h5>

<div id="S10.SS5.SSS0.Px1.p1" class="ltx_para">
<p id="S10.SS5.SSS0.Px1.p1.3" class="ltx_p">FigureÂ <a href="#S10.F6" title="Figure 6 â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the largest trainable model by enabling different <em id="S10.SS5.SSS0.Px1.p1.3.1" class="ltx_emph ltx_font_italic">ZeRO</em> optimizations for a fixed batch size and MP of 16. The model size increase from 40B to 60B when trained with C1 vs C2 due to a 16x (MP degree) reduction in activation memory from using <math id="S10.SS5.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="P_{a}" display="inline"><semantics id="S10.SS5.SSS0.Px1.p1.1.m1.1a"><msub id="S10.SS5.SSS0.Px1.p1.1.m1.1.1" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S10.SS5.SSS0.Px1.p1.1.m1.1.1.2" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml">P</mi><mi id="S10.SS5.SSS0.Px1.p1.1.m1.1.1.3" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S10.SS5.SSS0.Px1.p1.1.m1.1b"><apply id="S10.SS5.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S10.SS5.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S10.SS5.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1.2">ğ‘ƒ</ci><ci id="S10.SS5.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S10.SS5.SSS0.Px1.p1.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS5.SSS0.Px1.p1.1.m1.1c">P_{a}</annotation><annotation encoding="application/x-llamapun" id="S10.SS5.SSS0.Px1.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>, while the jump to 140B using C4 is from enabling <math id="S10.SS5.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="P_{os+g}" display="inline"><semantics id="S10.SS5.SSS0.Px1.p1.2.m2.1a"><msub id="S10.SS5.SSS0.Px1.p1.2.m2.1.1" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.2" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml">P</mi><mrow id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mrow id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.cmml"><mi id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.2" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.2.cmml">o</mi><mo id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.1" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.3" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.3.cmml">s</mi></mrow><mo id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.1" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">+</mo><mi id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS5.SSS0.Px1.p1.2.m2.1b"><apply id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3"><plus id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.1"></plus><apply id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2"><times id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.1.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.1"></times><ci id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.2.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.2">ğ‘œ</ci><ci id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.3.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.2.3">ğ‘ </ci></apply><ci id="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S10.SS5.SSS0.Px1.p1.2.m2.1.1.3.3">ğ‘”</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS5.SSS0.Px1.p1.2.m2.1c">P_{os+g}</annotation><annotation encoding="application/x-llamapun" id="S10.SS5.SSS0.Px1.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s + italic_g end_POSTSUBSCRIPT</annotation></semantics></math> which halves the memory requirement by the model states compared to <math id="S10.SS5.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="P_{os}" display="inline"><semantics id="S10.SS5.SSS0.Px1.p1.3.m3.1a"><msub id="S10.SS5.SSS0.Px1.p1.3.m3.1.1" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.2" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml">P</mi><mrow id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">o</mi><mo id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.1" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS5.SSS0.Px1.p1.3.m3.1b"><apply id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.2">ğ‘ƒ</ci><apply id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3"><times id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.1"></times><ci id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.2">ğ‘œ</ci><ci id="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S10.SS5.SSS0.Px1.p1.3.m3.1.1.3.3">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS5.SSS0.Px1.p1.3.m3.1c">P_{os}</annotation><annotation encoding="application/x-llamapun" id="S10.SS5.SSS0.Px1.p1.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> in C2. The increase to 150B using C5 is solely due to further reduction in activation memory from offloading the partitioned activation checkpoints to the CPU memory.</p>
</div>
</section>
<section id="S10.SS5.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Max Cached Memory</h5>

<div id="S10.SS5.SSS0.Px2.p1" class="ltx_para">
<p id="S10.SS5.SSS0.Px2.p1.2" class="ltx_p">FigureÂ <a href="#S10.F7" title="Figure 7 â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the maximum memory cached by PyTorch during each training iteration for a 40B and a 100B parameter model. The decrease of the cached memory size is as expected from C1 to C2. The difference in memory consumption between C2 and C3 depends on the size of the model states in comparison to the activation memory, and can increase when activation memory is larger, or decrease when the model states are larger. It is note worthy that the cached memory does not decrease from C4 to C5 for 40B but it does for 100B. This is simply because the activation memory for 100B is much larger for the decrease to be noticeable. This makes <math id="S10.SS5.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S10.SS5.SSS0.Px2.p1.1.m1.1a"><msub id="S10.SS5.SSS0.Px2.p1.1.m1.1.1" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.2" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">a</mi><mo id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.1" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mi id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">c</mi><mo id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.1" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml">p</mi><mo id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.1a" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.4" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS5.SSS0.Px2.p1.1.m1.1b"><apply id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3"><plus id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.1"></plus><ci id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.2">ğ‘</ci><apply id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3"><times id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.1"></times><ci id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.2">ğ‘</ci><ci id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.3">ğ‘</ci><ci id="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml" xref="S10.SS5.SSS0.Px2.p1.1.m1.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS5.SSS0.Px2.p1.1.m1.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S10.SS5.SSS0.Px2.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> a valuable tool to fit a larger batch size when we get to very large models. In FigureÂ <a href="#S10.F8" title="Figure 8 â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, <math id="S10.SS5.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S10.SS5.SSS0.Px2.p1.2.m2.1a"><msub id="S10.SS5.SSS0.Px2.p1.2.m2.1.1" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.2" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.2.cmml">P</mi><mrow id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">a</mi><mo id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.1" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">+</mo><mrow id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.cmml"><mi id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.2" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml">c</mi><mo id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.1" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.3" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml">p</mi><mo id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.1a" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.4" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS5.SSS0.Px2.p1.2.m2.1b"><apply id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.2">ğ‘ƒ</ci><apply id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3"><plus id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.1"></plus><ci id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.2">ğ‘</ci><apply id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3"><times id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.1"></times><ci id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.2">ğ‘</ci><ci id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.3">ğ‘</ci><ci id="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.4.cmml" xref="S10.SS5.SSS0.Px2.p1.2.m2.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS5.SSS0.Px2.p1.2.m2.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S10.SS5.SSS0.Px2.p1.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is needed for 170B model to execute without running out of memory.</p>
</div>
<figure id="S10.T4" class="ltx_table">
<table id="S10.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S10.T4.2.1.1" class="ltx_tr">
<th id="S10.T4.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3">Figure Â <a href="#S1.F2" title="Figure 2 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a></th>
<th id="S10.T4.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">Figures Â <a href="#S1.F3" title="Figure 3 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, <a href="#S9.F5" title="Figure 5 â€£ 9 Step Towards 1 Trillion Parameters â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a></th>
</tr>
<tr id="S10.T4.2.2.2" class="ltx_tr">
<th id="S10.T4.2.2.2.1" class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S10.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Layers</th>
<th id="S10.T4.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">HD</th>
<th id="S10.T4.2.2.2.4" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_t"></th>
<th id="S10.T4.2.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Layers</th>
<th id="S10.T4.2.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">HD</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S10.T4.2.3.1" class="ltx_tr">
<td id="S10.T4.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">1.5B</td>
<td id="S10.T4.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">48</td>
<td id="S10.T4.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1600</td>
<td id="S10.T4.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1.16B-2.5B</td>
<td id="S10.T4.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">24,34,54</td>
<td id="S10.T4.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">1920</td>
</tr>
<tr id="S10.T4.2.4.2" class="ltx_tr">
<td id="S10.T4.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">8B</td>
<td id="S10.T4.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">72</td>
<td id="S10.T4.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">3072</td>
<td id="S10.T4.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">4B</td>
<td id="S10.T4.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">64</td>
<td id="S10.T4.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">2304</td>
</tr>
<tr id="S10.T4.2.5.3" class="ltx_tr">
<td id="S10.T4.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">40B-60B</td>
<td id="S10.T4.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">88,132</td>
<td id="S10.T4.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">4096</td>
<td id="S10.T4.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">6B-8B</td>
<td id="S10.T4.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">52,72</td>
<td id="S10.T4.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">3072</td>
</tr>
<tr id="S10.T4.2.6.4" class="ltx_tr">
<td id="S10.T4.2.6.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t">80B-170B</td>
<td id="S10.T4.2.6.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">100,125,150</td>
<td id="S10.T4.2.6.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">8192</td>
<td id="S10.T4.2.6.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">10B-13B</td>
<td id="S10.T4.2.6.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">50,54,58,62</td>
<td id="S10.T4.2.6.4.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">4096</td>
</tr>
<tr id="S10.T4.2.7.5" class="ltx_tr">
<td id="S10.T4.2.7.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t">140B-170B</td>
<td id="S10.T4.2.7.5.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">175,212</td>
<td id="S10.T4.2.7.5.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">8192</td>
<td id="S10.T4.2.7.5.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">60B</td>
<td id="S10.T4.2.7.5.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">75</td>
<td id="S10.T4.2.7.5.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">8192</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S10.T4.3.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S10.T4.4.2" class="ltx_text" style="font-size:90%;">Configurations for different model sizes, number of layers, and hidden dimensions (HD) across FiguresÂ <a href="#S1.F2" title="Figure 2 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <a href="#S1.F3" title="Figure 3 â€£ 1 Extended Introduction â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, <a href="#S9.F5" title="Figure 5 â€£ 9 Step Towards 1 Trillion Parameters â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</span></figcaption>
</figure>
</section>
<section id="S10.SS5.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Max Achievable Performance</h5>

<div id="S10.SS5.SSS0.Px3.p1" class="ltx_para">
<p id="S10.SS5.SSS0.Px3.p1.1" class="ltx_p">FigureÂ <a href="#S10.F8" title="Figure 8 â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the best achievable performance for different set of optimizations. Notice that performance improvement corresponds to decrease in memory consumption between the optimizations. As mentioned earlier, lower memory consumption allows for larger batch size which improves performance. The only caveat is the performance drop between C4 and C5 for 60B parameter model. Despite lower memory consumption, C5 incurs activation movement to and from the CPU, this will result in worse performance in most cases, except for a few where the model is so large that the model simply cannot run without C5 or the batch size that can run without C5 is very small (such as model with 170B parameters in FigureÂ <a href="#S10.F8" title="Figure 8 â€£ 10 Implementation and Evaluation â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). During training, <math id="S10.SS5.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="P_{a+cpu}" display="inline"><semantics id="S10.SS5.SSS0.Px3.p1.1.m1.1a"><msub id="S10.SS5.SSS0.Px3.p1.1.m1.1.1" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.2" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.2.cmml">P</mi><mrow id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.cmml"><mi id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.2" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.2.cmml">a</mi><mo id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.1" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.cmml"><mi id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.2" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.2.cmml">c</mi><mo id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.1" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.3" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.3.cmml">p</mi><mo id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.1a" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.1.cmml">â¢</mo><mi id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.4" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.4.cmml">u</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S10.SS5.SSS0.Px3.p1.1.m1.1b"><apply id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.2">ğ‘ƒ</ci><apply id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3"><plus id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.1.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.1"></plus><ci id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.2.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.2">ğ‘</ci><apply id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3"><times id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.1.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.1"></times><ci id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.2.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.2">ğ‘</ci><ci id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.3.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.3">ğ‘</ci><ci id="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.4.cmml" xref="S10.SS5.SSS0.Px3.p1.1.m1.1.1.3.3.4">ğ‘¢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.SS5.SSS0.Px3.p1.1.m1.1c">P_{a+cpu}</annotation><annotation encoding="application/x-llamapun" id="S10.SS5.SSS0.Px3.p1.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_a + italic_c italic_p italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is turned on only when it is beneficial.</p>
</div>
</section>
</section>
<section id="S10.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">10.6 </span>Turing-NLG, the SOTA language model with 17B parameters</h3>

<div id="S10.SS6.p1" class="ltx_para">
<p id="S10.SS6.p1.1" class="ltx_p">As of May 12th, 2020, Turing-NLG is the largest model in the world with over 17B parameters. It achieved the new SOTA for language models with Webtext-103 perplexity of 10.21. Turing-NLG was trained end-to-end using <em id="S10.SS6.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em>-100B and Fig.Â <a href="#S9.F5" title="Figure 5 â€£ 9 Step Towards 1 Trillion Parameters â€£ ZeRO: Memory Optimizations Toward Training Trillion Parameter Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the validation perplexity over 300K iterations compared to previous SOTA, Megatron-LM 8.3B parameter model. <em id="S10.SS6.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B achieves a sustained throughput of 41.4â€‰TFlops/GPU for this model.</p>
</div>
</section>
</section>
<section id="S11" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">11 </span>Concluding Remarks</h2>

<div id="S11.p1" class="ltx_para">
<p id="S11.p1.1" class="ltx_p">From a HPC and system perspective, we believe that <em id="S11.p1.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> represents a revolutionary transformation in the large model training landscape. While our implementation, <em id="S11.p1.1.2" class="ltx_emph ltx_font_italic">ZeRO</em>-100B, enables 8x increase in model sizes, over 10x in throughput improvement, achieves super-linear speedups on modern GPU clusters, and trains the largest model in the world, it is still just a tip of the iceberg. <em id="S11.p1.1.3" class="ltx_emph ltx_font_italic">ZeRO</em> in its entirety has the potential to increase the model size by yet another order of magnitude, enabling the training of trillion parameter models of the future.</p>
</div>
<div id="S11.p2" class="ltx_para">
<p id="S11.p2.1" class="ltx_p">Perhaps, what we feel most optimistic about <em id="S11.p2.1.1" class="ltx_emph ltx_font_italic">ZeRO</em> is that it imposes no hurdles on the data scientists. Unlike existing approaches such as MP and PP, no model refactoring is necessary, and it is as easy to use as standard DP, making <em id="S11.p2.1.2" class="ltx_emph ltx_font_italic">ZeRO</em> a prime candidate for future investigations on large model training. Through open sourcing and community feedback, we plan to make <em id="S11.p2.1.3" class="ltx_emph ltx_font_italic">ZeRO</em> fully accessible to the DL community to catalyze the evolution and democratization of large model training at scale.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p">We thank Junhua Wang for his valuable support and advice. We thank Minjia
Zhang, Elton Zheng, Shaden Smith, Reza Yazdani Aminabadi, Arash Ashari, and
Niranjan Uma Naresh for their great feedback and help on evaluating the work.
We thank Brandon Norick, Corby Rossett, Gopi Kumar, Jack Zhang, Jing Zhao,
Payal Bajaj, Rangan Majumder, Saksham Singhal, Saurabh Tiwary, and Xia Song for
many helpful discussions and suggestions.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">BERT: pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1810.04805, 2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya
Sutskever.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Mohammad Shoeybi, Mostofa Patwary, Raul Puri, Patrick LeGresley, Jared Casper,
and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Megatron-lm: Training multi-billion parameter language models using
model parallelism, 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael
Matena, Yanqi Zhou, Wei Li, and PeterÂ J. Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Noam Shazeer, Youlong Cheng, Niki Parmar, Dustin Tran, Ashish Vaswani, Penporn
Koanantakool, Peter Hawkins, HyoukJoong Lee, Mingsheng Hong, Cliff Young,
Ryan Sepassi, and BlakeÂ A. Hechtman.

</span>
<span class="ltx_bibblock">Mesh-tensorflow: Deep learning for supercomputers.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1811.02084, 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
DiederikÂ P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In Yoshua Bengio and Yann LeCun, editors, <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">3rd International
Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May
7-9, 2015, Conference Track Proceedings</span>, 2015.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Tianqi Chen, Bing Xu, Chiyuan Zhang, and Carlos Guestrin.

</span>
<span class="ltx_bibblock">Training deep nets with sublinear memory cost.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1604.06174, 2016.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Sam McCandlish, Jared Kaplan, Dario Amodei, and OpenAIÂ Dota Team.

</span>
<span class="ltx_bibblock">An empirical model of large-batch training.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1812.06162, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Microsoft.

</span>
<span class="ltx_bibblock">Turing-nlg: A 17-billion-parameter language model by microsoft.

</span>
<span class="ltx_bibblock"><a href="https://www.microsoft.com/en-us/research/blog/turing-nlg-a-17-billion-parameter-language-model-by-microsoft/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.microsoft.com/en-us/research/blog/turing-nlg-a-17-billion-parameter-language-model-by-microsoft/</a>,
2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Yanping Huang, Yonglong Cheng, Dehao Chen, HyoukJoong Lee, Jiquan Ngiam,
QuocÂ V. Le, and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Gpipe: Efficient training of giant neural networks using pipeline
parallelism.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, abs/1811.06965, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Aaron Harlap, Deepak Narayanan, Amar Phanishayee, Vivek Seshadri, NikhilÂ R.
Devanur, GregoryÂ R. Ganger, and PhillipÂ B. Gibbons.

</span>
<span class="ltx_bibblock">Pipedream: Fast and efficient pipeline parallel DNN training.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1806.03377, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Deepak Narayanan, Aaron Harlap, Amar Phanishayee, Vivek Seshadri, Nikhil
Devanur, Greg Granger, Phil Gibbons, and Matei Zaharia.

</span>
<span class="ltx_bibblock">Pipedream: Generalized pipeline parallelism for dnn training.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">ACM Symposium on Operating Systems Principles (SOSP 2019)</span>,
October 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Animesh Jain, Amar Phanishayee, Jason Mars, Lingjia Tang, and Gennady
Pekhimenko.

</span>
<span class="ltx_bibblock">Gist: Efficient data encoding for deep neural network training.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">International Symposium on Computer Architecture (ISCA
2018)</span>, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Paras Jain, Ajay Jain, Aniruddha Nrusimha, Amir Gholami, Pieter Abbeel, Kurt
Keutzer, Ion Stoica, and JosephÂ E. Gonzalez.

</span>
<span class="ltx_bibblock">Checkmate: Breaking the memory wall with optimal tensor
rematerialization.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, abs/1910.02653, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Linnan Wang, Jinmian Ye, Yiyang Zhao, Wei Wu, Ang Li, ShuaiwenÂ Leon Song,
Zenglin Xu, and Tim Kraska.

</span>
<span class="ltx_bibblock">Superneurons: Dynamic GPU memory management for training deep
neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1801.04380, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Bharadwaj Pudipeddi, Maral Mesmakhosroshahi, Jinwen Xi, and Sujeeth Bharadwaj.

</span>
<span class="ltx_bibblock">Training large neural networks with constant memory using a new
execution algorithm.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, abs/2002.05645, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
M.Â Rhu, N.Â Gimelshein, J.Â Clemons, A.Â Zulfiqar, and S.Â W. Keckler.

</span>
<span class="ltx_bibblock">vdnn: Virtualized deep neural networks for scalable, memory-efficient
neural network design.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">2016 49th Annual IEEE/ACM International Symposium on
Microarchitecture (MICRO)</span>, pages 1â€“13, 2016.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Noam Shazeer and Mitchell Stern.

</span>
<span class="ltx_bibblock">Adafactor: Adaptive learning rates with sublinear memory cost.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1804.04235, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Rohan Anil, Vineet Gupta, Tomer Koren, and Yoram Singer.

</span>
<span class="ltx_bibblock">Memory-efficient adaptive optimization for large-scale learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">ArXiv</span>, abs/1901.11150, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
John Duchi, Elad Hazan, and Yoram Singer.

</span>
<span class="ltx_bibblock">Adaptive subgradient methods for online learning and stochastic
optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">J. Mach. Learn. Res.</span>, 12(null):2121â€“2159, July 2011.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Yang You, Igor Gitman, and Boris Ginsburg.

</span>
<span class="ltx_bibblock">Scaling SGD batch size to 32k for imagenet training.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1708.03888, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Yang You, Jing Li, Jonathan Hseu, Xiaodan Song, James Demmel, and Cho-Jui
Hsieh.

</span>
<span class="ltx_bibblock">Reducing BERT pre-training time from 3 days to 76 minutes.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1904.00962, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Paulius Micikevicius, Sharan Narang, Jonah Alben, Gregory Diamos, Erich Elsen,
David Garcia, Boris Ginsburg, Michael Houston, Oleksii Kuchaiev, Ganesh
Venkatesh, and Hao Wu.

</span>
<span class="ltx_bibblock">Mixed precision training, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
NVIDIA Tesla V100 GPU architecture.

</span>
<span class="ltx_bibblock"><a href="http://images.nvidia.com/content/volta-architecture/pdf/volta-architecture-whitepaper.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://images.nvidia.com/content/volta-architecture/pdf/volta-architecture-whitepaper.pdf</a>,
2017.

</span>
<span class="ltx_bibblock">[Online, accessed 22-April-2020].

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
NVIDIA.

</span>
<span class="ltx_bibblock">Automatic mixed-precision.

</span>
<span class="ltx_bibblock"><a href="https://developer.nvidia.com/automatic-mixed-precision" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://developer.nvidia.com/automatic-mixed-precision</a>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Shar Narasimhan.

</span>
<span class="ltx_bibblock">NVIDIA Clocks Worldâ€™s Fastest BERT Training Time â€¦

</span>
<span class="ltx_bibblock"><a href="https://devblogs.nvidia.com/training-bert-with-gpus/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://devblogs.nvidia.com/training-bert-with-gpus/</a>, 2019.

</span>
<span class="ltx_bibblock">[Online; accessed 25-September-2019].

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="A0.T5" class="ltx_table">
<table id="A0.T5.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A0.T5.2.1.1" class="ltx_tr">
<th id="A0.T5.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="9"><span id="A0.T5.2.1.1.1.1" class="ltx_text" style="font-size:70%;">Figure 2</span></th>
</tr>
<tr id="A0.T5.2.2.2" class="ltx_tr">
<th id="A0.T5.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.1.1" class="ltx_text" style="font-size:70%;">Model size</span></th>
<th id="A0.T5.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO/Baseline</span></th>
<th id="A0.T5.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.3.1" class="ltx_text" style="font-size:70%;">Number of GPUs</span></th>
<th id="A0.T5.2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.4.1" class="ltx_text" style="font-size:70%;">MP</span></th>
<th id="A0.T5.2.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.5.1" class="ltx_text" style="font-size:70%;">Layers</span></th>
<th id="A0.T5.2.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.6.1" class="ltx_text" style="font-size:70%;">Hidden size</span></th>
<th id="A0.T5.2.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.7.1" class="ltx_text" style="font-size:70%;">Attention head</span></th>
<th id="A0.T5.2.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.8.1" class="ltx_text" style="font-size:70%;">Batch size</span></th>
<th id="A0.T5.2.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T5.2.2.2.9.1" class="ltx_text" style="font-size:70%;">Total batch size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A0.T5.2.3.1" class="ltx_tr">
<td id="A0.T5.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.1.1" class="ltx_text" style="font-size:70%;">1.5B</span></td>
<td id="A0.T5.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T5.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.5.1" class="ltx_text" style="font-size:70%;">48</span></td>
<td id="A0.T5.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.6.1" class="ltx_text" style="font-size:70%;">1600</span></td>
<td id="A0.T5.2.3.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.7.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.3.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.8.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T5.2.3.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.3.1.9.1" class="ltx_text" style="font-size:70%;">9600</span></td>
</tr>
<tr id="A0.T5.2.4.2" class="ltx_tr">
<td id="A0.T5.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.1.1" class="ltx_text" style="font-size:70%;">1.5B</span></td>
<td id="A0.T5.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.4.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T5.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.5.1" class="ltx_text" style="font-size:70%;">48</span></td>
<td id="A0.T5.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.6.1" class="ltx_text" style="font-size:70%;">1600</span></td>
<td id="A0.T5.2.4.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.7.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.4.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.4.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.4.2.9.1" class="ltx_text" style="font-size:70%;">3200</span></td>
</tr>
<tr id="A0.T5.2.5.3" class="ltx_tr">
<td id="A0.T5.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.1.1" class="ltx_text" style="font-size:70%;">8B</span></td>
<td id="A0.T5.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.4.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T5.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.5.1" class="ltx_text" style="font-size:70%;">72</span></td>
<td id="A0.T5.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.6.1" class="ltx_text" style="font-size:70%;">3072</span></td>
<td id="A0.T5.2.5.3.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.7.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T5.2.5.3.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.8.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.5.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.5.3.9.1" class="ltx_text" style="font-size:70%;">6400</span></td>
</tr>
<tr id="A0.T5.2.6.4" class="ltx_tr">
<td id="A0.T5.2.6.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.1.1" class="ltx_text" style="font-size:70%;">8B</span></td>
<td id="A0.T5.2.6.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.6.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.6.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.4.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="A0.T5.2.6.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.5.1" class="ltx_text" style="font-size:70%;">72</span></td>
<td id="A0.T5.2.6.4.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.6.1" class="ltx_text" style="font-size:70%;">3072</span></td>
<td id="A0.T5.2.6.4.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.7.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T5.2.6.4.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.8.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="A0.T5.2.6.4.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.6.4.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T5.2.7.5" class="ltx_tr">
<td id="A0.T5.2.7.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T5.2.7.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.7.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.7.5.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.4.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T5.2.7.5.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.5.1" class="ltx_text" style="font-size:70%;">88</span></td>
<td id="A0.T5.2.7.5.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.6.1" class="ltx_text" style="font-size:70%;">6144</span></td>
<td id="A0.T5.2.7.5.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T5.2.7.5.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.8.1" class="ltx_text" style="font-size:70%;">12</span></td>
<td id="A0.T5.2.7.5.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.7.5.9.1" class="ltx_text" style="font-size:70%;">1200</span></td>
</tr>
<tr id="A0.T5.2.8.6" class="ltx_tr">
<td id="A0.T5.2.8.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T5.2.8.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.8.6.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.3.1" class="ltx_text" style="font-size:70%;">384</span></td>
<td id="A0.T5.2.8.6.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.4.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T5.2.8.6.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.5.1" class="ltx_text" style="font-size:70%;">88</span></td>
<td id="A0.T5.2.8.6.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.6.1" class="ltx_text" style="font-size:70%;">6144</span></td>
<td id="A0.T5.2.8.6.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.8.6.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.8.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T5.2.8.6.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.8.6.9.1" class="ltx_text" style="font-size:70%;">48</span></td>
</tr>
<tr id="A0.T5.2.9.7" class="ltx_tr">
<td id="A0.T5.2.9.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T5.2.9.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.9.7.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.9.7.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.9.7.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.5.1" class="ltx_text" style="font-size:70%;">132</span></td>
<td id="A0.T5.2.9.7.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.6.1" class="ltx_text" style="font-size:70%;">6144</span></td>
<td id="A0.T5.2.9.7.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T5.2.9.7.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.8.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.9.7.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.9.7.9.1" class="ltx_text" style="font-size:70%;">1600</span></td>
</tr>
<tr id="A0.T5.2.10.8" class="ltx_tr">
<td id="A0.T5.2.10.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T5.2.10.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.10.8.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.3.1" class="ltx_text" style="font-size:70%;">384</span></td>
<td id="A0.T5.2.10.8.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.4.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.10.8.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.5.1" class="ltx_text" style="font-size:70%;">132</span></td>
<td id="A0.T5.2.10.8.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.6.1" class="ltx_text" style="font-size:70%;">6144</span></td>
<td id="A0.T5.2.10.8.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.10.8.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.8.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T5.2.10.8.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.10.8.9.1" class="ltx_text" style="font-size:70%;">24</span></td>
</tr>
<tr id="A0.T5.2.11.9" class="ltx_tr">
<td id="A0.T5.2.11.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.1.1" class="ltx_text" style="font-size:70%;">80B</span></td>
<td id="A0.T5.2.11.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.11.9.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.11.9.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.11.9.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.5.1" class="ltx_text" style="font-size:70%;">100</span></td>
<td id="A0.T5.2.11.9.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.11.9.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.11.9.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.8.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T5.2.11.9.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.11.9.9.1" class="ltx_text" style="font-size:70%;">800</span></td>
</tr>
<tr id="A0.T5.2.12.10" class="ltx_tr">
<td id="A0.T5.2.12.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.1.1" class="ltx_text" style="font-size:70%;">80B</span></td>
<td id="A0.T5.2.12.10.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.12.10.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.3.1" class="ltx_text" style="font-size:70%;">384</span></td>
<td id="A0.T5.2.12.10.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.4.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.12.10.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.5.1" class="ltx_text" style="font-size:70%;">100</span></td>
<td id="A0.T5.2.12.10.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.12.10.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.7.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.12.10.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.8.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T5.2.12.10.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.12.10.9.1" class="ltx_text" style="font-size:70%;">12</span></td>
</tr>
<tr id="A0.T5.2.13.11" class="ltx_tr">
<td id="A0.T5.2.13.11.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.1.1" class="ltx_text" style="font-size:70%;">100B</span></td>
<td id="A0.T5.2.13.11.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.13.11.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.13.11.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.13.11.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.5.1" class="ltx_text" style="font-size:70%;">125</span></td>
<td id="A0.T5.2.13.11.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.13.11.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.13.11.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.8.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T5.2.13.11.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.13.11.9.1" class="ltx_text" style="font-size:70%;">800</span></td>
</tr>
<tr id="A0.T5.2.14.12" class="ltx_tr">
<td id="A0.T5.2.14.12.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.1.1" class="ltx_text" style="font-size:70%;">100B</span></td>
<td id="A0.T5.2.14.12.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.14.12.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.3.1" class="ltx_text" style="font-size:70%;">384</span></td>
<td id="A0.T5.2.14.12.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.4.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.14.12.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.5.1" class="ltx_text" style="font-size:70%;">125</span></td>
<td id="A0.T5.2.14.12.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.14.12.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.7.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.14.12.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.8.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T5.2.14.12.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.14.12.9.1" class="ltx_text" style="font-size:70%;">6</span></td>
</tr>
<tr id="A0.T5.2.15.13" class="ltx_tr">
<td id="A0.T5.2.15.13.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.1.1" class="ltx_text" style="font-size:70%;">120B</span></td>
<td id="A0.T5.2.15.13.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.15.13.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.15.13.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.15.13.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.5.1" class="ltx_text" style="font-size:70%;">150</span></td>
<td id="A0.T5.2.15.13.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.15.13.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.15.13.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.8.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T5.2.15.13.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.15.13.9.1" class="ltx_text" style="font-size:70%;">600</span></td>
</tr>
<tr id="A0.T5.2.16.14" class="ltx_tr">
<td id="A0.T5.2.16.14.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.1.1" class="ltx_text" style="font-size:70%;">120B</span></td>
<td id="A0.T5.2.16.14.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.16.14.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.3.1" class="ltx_text" style="font-size:70%;">384</span></td>
<td id="A0.T5.2.16.14.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.4.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.16.14.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.5.1" class="ltx_text" style="font-size:70%;">150</span></td>
<td id="A0.T5.2.16.14.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.16.14.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.7.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.16.14.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.8.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T5.2.16.14.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.16.14.9.1" class="ltx_text" style="font-size:70%;">6</span></td>
</tr>
<tr id="A0.T5.2.17.15" class="ltx_tr">
<td id="A0.T5.2.17.15.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.1.1" class="ltx_text" style="font-size:70%;">140B</span></td>
<td id="A0.T5.2.17.15.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.17.15.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.17.15.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.17.15.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.5.1" class="ltx_text" style="font-size:70%;">175</span></td>
<td id="A0.T5.2.17.15.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.17.15.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.17.15.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.17.15.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.17.15.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T5.2.18.16" class="ltx_tr">
<td id="A0.T5.2.18.16.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.1.1" class="ltx_text" style="font-size:70%;">140B</span></td>
<td id="A0.T5.2.18.16.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.18.16.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.3.1" class="ltx_text" style="font-size:70%;">384</span></td>
<td id="A0.T5.2.18.16.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.4.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.18.16.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.5.1" class="ltx_text" style="font-size:70%;">175</span></td>
<td id="A0.T5.2.18.16.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.18.16.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.7.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T5.2.18.16.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.8.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T5.2.18.16.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.18.16.9.1" class="ltx_text" style="font-size:70%;">6</span></td>
</tr>
<tr id="A0.T5.2.19.17" class="ltx_tr">
<td id="A0.T5.2.19.17.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.1.1" class="ltx_text" style="font-size:70%;">170B</span></td>
<td id="A0.T5.2.19.17.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T5.2.19.17.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T5.2.19.17.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T5.2.19.17.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.5.1" class="ltx_text" style="font-size:70%;">212</span></td>
<td id="A0.T5.2.19.17.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.19.17.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T5.2.19.17.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.8.1" class="ltx_text" style="font-size:70%;">12</span></td>
<td id="A0.T5.2.19.17.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T5.2.19.17.9.1" class="ltx_text" style="font-size:70%;">300</span></td>
</tr>
<tr id="A0.T5.2.20.18" class="ltx_tr">
<td id="A0.T5.2.20.18.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.1.1" class="ltx_text" style="font-size:70%;">170B</span></td>
<td id="A0.T5.2.20.18.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T5.2.20.18.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.3.1" class="ltx_text" style="font-size:70%;">256</span></td>
<td id="A0.T5.2.20.18.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.4.1" class="ltx_text" style="font-size:70%;">256</span></td>
<td id="A0.T5.2.20.18.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.5.1" class="ltx_text" style="font-size:70%;">212</span></td>
<td id="A0.T5.2.20.18.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T5.2.20.18.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.7.1" class="ltx_text" style="font-size:70%;">256</span></td>
<td id="A0.T5.2.20.18.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.8.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T5.2.20.18.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T5.2.20.18.9.1" class="ltx_text" style="font-size:70%;">2</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="A0.T5.5.1.1" class="ltx_text" style="font-size:129%;">Table 5</span>: </span><span id="A0.T5.6.2" class="ltx_text" style="font-size:129%;">Model configurations for Figure 2 related to ZeRO throughput compared with baseline.</span></figcaption>
</figure>
<figure id="A0.T6" class="ltx_table">
<table id="A0.T6.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A0.T6.2.1.1" class="ltx_tr">
<th id="A0.T6.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="9"><span id="A0.T6.2.1.1.1.1" class="ltx_text" style="font-size:70%;">Figure 3</span></th>
</tr>
<tr id="A0.T6.2.2.2" class="ltx_tr">
<th id="A0.T6.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.1.1" class="ltx_text" style="font-size:70%;">Model size</span></th>
<th id="A0.T6.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO/Baseline</span></th>
<th id="A0.T6.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.3.1" class="ltx_text" style="font-size:70%;">Number of GPUs</span></th>
<th id="A0.T6.2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.4.1" class="ltx_text" style="font-size:70%;">MP</span></th>
<th id="A0.T6.2.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.5.1" class="ltx_text" style="font-size:70%;">Layers</span></th>
<th id="A0.T6.2.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.6.1" class="ltx_text" style="font-size:70%;">Hidden size</span></th>
<th id="A0.T6.2.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.7.1" class="ltx_text" style="font-size:70%;">Attention head</span></th>
<th id="A0.T6.2.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.8.1" class="ltx_text" style="font-size:70%;">Batch size</span></th>
<th id="A0.T6.2.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T6.2.2.2.9.1" class="ltx_text" style="font-size:70%;">Total batch size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A0.T6.2.3.1" class="ltx_tr">
<td id="A0.T6.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T6.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T6.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.3.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T6.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T6.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T6.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T6.2.3.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T6.2.3.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T6.2.3.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.3.1.9.1" class="ltx_text" style="font-size:70%;">64</span></td>
</tr>
<tr id="A0.T6.2.4.2" class="ltx_tr">
<td id="A0.T6.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T6.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T6.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T6.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T6.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T6.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T6.2.4.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T6.2.4.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.8.1" class="ltx_text" style="font-size:70%;">48</span></td>
<td id="A0.T6.2.4.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.4.2.9.1" class="ltx_text" style="font-size:70%;">384</span></td>
</tr>
<tr id="A0.T6.2.5.3" class="ltx_tr">
<td id="A0.T6.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T6.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T6.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.3.1" class="ltx_text" style="font-size:70%;">256</span></td>
<td id="A0.T6.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T6.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T6.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T6.2.5.3.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T6.2.5.3.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.8.1" class="ltx_text" style="font-size:70%;">48</span></td>
<td id="A0.T6.2.5.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T6.2.5.3.9.1" class="ltx_text" style="font-size:70%;">768</span></td>
</tr>
<tr id="A0.T6.2.6.4" class="ltx_tr">
<td id="A0.T6.2.6.4.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T6.2.6.4.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T6.2.6.4.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T6.2.6.4.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T6.2.6.4.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T6.2.6.4.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T6.2.6.4.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T6.2.6.4.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.8.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T6.2.6.4.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T6.2.6.4.9.1" class="ltx_text" style="font-size:70%;">1600</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="A0.T6.5.1.1" class="ltx_text" style="font-size:129%;">Table 6</span>: </span><span id="A0.T6.6.2" class="ltx_text" style="font-size:129%;">Model configurations for Figure 3 related to superlinear scalability.</span></figcaption>
</figure>
<figure id="A0.T7" class="ltx_table">
<table id="A0.T7.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A0.T7.2.1.1" class="ltx_tr">
<th id="A0.T7.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="9"><span id="A0.T7.2.1.1.1.1" class="ltx_text" style="font-size:70%;">Figure 4</span></th>
</tr>
<tr id="A0.T7.2.2.2" class="ltx_tr">
<th id="A0.T7.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.1.1" class="ltx_text" style="font-size:70%;">Model size</span></th>
<th id="A0.T7.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO/Baseline</span></th>
<th id="A0.T7.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.3.1" class="ltx_text" style="font-size:70%;">Number of GPUs</span></th>
<th id="A0.T7.2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.4.1" class="ltx_text" style="font-size:70%;">MP</span></th>
<th id="A0.T7.2.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.5.1" class="ltx_text" style="font-size:70%;">Layers</span></th>
<th id="A0.T7.2.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.6.1" class="ltx_text" style="font-size:70%;">Hidden size</span></th>
<th id="A0.T7.2.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.7.1" class="ltx_text" style="font-size:70%;">Attention head</span></th>
<th id="A0.T7.2.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.8.1" class="ltx_text" style="font-size:70%;">Batch size</span></th>
<th id="A0.T7.2.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T7.2.2.2.9.1" class="ltx_text" style="font-size:70%;">Total batch size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A0.T7.2.3.1" class="ltx_tr">
<td id="A0.T7.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T7.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T7.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T7.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T7.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T7.2.3.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T7.2.3.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.3.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.3.1.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T7.2.4.2" class="ltx_tr">
<td id="A0.T7.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T7.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T7.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T7.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.5.1" class="ltx_text" style="font-size:70%;">132</span></td>
<td id="A0.T7.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.6.1" class="ltx_text" style="font-size:70%;">6144</span></td>
<td id="A0.T7.2.4.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T7.2.4.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.4.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.4.2.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T7.2.5.3" class="ltx_tr">
<td id="A0.T7.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.1.1" class="ltx_text" style="font-size:70%;">140B</span></td>
<td id="A0.T7.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T7.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T7.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.5.1" class="ltx_text" style="font-size:70%;">175</span></td>
<td id="A0.T7.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T7.2.5.3.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T7.2.5.3.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.5.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.5.3.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T7.2.6.4" class="ltx_tr">
<td id="A0.T7.2.6.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.1.1" class="ltx_text" style="font-size:70%;">150B</span></td>
<td id="A0.T7.2.6.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T7.2.6.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T7.2.6.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.6.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.5.1" class="ltx_text" style="font-size:70%;">187</span></td>
<td id="A0.T7.2.6.4.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T7.2.6.4.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T7.2.6.4.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.6.4.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T7.2.6.4.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T7.2.7.5" class="ltx_tr">
<td id="A0.T7.2.7.5.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.1.1" class="ltx_text" style="font-size:70%;">50B</span></td>
<td id="A0.T7.2.7.5.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T7.2.7.5.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T7.2.7.5.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.7.5.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.5.1" class="ltx_text" style="font-size:70%;">62</span></td>
<td id="A0.T7.2.7.5.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T7.2.7.5.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T7.2.7.5.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T7.2.7.5.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T7.2.7.5.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="A0.T7.5.1.1" class="ltx_text" style="font-size:129%;">Table 7</span>: </span><span id="A0.T7.6.2" class="ltx_text" style="font-size:129%;">Model configurations for Figure 4 related to max model size with different ZeRO configurations.</span></figcaption>
</figure>
<figure id="A0.T8" class="ltx_table">
<table id="A0.T8.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A0.T8.2.1.1" class="ltx_tr">
<th id="A0.T8.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="9"><span id="A0.T8.2.1.1.1.1" class="ltx_text" style="font-size:70%;">Figure 5</span></th>
</tr>
<tr id="A0.T8.2.2.2" class="ltx_tr">
<th id="A0.T8.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.1.1" class="ltx_text" style="font-size:70%;">Model size</span></th>
<th id="A0.T8.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO/Baseline</span></th>
<th id="A0.T8.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.3.1" class="ltx_text" style="font-size:70%;">Number of GPUs</span></th>
<th id="A0.T8.2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.4.1" class="ltx_text" style="font-size:70%;">MP</span></th>
<th id="A0.T8.2.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.5.1" class="ltx_text" style="font-size:70%;">Layers</span></th>
<th id="A0.T8.2.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.6.1" class="ltx_text" style="font-size:70%;">Hidden size</span></th>
<th id="A0.T8.2.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.7.1" class="ltx_text" style="font-size:70%;">Attention head</span></th>
<th id="A0.T8.2.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.8.1" class="ltx_text" style="font-size:70%;">Batch size</span></th>
<th id="A0.T8.2.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T8.2.2.2.9.1" class="ltx_text" style="font-size:70%;">Total batch size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A0.T8.2.3.1" class="ltx_tr">
<td id="A0.T8.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T8.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T8.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.3.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.3.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.3.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.3.1.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T8.2.4.2" class="ltx_tr">
<td id="A0.T8.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T8.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T8.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.4.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.4.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.4.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.4.2.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T8.2.5.3" class="ltx_tr">
<td id="A0.T8.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T8.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T8.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.5.3.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.5.3.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.5.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.5.3.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T8.2.6.4" class="ltx_tr">
<td id="A0.T8.2.6.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T8.2.6.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.6.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.6.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.6.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T8.2.6.4.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.6.4.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.6.4.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.6.4.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.6.4.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T8.2.7.5" class="ltx_tr">
<td id="A0.T8.2.7.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.1.1" class="ltx_text" style="font-size:70%;">40B</span></td>
<td id="A0.T8.2.7.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.7.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.7.5.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.7.5.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T8.2.7.5.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.7.5.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.7.5.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.7.5.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.7.5.9.1" class="ltx_text" style="font-size:70%;">400</span></td>
</tr>
<tr id="A0.T8.2.8.6" class="ltx_tr">
<td id="A0.T8.2.8.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.1.1" class="ltx_text" style="font-size:70%;">100B</span></td>
<td id="A0.T8.2.8.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.8.6.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.8.6.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.8.6.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.5.1" class="ltx_text" style="font-size:70%;">125</span></td>
<td id="A0.T8.2.8.6.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.8.6.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T8.2.8.6.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.8.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.8.6.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T8.2.8.6.9.1" class="ltx_text" style="font-size:70%;">800</span></td>
</tr>
<tr id="A0.T8.2.9.7" class="ltx_tr">
<td id="A0.T8.2.9.7.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.1.1" class="ltx_text" style="font-size:70%;">100B</span></td>
<td id="A0.T8.2.9.7.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T8.2.9.7.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T8.2.9.7.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T8.2.9.7.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.5.1" class="ltx_text" style="font-size:70%;">125</span></td>
<td id="A0.T8.2.9.7.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T8.2.9.7.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T8.2.9.7.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.8.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T8.2.9.7.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T8.2.9.7.9.1" class="ltx_text" style="font-size:70%;">800</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="A0.T8.5.1.1" class="ltx_text" style="font-size:129%;">Table 8</span>: </span><span id="A0.T8.6.2" class="ltx_text" style="font-size:129%;">Model configurations for Figure 5 related to memory allocated with different ZeRO configurations.</span></figcaption>
</figure>
<figure id="A0.T9" class="ltx_table">
<table id="A0.T9.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A0.T9.2.1.1" class="ltx_tr">
<th id="A0.T9.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="9"><span id="A0.T9.2.1.1.1.1" class="ltx_text" style="font-size:70%;">Figure 6</span></th>
</tr>
<tr id="A0.T9.2.2.2" class="ltx_tr">
<th id="A0.T9.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.1.1" class="ltx_text" style="font-size:70%;">Model size</span></th>
<th id="A0.T9.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO/Baseline</span></th>
<th id="A0.T9.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.3.1" class="ltx_text" style="font-size:70%;">Number of GPUs</span></th>
<th id="A0.T9.2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.4.1" class="ltx_text" style="font-size:70%;">MP</span></th>
<th id="A0.T9.2.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.5.1" class="ltx_text" style="font-size:70%;">Layers</span></th>
<th id="A0.T9.2.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.6.1" class="ltx_text" style="font-size:70%;">Hidden size</span></th>
<th id="A0.T9.2.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.7.1" class="ltx_text" style="font-size:70%;">Attention head</span></th>
<th id="A0.T9.2.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.8.1" class="ltx_text" style="font-size:70%;">Batch size</span></th>
<th id="A0.T9.2.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T9.2.2.2.9.1" class="ltx_text" style="font-size:70%;">Total batch size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A0.T9.2.3.1" class="ltx_tr">
<td id="A0.T9.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T9.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T9.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T9.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T9.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T9.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T9.2.3.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T9.2.3.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.8.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T9.2.3.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.3.1.9.1" class="ltx_text" style="font-size:70%;">16</span></td>
</tr>
<tr id="A0.T9.2.4.2" class="ltx_tr">
<td id="A0.T9.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T9.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T9.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T9.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T9.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T9.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T9.2.4.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T9.2.4.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.8.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T9.2.4.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.4.2.9.1" class="ltx_text" style="font-size:70%;">32</span></td>
</tr>
<tr id="A0.T9.2.5.3" class="ltx_tr">
<td id="A0.T9.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T9.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T9.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T9.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T9.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T9.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T9.2.5.3.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T9.2.5.3.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.8.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T9.2.5.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.5.3.9.1" class="ltx_text" style="font-size:70%;">256</span></td>
</tr>
<tr id="A0.T9.2.6.4" class="ltx_tr">
<td id="A0.T9.2.6.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T9.2.6.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T9.2.6.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T9.2.6.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T9.2.6.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T9.2.6.4.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T9.2.6.4.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T9.2.6.4.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.8.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T9.2.6.4.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.6.4.9.1" class="ltx_text" style="font-size:70%;">256</span></td>
</tr>
<tr id="A0.T9.2.7.5" class="ltx_tr">
<td id="A0.T9.2.7.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.1.1" class="ltx_text" style="font-size:70%;">60B</span></td>
<td id="A0.T9.2.7.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T9.2.7.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T9.2.7.5.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T9.2.7.5.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.5.1" class="ltx_text" style="font-size:70%;">75</span></td>
<td id="A0.T9.2.7.5.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T9.2.7.5.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T9.2.7.5.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.8.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="A0.T9.2.7.5.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T9.2.7.5.9.1" class="ltx_text" style="font-size:70%;">64</span></td>
</tr>
<tr id="A0.T9.2.8.6" class="ltx_tr">
<td id="A0.T9.2.8.6.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.1.1" class="ltx_text" style="font-size:70%;">170B</span></td>
<td id="A0.T9.2.8.6.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T9.2.8.6.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.3.1" class="ltx_text" style="font-size:70%;">400</span></td>
<td id="A0.T9.2.8.6.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.4.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T9.2.8.6.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.5.1" class="ltx_text" style="font-size:70%;">212</span></td>
<td id="A0.T9.2.8.6.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.6.1" class="ltx_text" style="font-size:70%;">8192</span></td>
<td id="A0.T9.2.8.6.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.7.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T9.2.8.6.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.8.1" class="ltx_text" style="font-size:70%;">12</span></td>
<td id="A0.T9.2.8.6.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T9.2.8.6.9.1" class="ltx_text" style="font-size:70%;">300</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="A0.T9.5.1.1" class="ltx_text" style="font-size:129%;">Table 9</span>: </span><span id="A0.T9.6.2" class="ltx_text" style="font-size:129%;">Model configurations for Figure 6 related to throughput with different ZeRO configurations.</span></figcaption>
</figure>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p">These tables contain all the model configurations and batch sizes used for the experiments presented in the paper. In Figure 2, notice that the total number of GPUs for some baseline experiment is 384 or 256 compared to 400 for ZeRO. This is because the total number of GPUs must be a product of the number of MP, and we only had access to a total of 400 GPUs. There exist a handful of additional constraints in model configuration values, such as hidden size must be divisible by attention heads, hidden size divisible by MP, and attention heads divisible by MP. For baseline we used the lowest number of GPUs that was a power of 2 that would fit the model. So for example, for 170B parameter model this was 256 for the baseline. Since we only had 400 GPUs, we could only run baseline with 256 GPUs.</p>
</div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p">We do want to point out that this gives the baseline an advantage over ZeRO because fewer GPUs means better communication throughput for the baseline. For example, in case of the 170B parameter model, DP=1 for the baseline so it in fact incurs no communication for DP. The results presented in this paper are despite this advantage for the baseline.</p>
</div>
<div id="p4" class="ltx_para">
<p id="p4.1" class="ltx_p">Also, we want to point out that we are comparing the performance per GPU, not the aggregate performance, and therefore the results are still apples-to-apples while giving a slight advantage to the baseline.</p>
</div>
<figure id="A0.T10" class="ltx_table">
<table id="A0.T10.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A0.T10.2.1.1" class="ltx_tr">
<th id="A0.T10.2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="9"><span id="A0.T10.2.1.1.1.1" class="ltx_text" style="font-size:70%;">Figure 7</span></th>
</tr>
<tr id="A0.T10.2.2.2" class="ltx_tr">
<th id="A0.T10.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.1.1" class="ltx_text" style="font-size:70%;">Model size</span></th>
<th id="A0.T10.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO/Baseline</span></th>
<th id="A0.T10.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.3.1" class="ltx_text" style="font-size:70%;">Number of GPUs</span></th>
<th id="A0.T10.2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.4.1" class="ltx_text" style="font-size:70%;">MP</span></th>
<th id="A0.T10.2.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.5.1" class="ltx_text" style="font-size:70%;">Layers</span></th>
<th id="A0.T10.2.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.6.1" class="ltx_text" style="font-size:70%;">Hidden size</span></th>
<th id="A0.T10.2.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.7.1" class="ltx_text" style="font-size:70%;">Attention head</span></th>
<th id="A0.T10.2.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.8.1" class="ltx_text" style="font-size:70%;">Batch size</span></th>
<th id="A0.T10.2.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><span id="A0.T10.2.2.2.9.1" class="ltx_text" style="font-size:70%;">Total batch size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A0.T10.2.3.1" class="ltx_tr">
<td id="A0.T10.2.3.1.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.1.1" class="ltx_text" style="font-size:70%;">1.5B</span></td>
<td id="A0.T10.2.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.3.1.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.3.1.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.3.1.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.5.1" class="ltx_text" style="font-size:70%;">34</span></td>
<td id="A0.T10.2.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.6.1" class="ltx_text" style="font-size:70%;">1920</span></td>
<td id="A0.T10.2.3.1.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.7.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T10.2.3.1.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.8.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T10.2.3.1.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.3.1.9.1" class="ltx_text" style="font-size:70%;">3072</span></td>
</tr>
<tr id="A0.T10.2.4.2" class="ltx_tr">
<td id="A0.T10.2.4.2.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.1.1" class="ltx_text" style="font-size:70%;">2.5B</span></td>
<td id="A0.T10.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.4.2.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.4.2.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.4.2.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.5.1" class="ltx_text" style="font-size:70%;">54</span></td>
<td id="A0.T10.2.4.2.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.6.1" class="ltx_text" style="font-size:70%;">1920</span></td>
<td id="A0.T10.2.4.2.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.7.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T10.2.4.2.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.8.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T10.2.4.2.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.4.2.9.1" class="ltx_text" style="font-size:70%;">3072</span></td>
</tr>
<tr id="A0.T10.2.5.3" class="ltx_tr">
<td id="A0.T10.2.5.3.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.1.1" class="ltx_text" style="font-size:70%;">4B</span></td>
<td id="A0.T10.2.5.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.5.3.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.5.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.5.3.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.5.1" class="ltx_text" style="font-size:70%;">64</span></td>
<td id="A0.T10.2.5.3.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.6.1" class="ltx_text" style="font-size:70%;">2304</span></td>
<td id="A0.T10.2.5.3.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.7.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T10.2.5.3.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.8.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T10.2.5.3.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.5.3.9.1" class="ltx_text" style="font-size:70%;">2048</span></td>
</tr>
<tr id="A0.T10.2.6.4" class="ltx_tr">
<td id="A0.T10.2.6.4.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.1.1" class="ltx_text" style="font-size:70%;">6B</span></td>
<td id="A0.T10.2.6.4.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.6.4.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.6.4.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.6.4.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.5.1" class="ltx_text" style="font-size:70%;">52</span></td>
<td id="A0.T10.2.6.4.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.6.1" class="ltx_text" style="font-size:70%;">3072</span></td>
<td id="A0.T10.2.6.4.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.7.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T10.2.6.4.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.8.1" class="ltx_text" style="font-size:70%;">12</span></td>
<td id="A0.T10.2.6.4.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.6.4.9.1" class="ltx_text" style="font-size:70%;">1536</span></td>
</tr>
<tr id="A0.T10.2.7.5" class="ltx_tr">
<td id="A0.T10.2.7.5.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.1.1" class="ltx_text" style="font-size:70%;">8B</span></td>
<td id="A0.T10.2.7.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.7.5.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.7.5.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.7.5.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.5.1" class="ltx_text" style="font-size:70%;">72</span></td>
<td id="A0.T10.2.7.5.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.6.1" class="ltx_text" style="font-size:70%;">3072</span></td>
<td id="A0.T10.2.7.5.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.7.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T10.2.7.5.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.8.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="A0.T10.2.7.5.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.7.5.9.1" class="ltx_text" style="font-size:70%;">1024</span></td>
</tr>
<tr id="A0.T10.2.8.6" class="ltx_tr">
<td id="A0.T10.2.8.6.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.1.1" class="ltx_text" style="font-size:70%;">10B</span></td>
<td id="A0.T10.2.8.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.8.6.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.8.6.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.8.6.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.5.1" class="ltx_text" style="font-size:70%;">50</span></td>
<td id="A0.T10.2.8.6.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.6.1" class="ltx_text" style="font-size:70%;">4096</span></td>
<td id="A0.T10.2.8.6.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T10.2.8.6.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.8.1" class="ltx_text" style="font-size:70%;">6</span></td>
<td id="A0.T10.2.8.6.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.8.6.9.1" class="ltx_text" style="font-size:70%;">768</span></td>
</tr>
<tr id="A0.T10.2.9.7" class="ltx_tr">
<td id="A0.T10.2.9.7.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.1.1" class="ltx_text" style="font-size:70%;">11B</span></td>
<td id="A0.T10.2.9.7.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.9.7.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.9.7.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.9.7.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.5.1" class="ltx_text" style="font-size:70%;">54</span></td>
<td id="A0.T10.2.9.7.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.6.1" class="ltx_text" style="font-size:70%;">4096</span></td>
<td id="A0.T10.2.9.7.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T10.2.9.7.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.8.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T10.2.9.7.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.9.7.9.1" class="ltx_text" style="font-size:70%;">512</span></td>
</tr>
<tr id="A0.T10.2.10.8" class="ltx_tr">
<td id="A0.T10.2.10.8.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.1.1" class="ltx_text" style="font-size:70%;">12B</span></td>
<td id="A0.T10.2.10.8.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.10.8.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.10.8.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.10.8.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.5.1" class="ltx_text" style="font-size:70%;">58</span></td>
<td id="A0.T10.2.10.8.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.6.1" class="ltx_text" style="font-size:70%;">4096</span></td>
<td id="A0.T10.2.10.8.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T10.2.10.8.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.8.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A0.T10.2.10.8.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.10.8.9.1" class="ltx_text" style="font-size:70%;">512</span></td>
</tr>
<tr id="A0.T10.2.11.9" class="ltx_tr">
<td id="A0.T10.2.11.9.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.1.1" class="ltx_text" style="font-size:70%;">13B</span></td>
<td id="A0.T10.2.11.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.2.1" class="ltx_text" style="font-size:70%;">ZeRO</span></td>
<td id="A0.T10.2.11.9.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.11.9.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.11.9.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.5.1" class="ltx_text" style="font-size:70%;">62</span></td>
<td id="A0.T10.2.11.9.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.6.1" class="ltx_text" style="font-size:70%;">4096</span></td>
<td id="A0.T10.2.11.9.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.7.1" class="ltx_text" style="font-size:70%;">32</span></td>
<td id="A0.T10.2.11.9.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.8.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A0.T10.2.11.9.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.11.9.9.1" class="ltx_text" style="font-size:70%;">256</span></td>
</tr>
<tr id="A0.T10.2.12.10" class="ltx_tr">
<td id="A0.T10.2.12.10.1" class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.1.1" class="ltx_text" style="font-size:70%;">1p16B</span></td>
<td id="A0.T10.2.12.10.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T10.2.12.10.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.12.10.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.12.10.5" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.5.1" class="ltx_text" style="font-size:70%;">24</span></td>
<td id="A0.T10.2.12.10.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.6.1" class="ltx_text" style="font-size:70%;">1920</span></td>
<td id="A0.T10.2.12.10.7" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.7.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T10.2.12.10.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.8.1" class="ltx_text" style="font-size:70%;">8</span></td>
<td id="A0.T10.2.12.10.9" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A0.T10.2.12.10.9.1" class="ltx_text" style="font-size:70%;">1024</span></td>
</tr>
<tr id="A0.T10.2.13.11" class="ltx_tr">
<td id="A0.T10.2.13.11.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.1.1" class="ltx_text" style="font-size:70%;">1p38B</span></td>
<td id="A0.T10.2.13.11.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.2.1" class="ltx_text" style="font-size:70%;">Baseline</span></td>
<td id="A0.T10.2.13.11.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.3.1" class="ltx_text" style="font-size:70%;">128</span></td>
<td id="A0.T10.2.13.11.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.4.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.13.11.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.5.1" class="ltx_text" style="font-size:70%;">40</span></td>
<td id="A0.T10.2.13.11.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.6.1" class="ltx_text" style="font-size:70%;">1536</span></td>
<td id="A0.T10.2.13.11.7" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.7.1" class="ltx_text" style="font-size:70%;">16</span></td>
<td id="A0.T10.2.13.11.8" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.8.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A0.T10.2.13.11.9" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t"><span id="A0.T10.2.13.11.9.1" class="ltx_text" style="font-size:70%;">128</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span id="A0.T10.5.1.1" class="ltx_text" style="font-size:129%;">Table 10</span>: </span><span id="A0.T10.6.2" class="ltx_text" style="font-size:129%;">Model configurations for Figure 7 related to evaluating maximum model sizes vs throughput while using only data-parallelism.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Jul 25 05:18:57 2023 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
