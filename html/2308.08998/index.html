<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Reinforced Self-Training (\rest) for Language Modeling</title>
<!--Generated on Wed Aug 23 01:31:02 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dginev/ar5iv-css@0.7.6/css/ar5iv.min.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_ERROR undefined">\correspondingauthor</span>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">ca9lar@gmail.com












<span id="p1.1.1" class="ltx_ERROR undefined">\reportnumber</span>001</p>
</div>
<h1 class="ltx_title ltx_title_document">Reinforced Self-Training (<span id="id1.id1" class="ltx_ERROR undefined">\rest</span>) for Language Modeling</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Caglar Gulcehre<sup id="id2.1.id1" class="ltx_sup">*†,1</sup>,
Tom Le Paine<sup id="id3.2.id2" class="ltx_sup">*†,1</sup>,
Srivatsan Srinivasan<sup id="id4.3.id3" class="ltx_sup">*†,1</sup>,
Ksenia Konyushkova<sup id="id5.4.id4" class="ltx_sup">†,1</sup>,
Lotte Weerts<sup id="id6.5.id5" class="ltx_sup">†,1</sup>

<br class="ltx_break">
Abhishek Sharma<sup id="id7.6.id6" class="ltx_sup">†,1</sup>,
Aditya Siddhant<sup id="id8.7.id7" class="ltx_sup">†,1</sup>,
Alex Ahern<sup id="id9.8.id8" class="ltx_sup">1</sup>,
Miaosen Wang<sup id="id10.9.id9" class="ltx_sup">1</sup>,
Chenjie Gu<sup id="id11.10.id10" class="ltx_sup">1</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

<br class="ltx_break">
Wolfgang Macherey<sup id="id12.1.id1" class="ltx_sup">2</sup>,
Arnaud Doucet<sup id="id13.2.id2" class="ltx_sup">1</sup>,
Orhan Firat<sup id="id14.3.id3" class="ltx_sup">†,1</sup>,
Nando de Freitas<sup id="id15.4.id4" class="ltx_sup">1</sup>

<br class="ltx_break">
<sup id="id16.5.id5" class="ltx_sup">*</sup>Contributed equally, <sup id="id17.6.id6" class="ltx_sup">†</sup>Core contributors
<br class="ltx_break"><sup id="id18.7.id7" class="ltx_sup">1</sup>Google DeepMind, <sup id="id19.8.id8" class="ltx_sup">2</sup>Google Research
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id20.id1" class="ltx_p">Reinforcement learning from human feedback (RLHF) can improve the quality of large language model’s (LLM) outputs by aligning them with human preferences. We propose a simple algorithm for aligning LLMs with human preferences inspired by growing batch reinforcement learning (RL), which we call <span id="id20.id1.1" class="ltx_text ltx_font_italic">Reinforced Self-Training</span> (<span id="id20.id1.2" class="ltx_ERROR undefined">\rest</span>). Given an initial LLM policy, <span id="id20.id1.3" class="ltx_ERROR undefined">\rest</span> produces a dataset by generating samples from the policy, which are then used to improve the LLM policy using offline RL algorithms. <span id="id20.id1.4" class="ltx_ERROR undefined">\rest</span> is more efficient than typical online RLHF methods because the training dataset is produced offline, which allows data reuse. While <span id="id20.id1.5" class="ltx_ERROR undefined">\rest</span> is a general approach applicable to all generative learning settings, we focus on its application to machine translation. Our results show that <span id="id20.id1.6" class="ltx_ERROR undefined">\rest</span> can substantially improve translation quality, as measured by automated metrics and human evaluation on machine translation benchmarks in a compute and sample-efficient manner.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Offline RL, reinforcement learning, RL from human feedback, language, natural language processing, machine translation
</div>
<section id="S1" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure ltx_align_floatright"><img src="assets/plots/first-figure-v3.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="479" height="418" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.6.1" class="ltx_ERROR undefined">\rest</span><span id="S1.F1.7.2" class="ltx_text ltx_font_bold"> method.</span> During <span id="S1.F1.8.3" class="ltx_text ltx_font_typewriter">Grow</span> step, a policy generates a dataset. At <span id="S1.F1.9.4" class="ltx_text ltx_font_typewriter">Improve</span> step, the filtered dataset is used to fine-tune the policy. Both steps are repeated, <span id="S1.F1.10.5" class="ltx_text ltx_font_typewriter">Improve</span> step is repeated more frequently to amortise the dataset creation cost.</figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Large language models (LLMs) have demonstrated impressive abilities in generating high-quality text and in solving numerous language tasks <cite class="ltx_cite ltx_citemacro_citep">(Bubeck et al., <a href="#bib.bib9" title="" class="ltx_ref">2023</a>; Brown et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>; Rae et al., <a href="#bib.bib44" title="" class="ltx_ref">2021</a>)</cite>. These models are trained to maximize the likelihood of the next token autoregressively using massive amounts of text and compute <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al., <a href="#bib.bib53" title="" class="ltx_ref">2022</a>; Hoffmann et al., <a href="#bib.bib24" title="" class="ltx_ref">2022</a>)</cite>. However, <cite class="ltx_cite ltx_citemacro_cite">Perez et al. (<a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite> showed that producing text with high likelihood does not necessarily align well with human preferences on various tasks. Without proper alignment, the language models can also output unsafe contents with harmful consequences. Moreover, aligning LLMs helps to improve on other downstream tasks <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a href="#bib.bib40" title="" class="ltx_ref">2022b</a>)</cite>. <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">Reinforcement learning from human feedback</em> (RLHF) aims to address the alignment problem by using human preferences <cite class="ltx_cite ltx_citemacro_citep">(Glaese et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>; Wu et al., <a href="#bib.bib59" title="" class="ltx_ref">2021</a>; Stiennon et al., <a href="#bib.bib54" title="" class="ltx_ref">2020</a>)</cite>. Typically, human feedback is used to learn a reward model, which is then used to fine-tune LLM with a reinforcement learning (RL) objective.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">RLHF methods often rely on online RL methods such as PPO <cite class="ltx_cite ltx_citemacro_citep">(Schulman et al., <a href="#bib.bib47" title="" class="ltx_ref">2017</a>)</cite> and A2C <cite class="ltx_cite ltx_citemacro_citep">(Mnih et al., <a href="#bib.bib37" title="" class="ltx_ref">2016</a>)</cite>. Online training requires sampling from the updated policy and scoring the samples with the reward model many times during training. The computational cost of dealing with a continual flow of new samples becomes a limitation of online methods, especially when the sizes of the policy and reward networks grow. Moreover, these methods are prone to reward “hacking” <cite class="ltx_cite ltx_citemacro_citep">(Skalse et al., <a href="#bib.bib51" title="" class="ltx_ref">2022</a>)</cite>, and prior works <cite class="ltx_cite ltx_citemacro_citep">(Glaese et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite> explored model regularization to mitigate this issue. Alternatively, offline RL methods learn from a fixed dataset of examples and, thus they are more computationally efficient and less prone to reward hacking. However, the quality of the policy learnt offline inevitably depends on the properties of the offline dataset <cite class="ltx_cite ltx_citemacro_citep">(Gulcehre et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>; Fu et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>. As a result, carefully curated datasets become very important for the success of offline RL. Otherwise, the performance gains over supervised learning may be limited <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>. Concurrent to our work, <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et al., <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite> proposed a method called DPO (Direct Preference Optimization) that can make use of offline data to align an LM with human preferences.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We frame the alignment problem of a language model as a growing batch RL problem <cite class="ltx_cite ltx_citemacro_citep">(Lange et al., <a href="#bib.bib31" title="" class="ltx_ref">2012</a>)</cite>. Specifically, our Reinforced Self-Training (<span id="S1.p3.1.1" class="ltx_ERROR undefined">\rest</span>) method includes two loops: in the inner loop (<span id="S1.p3.1.2" class="ltx_text ltx_font_typewriter">Improve</span>), we improve the policy on a fixed dataset and in the outer loop (<span id="S1.p3.1.3" class="ltx_text ltx_font_typewriter">Grow</span>), we grow the dataset by sampling from the latest policy (see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). In this work we consider conditional language modelling, then the steps of <span id="S1.p3.1.4" class="ltx_ERROR undefined">\rest</span> are as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_typewriter">Grow</span> (<span id="S1.I1.i1.p1.1.2" class="ltx_text ltx_font_typewriter">G</span>): The language model policy (initially, a supervised policy) is used to generate multiple output predictions for each context to augment the training dataset.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_typewriter">Improve</span> (<span id="S1.I1.i2.p1.1.2" class="ltx_text ltx_font_typewriter">I</span>): We rank and filter the augmented dataset with a scoring function. We use a learned reward model trained on human preferences as the scoring function in our experiments. Then, the language model is fine-tuned on the filtered dataset with an offline RL objective. This step can be repeated with an increasing filtering threshold. The final policy is then used in the next <span id="S1.I1.i2.p1.1.3" class="ltx_text ltx_font_typewriter">Grow</span> step.</p>
</div>
</li>
</ol>
</div>
<span id="S1.1" class="ltx_ERROR undefined">\rest</span>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">is a general approach that allows different offline RL losses to be used in the inner loop when executing the <span id="S1.p4.1.1" class="ltx_text ltx_font_typewriter">Improve</span> steps. To put it in practice, one only needs the ability to: i) sample from a model efficiently, ii) score the model’s samples. <span id="S1.p4.1.2" class="ltx_ERROR undefined">\rest</span> provides several advantages over typical RLHF methods with online or offline RL:
</p>
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.1" class="ltx_p">The computational burden is significantly reduced compared to online RL thanks to the output of <span id="S1.I2.i1.p1.1.1" class="ltx_text ltx_font_typewriter">Grow</span> step being exploited across several <span id="S1.I2.i1.p1.1.2" class="ltx_text ltx_font_typewriter">Improve</span> steps.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p">The quality of the policy is not restricted by the quality of the original dataset (as in offline RL) since new training data is sampled from an improved policy during the <span id="S1.I2.i2.p1.1.1" class="ltx_text ltx_font_typewriter">Grow</span> step.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i3.p1" class="ltx_para">
<p id="S1.I2.i3.p1.1" class="ltx_p">It is easy to inspect the data quality and potentially diagnose alignment issues, <em id="S1.I2.i3.p1.1.1" class="ltx_emph ltx_font_italic">e.g.,</em> reward hacking, as the <span id="S1.I2.i3.p1.1.2" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S1.I2.i3.p1.1.3" class="ltx_text ltx_font_typewriter">Improve</span> steps are decoupled.</p>
</div>
</li>
<li id="S1.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i4.p1" class="ltx_para">
<p id="S1.I2.i4.p1.1" class="ltx_p">The approach is simple, stable and has only a small number of hyperparameters to tune.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We explain the details of our proposed <span id="S1.p5.1.1" class="ltx_ERROR undefined">\rest</span> approach in Section <a href="#S3" title="3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Then, we present our experimental results on machine translation benchmarks in Section <a href="#S4" title="4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Machine translation is a sequence-to-sequence learning problem <cite class="ltx_cite ltx_citemacro_citep">(Sutskever et al., <a href="#bib.bib56" title="" class="ltx_ref">2014</a>)</cite>, which is usually formulated as conditional language modelling where the context for conditioning is a sentence in a foreign language (source). We chose machine translation because i) it is an impactful application with strong baselines and a well-defined evaluation procedure, ii) several existing reliable scoring and evaluation methods are available for the use as a reward model <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>. In our experiments, we compare several offline RL algorithms on the IWSLT 2014 <cite class="ltx_cite ltx_citemacro_citep">(Cettolo et al., <a href="#bib.bib10" title="" class="ltx_ref">2014</a>)</cite> and WMT 2020 benchmarks <cite class="ltx_cite ltx_citemacro_citep">(Koehn et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> as well as more competitive, high-fidelity internal benchmarks on Web Domain. In our experiments <span id="S1.p5.1.2" class="ltx_ERROR undefined">\rest</span> significantly improves reward model scores on test and validation sets. Furthermore, according to human raters, <span id="S1.p5.1.3" class="ltx_ERROR undefined">\rest</span> generates higher quality translations compared to a supervised learning baseline.</p>
</div>
</section>
<section id="S2" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.5" class="ltx_p">A conditional language model produces an output sequence <math id="S2.p1.1.m1.1" class="ltx_math_unparsed" alttext="{\bm{y}}=\left(y_{1},y_{2},....y_{T}\right)" display="inline"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1b"><mi id="S2.p1.1.m1.1.2">𝒚</mi><mo id="S2.p1.1.m1.1.3">=</mo><mrow id="S2.p1.1.m1.1.4"><mo id="S2.p1.1.m1.1.4.1">(</mo><msub id="S2.p1.1.m1.1.4.2"><mi id="S2.p1.1.m1.1.4.2.2">y</mi><mn id="S2.p1.1.m1.1.4.2.3">1</mn></msub><mo id="S2.p1.1.m1.1.4.3">,</mo><msub id="S2.p1.1.m1.1.4.4"><mi id="S2.p1.1.m1.1.4.4.2">y</mi><mn id="S2.p1.1.m1.1.4.4.3">2</mn></msub><mo id="S2.p1.1.m1.1.4.5">,</mo><mi mathvariant="normal" id="S2.p1.1.m1.1.1">…</mi><mo lspace="0em" rspace="0.167em" id="S2.p1.1.m1.1.4.6">.</mo><msub id="S2.p1.1.m1.1.4.7"><mi id="S2.p1.1.m1.1.4.7.2">y</mi><mi id="S2.p1.1.m1.1.4.7.3">T</mi></msub><mo id="S2.p1.1.m1.1.4.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">{\bm{y}}=\left(y_{1},y_{2},....y_{T}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">bold_italic_y = ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … . italic_y start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math> given a context (or source input) <math id="S2.p1.2.m2.3" class="ltx_Math" alttext="{\bm{x}}=\left(x_{1},x_{2},...x_{L}\right)" display="inline"><semantics id="S2.p1.2.m2.3a"><mrow id="S2.p1.2.m2.3.3" xref="S2.p1.2.m2.3.3.cmml"><mi id="S2.p1.2.m2.3.3.5" xref="S2.p1.2.m2.3.3.5.cmml">𝒙</mi><mo id="S2.p1.2.m2.3.3.4" xref="S2.p1.2.m2.3.3.4.cmml">=</mo><mrow id="S2.p1.2.m2.3.3.3.3" xref="S2.p1.2.m2.3.3.3.4.cmml"><mo id="S2.p1.2.m2.3.3.3.3.4" xref="S2.p1.2.m2.3.3.3.4.cmml">(</mo><msub id="S2.p1.2.m2.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.p1.2.m2.1.1.1.1.1.2" xref="S2.p1.2.m2.1.1.1.1.1.2.cmml">x</mi><mn id="S2.p1.2.m2.1.1.1.1.1.3" xref="S2.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.3.3.3.3.5" xref="S2.p1.2.m2.3.3.3.4.cmml">,</mo><msub id="S2.p1.2.m2.2.2.2.2.2" xref="S2.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.p1.2.m2.2.2.2.2.2.2" xref="S2.p1.2.m2.2.2.2.2.2.2.cmml">x</mi><mn id="S2.p1.2.m2.2.2.2.2.2.3" xref="S2.p1.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.2.m2.3.3.3.3.6" xref="S2.p1.2.m2.3.3.3.4.cmml">,</mo><mrow id="S2.p1.2.m2.3.3.3.3.3" xref="S2.p1.2.m2.3.3.3.3.3.cmml"><mi mathvariant="normal" id="S2.p1.2.m2.3.3.3.3.3.2" xref="S2.p1.2.m2.3.3.3.3.3.2.cmml">…</mi><mo id="S2.p1.2.m2.3.3.3.3.3.1" xref="S2.p1.2.m2.3.3.3.3.3.1.cmml">⁢</mo><msub id="S2.p1.2.m2.3.3.3.3.3.3" xref="S2.p1.2.m2.3.3.3.3.3.3.cmml"><mi id="S2.p1.2.m2.3.3.3.3.3.3.2" xref="S2.p1.2.m2.3.3.3.3.3.3.2.cmml">x</mi><mi id="S2.p1.2.m2.3.3.3.3.3.3.3" xref="S2.p1.2.m2.3.3.3.3.3.3.3.cmml">L</mi></msub></mrow><mo id="S2.p1.2.m2.3.3.3.3.7" xref="S2.p1.2.m2.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.3b"><apply id="S2.p1.2.m2.3.3.cmml" xref="S2.p1.2.m2.3.3"><eq id="S2.p1.2.m2.3.3.4.cmml" xref="S2.p1.2.m2.3.3.4"></eq><ci id="S2.p1.2.m2.3.3.5.cmml" xref="S2.p1.2.m2.3.3.5">𝒙</ci><vector id="S2.p1.2.m2.3.3.3.4.cmml" xref="S2.p1.2.m2.3.3.3.3"><apply id="S2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.p1.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S2.p1.2.m2.2.2.2.2.2.cmml" xref="S2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.p1.2.m2.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S2.p1.2.m2.2.2.2.2.2.3.cmml" xref="S2.p1.2.m2.2.2.2.2.2.3">2</cn></apply><apply id="S2.p1.2.m2.3.3.3.3.3.cmml" xref="S2.p1.2.m2.3.3.3.3.3"><times id="S2.p1.2.m2.3.3.3.3.3.1.cmml" xref="S2.p1.2.m2.3.3.3.3.3.1"></times><ci id="S2.p1.2.m2.3.3.3.3.3.2.cmml" xref="S2.p1.2.m2.3.3.3.3.3.2">…</ci><apply id="S2.p1.2.m2.3.3.3.3.3.3.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.3.3.3.3.1.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3">subscript</csymbol><ci id="S2.p1.2.m2.3.3.3.3.3.3.2.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3.2">𝑥</ci><ci id="S2.p1.2.m2.3.3.3.3.3.3.3.cmml" xref="S2.p1.2.m2.3.3.3.3.3.3.3">𝐿</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.3c">{\bm{x}}=\left(x_{1},x_{2},...x_{L}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.3d">bold_italic_x = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_x start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math>, where the tokens <math id="S2.p1.3.m3.2" class="ltx_Math" alttext="x_{l},y_{t}" display="inline"><semantics id="S2.p1.3.m3.2a"><mrow id="S2.p1.3.m3.2.2.2" xref="S2.p1.3.m3.2.2.3.cmml"><msub id="S2.p1.3.m3.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.cmml"><mi id="S2.p1.3.m3.1.1.1.1.2" xref="S2.p1.3.m3.1.1.1.1.2.cmml">x</mi><mi id="S2.p1.3.m3.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.p1.3.m3.2.2.2.3" xref="S2.p1.3.m3.2.2.3.cmml">,</mo><msub id="S2.p1.3.m3.2.2.2.2" xref="S2.p1.3.m3.2.2.2.2.cmml"><mi id="S2.p1.3.m3.2.2.2.2.2" xref="S2.p1.3.m3.2.2.2.2.2.cmml">y</mi><mi id="S2.p1.3.m3.2.2.2.2.3" xref="S2.p1.3.m3.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.2b"><list id="S2.p1.3.m3.2.2.3.cmml" xref="S2.p1.3.m3.2.2.2"><apply id="S2.p1.3.m3.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.2">𝑥</ci><ci id="S2.p1.3.m3.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.3">𝑙</ci></apply><apply id="S2.p1.3.m3.2.2.2.2.cmml" xref="S2.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.2.2.1.cmml" xref="S2.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S2.p1.3.m3.2.2.2.2.2.cmml" xref="S2.p1.3.m3.2.2.2.2.2">𝑦</ci><ci id="S2.p1.3.m3.2.2.2.2.3.cmml" xref="S2.p1.3.m3.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.2c">x_{l},y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.2d">italic_x start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> belong to a chosen vocabulary. A language generation policy <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_π</annotation></semantics></math> in an auto-regressive model characterized by a conditional probability distribution parameterized by <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_θ</annotation></semantics></math> as</p>
<table id="S2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex1.m1.2" class="ltx_Math" alttext="\pi_{\theta}({\bm{y}}\mid{\bm{x}})=\prod_{t=1}^{T}\pi_{\theta}(y_{t}\mid{\bm{y}}_{1:t-1},{\bm{x}})," display="block"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.cmml"><msub id="S2.Ex1.m1.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.1.3.2.cmml">π</mi><mi id="S2.Ex1.m1.2.2.1.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.Ex1.m1.2.2.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.Ex1.m1.2.2.1.1.3" xref="S2.Ex1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.cmml"><munderover id="S2.Ex1.m1.2.2.1.1.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="S2.Ex1.m1.2.2.1.1.2.2.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.cmml">∏</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2.2.3" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.2.2.3.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.2.cmml">t</mi><mo id="S2.Ex1.m1.2.2.1.1.2.2.2.3.1" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.1.cmml">=</mo><mn id="S2.Ex1.m1.2.2.1.1.2.2.2.3.3" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex1.m1.2.2.1.1.2.2.3" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">T</mi></munderover><mrow id="S2.Ex1.m1.2.2.1.1.2.1" xref="S2.Ex1.m1.2.2.1.1.2.1.cmml"><msub id="S2.Ex1.m1.2.2.1.1.2.1.3" xref="S2.Ex1.m1.2.2.1.1.2.1.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.1.3.2" xref="S2.Ex1.m1.2.2.1.1.2.1.3.2.cmml">π</mi><mi id="S2.Ex1.m1.2.2.1.1.2.1.3.3" xref="S2.Ex1.m1.2.2.1.1.2.1.3.3.cmml">θ</mi></msub><mo id="S2.Ex1.m1.2.2.1.1.2.1.2" xref="S2.Ex1.m1.2.2.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.cmml"><msub id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">y</mi><mi id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.2.cmml">∣</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><msub id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mrow id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml"><mn id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">,</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">𝒙</mi></mrow></mrow><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.2" xref="S2.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.1"><eq id="S2.Ex1.m1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.3"></eq><apply id="S2.Ex1.m1.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.2"></times><apply id="S2.Ex1.m1.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.3.2">𝜋</ci><ci id="S2.Ex1.m1.2.2.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.3.3">𝜃</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2">𝒚</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.3">𝒙</ci></apply></apply><apply id="S2.Ex1.m1.2.2.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2"><apply id="S2.Ex1.m1.2.2.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S2.Ex1.m1.2.2.1.1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.Ex1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2">product</csymbol><apply id="S2.Ex1.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3"><eq id="S2.Ex1.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.1"></eq><ci id="S2.Ex1.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="S2.Ex1.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S2.Ex1.m1.2.2.1.1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.3">𝑇</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1"><times id="S2.Ex1.m1.2.2.1.1.2.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.2"></times><apply id="S2.Ex1.m1.2.2.1.1.2.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.2.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.3.2">𝜋</ci><ci id="S2.Ex1.m1.2.2.1.1.2.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.3.3">𝜃</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.2">conditional</csymbol><apply id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.2">𝑦</ci><ci id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1"><apply id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">𝒚</ci><apply id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3"><ci id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3"><minus id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝒙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\pi_{\theta}({\bm{y}}\mid{\bm{x}})=\prod_{t=1}^{T}\pi_{\theta}(y_{t}\mid{\bm{y}}_{1:t-1},{\bm{x}}),</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x ) = ∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ bold_italic_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p1.7" class="ltx_p">with the convention <math id="S2.p1.6.m1.1" class="ltx_Math" alttext="{\bm{y}}_{1:0}=\emptyset" display="inline"><semantics id="S2.p1.6.m1.1a"><mrow id="S2.p1.6.m1.1.1" xref="S2.p1.6.m1.1.1.cmml"><msub id="S2.p1.6.m1.1.1.2" xref="S2.p1.6.m1.1.1.2.cmml"><mi id="S2.p1.6.m1.1.1.2.2" xref="S2.p1.6.m1.1.1.2.2.cmml">𝒚</mi><mrow id="S2.p1.6.m1.1.1.2.3" xref="S2.p1.6.m1.1.1.2.3.cmml"><mn id="S2.p1.6.m1.1.1.2.3.2" xref="S2.p1.6.m1.1.1.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.p1.6.m1.1.1.2.3.1" xref="S2.p1.6.m1.1.1.2.3.1.cmml">:</mo><mn id="S2.p1.6.m1.1.1.2.3.3" xref="S2.p1.6.m1.1.1.2.3.3.cmml">0</mn></mrow></msub><mo id="S2.p1.6.m1.1.1.1" xref="S2.p1.6.m1.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S2.p1.6.m1.1.1.3" xref="S2.p1.6.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m1.1b"><apply id="S2.p1.6.m1.1.1.cmml" xref="S2.p1.6.m1.1.1"><eq id="S2.p1.6.m1.1.1.1.cmml" xref="S2.p1.6.m1.1.1.1"></eq><apply id="S2.p1.6.m1.1.1.2.cmml" xref="S2.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.6.m1.1.1.2.1.cmml" xref="S2.p1.6.m1.1.1.2">subscript</csymbol><ci id="S2.p1.6.m1.1.1.2.2.cmml" xref="S2.p1.6.m1.1.1.2.2">𝒚</ci><apply id="S2.p1.6.m1.1.1.2.3.cmml" xref="S2.p1.6.m1.1.1.2.3"><ci id="S2.p1.6.m1.1.1.2.3.1.cmml" xref="S2.p1.6.m1.1.1.2.3.1">:</ci><cn type="integer" id="S2.p1.6.m1.1.1.2.3.2.cmml" xref="S2.p1.6.m1.1.1.2.3.2">1</cn><cn type="integer" id="S2.p1.6.m1.1.1.2.3.3.cmml" xref="S2.p1.6.m1.1.1.2.3.3">0</cn></apply></apply><emptyset id="S2.p1.6.m1.1.1.3.cmml" xref="S2.p1.6.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m1.1c">{\bm{y}}_{1:0}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m1.1d">bold_italic_y start_POSTSUBSCRIPT 1 : 0 end_POSTSUBSCRIPT = ∅</annotation></semantics></math> and <math id="S2.p1.7.m2.1" class="ltx_math_unparsed" alttext="{\bm{y}}_{1:t-1}=\left(y_{1},y_{2},....y_{t-1}\right)" display="inline"><semantics id="S2.p1.7.m2.1a"><mrow id="S2.p1.7.m2.1b"><msub id="S2.p1.7.m2.1.2"><mi id="S2.p1.7.m2.1.2.2">𝒚</mi><mrow id="S2.p1.7.m2.1.2.3"><mn id="S2.p1.7.m2.1.2.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.p1.7.m2.1.2.3.1">:</mo><mrow id="S2.p1.7.m2.1.2.3.3"><mi id="S2.p1.7.m2.1.2.3.3.2">t</mi><mo id="S2.p1.7.m2.1.2.3.3.1">−</mo><mn id="S2.p1.7.m2.1.2.3.3.3">1</mn></mrow></mrow></msub><mo id="S2.p1.7.m2.1.3">=</mo><mrow id="S2.p1.7.m2.1.4"><mo id="S2.p1.7.m2.1.4.1">(</mo><msub id="S2.p1.7.m2.1.4.2"><mi id="S2.p1.7.m2.1.4.2.2">y</mi><mn id="S2.p1.7.m2.1.4.2.3">1</mn></msub><mo id="S2.p1.7.m2.1.4.3">,</mo><msub id="S2.p1.7.m2.1.4.4"><mi id="S2.p1.7.m2.1.4.4.2">y</mi><mn id="S2.p1.7.m2.1.4.4.3">2</mn></msub><mo id="S2.p1.7.m2.1.4.5">,</mo><mi mathvariant="normal" id="S2.p1.7.m2.1.1">…</mi><mo lspace="0em" rspace="0.167em" id="S2.p1.7.m2.1.4.6">.</mo><msub id="S2.p1.7.m2.1.4.7"><mi id="S2.p1.7.m2.1.4.7.2">y</mi><mrow id="S2.p1.7.m2.1.4.7.3"><mi id="S2.p1.7.m2.1.4.7.3.2">t</mi><mo id="S2.p1.7.m2.1.4.7.3.1">−</mo><mn id="S2.p1.7.m2.1.4.7.3.3">1</mn></mrow></msub><mo id="S2.p1.7.m2.1.4.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.p1.7.m2.1c">{\bm{y}}_{1:t-1}=\left(y_{1},y_{2},....y_{t-1}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m2.1d">bold_italic_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT = ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … . italic_y start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.2" class="ltx_p">Let <math id="S2.p2.1.m1.4" class="ltx_Math" alttext="p({\bm{x}},{\bm{y}})=p({\bm{x}})p({\bm{y}}|{\bm{x}})" display="inline"><semantics id="S2.p2.1.m1.4a"><mrow id="S2.p2.1.m1.4.4" xref="S2.p2.1.m1.4.4.cmml"><mrow id="S2.p2.1.m1.4.4.3" xref="S2.p2.1.m1.4.4.3.cmml"><mi id="S2.p2.1.m1.4.4.3.2" xref="S2.p2.1.m1.4.4.3.2.cmml">p</mi><mo id="S2.p2.1.m1.4.4.3.1" xref="S2.p2.1.m1.4.4.3.1.cmml">⁢</mo><mrow id="S2.p2.1.m1.4.4.3.3.2" xref="S2.p2.1.m1.4.4.3.3.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.4.4.3.3.2.1" xref="S2.p2.1.m1.4.4.3.3.1.cmml">(</mo><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">𝒙</mi><mo id="S2.p2.1.m1.4.4.3.3.2.2" xref="S2.p2.1.m1.4.4.3.3.1.cmml">,</mo><mi id="S2.p2.1.m1.2.2" xref="S2.p2.1.m1.2.2.cmml">𝒚</mi><mo stretchy="false" id="S2.p2.1.m1.4.4.3.3.2.3" xref="S2.p2.1.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.p2.1.m1.4.4.2" xref="S2.p2.1.m1.4.4.2.cmml">=</mo><mrow id="S2.p2.1.m1.4.4.1" xref="S2.p2.1.m1.4.4.1.cmml"><mi id="S2.p2.1.m1.4.4.1.3" xref="S2.p2.1.m1.4.4.1.3.cmml">p</mi><mo id="S2.p2.1.m1.4.4.1.2" xref="S2.p2.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.4.4.1.4.2" xref="S2.p2.1.m1.4.4.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.4.4.1.4.2.1" xref="S2.p2.1.m1.4.4.1.cmml">(</mo><mi id="S2.p2.1.m1.3.3" xref="S2.p2.1.m1.3.3.cmml">𝒙</mi><mo stretchy="false" id="S2.p2.1.m1.4.4.1.4.2.2" xref="S2.p2.1.m1.4.4.1.cmml">)</mo></mrow><mo id="S2.p2.1.m1.4.4.1.2a" xref="S2.p2.1.m1.4.4.1.2.cmml">⁢</mo><mi id="S2.p2.1.m1.4.4.1.5" xref="S2.p2.1.m1.4.4.1.5.cmml">p</mi><mo id="S2.p2.1.m1.4.4.1.2b" xref="S2.p2.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.4.4.1.1.1" xref="S2.p2.1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.4.4.1.1.1.2" xref="S2.p2.1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.p2.1.m1.4.4.1.1.1.1" xref="S2.p2.1.m1.4.4.1.1.1.1.cmml"><mi id="S2.p2.1.m1.4.4.1.1.1.1.2" xref="S2.p2.1.m1.4.4.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S2.p2.1.m1.4.4.1.1.1.1.1" xref="S2.p2.1.m1.4.4.1.1.1.1.1.cmml">|</mo><mi id="S2.p2.1.m1.4.4.1.1.1.1.3" xref="S2.p2.1.m1.4.4.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S2.p2.1.m1.4.4.1.1.1.3" xref="S2.p2.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.4b"><apply id="S2.p2.1.m1.4.4.cmml" xref="S2.p2.1.m1.4.4"><eq id="S2.p2.1.m1.4.4.2.cmml" xref="S2.p2.1.m1.4.4.2"></eq><apply id="S2.p2.1.m1.4.4.3.cmml" xref="S2.p2.1.m1.4.4.3"><times id="S2.p2.1.m1.4.4.3.1.cmml" xref="S2.p2.1.m1.4.4.3.1"></times><ci id="S2.p2.1.m1.4.4.3.2.cmml" xref="S2.p2.1.m1.4.4.3.2">𝑝</ci><interval closure="open" id="S2.p2.1.m1.4.4.3.3.1.cmml" xref="S2.p2.1.m1.4.4.3.3.2"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝒙</ci><ci id="S2.p2.1.m1.2.2.cmml" xref="S2.p2.1.m1.2.2">𝒚</ci></interval></apply><apply id="S2.p2.1.m1.4.4.1.cmml" xref="S2.p2.1.m1.4.4.1"><times id="S2.p2.1.m1.4.4.1.2.cmml" xref="S2.p2.1.m1.4.4.1.2"></times><ci id="S2.p2.1.m1.4.4.1.3.cmml" xref="S2.p2.1.m1.4.4.1.3">𝑝</ci><ci id="S2.p2.1.m1.3.3.cmml" xref="S2.p2.1.m1.3.3">𝒙</ci><ci id="S2.p2.1.m1.4.4.1.5.cmml" xref="S2.p2.1.m1.4.4.1.5">𝑝</ci><apply id="S2.p2.1.m1.4.4.1.1.1.1.cmml" xref="S2.p2.1.m1.4.4.1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.4.4.1.1.1.1.1.cmml" xref="S2.p2.1.m1.4.4.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.1.m1.4.4.1.1.1.1.2.cmml" xref="S2.p2.1.m1.4.4.1.1.1.1.2">𝒚</ci><ci id="S2.p2.1.m1.4.4.1.1.1.1.3.cmml" xref="S2.p2.1.m1.4.4.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.4c">p({\bm{x}},{\bm{y}})=p({\bm{x}})p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.4d">italic_p ( bold_italic_x , bold_italic_y ) = italic_p ( bold_italic_x ) italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math> denote the data distribution. A given dataset <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S2.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">caligraphic_D</annotation></semantics></math> consists of samples from this distribution:</p>
<table id="S2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.Ex2.m1.4" class="ltx_Math" alttext="{\cal D}=\{\;({\bm{x}}^{i},{\bm{y}}^{i})|_{i=1}^{N}\;\;\mbox{such that}\;\;{\bm{x}}^{i}\sim p({\bm{x}}),\;{\bm{y}}^{i}\sim p({\bm{y}}|{\bm{x}}={\bm{x}}^{i})\;\}." display="block"><semantics id="S2.Ex2.m1.4a"><mrow id="S2.Ex2.m1.4.4.1" xref="S2.Ex2.m1.4.4.1.1.cmml"><mrow id="S2.Ex2.m1.4.4.1.1" xref="S2.Ex2.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.4.4.1.1.3" xref="S2.Ex2.m1.4.4.1.1.3.cmml">𝒟</mi><mo id="S2.Ex2.m1.4.4.1.1.2" xref="S2.Ex2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.2.cmml"><mo rspace="0.280em" stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.2.cmml">{</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.3.cmml"><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msup id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msup id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S2.Ex2.m1.1.1.1" xref="S2.Ex2.m1.1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.2.cmml">i</mi><mo id="S2.Ex2.m1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.cmml">=</mo><mn id="S2.Ex2.m1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.3.cmml">1</mn></mrow><mi id="S2.Ex2.m1.2.2.1" xref="S2.Ex2.m1.2.2.1.cmml">N</mi></msubsup><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mtext id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.3a.cmml">such that</mtext><mo lspace="0.560em" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.2a" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml">𝒙</mi><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msup></mrow><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.2.cmml">∼</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">p</mi><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.3.2.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml">𝒙</mi><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.3.2.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.447em" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.cmml"><msup id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">𝒚</mi><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">i</mi></msup><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.2.cmml">∼</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.3.cmml">p</mi><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">𝒚</mi><mo fence="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.1.cmml">|</mo><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.3.cmml">𝒙</mi></mrow><mo id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.1" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.1.cmml">=</mo><msup id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">i</mi></msup></mrow><mo rspace="0.280em" stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.3" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S2.Ex2.m1.4.4.1.1.1.1.3" xref="S2.Ex2.m1.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S2.Ex2.m1.4.4.1.2" xref="S2.Ex2.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.4b"><apply id="S2.Ex2.m1.4.4.1.1.cmml" xref="S2.Ex2.m1.4.4.1"><eq id="S2.Ex2.m1.4.4.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.2"></eq><ci id="S2.Ex2.m1.4.4.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.3">𝒟</ci><set id="S2.Ex2.m1.4.4.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1"><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.1.1.1.1.1.3a.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.2">similar-to</csymbol><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1"><times id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.2"></times><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2">evaluated-at</csymbol><interval closure="open" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒚</ci><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="S2.Ex2.m1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1"><eq id="S2.Ex2.m1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1"></eq><ci id="S2.Ex2.m1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.2">𝑖</ci><cn type="integer" id="S2.Ex2.m1.1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.3">1</cn></apply><ci id="S2.Ex2.m1.2.2.1.cmml" xref="S2.Ex2.m1.2.2.1">𝑁</ci></apply><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.3"><mtext id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.3">such that</mtext></ci><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.2">𝒙</ci><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3"><times id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.1"></times><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">𝒙</ci></apply></apply><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2"><csymbol cd="latexml" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.2">similar-to</csymbol><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.2">𝒚</ci><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.3.3">𝑖</ci></apply><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1"><times id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.2"></times><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.3">𝑝</ci><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1"><eq id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.1"></eq><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2"><csymbol cd="latexml" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.1">conditional</csymbol><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.2">𝒚</ci><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.2.3">𝒙</ci></apply><apply id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.2">𝒙</ci><ci id="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.4.4.1.1.1.1.1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.4c">{\cal D}=\{\;({\bm{x}}^{i},{\bm{y}}^{i})|_{i=1}^{N}\;\;\mbox{such that}\;\;{\bm{x}}^{i}\sim p({\bm{x}}),\;{\bm{y}}^{i}\sim p({\bm{y}}|{\bm{x}}={\bm{x}}^{i})\;\}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.4d">caligraphic_D = { ( bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , bold_italic_y start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) | start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT such that bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ italic_p ( bold_italic_x ) , bold_italic_y start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ italic_p ( bold_italic_y | bold_italic_x = bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.p2.3" class="ltx_p">Given this dataset, the supervised policy is trained by minimizing the negative log likelihood (NLL) loss:</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\displaystyle{\mathcal{L}}_{\text{NLL}}(\theta)=-\mathbb{E}_{({\bm{x}},{\bm{y}})\sim{\cal D}}\left[\sum_{t=1}^{T}\log\pi_{\theta}(y_{t}\mid{\bm{y}}_{1:t-1},{\bm{x}})\right]." display="inline"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml"><msub id="S2.E1.m1.5.5.1.1.3.2" xref="S2.E1.m1.5.5.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.3.2.2" xref="S2.E1.m1.5.5.1.1.3.2.2.cmml">ℒ</mi><mtext id="S2.E1.m1.5.5.1.1.3.2.3" xref="S2.E1.m1.5.5.1.1.3.2.3a.cmml">NLL</mtext></msub><mo id="S2.E1.m1.5.5.1.1.3.1" xref="S2.E1.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.3.3.2" xref="S2.E1.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.3.3.2.1" xref="S2.E1.m1.5.5.1.1.3.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.3.3.2.2" xref="S2.E1.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.2" xref="S2.E1.m1.5.5.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.5.5.1.1.1" xref="S2.E1.m1.5.5.1.1.1.cmml"><mo id="S2.E1.m1.5.5.1.1.1a" xref="S2.E1.m1.5.5.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.5.5.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><msub id="S2.E1.m1.5.5.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mrow id="S2.E1.m1.2.2.2.4.2" xref="S2.E1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.4.2.1" xref="S2.E1.m1.2.2.2.4.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">𝒙</mi><mo id="S2.E1.m1.2.2.2.4.2.2" xref="S2.E1.m1.2.2.2.4.1.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">𝒚</mi><mo stretchy="false" id="S2.E1.m1.2.2.2.4.2.3" xref="S2.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.2.5" xref="S2.E1.m1.2.2.2.5.cmml">𝒟</mi></mrow></msub><mo id="S2.E1.m1.5.5.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml"><munderover id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2a" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3a" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">𝒙</mi></mrow></mrow><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><eq id="S2.E1.m1.5.5.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.2"></eq><apply id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"><times id="S2.E1.m1.5.5.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.1"></times><apply id="S2.E1.m1.5.5.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.3.2.2">ℒ</ci><ci id="S2.E1.m1.5.5.1.1.3.2.3a.cmml" xref="S2.E1.m1.5.5.1.1.3.2.3"><mtext mathsize="70%" id="S2.E1.m1.5.5.1.1.3.2.3.cmml" xref="S2.E1.m1.5.5.1.1.3.2.3">NLL</mtext></ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝜃</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1"><minus id="S2.E1.m1.5.5.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1"></minus><apply id="S2.E1.m1.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2"></times><apply id="S2.E1.m1.5.5.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3.2">𝔼</ci><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S2.E1.m1.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.4.2"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝒙</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝒚</ci></interval><ci id="S2.E1.m1.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.5">𝒟</ci></apply></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3"><log id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.1"></log><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒚</ci><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝒙</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\displaystyle{\mathcal{L}}_{\text{NLL}}(\theta)=-\mathbb{E}_{({\bm{x}},{\bm{y}})\sim{\cal D}}\left[\sum_{t=1}^{T}\log\pi_{\theta}(y_{t}\mid{\bm{y}}_{1:t-1},{\bm{x}})\right].</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.5d">caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT ( italic_θ ) = - blackboard_E start_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) ∼ caligraphic_D end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ bold_italic_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_x ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.4" class="ltx_p">We refer to the model that is trained with the NLL loss as behavioral cloning (BC) <cite class="ltx_cite ltx_citemacro_citep">(Pomerleau, <a href="#bib.bib43" title="" class="ltx_ref">1989</a>)</cite> following the RL literature nomenclature.</p>
</div>
</section>
<section id="S3" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Reinforced Self-Training (<span id="S3.1.1" class="ltx_ERROR undefined">\rest</span>)</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We present <span id="S3.p1.1.1" class="ltx_ERROR undefined">\rest</span>, an RLHF algorithm that aligns the language model’s outputs with human preferences. Human preferences over sequences are modelled using a learned reward function (see Appendix <a href="#A1.SS4" title="A.4 Reward model ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.4</span></a>). In the underlying Markov decision process for conditional language modelling the states are the partial sequences, and the actions are the generated tokens (see Appendix <a href="#A1.SS1" title="A.1 RLHF for conditional language modeling as MDP ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>).</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.5" class="ltx_p">The <span id="S3.p2.5.1" class="ltx_ERROR undefined">\rest</span> algorithm decouples the dataset growth and policy improvement of a typical RL pipeline into separate offline stages (Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S3.F2" title="Figure 2 ‣ Grow ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). We start by training an initial model <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\pi_{\theta}({\bm{y}}|{\bm{x}})" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><msub id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mi id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">π</mi><mi id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.1.m1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S3.p2.1.m1.1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.p2.1.m1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><times id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2"></times><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">𝜋</ci><ci id="S3.p2.1.m1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2">𝒚</ci><ci id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\pi_{\theta}({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x )</annotation></semantics></math> to map input sequences <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="{\bm{x}}" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">bold_italic_x</annotation></semantics></math> to output sequences <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">bold_italic_y</annotation></semantics></math> on a given dataset of sequence pairs <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S3.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">caligraphic_D</annotation></semantics></math> using the NLL loss from Equation (<a href="#S2.E1" title="1 ‣ 2 Preliminaries ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Next, the <span id="S3.p2.5.2" class="ltx_text ltx_font_typewriter">Grow</span> step creates a new dataset <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">𝒟</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝒟</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, which augments the initial training dataset with samples from the model:</p>
<table id="S3.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex3.m1.3" class="ltx_Math" alttext="{\cal D}_{g}=\{\;({\bm{x}}^{i},{\bm{y}}^{i})|_{i=1}^{N_{g}}\;\;\mbox{such that}\;\;{\bm{x}}^{i}\sim{\cal D},\;{\bm{y}}^{i}\sim\pi_{\theta}({\bm{y}}|{\bm{x}}^{i})\;\}\cup{\cal D}." display="block"><semantics id="S3.Ex3.m1.3a"><mrow id="S3.Ex3.m1.3.3.1" xref="S3.Ex3.m1.3.3.1.1.cmml"><mrow id="S3.Ex3.m1.3.3.1.1" xref="S3.Ex3.m1.3.3.1.1.cmml"><msub id="S3.Ex3.m1.3.3.1.1.3" xref="S3.Ex3.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.1.1.3.2" xref="S3.Ex3.m1.3.3.1.1.3.2.cmml">𝒟</mi><mi id="S3.Ex3.m1.3.3.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.3.3.cmml">g</mi></msub><mo id="S3.Ex3.m1.3.3.1.1.2" xref="S3.Ex3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.Ex3.m1.3.3.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.2.cmml"><mo rspace="0.280em" stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.2.cmml">{</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">i</mi><mo id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml">=</mo><mn id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">1</mn></mrow><msub id="S3.Ex3.m1.2.2.1" xref="S3.Ex3.m1.2.2.1.cmml"><mi id="S3.Ex3.m1.2.2.1.2" xref="S3.Ex3.m1.2.2.1.2.cmml">N</mi><mi id="S3.Ex3.m1.2.2.1.3" xref="S3.Ex3.m1.2.2.1.3.cmml">g</mi></msub></msubsup><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mtext id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3a.cmml">such that</mtext><mo lspace="0.560em" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2a" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml">𝒙</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msup></mrow><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi></mrow><mo rspace="0.447em" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.cmml"><msup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.2.cmml">𝒚</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></msup><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">∼</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.cmml"><msub id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.2.cmml">π</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.3.cmml">θ</mi></msub><mo id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml">|</mo><msup id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">𝒙</mi><mi id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">i</mi></msup></mrow><mo rspace="0.280em" stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S3.Ex3.m1.3.3.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.Ex3.m1.3.3.1.1.1.2" xref="S3.Ex3.m1.3.3.1.1.1.2.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.1.1.1.3" xref="S3.Ex3.m1.3.3.1.1.1.3.cmml">𝒟</mi></mrow></mrow><mo lspace="0em" id="S3.Ex3.m1.3.3.1.2" xref="S3.Ex3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.3b"><apply id="S3.Ex3.m1.3.3.1.1.cmml" xref="S3.Ex3.m1.3.3.1"><eq id="S3.Ex3.m1.3.3.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.2"></eq><apply id="S3.Ex3.m1.3.3.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.3.2">𝒟</ci><ci id="S3.Ex3.m1.3.3.1.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.3.3">𝑔</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1"><union id="S3.Ex3.m1.3.3.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.2"></union><set id="S3.Ex3.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1"><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.3a.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.2">similar-to</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">evaluated-at</csymbol><interval closure="open" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒚</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><eq id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1"></eq><ci id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2">𝑖</ci><cn type="integer" id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">1</cn></apply><apply id="S3.Ex3.m1.2.2.1.cmml" xref="S3.Ex3.m1.2.2.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.1">subscript</csymbol><ci id="S3.Ex3.m1.2.2.1.2.cmml" xref="S3.Ex3.m1.2.2.1.2">𝑁</ci><ci id="S3.Ex3.m1.2.2.1.3.cmml" xref="S3.Ex3.m1.2.2.1.3">𝑔</ci></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.3">such that</mtext></ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.2">𝒙</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.1.1.3">𝒟</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.2">similar-to</csymbol><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.2">𝒚</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.3.3">𝑖</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1"><times id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.2"></times><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.2">𝜋</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.3.3">𝜃</ci></apply><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2">𝒚</ci><apply id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2">𝒙</ci><ci id="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></set><ci id="S3.Ex3.m1.3.3.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.1.1.1.3">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.3c">{\cal D}_{g}=\{\;({\bm{x}}^{i},{\bm{y}}^{i})|_{i=1}^{N_{g}}\;\;\mbox{such that}\;\;{\bm{x}}^{i}\sim{\cal D},\;{\bm{y}}^{i}\sim\pi_{\theta}({\bm{y}}|{\bm{x}}^{i})\;\}\cup{\cal D}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.3d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT = { ( bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , bold_italic_y start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) | start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_POSTSUPERSCRIPT such that bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ caligraphic_D , bold_italic_y start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) } ∪ caligraphic_D .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p2.9" class="ltx_p">Here, the conditioning inputs are resampled from the original dataset <math id="S3.p2.6.m1.1" class="ltx_Math" alttext="{\bm{x}}^{i}\sim{\cal D}" display="inline"><semantics id="S3.p2.6.m1.1a"><mrow id="S3.p2.6.m1.1.1" xref="S3.p2.6.m1.1.1.cmml"><msup id="S3.p2.6.m1.1.1.2" xref="S3.p2.6.m1.1.1.2.cmml"><mi id="S3.p2.6.m1.1.1.2.2" xref="S3.p2.6.m1.1.1.2.2.cmml">𝒙</mi><mi id="S3.p2.6.m1.1.1.2.3" xref="S3.p2.6.m1.1.1.2.3.cmml">i</mi></msup><mo id="S3.p2.6.m1.1.1.1" xref="S3.p2.6.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m1.1.1.3" xref="S3.p2.6.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m1.1b"><apply id="S3.p2.6.m1.1.1.cmml" xref="S3.p2.6.m1.1.1"><csymbol cd="latexml" id="S3.p2.6.m1.1.1.1.cmml" xref="S3.p2.6.m1.1.1.1">similar-to</csymbol><apply id="S3.p2.6.m1.1.1.2.cmml" xref="S3.p2.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.6.m1.1.1.2.1.cmml" xref="S3.p2.6.m1.1.1.2">superscript</csymbol><ci id="S3.p2.6.m1.1.1.2.2.cmml" xref="S3.p2.6.m1.1.1.2.2">𝒙</ci><ci id="S3.p2.6.m1.1.1.2.3.cmml" xref="S3.p2.6.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.p2.6.m1.1.1.3.cmml" xref="S3.p2.6.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m1.1c">{\bm{x}}^{i}\sim{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m1.1d">bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ caligraphic_D</annotation></semantics></math>, as in self-training, but in situations where one has access to <math id="S3.p2.7.m2.1" class="ltx_Math" alttext="p({\bm{x}})" display="inline"><semantics id="S3.p2.7.m2.1a"><mrow id="S3.p2.7.m2.1.2" xref="S3.p2.7.m2.1.2.cmml"><mi id="S3.p2.7.m2.1.2.2" xref="S3.p2.7.m2.1.2.2.cmml">p</mi><mo id="S3.p2.7.m2.1.2.1" xref="S3.p2.7.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p2.7.m2.1.2.3.2" xref="S3.p2.7.m2.1.2.cmml"><mo stretchy="false" id="S3.p2.7.m2.1.2.3.2.1" xref="S3.p2.7.m2.1.2.cmml">(</mo><mi id="S3.p2.7.m2.1.1" xref="S3.p2.7.m2.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.p2.7.m2.1.2.3.2.2" xref="S3.p2.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.7.m2.1b"><apply id="S3.p2.7.m2.1.2.cmml" xref="S3.p2.7.m2.1.2"><times id="S3.p2.7.m2.1.2.1.cmml" xref="S3.p2.7.m2.1.2.1"></times><ci id="S3.p2.7.m2.1.2.2.cmml" xref="S3.p2.7.m2.1.2.2">𝑝</ci><ci id="S3.p2.7.m2.1.1.cmml" xref="S3.p2.7.m2.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m2.1c">p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m2.1d">italic_p ( bold_italic_x )</annotation></semantics></math> they could sample directly from it, i.e., <math id="S3.p2.8.m3.1" class="ltx_Math" alttext="{\bm{x}}^{i}\sim p({\bm{x}})" display="inline"><semantics id="S3.p2.8.m3.1a"><mrow id="S3.p2.8.m3.1.2" xref="S3.p2.8.m3.1.2.cmml"><msup id="S3.p2.8.m3.1.2.2" xref="S3.p2.8.m3.1.2.2.cmml"><mi id="S3.p2.8.m3.1.2.2.2" xref="S3.p2.8.m3.1.2.2.2.cmml">𝒙</mi><mi id="S3.p2.8.m3.1.2.2.3" xref="S3.p2.8.m3.1.2.2.3.cmml">i</mi></msup><mo id="S3.p2.8.m3.1.2.1" xref="S3.p2.8.m3.1.2.1.cmml">∼</mo><mrow id="S3.p2.8.m3.1.2.3" xref="S3.p2.8.m3.1.2.3.cmml"><mi id="S3.p2.8.m3.1.2.3.2" xref="S3.p2.8.m3.1.2.3.2.cmml">p</mi><mo id="S3.p2.8.m3.1.2.3.1" xref="S3.p2.8.m3.1.2.3.1.cmml">⁢</mo><mrow id="S3.p2.8.m3.1.2.3.3.2" xref="S3.p2.8.m3.1.2.3.cmml"><mo stretchy="false" id="S3.p2.8.m3.1.2.3.3.2.1" xref="S3.p2.8.m3.1.2.3.cmml">(</mo><mi id="S3.p2.8.m3.1.1" xref="S3.p2.8.m3.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.p2.8.m3.1.2.3.3.2.2" xref="S3.p2.8.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m3.1b"><apply id="S3.p2.8.m3.1.2.cmml" xref="S3.p2.8.m3.1.2"><csymbol cd="latexml" id="S3.p2.8.m3.1.2.1.cmml" xref="S3.p2.8.m3.1.2.1">similar-to</csymbol><apply id="S3.p2.8.m3.1.2.2.cmml" xref="S3.p2.8.m3.1.2.2"><csymbol cd="ambiguous" id="S3.p2.8.m3.1.2.2.1.cmml" xref="S3.p2.8.m3.1.2.2">superscript</csymbol><ci id="S3.p2.8.m3.1.2.2.2.cmml" xref="S3.p2.8.m3.1.2.2.2">𝒙</ci><ci id="S3.p2.8.m3.1.2.2.3.cmml" xref="S3.p2.8.m3.1.2.2.3">𝑖</ci></apply><apply id="S3.p2.8.m3.1.2.3.cmml" xref="S3.p2.8.m3.1.2.3"><times id="S3.p2.8.m3.1.2.3.1.cmml" xref="S3.p2.8.m3.1.2.3.1"></times><ci id="S3.p2.8.m3.1.2.3.2.cmml" xref="S3.p2.8.m3.1.2.3.2">𝑝</ci><ci id="S3.p2.8.m3.1.1.cmml" xref="S3.p2.8.m3.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m3.1c">{\bm{x}}^{i}\sim p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m3.1d">bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ italic_p ( bold_italic_x )</annotation></semantics></math>. For example, consider a model that generates image from a textual description, in this case, the distribution of text inputs can be sampled from a language model <math id="S3.p2.9.m4.1" class="ltx_Math" alttext="p({\bm{x}})" display="inline"><semantics id="S3.p2.9.m4.1a"><mrow id="S3.p2.9.m4.1.2" xref="S3.p2.9.m4.1.2.cmml"><mi id="S3.p2.9.m4.1.2.2" xref="S3.p2.9.m4.1.2.2.cmml">p</mi><mo id="S3.p2.9.m4.1.2.1" xref="S3.p2.9.m4.1.2.1.cmml">⁢</mo><mrow id="S3.p2.9.m4.1.2.3.2" xref="S3.p2.9.m4.1.2.cmml"><mo stretchy="false" id="S3.p2.9.m4.1.2.3.2.1" xref="S3.p2.9.m4.1.2.cmml">(</mo><mi id="S3.p2.9.m4.1.1" xref="S3.p2.9.m4.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.p2.9.m4.1.2.3.2.2" xref="S3.p2.9.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.9.m4.1b"><apply id="S3.p2.9.m4.1.2.cmml" xref="S3.p2.9.m4.1.2"><times id="S3.p2.9.m4.1.2.1.cmml" xref="S3.p2.9.m4.1.2.1"></times><ci id="S3.p2.9.m4.1.2.2.cmml" xref="S3.p2.9.m4.1.2.2">𝑝</ci><ci id="S3.p2.9.m4.1.1.cmml" xref="S3.p2.9.m4.1.1">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m4.1c">p({\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m4.1d">italic_p ( bold_italic_x )</annotation></semantics></math>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.2" class="ltx_p">Subsequently, the <span id="S3.p3.2.1" class="ltx_text ltx_font_typewriter">Improve</span> steps use <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝒟</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> to fine-tune the policy <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">π</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝜋</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. Note that we keep the original dataset in the training mixture to ensure that the policies do not diverge. Below, we describe <span id="S3.p3.2.2" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S3.p3.2.3" class="ltx_text ltx_font_typewriter">Improve</span> steps in more details.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S3.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">Grow</h4>

<figure id="S3.F2" class="ltx_figure ltx_align_floatright"><img src="assets/plots/threshold-v5.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="503" height="779" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.15.1" class="ltx_ERROR undefined">\rest</span><span id="S3.F2.16.2" class="ltx_text ltx_font_bold"> algorithm</span>. <span id="S3.F2.17.3" class="ltx_text ltx_font_italic">Top</span>: At <span id="S3.F2.18.4" class="ltx_text ltx_font_typewriter">Improve</span> steps <span id="S3.F2.19.5" class="ltx_text ltx_font_typewriter">I=1,I=2,I=3</span>, the dataset from the initial policy is filtered with thresholds <math id="S3.F2.5.m1.1" class="ltx_Math" alttext="\tau_{1}&lt;\tau_{2}&lt;\tau_{3}" display="inline"><semantics id="S3.F2.5.m1.1b"><mrow id="S3.F2.5.m1.1.1" xref="S3.F2.5.m1.1.1.cmml"><msub id="S3.F2.5.m1.1.1.2" xref="S3.F2.5.m1.1.1.2.cmml"><mi id="S3.F2.5.m1.1.1.2.2" xref="S3.F2.5.m1.1.1.2.2.cmml">τ</mi><mn id="S3.F2.5.m1.1.1.2.3" xref="S3.F2.5.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.F2.5.m1.1.1.3" xref="S3.F2.5.m1.1.1.3.cmml">&lt;</mo><msub id="S3.F2.5.m1.1.1.4" xref="S3.F2.5.m1.1.1.4.cmml"><mi id="S3.F2.5.m1.1.1.4.2" xref="S3.F2.5.m1.1.1.4.2.cmml">τ</mi><mn id="S3.F2.5.m1.1.1.4.3" xref="S3.F2.5.m1.1.1.4.3.cmml">2</mn></msub><mo id="S3.F2.5.m1.1.1.5" xref="S3.F2.5.m1.1.1.5.cmml">&lt;</mo><msub id="S3.F2.5.m1.1.1.6" xref="S3.F2.5.m1.1.1.6.cmml"><mi id="S3.F2.5.m1.1.1.6.2" xref="S3.F2.5.m1.1.1.6.2.cmml">τ</mi><mn id="S3.F2.5.m1.1.1.6.3" xref="S3.F2.5.m1.1.1.6.3.cmml">3</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.5.m1.1c"><apply id="S3.F2.5.m1.1.1.cmml" xref="S3.F2.5.m1.1.1"><and id="S3.F2.5.m1.1.1a.cmml" xref="S3.F2.5.m1.1.1"></and><apply id="S3.F2.5.m1.1.1b.cmml" xref="S3.F2.5.m1.1.1"><lt id="S3.F2.5.m1.1.1.3.cmml" xref="S3.F2.5.m1.1.1.3"></lt><apply id="S3.F2.5.m1.1.1.2.cmml" xref="S3.F2.5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.F2.5.m1.1.1.2.1.cmml" xref="S3.F2.5.m1.1.1.2">subscript</csymbol><ci id="S3.F2.5.m1.1.1.2.2.cmml" xref="S3.F2.5.m1.1.1.2.2">𝜏</ci><cn type="integer" id="S3.F2.5.m1.1.1.2.3.cmml" xref="S3.F2.5.m1.1.1.2.3">1</cn></apply><apply id="S3.F2.5.m1.1.1.4.cmml" xref="S3.F2.5.m1.1.1.4"><csymbol cd="ambiguous" id="S3.F2.5.m1.1.1.4.1.cmml" xref="S3.F2.5.m1.1.1.4">subscript</csymbol><ci id="S3.F2.5.m1.1.1.4.2.cmml" xref="S3.F2.5.m1.1.1.4.2">𝜏</ci><cn type="integer" id="S3.F2.5.m1.1.1.4.3.cmml" xref="S3.F2.5.m1.1.1.4.3">2</cn></apply></apply><apply id="S3.F2.5.m1.1.1c.cmml" xref="S3.F2.5.m1.1.1"><lt id="S3.F2.5.m1.1.1.5.cmml" xref="S3.F2.5.m1.1.1.5"></lt><share href="#S3.F2.5.m1.1.1.4.cmml" id="S3.F2.5.m1.1.1d.cmml" xref="S3.F2.5.m1.1.1"></share><apply id="S3.F2.5.m1.1.1.6.cmml" xref="S3.F2.5.m1.1.1.6"><csymbol cd="ambiguous" id="S3.F2.5.m1.1.1.6.1.cmml" xref="S3.F2.5.m1.1.1.6">subscript</csymbol><ci id="S3.F2.5.m1.1.1.6.2.cmml" xref="S3.F2.5.m1.1.1.6.2">𝜏</ci><cn type="integer" id="S3.F2.5.m1.1.1.6.3.cmml" xref="S3.F2.5.m1.1.1.6.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m1.1d">\tau_{1}&lt;\tau_{2}&lt;\tau_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.5.m1.1e">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT &lt; italic_τ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> and a sequence of policies <math id="S3.F2.6.m2.3" class="ltx_Math" alttext="\pi_{\theta_{1}},\pi_{\theta_{2}},\pi_{\theta_{3}}" display="inline"><semantics id="S3.F2.6.m2.3b"><mrow id="S3.F2.6.m2.3.3.3" xref="S3.F2.6.m2.3.3.4.cmml"><msub id="S3.F2.6.m2.1.1.1.1" xref="S3.F2.6.m2.1.1.1.1.cmml"><mi id="S3.F2.6.m2.1.1.1.1.2" xref="S3.F2.6.m2.1.1.1.1.2.cmml">π</mi><msub id="S3.F2.6.m2.1.1.1.1.3" xref="S3.F2.6.m2.1.1.1.1.3.cmml"><mi id="S3.F2.6.m2.1.1.1.1.3.2" xref="S3.F2.6.m2.1.1.1.1.3.2.cmml">θ</mi><mn id="S3.F2.6.m2.1.1.1.1.3.3" xref="S3.F2.6.m2.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.F2.6.m2.3.3.3.4" xref="S3.F2.6.m2.3.3.4.cmml">,</mo><msub id="S3.F2.6.m2.2.2.2.2" xref="S3.F2.6.m2.2.2.2.2.cmml"><mi id="S3.F2.6.m2.2.2.2.2.2" xref="S3.F2.6.m2.2.2.2.2.2.cmml">π</mi><msub id="S3.F2.6.m2.2.2.2.2.3" xref="S3.F2.6.m2.2.2.2.2.3.cmml"><mi id="S3.F2.6.m2.2.2.2.2.3.2" xref="S3.F2.6.m2.2.2.2.2.3.2.cmml">θ</mi><mn id="S3.F2.6.m2.2.2.2.2.3.3" xref="S3.F2.6.m2.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.F2.6.m2.3.3.3.5" xref="S3.F2.6.m2.3.3.4.cmml">,</mo><msub id="S3.F2.6.m2.3.3.3.3" xref="S3.F2.6.m2.3.3.3.3.cmml"><mi id="S3.F2.6.m2.3.3.3.3.2" xref="S3.F2.6.m2.3.3.3.3.2.cmml">π</mi><msub id="S3.F2.6.m2.3.3.3.3.3" xref="S3.F2.6.m2.3.3.3.3.3.cmml"><mi id="S3.F2.6.m2.3.3.3.3.3.2" xref="S3.F2.6.m2.3.3.3.3.3.2.cmml">θ</mi><mn id="S3.F2.6.m2.3.3.3.3.3.3" xref="S3.F2.6.m2.3.3.3.3.3.3.cmml">3</mn></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.6.m2.3c"><list id="S3.F2.6.m2.3.3.4.cmml" xref="S3.F2.6.m2.3.3.3"><apply id="S3.F2.6.m2.1.1.1.1.cmml" xref="S3.F2.6.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.6.m2.1.1.1.1.1.cmml" xref="S3.F2.6.m2.1.1.1.1">subscript</csymbol><ci id="S3.F2.6.m2.1.1.1.1.2.cmml" xref="S3.F2.6.m2.1.1.1.1.2">𝜋</ci><apply id="S3.F2.6.m2.1.1.1.1.3.cmml" xref="S3.F2.6.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.6.m2.1.1.1.1.3.1.cmml" xref="S3.F2.6.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.F2.6.m2.1.1.1.1.3.2.cmml" xref="S3.F2.6.m2.1.1.1.1.3.2">𝜃</ci><cn type="integer" id="S3.F2.6.m2.1.1.1.1.3.3.cmml" xref="S3.F2.6.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.F2.6.m2.2.2.2.2.cmml" xref="S3.F2.6.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.F2.6.m2.2.2.2.2.1.cmml" xref="S3.F2.6.m2.2.2.2.2">subscript</csymbol><ci id="S3.F2.6.m2.2.2.2.2.2.cmml" xref="S3.F2.6.m2.2.2.2.2.2">𝜋</ci><apply id="S3.F2.6.m2.2.2.2.2.3.cmml" xref="S3.F2.6.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.F2.6.m2.2.2.2.2.3.1.cmml" xref="S3.F2.6.m2.2.2.2.2.3">subscript</csymbol><ci id="S3.F2.6.m2.2.2.2.2.3.2.cmml" xref="S3.F2.6.m2.2.2.2.2.3.2">𝜃</ci><cn type="integer" id="S3.F2.6.m2.2.2.2.2.3.3.cmml" xref="S3.F2.6.m2.2.2.2.2.3.3">2</cn></apply></apply><apply id="S3.F2.6.m2.3.3.3.3.cmml" xref="S3.F2.6.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.F2.6.m2.3.3.3.3.1.cmml" xref="S3.F2.6.m2.3.3.3.3">subscript</csymbol><ci id="S3.F2.6.m2.3.3.3.3.2.cmml" xref="S3.F2.6.m2.3.3.3.3.2">𝜋</ci><apply id="S3.F2.6.m2.3.3.3.3.3.cmml" xref="S3.F2.6.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.F2.6.m2.3.3.3.3.3.1.cmml" xref="S3.F2.6.m2.3.3.3.3.3">subscript</csymbol><ci id="S3.F2.6.m2.3.3.3.3.3.2.cmml" xref="S3.F2.6.m2.3.3.3.3.3.2">𝜃</ci><cn type="integer" id="S3.F2.6.m2.3.3.3.3.3.3.cmml" xref="S3.F2.6.m2.3.3.3.3.3.3">3</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m2.3d">\pi_{\theta_{1}},\pi_{\theta_{2}},\pi_{\theta_{3}}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.6.m2.3e">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are fine-tuned. <span id="S3.F2.20.6" class="ltx_text ltx_font_italic">Bottom</span>: If we were to sample from those policies (grey), the quality of samples would increase. In practice, only the final policy <math id="S3.F2.7.m3.1" class="ltx_Math" alttext="\pi_{\theta_{3}}" display="inline"><semantics id="S3.F2.7.m3.1b"><msub id="S3.F2.7.m3.1.1" xref="S3.F2.7.m3.1.1.cmml"><mi id="S3.F2.7.m3.1.1.2" xref="S3.F2.7.m3.1.1.2.cmml">π</mi><msub id="S3.F2.7.m3.1.1.3" xref="S3.F2.7.m3.1.1.3.cmml"><mi id="S3.F2.7.m3.1.1.3.2" xref="S3.F2.7.m3.1.1.3.2.cmml">θ</mi><mn id="S3.F2.7.m3.1.1.3.3" xref="S3.F2.7.m3.1.1.3.3.cmml">3</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S3.F2.7.m3.1c"><apply id="S3.F2.7.m3.1.1.cmml" xref="S3.F2.7.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.7.m3.1.1.1.cmml" xref="S3.F2.7.m3.1.1">subscript</csymbol><ci id="S3.F2.7.m3.1.1.2.cmml" xref="S3.F2.7.m3.1.1.2">𝜋</ci><apply id="S3.F2.7.m3.1.1.3.cmml" xref="S3.F2.7.m3.1.1.3"><csymbol cd="ambiguous" id="S3.F2.7.m3.1.1.3.1.cmml" xref="S3.F2.7.m3.1.1.3">subscript</csymbol><ci id="S3.F2.7.m3.1.1.3.2.cmml" xref="S3.F2.7.m3.1.1.3.2">𝜃</ci><cn type="integer" id="S3.F2.7.m3.1.1.3.3.cmml" xref="S3.F2.7.m3.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m3.1d">\pi_{\theta_{3}}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.7.m3.1e">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is used to generate the next dataset <math id="S3.F2.8.m4.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S3.F2.8.m4.1b"><msub id="S3.F2.8.m4.1.1" xref="S3.F2.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F2.8.m4.1.1.2" xref="S3.F2.8.m4.1.1.2.cmml">𝒟</mi><mi id="S3.F2.8.m4.1.1.3" xref="S3.F2.8.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.8.m4.1c"><apply id="S3.F2.8.m4.1.1.cmml" xref="S3.F2.8.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.8.m4.1.1.1.cmml" xref="S3.F2.8.m4.1.1">subscript</csymbol><ci id="S3.F2.8.m4.1.1.2.cmml" xref="S3.F2.8.m4.1.1.2">𝒟</ci><ci id="S3.F2.8.m4.1.1.3.cmml" xref="S3.F2.8.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m4.1d">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.8.m4.1e">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>.</figcaption>
</figure>
<div id="S3.SS0.SSSx1.p1" class="ltx_para">
<p id="S3.SS0.SSSx1.p1.5" class="ltx_p">The <span id="S3.SS0.SSSx1.p1.5.1" class="ltx_text ltx_font_typewriter">Grow</span> step corresponds to the acting or data-generation step in RL. We create an augmented dataset of trajectories <math id="S3.SS0.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S3.SS0.SSSx1.p1.1.m1.1a"><msub id="S3.SS0.SSSx1.p1.1.m1.1.1" xref="S3.SS0.SSSx1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx1.p1.1.m1.1.1.2" xref="S3.SS0.SSSx1.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS0.SSSx1.p1.1.m1.1.1.3" xref="S3.SS0.SSSx1.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx1.p1.1.m1.1b"><apply id="S3.SS0.SSSx1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx1.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSSx1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx1.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSSx1.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.SS0.SSSx1.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSSx1.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx1.p1.1.m1.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx1.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> by sampling many output sequences from the current policy <math id="S3.SS0.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS0.SSSx1.p1.2.m2.1a"><msub id="S3.SS0.SSSx1.p1.2.m2.1.1" xref="S3.SS0.SSSx1.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSSx1.p1.2.m2.1.1.2" xref="S3.SS0.SSSx1.p1.2.m2.1.1.2.cmml">π</mi><mi id="S3.SS0.SSSx1.p1.2.m2.1.1.3" xref="S3.SS0.SSSx1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx1.p1.2.m2.1b"><apply id="S3.SS0.SSSx1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSSx1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx1.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSSx1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSSx1.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSSx1.p1.2.m2.1.1.2">𝜋</ci><ci id="S3.SS0.SSSx1.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSSx1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx1.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, i.e., <math id="S3.SS0.SSSx1.p1.3.m3.1" class="ltx_Math" alttext="{\bm{y}}\sim\pi_{\theta}({\bm{y}}|{\bm{x}})" display="inline"><semantics id="S3.SS0.SSSx1.p1.3.m3.1a"><mrow id="S3.SS0.SSSx1.p1.3.m3.1.1" xref="S3.SS0.SSSx1.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSSx1.p1.3.m3.1.1.3" xref="S3.SS0.SSSx1.p1.3.m3.1.1.3.cmml">𝒚</mi><mo id="S3.SS0.SSSx1.p1.3.m3.1.1.2" xref="S3.SS0.SSSx1.p1.3.m3.1.1.2.cmml">∼</mo><mrow id="S3.SS0.SSSx1.p1.3.m3.1.1.1" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.cmml"><msub id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.cmml"><mi id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.2" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.2.cmml">π</mi><mi id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.3" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS0.SSSx1.p1.3.m3.1.1.1.2" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.1" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx1.p1.3.m3.1b"><apply id="S3.SS0.SSSx1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS0.SSSx1.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.2">similar-to</csymbol><ci id="S3.SS0.SSSx1.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.3">𝒚</ci><apply id="S3.SS0.SSSx1.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1"><times id="S3.SS0.SSSx1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.2"></times><apply id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.1.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.2.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.2">𝜋</ci><ci id="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.3.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.2">𝒚</ci><ci id="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSSx1.p1.3.m3.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx1.p1.3.m3.1c">{\bm{y}}\sim\pi_{\theta}({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx1.p1.3.m3.1d">bold_italic_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x )</annotation></semantics></math> for <math id="S3.SS0.SSSx1.p1.4.m4.1" class="ltx_Math" alttext="{\bm{x}}\sim{\cal D}" display="inline"><semantics id="S3.SS0.SSSx1.p1.4.m4.1a"><mrow id="S3.SS0.SSSx1.p1.4.m4.1.1" xref="S3.SS0.SSSx1.p1.4.m4.1.1.cmml"><mi id="S3.SS0.SSSx1.p1.4.m4.1.1.2" xref="S3.SS0.SSSx1.p1.4.m4.1.1.2.cmml">𝒙</mi><mo id="S3.SS0.SSSx1.p1.4.m4.1.1.1" xref="S3.SS0.SSSx1.p1.4.m4.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx1.p1.4.m4.1.1.3" xref="S3.SS0.SSSx1.p1.4.m4.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx1.p1.4.m4.1b"><apply id="S3.SS0.SSSx1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSSx1.p1.4.m4.1.1"><csymbol cd="latexml" id="S3.SS0.SSSx1.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSSx1.p1.4.m4.1.1.1">similar-to</csymbol><ci id="S3.SS0.SSSx1.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSSx1.p1.4.m4.1.1.2">𝒙</ci><ci id="S3.SS0.SSSx1.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSSx1.p1.4.m4.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx1.p1.4.m4.1c">{\bm{x}}\sim{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx1.p1.4.m4.1d">bold_italic_x ∼ caligraphic_D</annotation></semantics></math>. The new dataset of sequences is then scored with a reward function <math id="S3.SS0.SSSx1.p1.5.m5.2" class="ltx_Math" alttext="R({\bm{x}},{\bm{y}})" display="inline"><semantics id="S3.SS0.SSSx1.p1.5.m5.2a"><mrow id="S3.SS0.SSSx1.p1.5.m5.2.3" xref="S3.SS0.SSSx1.p1.5.m5.2.3.cmml"><mi id="S3.SS0.SSSx1.p1.5.m5.2.3.2" xref="S3.SS0.SSSx1.p1.5.m5.2.3.2.cmml">R</mi><mo id="S3.SS0.SSSx1.p1.5.m5.2.3.1" xref="S3.SS0.SSSx1.p1.5.m5.2.3.1.cmml">⁢</mo><mrow id="S3.SS0.SSSx1.p1.5.m5.2.3.3.2" xref="S3.SS0.SSSx1.p1.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx1.p1.5.m5.2.3.3.2.1" xref="S3.SS0.SSSx1.p1.5.m5.2.3.3.1.cmml">(</mo><mi id="S3.SS0.SSSx1.p1.5.m5.1.1" xref="S3.SS0.SSSx1.p1.5.m5.1.1.cmml">𝒙</mi><mo id="S3.SS0.SSSx1.p1.5.m5.2.3.3.2.2" xref="S3.SS0.SSSx1.p1.5.m5.2.3.3.1.cmml">,</mo><mi id="S3.SS0.SSSx1.p1.5.m5.2.2" xref="S3.SS0.SSSx1.p1.5.m5.2.2.cmml">𝒚</mi><mo stretchy="false" id="S3.SS0.SSSx1.p1.5.m5.2.3.3.2.3" xref="S3.SS0.SSSx1.p1.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx1.p1.5.m5.2b"><apply id="S3.SS0.SSSx1.p1.5.m5.2.3.cmml" xref="S3.SS0.SSSx1.p1.5.m5.2.3"><times id="S3.SS0.SSSx1.p1.5.m5.2.3.1.cmml" xref="S3.SS0.SSSx1.p1.5.m5.2.3.1"></times><ci id="S3.SS0.SSSx1.p1.5.m5.2.3.2.cmml" xref="S3.SS0.SSSx1.p1.5.m5.2.3.2">𝑅</ci><interval closure="open" id="S3.SS0.SSSx1.p1.5.m5.2.3.3.1.cmml" xref="S3.SS0.SSSx1.p1.5.m5.2.3.3.2"><ci id="S3.SS0.SSSx1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSSx1.p1.5.m5.1.1">𝒙</ci><ci id="S3.SS0.SSSx1.p1.5.m5.2.2.cmml" xref="S3.SS0.SSSx1.p1.5.m5.2.2">𝒚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx1.p1.5.m5.2c">R({\bm{x}},{\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx1.p1.5.m5.2d">italic_R ( bold_italic_x , bold_italic_y )</annotation></semantics></math>. The datapoints with the reward above a threshold score are used to update the policy (see next). Once the policy is improved, a new dataset of better quality samples can be created once again (Figure <a href="#S3.F2" title="Figure 2 ‣ Grow ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, bottom).</p>
</div>
</section>
<section id="S3.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_font_typewriter ltx_title_subsubsection">Improve</h4>

<div id="S3.SS0.SSSx2.p1" class="ltx_para">
<p id="S3.SS0.SSSx2.p1.3" class="ltx_p">At the <span id="S3.SS0.SSSx2.p1.3.1" class="ltx_text ltx_font_typewriter">Improve</span> step (exploitation or policy improvement in RL terminology), the goal is to use the new dataset <math id="S3.SS0.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S3.SS0.SSSx2.p1.1.m1.1a"><msub id="S3.SS0.SSSx2.p1.1.m1.1.1" xref="S3.SS0.SSSx2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.p1.1.m1.1.1.2" xref="S3.SS0.SSSx2.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS0.SSSx2.p1.1.m1.1.1.3" xref="S3.SS0.SSSx2.p1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p1.1.m1.1b"><apply id="S3.SS0.SSSx2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSSx2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSSx2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSSx2.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.SS0.SSSx2.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSSx2.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p1.1.m1.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> to fine-tune the policy <math id="S3.SS0.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS0.SSSx2.p1.2.m2.1a"><msub id="S3.SS0.SSSx2.p1.2.m2.1.1" xref="S3.SS0.SSSx2.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSSx2.p1.2.m2.1.1.2" xref="S3.SS0.SSSx2.p1.2.m2.1.1.2.cmml">π</mi><mi id="S3.SS0.SSSx2.p1.2.m2.1.1.3" xref="S3.SS0.SSSx2.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p1.2.m2.1b"><apply id="S3.SS0.SSSx2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSSx2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSSx2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSSx2.p1.2.m2.1.1.2">𝜋</ci><ci id="S3.SS0.SSSx2.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSSx2.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. We start by defining a filtering function that includes only samples with rewards higher than a certain threshold <math id="S3.SS0.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS0.SSSx2.p1.3.m3.1a"><mi id="S3.SS0.SSSx2.p1.3.m3.1.1" xref="S3.SS0.SSSx2.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p1.3.m3.1b"><ci id="S3.SS0.SSSx2.p1.3.m3.1.1.cmml" xref="S3.SS0.SSSx2.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p1.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p1.3.m3.1d">italic_τ</annotation></semantics></math>:</p>
<table id="S3.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex4.m1.6" class="ltx_Math" alttext="F({\bm{x}},{\bm{y}};\tau)=\mathbbm{1}_{R({\bm{x}},{\bm{y}})&gt;\tau}." display="block"><semantics id="S3.Ex4.m1.6a"><mrow id="S3.Ex4.m1.6.6.1" xref="S3.Ex4.m1.6.6.1.1.cmml"><mrow id="S3.Ex4.m1.6.6.1.1" xref="S3.Ex4.m1.6.6.1.1.cmml"><mrow id="S3.Ex4.m1.6.6.1.1.2" xref="S3.Ex4.m1.6.6.1.1.2.cmml"><mi id="S3.Ex4.m1.6.6.1.1.2.2" xref="S3.Ex4.m1.6.6.1.1.2.2.cmml">F</mi><mo id="S3.Ex4.m1.6.6.1.1.2.1" xref="S3.Ex4.m1.6.6.1.1.2.1.cmml">⁢</mo><mrow id="S3.Ex4.m1.6.6.1.1.2.3.2" xref="S3.Ex4.m1.6.6.1.1.2.3.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.6.6.1.1.2.3.2.1" xref="S3.Ex4.m1.6.6.1.1.2.3.1.cmml">(</mo><mi id="S3.Ex4.m1.3.3" xref="S3.Ex4.m1.3.3.cmml">𝒙</mi><mo id="S3.Ex4.m1.6.6.1.1.2.3.2.2" xref="S3.Ex4.m1.6.6.1.1.2.3.1.cmml">,</mo><mi id="S3.Ex4.m1.4.4" xref="S3.Ex4.m1.4.4.cmml">𝒚</mi><mo id="S3.Ex4.m1.6.6.1.1.2.3.2.3" xref="S3.Ex4.m1.6.6.1.1.2.3.1.cmml">;</mo><mi id="S3.Ex4.m1.5.5" xref="S3.Ex4.m1.5.5.cmml">τ</mi><mo stretchy="false" id="S3.Ex4.m1.6.6.1.1.2.3.2.4" xref="S3.Ex4.m1.6.6.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.6.6.1.1.1" xref="S3.Ex4.m1.6.6.1.1.1.cmml">=</mo><msub id="S3.Ex4.m1.6.6.1.1.3" xref="S3.Ex4.m1.6.6.1.1.3.cmml"><mn id="S3.Ex4.m1.6.6.1.1.3.2" xref="S3.Ex4.m1.6.6.1.1.3.2.cmml">𝟙</mn><mrow id="S3.Ex4.m1.2.2.2" xref="S3.Ex4.m1.2.2.2.cmml"><mrow id="S3.Ex4.m1.2.2.2.4" xref="S3.Ex4.m1.2.2.2.4.cmml"><mi id="S3.Ex4.m1.2.2.2.4.2" xref="S3.Ex4.m1.2.2.2.4.2.cmml">R</mi><mo id="S3.Ex4.m1.2.2.2.4.1" xref="S3.Ex4.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="S3.Ex4.m1.2.2.2.4.3.2" xref="S3.Ex4.m1.2.2.2.4.3.1.cmml"><mo stretchy="false" id="S3.Ex4.m1.2.2.2.4.3.2.1" xref="S3.Ex4.m1.2.2.2.4.3.1.cmml">(</mo><mi id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml">𝒙</mi><mo id="S3.Ex4.m1.2.2.2.4.3.2.2" xref="S3.Ex4.m1.2.2.2.4.3.1.cmml">,</mo><mi id="S3.Ex4.m1.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.cmml">𝒚</mi><mo stretchy="false" id="S3.Ex4.m1.2.2.2.4.3.2.3" xref="S3.Ex4.m1.2.2.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.2.2.2.3" xref="S3.Ex4.m1.2.2.2.3.cmml">&gt;</mo><mi id="S3.Ex4.m1.2.2.2.5" xref="S3.Ex4.m1.2.2.2.5.cmml">τ</mi></mrow></msub></mrow><mo lspace="0em" id="S3.Ex4.m1.6.6.1.2" xref="S3.Ex4.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.6b"><apply id="S3.Ex4.m1.6.6.1.1.cmml" xref="S3.Ex4.m1.6.6.1"><eq id="S3.Ex4.m1.6.6.1.1.1.cmml" xref="S3.Ex4.m1.6.6.1.1.1"></eq><apply id="S3.Ex4.m1.6.6.1.1.2.cmml" xref="S3.Ex4.m1.6.6.1.1.2"><times id="S3.Ex4.m1.6.6.1.1.2.1.cmml" xref="S3.Ex4.m1.6.6.1.1.2.1"></times><ci id="S3.Ex4.m1.6.6.1.1.2.2.cmml" xref="S3.Ex4.m1.6.6.1.1.2.2">𝐹</ci><vector id="S3.Ex4.m1.6.6.1.1.2.3.1.cmml" xref="S3.Ex4.m1.6.6.1.1.2.3.2"><ci id="S3.Ex4.m1.3.3.cmml" xref="S3.Ex4.m1.3.3">𝒙</ci><ci id="S3.Ex4.m1.4.4.cmml" xref="S3.Ex4.m1.4.4">𝒚</ci><ci id="S3.Ex4.m1.5.5.cmml" xref="S3.Ex4.m1.5.5">𝜏</ci></vector></apply><apply id="S3.Ex4.m1.6.6.1.1.3.cmml" xref="S3.Ex4.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.6.6.1.1.3.1.cmml" xref="S3.Ex4.m1.6.6.1.1.3">subscript</csymbol><cn type="integer" id="S3.Ex4.m1.6.6.1.1.3.2.cmml" xref="S3.Ex4.m1.6.6.1.1.3.2">1</cn><apply id="S3.Ex4.m1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2"><gt id="S3.Ex4.m1.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.3"></gt><apply id="S3.Ex4.m1.2.2.2.4.cmml" xref="S3.Ex4.m1.2.2.2.4"><times id="S3.Ex4.m1.2.2.2.4.1.cmml" xref="S3.Ex4.m1.2.2.2.4.1"></times><ci id="S3.Ex4.m1.2.2.2.4.2.cmml" xref="S3.Ex4.m1.2.2.2.4.2">𝑅</ci><interval closure="open" id="S3.Ex4.m1.2.2.2.4.3.1.cmml" xref="S3.Ex4.m1.2.2.2.4.3.2"><ci id="S3.Ex4.m1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1">𝒙</ci><ci id="S3.Ex4.m1.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2">𝒚</ci></interval></apply><ci id="S3.Ex4.m1.2.2.2.5.cmml" xref="S3.Ex4.m1.2.2.2.5">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.6c">F({\bm{x}},{\bm{y}};\tau)=\mathbbm{1}_{R({\bm{x}},{\bm{y}})&gt;\tau}.</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.6d">italic_F ( bold_italic_x , bold_italic_y ; italic_τ ) = blackboard_1 start_POSTSUBSCRIPT italic_R ( bold_italic_x , bold_italic_y ) &gt; italic_τ end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSSx2.p1.4" class="ltx_p">Let us note that the threshold based filtering function may result into learning suboptimal behaviors that favors outcomes with high variance in the environments with stochastic dynamics <cite class="ltx_cite ltx_citemacro_citep">(Brandfonbrener et al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite>. However, in this work we formulate the language modeling and translation tasks as deterministic RL problems (Appendix <a href="#A1.SS1" title="A.1 RLHF for conditional language modeling as MDP ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>.)
</p>
</div>
<div id="S3.SS0.SSSx2.p2" class="ltx_para">
<p id="S3.SS0.SSSx2.p2.3" class="ltx_p">Next, we finetune the current best policy typically trained with either the supervised learning loss <math id="S3.SS0.SSSx2.p2.1.m1.1" class="ltx_Math" alttext="{\mathcal{L}}_{\text{NLL}}" display="inline"><semantics id="S3.SS0.SSSx2.p2.1.m1.1a"><msub id="S3.SS0.SSSx2.p2.1.m1.1.1" xref="S3.SS0.SSSx2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.p2.1.m1.1.1.2" xref="S3.SS0.SSSx2.p2.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS0.SSSx2.p2.1.m1.1.1.3" xref="S3.SS0.SSSx2.p2.1.m1.1.1.3a.cmml">NLL</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p2.1.m1.1b"><apply id="S3.SS0.SSSx2.p2.1.m1.1.1.cmml" xref="S3.SS0.SSSx2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p2.1.m1.1.1.1.cmml" xref="S3.SS0.SSSx2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.p2.1.m1.1.1.2.cmml" xref="S3.SS0.SSSx2.p2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS0.SSSx2.p2.1.m1.1.1.3a.cmml" xref="S3.SS0.SSSx2.p2.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS0.SSSx2.p2.1.m1.1.1.3.cmml" xref="S3.SS0.SSSx2.p2.1.m1.1.1.3">NLL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p2.1.m1.1c">{\mathcal{L}}_{\text{NLL}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT</annotation></semantics></math> from equation <a href="#S2.E1" title="1 ‣ 2 Preliminaries ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> or an offline RL loss <math id="S3.SS0.SSSx2.p2.2.m2.3" class="ltx_Math" alttext="{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)" display="inline"><semantics id="S3.SS0.SSSx2.p2.2.m2.3a"><mrow id="S3.SS0.SSSx2.p2.2.m2.3.4" xref="S3.SS0.SSSx2.p2.2.m2.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.p2.2.m2.3.4.2" xref="S3.SS0.SSSx2.p2.2.m2.3.4.2.cmml">ℒ</mi><mo id="S3.SS0.SSSx2.p2.2.m2.3.4.1" xref="S3.SS0.SSSx2.p2.2.m2.3.4.1.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.p2.2.m2.3.4.3.2" xref="S3.SS0.SSSx2.p2.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.p2.2.m2.3.4.3.2.1" xref="S3.SS0.SSSx2.p2.2.m2.3.4.3.1.cmml">(</mo><mi id="S3.SS0.SSSx2.p2.2.m2.1.1" xref="S3.SS0.SSSx2.p2.2.m2.1.1.cmml">𝒙</mi><mo id="S3.SS0.SSSx2.p2.2.m2.3.4.3.2.2" xref="S3.SS0.SSSx2.p2.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS0.SSSx2.p2.2.m2.2.2" xref="S3.SS0.SSSx2.p2.2.m2.2.2.cmml">𝒚</mi><mo id="S3.SS0.SSSx2.p2.2.m2.3.4.3.2.3" xref="S3.SS0.SSSx2.p2.2.m2.3.4.3.1.cmml">;</mo><mi id="S3.SS0.SSSx2.p2.2.m2.3.3" xref="S3.SS0.SSSx2.p2.2.m2.3.3.cmml">θ</mi><mo stretchy="false" id="S3.SS0.SSSx2.p2.2.m2.3.4.3.2.4" xref="S3.SS0.SSSx2.p2.2.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p2.2.m2.3b"><apply id="S3.SS0.SSSx2.p2.2.m2.3.4.cmml" xref="S3.SS0.SSSx2.p2.2.m2.3.4"><times id="S3.SS0.SSSx2.p2.2.m2.3.4.1.cmml" xref="S3.SS0.SSSx2.p2.2.m2.3.4.1"></times><ci id="S3.SS0.SSSx2.p2.2.m2.3.4.2.cmml" xref="S3.SS0.SSSx2.p2.2.m2.3.4.2">ℒ</ci><vector id="S3.SS0.SSSx2.p2.2.m2.3.4.3.1.cmml" xref="S3.SS0.SSSx2.p2.2.m2.3.4.3.2"><ci id="S3.SS0.SSSx2.p2.2.m2.1.1.cmml" xref="S3.SS0.SSSx2.p2.2.m2.1.1">𝒙</ci><ci id="S3.SS0.SSSx2.p2.2.m2.2.2.cmml" xref="S3.SS0.SSSx2.p2.2.m2.2.2">𝒚</ci><ci id="S3.SS0.SSSx2.p2.2.m2.3.3.cmml" xref="S3.SS0.SSSx2.p2.2.m2.3.3">𝜃</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p2.2.m2.3c">{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p2.2.m2.3d">caligraphic_L ( bold_italic_x , bold_italic_y ; italic_θ )</annotation></semantics></math> on the filtered data such as V-MPO <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a href="#bib.bib52" title="" class="ltx_ref">2020</a>)</cite> or offline actor-critic <cite class="ltx_cite ltx_citemacro_citep">(Mathieu et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>. To sum up, we use the following reward weighted loss <math id="S3.SS0.SSSx2.p2.3.m3.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S3.SS0.SSSx2.p2.3.m3.1a"><mi id="S3.SS0.SSSx2.p2.3.m3.1.1" xref="S3.SS0.SSSx2.p2.3.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p2.3.m3.1b"><ci id="S3.SS0.SSSx2.p2.3.m3.1.1.cmml" xref="S3.SS0.SSSx2.p2.3.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p2.3.m3.1c">J</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p2.3.m3.1d">italic_J</annotation></semantics></math>:</p>
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.10" class="ltx_Math" alttext="\displaystyle J(\theta)=\mathbb{E}_{({\bm{x}},{\bm{y}})\sim{\cal D}_{g}}\left[F({\bm{x}},{\bm{y}};\tau)\;{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)\right]." display="inline"><semantics id="S3.E2.m1.10a"><mrow id="S3.E2.m1.10.10.1" xref="S3.E2.m1.10.10.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1" xref="S3.E2.m1.10.10.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.3" xref="S3.E2.m1.10.10.1.1.3.cmml"><mi id="S3.E2.m1.10.10.1.1.3.2" xref="S3.E2.m1.10.10.1.1.3.2.cmml">J</mi><mo id="S3.E2.m1.10.10.1.1.3.1" xref="S3.E2.m1.10.10.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.3.3.2" xref="S3.E2.m1.10.10.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.3.3.2.1" xref="S3.E2.m1.10.10.1.1.3.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.10.10.1.1.3.3.2.2" xref="S3.E2.m1.10.10.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.2" xref="S3.E2.m1.10.10.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.10.10.1.1.1" xref="S3.E2.m1.10.10.1.1.1.cmml"><msub id="S3.E2.m1.10.10.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.3.cmml"><mi id="S3.E2.m1.10.10.1.1.1.3.2" xref="S3.E2.m1.10.10.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.4.2.1" xref="S3.E2.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝒙</mi><mo id="S3.E2.m1.2.2.2.4.2.2" xref="S3.E2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">𝒚</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.4.2.3" xref="S3.E2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E2.m1.2.2.2.5" xref="S3.E2.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.5.2" xref="S3.E2.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.2.5.3" xref="S3.E2.m1.2.2.2.5.3.cmml">g</mi></msub></mrow></msub><mo id="S3.E2.m1.10.10.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.cmml">F</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">𝒙</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">𝒚</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">τ</mi><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.1.3.2.4" xref="S3.E2.m1.10.10.1.1.1.1.1.1.3.1.cmml">)</mo></mrow><mo lspace="0.280em" id="S3.E2.m1.10.10.1.1.1.1.1.1.1a" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.10.10.1.1.1.1.1.1.4" xref="S3.E2.m1.10.10.1.1.1.1.1.1.4.cmml">ℒ</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1b" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.5.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.5.1.cmml"><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.1.5.2.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.5.1.cmml">(</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">𝒙</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.5.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.5.1.cmml">,</mo><mi id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml">𝒚</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.5.2.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.5.1.cmml">;</mo><mi id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.10.10.1.1.1.1.1.1.5.2.4" xref="S3.E2.m1.10.10.1.1.1.1.1.1.5.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.10.10.1.2" xref="S3.E2.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.10b"><apply id="S3.E2.m1.10.10.1.1.cmml" xref="S3.E2.m1.10.10.1"><eq id="S3.E2.m1.10.10.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.2"></eq><apply id="S3.E2.m1.10.10.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.3"><times id="S3.E2.m1.10.10.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.3.1"></times><ci id="S3.E2.m1.10.10.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.3.2">𝐽</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝜃</ci></apply><apply id="S3.E2.m1.10.10.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1"><times id="S3.E2.m1.10.10.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.2"></times><apply id="S3.E2.m1.10.10.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.1.3.2">𝔼</ci><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝒙</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝒚</ci></interval><apply id="S3.E2.m1.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.5.1.cmml" xref="S3.E2.m1.2.2.2.5">subscript</csymbol><ci id="S3.E2.m1.2.2.2.5.2.cmml" xref="S3.E2.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E2.m1.2.2.2.5.3.cmml" xref="S3.E2.m1.2.2.2.5.3">𝑔</ci></apply></apply></apply><apply id="S3.E2.m1.10.10.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1"><times id="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2">𝐹</ci><vector id="S3.E2.m1.10.10.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.3.2"><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝒙</ci><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝒚</ci><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝜏</ci></vector><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.4">ℒ</ci><vector id="S3.E2.m1.10.10.1.1.1.1.1.1.5.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.5.2"><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝒙</ci><ci id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8">𝒚</ci><ci id="S3.E2.m1.9.9.cmml" xref="S3.E2.m1.9.9">𝜃</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.10c">\displaystyle J(\theta)=\mathbb{E}_{({\bm{x}},{\bm{y}})\sim{\cal D}_{g}}\left[F({\bm{x}},{\bm{y}};\tau)\;{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.10d">italic_J ( italic_θ ) = blackboard_E start_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) ∼ caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_F ( bold_italic_x , bold_italic_y ; italic_τ ) caligraphic_L ( bold_italic_x , bold_italic_y ; italic_θ ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS0.SSSx2.p3" class="ltx_para">
<p id="S3.SS0.SSSx2.p3.2" class="ltx_p">Standard imitation learning approaches, such as BC (<cite class="ltx_cite ltx_citemacro_cite">Pomerleau (<a href="#bib.bib43" title="" class="ltx_ref">1989</a>)</cite>, equation <a href="#S2.E1" title="1 ‣ 2 Preliminaries ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and one-step RL methods like Behavior Value Estimation (BVE)  <cite class="ltx_cite ltx_citemacro_citep">(Gulcehre et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite> perform one-step of <span id="S3.SS0.SSSx2.p3.2.1" class="ltx_text ltx_font_typewriter">Improve</span> on the fixed dataset <math id="S3.SS0.SSSx2.p3.1.m1.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S3.SS0.SSSx2.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.p3.1.m1.1.1" xref="S3.SS0.SSSx2.p3.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p3.1.m1.1b"><ci id="S3.SS0.SSSx2.p3.1.m1.1.1.cmml" xref="S3.SS0.SSSx2.p3.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p3.1.m1.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p3.1.m1.1d">caligraphic_D</annotation></semantics></math>. In contrast, the basic version of <span id="S3.SS0.SSSx2.p3.2.2" class="ltx_ERROR undefined">\rest</span> additionally includes a <span id="S3.SS0.SSSx2.p3.2.3" class="ltx_text ltx_font_typewriter">Grow</span> step that allows the model to gather multiple new output sequences (potential translations) for contexts <math id="S3.SS0.SSSx2.p3.2.m2.1" class="ltx_Math" alttext="{\bm{x}}" display="inline"><semantics id="S3.SS0.SSSx2.p3.2.m2.1a"><mi id="S3.SS0.SSSx2.p3.2.m2.1.1" xref="S3.SS0.SSSx2.p3.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p3.2.m2.1b"><ci id="S3.SS0.SSSx2.p3.2.m2.1.1.cmml" xref="S3.SS0.SSSx2.p3.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p3.2.m2.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p3.2.m2.1d">bold_italic_x</annotation></semantics></math> from the original dataset (source sentences to translate).</p>
</div>
<div id="S3.SS0.SSSx2.p4" class="ltx_para">
<p id="S3.SS0.SSSx2.p4.4" class="ltx_p">When iterating over <span id="S3.SS0.SSSx2.p4.4.1" class="ltx_text ltx_font_typewriter">Improve</span> steps, we increase the filtering thresholds: <math id="S3.SS0.SSSx2.p4.1.m1.1" class="ltx_Math" alttext="\tau_{1}&lt;\dots&lt;\tau_{N-1}&lt;\tau_{N}" display="inline"><semantics id="S3.SS0.SSSx2.p4.1.m1.1a"><mrow id="S3.SS0.SSSx2.p4.1.m1.1.1" xref="S3.SS0.SSSx2.p4.1.m1.1.1.cmml"><msub id="S3.SS0.SSSx2.p4.1.m1.1.1.2" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2.cmml"><mi id="S3.SS0.SSSx2.p4.1.m1.1.1.2.2" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2.2.cmml">τ</mi><mn id="S3.SS0.SSSx2.p4.1.m1.1.1.2.3" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS0.SSSx2.p4.1.m1.1.1.3" xref="S3.SS0.SSSx2.p4.1.m1.1.1.3.cmml">&lt;</mo><mi mathvariant="normal" id="S3.SS0.SSSx2.p4.1.m1.1.1.4" xref="S3.SS0.SSSx2.p4.1.m1.1.1.4.cmml">⋯</mi><mo id="S3.SS0.SSSx2.p4.1.m1.1.1.5" xref="S3.SS0.SSSx2.p4.1.m1.1.1.5.cmml">&lt;</mo><msub id="S3.SS0.SSSx2.p4.1.m1.1.1.6" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.cmml"><mi id="S3.SS0.SSSx2.p4.1.m1.1.1.6.2" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.2.cmml">τ</mi><mrow id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.cmml"><mi id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.2" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.2.cmml">N</mi><mo id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.1" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.1.cmml">−</mo><mn id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.3" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS0.SSSx2.p4.1.m1.1.1.7" xref="S3.SS0.SSSx2.p4.1.m1.1.1.7.cmml">&lt;</mo><msub id="S3.SS0.SSSx2.p4.1.m1.1.1.8" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8.cmml"><mi id="S3.SS0.SSSx2.p4.1.m1.1.1.8.2" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8.2.cmml">τ</mi><mi id="S3.SS0.SSSx2.p4.1.m1.1.1.8.3" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p4.1.m1.1b"><apply id="S3.SS0.SSSx2.p4.1.m1.1.1.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"><and id="S3.SS0.SSSx2.p4.1.m1.1.1a.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"></and><apply id="S3.SS0.SSSx2.p4.1.m1.1.1b.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"><lt id="S3.SS0.SSSx2.p4.1.m1.1.1.3.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.3"></lt><apply id="S3.SS0.SSSx2.p4.1.m1.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2.2">𝜏</ci><cn type="integer" id="S3.SS0.SSSx2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.2.3">1</cn></apply><ci id="S3.SS0.SSSx2.p4.1.m1.1.1.4.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.4">⋯</ci></apply><apply id="S3.SS0.SSSx2.p4.1.m1.1.1c.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"><lt id="S3.SS0.SSSx2.p4.1.m1.1.1.5.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.5"></lt><share href="#S3.SS0.SSSx2.p4.1.m1.1.1.4.cmml" id="S3.SS0.SSSx2.p4.1.m1.1.1d.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"></share><apply id="S3.SS0.SSSx2.p4.1.m1.1.1.6.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.1.m1.1.1.6.1.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.1.m1.1.1.6.2.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.2">𝜏</ci><apply id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3"><minus id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.1.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.1"></minus><ci id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.2.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.2">𝑁</ci><cn type="integer" id="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.3.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.6.3.3">1</cn></apply></apply></apply><apply id="S3.SS0.SSSx2.p4.1.m1.1.1e.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"><lt id="S3.SS0.SSSx2.p4.1.m1.1.1.7.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.7"></lt><share href="#S3.SS0.SSSx2.p4.1.m1.1.1.6.cmml" id="S3.SS0.SSSx2.p4.1.m1.1.1f.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1"></share><apply id="S3.SS0.SSSx2.p4.1.m1.1.1.8.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.1.m1.1.1.8.1.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.1.m1.1.1.8.2.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8.2">𝜏</ci><ci id="S3.SS0.SSSx2.p4.1.m1.1.1.8.3.cmml" xref="S3.SS0.SSSx2.p4.1.m1.1.1.8.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p4.1.m1.1c">\tau_{1}&lt;\dots&lt;\tau_{N-1}&lt;\tau_{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p4.1.m1.1d">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; ⋯ &lt; italic_τ start_POSTSUBSCRIPT italic_N - 1 end_POSTSUBSCRIPT &lt; italic_τ start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> (Figure <a href="#S3.F2" title="Figure 2 ‣ Grow ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). This filtering with the growing threshold results in data subsets of increasing quality but of decreasing size. As LLMs overfit to small datasets quickly, we fine-tune every new policy from the previous policy with a lower learning rate. Consecutive fine-tuning of policies <math id="S3.SS0.SSSx2.p4.2.m2.1" class="ltx_Math" alttext="\{\pi_{\theta_{k}}\}_{k\geq 1}" display="inline"><semantics id="S3.SS0.SSSx2.p4.2.m2.1a"><msub id="S3.SS0.SSSx2.p4.2.m2.1.1" xref="S3.SS0.SSSx2.p4.2.m2.1.1.cmml"><mrow id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.2" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.2" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.2.cmml">π</mi><msub id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.2" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.3" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.3" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSSx2.p4.2.m2.1.1.3" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS0.SSSx2.p4.2.m2.1.1.3.2" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.2.cmml">k</mi><mo id="S3.SS0.SSSx2.p4.2.m2.1.1.3.1" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.1.cmml">≥</mo><mn id="S3.SS0.SSSx2.p4.2.m2.1.1.3.3" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p4.2.m2.1b"><apply id="S3.SS0.SSSx2.p4.2.m2.1.1.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.2.m2.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1">subscript</csymbol><set id="S3.SS0.SSSx2.p4.2.m2.1.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1"><apply id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.2">𝜋</ci><apply id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.1.1.1.3.3">𝑘</ci></apply></apply></set><apply id="S3.SS0.SSSx2.p4.2.m2.1.1.3.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3"><geq id="S3.SS0.SSSx2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.1"></geq><ci id="S3.SS0.SSSx2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS0.SSSx2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS0.SSSx2.p4.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p4.2.m2.1c">\{\pi_{\theta_{k}}\}_{k\geq 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p4.2.m2.1d">{ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k ≥ 1 end_POSTSUBSCRIPT</annotation></semantics></math> on higher quality data subsets ensures policy improvement with a fixed dataset <math id="S3.SS0.SSSx2.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{g}" display="inline"><semantics id="S3.SS0.SSSx2.p4.3.m3.1a"><msub id="S3.SS0.SSSx2.p4.3.m3.1.1" xref="S3.SS0.SSSx2.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.p4.3.m3.1.1.2" xref="S3.SS0.SSSx2.p4.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS0.SSSx2.p4.3.m3.1.1.3" xref="S3.SS0.SSSx2.p4.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p4.3.m3.1b"><apply id="S3.SS0.SSSx2.p4.3.m3.1.1.cmml" xref="S3.SS0.SSSx2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.3.m3.1.1.1.cmml" xref="S3.SS0.SSSx2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.3.m3.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.3.m3.1.1.2">𝒟</ci><ci id="S3.SS0.SSSx2.p4.3.m3.1.1.3.cmml" xref="S3.SS0.SSSx2.p4.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p4.3.m3.1c">\mathcal{D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p4.3.m3.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>. If we were to sample from policies <math id="S3.SS0.SSSx2.p4.4.m4.1" class="ltx_Math" alttext="\{\pi_{\theta_{k}}\}_{k\geq 1}" display="inline"><semantics id="S3.SS0.SSSx2.p4.4.m4.1a"><msub id="S3.SS0.SSSx2.p4.4.m4.1.1" xref="S3.SS0.SSSx2.p4.4.m4.1.1.cmml"><mrow id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.2" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.2" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.2.cmml">π</mi><msub id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.2" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.3" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.3" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSSx2.p4.4.m4.1.1.3" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.cmml"><mi id="S3.SS0.SSSx2.p4.4.m4.1.1.3.2" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.2.cmml">k</mi><mo id="S3.SS0.SSSx2.p4.4.m4.1.1.3.1" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.1.cmml">≥</mo><mn id="S3.SS0.SSSx2.p4.4.m4.1.1.3.3" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.p4.4.m4.1b"><apply id="S3.SS0.SSSx2.p4.4.m4.1.1.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.4.m4.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1">subscript</csymbol><set id="S3.SS0.SSSx2.p4.4.m4.1.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1"><apply id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.2">𝜋</ci><apply id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.1.1.1.3.3">𝑘</ci></apply></apply></set><apply id="S3.SS0.SSSx2.p4.4.m4.1.1.3.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3"><geq id="S3.SS0.SSSx2.p4.4.m4.1.1.3.1.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.1"></geq><ci id="S3.SS0.SSSx2.p4.4.m4.1.1.3.2.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS0.SSSx2.p4.4.m4.1.1.3.3.cmml" xref="S3.SS0.SSSx2.p4.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.p4.4.m4.1c">\{\pi_{\theta_{k}}\}_{k\geq 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.p4.4.m4.1d">{ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k ≥ 1 end_POSTSUBSCRIPT</annotation></semantics></math>, the average reward of the generated samples would be increasing (shown in grey in Figure <a href="#S3.F2" title="Figure 2 ‣ Grow ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). As sampling from a policy in the <span id="S3.SS0.SSSx2.p4.4.2" class="ltx_text ltx_font_typewriter">Grow</span> step is computationally expensive, after each such step we perform several <span id="S3.SS0.SSSx2.p4.4.3" class="ltx_text ltx_font_typewriter">Improve</span> steps. Thus, the cost of a single dataset generation is amortised over multiple <span id="S3.SS0.SSSx2.p4.4.4" class="ltx_text ltx_font_typewriter">Improve</span> steps. Algorithm <a href="#alg1" title="1 ‣ Improve ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> outlines the full <span id="S3.SS0.SSSx2.p4.4.5" class="ltx_ERROR undefined">\rest</span> algorithm with multiple dataset growth and policy improvement steps.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.25" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.7.7" class="ltx_listingline"> <span id="alg1.7.7.1" class="ltx_text" style="color:#000000;"><span id="alg1.7.7.1.1" class="ltx_text ltx_font_bold">Input:</span> </span><math id="alg1.1.1.m1.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="alg1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.m1.1d">caligraphic_D</annotation></semantics></math>: Dataset, <math id="alg1.2.2.m2.1" class="ltx_Math" alttext="{\cal D}_{eval}" display="inline"><semantics id="alg1.2.2.m2.1a"><msub id="alg1.2.2.m2.1.1" xref="alg1.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.2.2.m2.1.1.2" xref="alg1.2.2.m2.1.1.2.cmml">𝒟</mi><mrow id="alg1.2.2.m2.1.1.3" xref="alg1.2.2.m2.1.1.3.cmml"><mi id="alg1.2.2.m2.1.1.3.2" xref="alg1.2.2.m2.1.1.3.2.cmml">e</mi><mo id="alg1.2.2.m2.1.1.3.1" xref="alg1.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.2.2.m2.1.1.3.3" xref="alg1.2.2.m2.1.1.3.3.cmml">v</mi><mo id="alg1.2.2.m2.1.1.3.1a" xref="alg1.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.2.2.m2.1.1.3.4" xref="alg1.2.2.m2.1.1.3.4.cmml">a</mi><mo id="alg1.2.2.m2.1.1.3.1b" xref="alg1.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.2.2.m2.1.1.3.5" xref="alg1.2.2.m2.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.2.2.m2.1b"><apply id="alg1.2.2.m2.1.1.cmml" xref="alg1.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.2.m2.1.1.1.cmml" xref="alg1.2.2.m2.1.1">subscript</csymbol><ci id="alg1.2.2.m2.1.1.2.cmml" xref="alg1.2.2.m2.1.1.2">𝒟</ci><apply id="alg1.2.2.m2.1.1.3.cmml" xref="alg1.2.2.m2.1.1.3"><times id="alg1.2.2.m2.1.1.3.1.cmml" xref="alg1.2.2.m2.1.1.3.1"></times><ci id="alg1.2.2.m2.1.1.3.2.cmml" xref="alg1.2.2.m2.1.1.3.2">𝑒</ci><ci id="alg1.2.2.m2.1.1.3.3.cmml" xref="alg1.2.2.m2.1.1.3.3">𝑣</ci><ci id="alg1.2.2.m2.1.1.3.4.cmml" xref="alg1.2.2.m2.1.1.3.4">𝑎</ci><ci id="alg1.2.2.m2.1.1.3.5.cmml" xref="alg1.2.2.m2.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m2.1c">{\cal D}_{eval}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math>: Evaluation dataset, <math id="alg1.3.3.m3.3" class="ltx_Math" alttext="{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)" display="inline"><semantics id="alg1.3.3.m3.3a"><mrow id="alg1.3.3.m3.3.4" xref="alg1.3.3.m3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.3.3.m3.3.4.2" xref="alg1.3.3.m3.3.4.2.cmml">ℒ</mi><mo id="alg1.3.3.m3.3.4.1" xref="alg1.3.3.m3.3.4.1.cmml">⁢</mo><mrow id="alg1.3.3.m3.3.4.3.2" xref="alg1.3.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="alg1.3.3.m3.3.4.3.2.1" xref="alg1.3.3.m3.3.4.3.1.cmml">(</mo><mi id="alg1.3.3.m3.1.1" xref="alg1.3.3.m3.1.1.cmml">𝒙</mi><mo id="alg1.3.3.m3.3.4.3.2.2" xref="alg1.3.3.m3.3.4.3.1.cmml">,</mo><mi id="alg1.3.3.m3.2.2" xref="alg1.3.3.m3.2.2.cmml">𝒚</mi><mo id="alg1.3.3.m3.3.4.3.2.3" xref="alg1.3.3.m3.3.4.3.1.cmml">;</mo><mi id="alg1.3.3.m3.3.3" xref="alg1.3.3.m3.3.3.cmml">θ</mi><mo stretchy="false" id="alg1.3.3.m3.3.4.3.2.4" xref="alg1.3.3.m3.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.3.m3.3b"><apply id="alg1.3.3.m3.3.4.cmml" xref="alg1.3.3.m3.3.4"><times id="alg1.3.3.m3.3.4.1.cmml" xref="alg1.3.3.m3.3.4.1"></times><ci id="alg1.3.3.m3.3.4.2.cmml" xref="alg1.3.3.m3.3.4.2">ℒ</ci><vector id="alg1.3.3.m3.3.4.3.1.cmml" xref="alg1.3.3.m3.3.4.3.2"><ci id="alg1.3.3.m3.1.1.cmml" xref="alg1.3.3.m3.1.1">𝒙</ci><ci id="alg1.3.3.m3.2.2.cmml" xref="alg1.3.3.m3.2.2">𝒚</ci><ci id="alg1.3.3.m3.3.3.cmml" xref="alg1.3.3.m3.3.3">𝜃</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m3.3c">{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m3.3d">caligraphic_L ( bold_italic_x , bold_italic_y ; italic_θ )</annotation></semantics></math>: loss, <math id="alg1.4.4.m4.2" class="ltx_Math" alttext="R({\bm{x}},{\bm{y}})" display="inline"><semantics id="alg1.4.4.m4.2a"><mrow id="alg1.4.4.m4.2.3" xref="alg1.4.4.m4.2.3.cmml"><mi id="alg1.4.4.m4.2.3.2" xref="alg1.4.4.m4.2.3.2.cmml">R</mi><mo id="alg1.4.4.m4.2.3.1" xref="alg1.4.4.m4.2.3.1.cmml">⁢</mo><mrow id="alg1.4.4.m4.2.3.3.2" xref="alg1.4.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="alg1.4.4.m4.2.3.3.2.1" xref="alg1.4.4.m4.2.3.3.1.cmml">(</mo><mi id="alg1.4.4.m4.1.1" xref="alg1.4.4.m4.1.1.cmml">𝒙</mi><mo id="alg1.4.4.m4.2.3.3.2.2" xref="alg1.4.4.m4.2.3.3.1.cmml">,</mo><mi id="alg1.4.4.m4.2.2" xref="alg1.4.4.m4.2.2.cmml">𝒚</mi><mo stretchy="false" id="alg1.4.4.m4.2.3.3.2.3" xref="alg1.4.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m4.2b"><apply id="alg1.4.4.m4.2.3.cmml" xref="alg1.4.4.m4.2.3"><times id="alg1.4.4.m4.2.3.1.cmml" xref="alg1.4.4.m4.2.3.1"></times><ci id="alg1.4.4.m4.2.3.2.cmml" xref="alg1.4.4.m4.2.3.2">𝑅</ci><interval closure="open" id="alg1.4.4.m4.2.3.3.1.cmml" xref="alg1.4.4.m4.2.3.3.2"><ci id="alg1.4.4.m4.1.1.cmml" xref="alg1.4.4.m4.1.1">𝒙</ci><ci id="alg1.4.4.m4.2.2.cmml" xref="alg1.4.4.m4.2.2">𝒚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m4.2c">R({\bm{x}},{\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m4.2d">italic_R ( bold_italic_x , bold_italic_y )</annotation></semantics></math>: reward model, <math id="alg1.5.5.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="alg1.5.5.m5.1a"><mi id="alg1.5.5.m5.1.1" xref="alg1.5.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.5.5.m5.1b"><ci id="alg1.5.5.m5.1.1.cmml" xref="alg1.5.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m5.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.m5.1d">italic_G</annotation></semantics></math>: number of grow steps, <math id="alg1.6.6.m6.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.6.6.m6.1a"><mi id="alg1.6.6.m6.1.1" xref="alg1.6.6.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.6.6.m6.1b"><ci id="alg1.6.6.m6.1.1.cmml" xref="alg1.6.6.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m6.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.m6.1d">italic_I</annotation></semantics></math>: number of improve steps, <math id="alg1.7.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.7.7.m7.1a"><mi id="alg1.7.7.m7.1.1" xref="alg1.7.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.7.7.m7.1b"><ci id="alg1.7.7.m7.1.1.cmml" xref="alg1.7.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.m7.1d">italic_N</annotation></semantics></math>: number of samples per context
</div>
<div id="alg1.10.10" class="ltx_listingline"> Train <math id="alg1.8.8.m1.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="alg1.8.8.m1.1a"><msub id="alg1.8.8.m1.1.1" xref="alg1.8.8.m1.1.1.cmml"><mi id="alg1.8.8.m1.1.1.2" xref="alg1.8.8.m1.1.1.2.cmml">π</mi><mi id="alg1.8.8.m1.1.1.3" xref="alg1.8.8.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.8.m1.1b"><apply id="alg1.8.8.m1.1.1.cmml" xref="alg1.8.8.m1.1.1"><csymbol cd="ambiguous" id="alg1.8.8.m1.1.1.1.cmml" xref="alg1.8.8.m1.1.1">subscript</csymbol><ci id="alg1.8.8.m1.1.1.2.cmml" xref="alg1.8.8.m1.1.1.2">𝜋</ci><ci id="alg1.8.8.m1.1.1.3.cmml" xref="alg1.8.8.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> on <math id="alg1.9.9.m2.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="alg1.9.9.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.9.9.m2.1.1" xref="alg1.9.9.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.9.9.m2.1b"><ci id="alg1.9.9.m2.1.1.cmml" xref="alg1.9.9.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m2.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.m2.1d">caligraphic_D</annotation></semantics></math> using loss <math id="alg1.10.10.m3.1" class="ltx_Math" alttext="{\mathcal{L}}" display="inline"><semantics id="alg1.10.10.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.10.10.m3.1.1" xref="alg1.10.10.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg1.10.10.m3.1b"><ci id="alg1.10.10.m3.1.1.cmml" xref="alg1.10.10.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m3.1c">{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m3.1d">caligraphic_L</annotation></semantics></math>.
</div>
<div id="alg1.12.12" class="ltx_listingline"> <span id="alg1.12.12.3" class="ltx_text ltx_font_bold">for</span> <em id="alg1.12.12.2" class="ltx_emph ltx_font_italic"><math id="alg1.11.11.1.m1.1" class="ltx_Math" alttext="g=1" display="inline"><semantics id="alg1.11.11.1.m1.1a"><mrow id="alg1.11.11.1.m1.1.1" xref="alg1.11.11.1.m1.1.1.cmml"><mi id="alg1.11.11.1.m1.1.1.2" xref="alg1.11.11.1.m1.1.1.2.cmml">g</mi><mo mathvariant="normal" id="alg1.11.11.1.m1.1.1.1" xref="alg1.11.11.1.m1.1.1.1.cmml">=</mo><mn mathvariant="normal" id="alg1.11.11.1.m1.1.1.3" xref="alg1.11.11.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.1.m1.1b"><apply id="alg1.11.11.1.m1.1.1.cmml" xref="alg1.11.11.1.m1.1.1"><eq id="alg1.11.11.1.m1.1.1.1.cmml" xref="alg1.11.11.1.m1.1.1.1"></eq><ci id="alg1.11.11.1.m1.1.1.2.cmml" xref="alg1.11.11.1.m1.1.1.2">𝑔</ci><cn type="integer" id="alg1.11.11.1.m1.1.1.3.cmml" xref="alg1.11.11.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.1.m1.1c">g=1</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.1.m1.1d">italic_g = 1</annotation></semantics></math> to <math id="alg1.12.12.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="alg1.12.12.2.m2.1a"><mi id="alg1.12.12.2.m2.1.1" xref="alg1.12.12.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.12.12.2.m2.1b"><ci id="alg1.12.12.2.m2.1.1.cmml" xref="alg1.12.12.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.2.m2.1d">italic_G</annotation></semantics></math></em> <span id="alg1.12.12.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.25.26" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span id="alg1.25.26.1" class="ltx_text ltx_font_typewriter" style="color:#0045B1;">// Grow</span> 
</div>
<div id="alg1.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    Generate dataset <math id="alg1.13.13.m1.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="alg1.13.13.m1.1a"><msub id="alg1.13.13.m1.1.1" xref="alg1.13.13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.13.m1.1.1.2" xref="alg1.13.13.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.13.13.m1.1.1.3" xref="alg1.13.13.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.1b"><apply id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1"><csymbol cd="ambiguous" id="alg1.13.13.m1.1.1.1.cmml" xref="alg1.13.13.m1.1.1">subscript</csymbol><ci id="alg1.13.13.m1.1.1.2.cmml" xref="alg1.13.13.m1.1.1.2">𝒟</ci><ci id="alg1.13.13.m1.1.1.3.cmml" xref="alg1.13.13.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> by sampling: <math id="alg1.14.14.m2.3" class="ltx_Math" alttext="{\cal D}_{g}=\{\;({\bm{x}}^{i},{\bm{y}}^{i})|_{i=1}^{N_{g}}\;\;\mbox{s.t.}\;\;{\bm{x}}^{i}\sim{\cal D},\;{\bm{y}}^{i}\sim\pi_{\theta}({\bm{y}}|{\bm{x}}^{i})\;\}\cup{\cal D}." display="inline"><semantics id="alg1.14.14.m2.3a"><mrow id="alg1.14.14.m2.3.3.1" xref="alg1.14.14.m2.3.3.1.1.cmml"><mrow id="alg1.14.14.m2.3.3.1.1" xref="alg1.14.14.m2.3.3.1.1.cmml"><msub id="alg1.14.14.m2.3.3.1.1.3" xref="alg1.14.14.m2.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.14.14.m2.3.3.1.1.3.2" xref="alg1.14.14.m2.3.3.1.1.3.2.cmml">𝒟</mi><mi id="alg1.14.14.m2.3.3.1.1.3.3" xref="alg1.14.14.m2.3.3.1.1.3.3.cmml">g</mi></msub><mo id="alg1.14.14.m2.3.3.1.1.2" xref="alg1.14.14.m2.3.3.1.1.2.cmml">=</mo><mrow id="alg1.14.14.m2.3.3.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.cmml"><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.2.cmml"><mo rspace="0.280em" stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.2.cmml">{</mo><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.3.cmml"><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msup id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msup id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.5" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.14.14.m2.1.1.1" xref="alg1.14.14.m2.1.1.1.cmml"><mi id="alg1.14.14.m2.1.1.1.2" xref="alg1.14.14.m2.1.1.1.2.cmml">i</mi><mo id="alg1.14.14.m2.1.1.1.1" xref="alg1.14.14.m2.1.1.1.1.cmml">=</mo><mn id="alg1.14.14.m2.1.1.1.3" xref="alg1.14.14.m2.1.1.1.3.cmml">1</mn></mrow><msub id="alg1.14.14.m2.2.2.1" xref="alg1.14.14.m2.2.2.1.cmml"><mi id="alg1.14.14.m2.2.2.1.2" xref="alg1.14.14.m2.2.2.1.2.cmml">N</mi><mi id="alg1.14.14.m2.2.2.1.3" xref="alg1.14.14.m2.2.2.1.3.cmml">g</mi></msub></msubsup><mo id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mtext id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.3a.cmml">s.t.</mtext><mo lspace="0.560em" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.2a" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml">𝒙</mi><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msup></mrow><mo id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">𝒟</mi></mrow><mo rspace="0.447em" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.3a.cmml">,</mo><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.cmml"><msup id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.2.cmml">𝒚</mi><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></msup><mo id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.2.cmml">∼</mo><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.cmml"><msub id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.2.cmml">π</mi><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.3.cmml">θ</mi></msub><mo id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml">|</mo><msup id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">𝒙</mi><mi id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">i</mi></msup></mrow><mo rspace="0.280em" stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="alg1.14.14.m2.3.3.1.1.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.1.2.cmml">}</mo></mrow><mo id="alg1.14.14.m2.3.3.1.1.1.2" xref="alg1.14.14.m2.3.3.1.1.1.2.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="alg1.14.14.m2.3.3.1.1.1.3" xref="alg1.14.14.m2.3.3.1.1.1.3.cmml">𝒟</mi></mrow></mrow><mo lspace="0em" id="alg1.14.14.m2.3.3.1.2" xref="alg1.14.14.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.14.m2.3b"><apply id="alg1.14.14.m2.3.3.1.1.cmml" xref="alg1.14.14.m2.3.3.1"><eq id="alg1.14.14.m2.3.3.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.2"></eq><apply id="alg1.14.14.m2.3.3.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.3.1.cmml" xref="alg1.14.14.m2.3.3.1.1.3">subscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.3.2.cmml" xref="alg1.14.14.m2.3.3.1.1.3.2">𝒟</ci><ci id="alg1.14.14.m2.3.3.1.1.3.3.cmml" xref="alg1.14.14.m2.3.3.1.1.3.3">𝑔</ci></apply><apply id="alg1.14.14.m2.3.3.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1"><union id="alg1.14.14.m2.3.3.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.2"></union><set id="alg1.14.14.m2.3.3.1.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1"><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.3a.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.2">similar-to</csymbol><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1"><times id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">evaluated-at</csymbol><interval closure="open" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒚</ci><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="alg1.14.14.m2.1.1.1.cmml" xref="alg1.14.14.m2.1.1.1"><eq id="alg1.14.14.m2.1.1.1.1.cmml" xref="alg1.14.14.m2.1.1.1.1"></eq><ci id="alg1.14.14.m2.1.1.1.2.cmml" xref="alg1.14.14.m2.1.1.1.2">𝑖</ci><cn type="integer" id="alg1.14.14.m2.1.1.1.3.cmml" xref="alg1.14.14.m2.1.1.1.3">1</cn></apply><apply id="alg1.14.14.m2.2.2.1.cmml" xref="alg1.14.14.m2.2.2.1"><csymbol cd="ambiguous" id="alg1.14.14.m2.2.2.1.1.cmml" xref="alg1.14.14.m2.2.2.1">subscript</csymbol><ci id="alg1.14.14.m2.2.2.1.2.cmml" xref="alg1.14.14.m2.2.2.1.2">𝑁</ci><ci id="alg1.14.14.m2.2.2.1.3.cmml" xref="alg1.14.14.m2.2.2.1.3">𝑔</ci></apply></apply><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.3"><mtext id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.3">s.t.</mtext></ci><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.2">𝒙</ci><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.1.1.3">𝒟</ci></apply><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2"><csymbol cd="latexml" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.2">similar-to</csymbol><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.2">𝒚</ci><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.3.3">𝑖</ci></apply><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1"><times id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.2"></times><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3">subscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.2">𝜋</ci><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.3.3">𝜃</ci></apply><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1"><csymbol cd="latexml" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.1">conditional</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.2">𝒚</ci><apply id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3">superscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.2">𝒙</ci><ci id="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.1.1.1.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></set><ci id="alg1.14.14.m2.3.3.1.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.1.3">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m2.3c">{\cal D}_{g}=\{\;({\bm{x}}^{i},{\bm{y}}^{i})|_{i=1}^{N_{g}}\;\;\mbox{s.t.}\;\;{\bm{x}}^{i}\sim{\cal D},\;{\bm{y}}^{i}\sim\pi_{\theta}({\bm{y}}|{\bm{x}}^{i})\;\}\cup{\cal D}.</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.m2.3d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT = { ( bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , bold_italic_y start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) | start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_POSTSUPERSCRIPT s.t. bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ caligraphic_D , bold_italic_y start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) } ∪ caligraphic_D .</annotation></semantics></math> 
</div>
<div id="alg1.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    Annotate <math id="alg1.15.15.m1.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="alg1.15.15.m1.1a"><msub id="alg1.15.15.m1.1.1" xref="alg1.15.15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.15.15.m1.1.1.2" xref="alg1.15.15.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.15.15.m1.1.1.3" xref="alg1.15.15.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.15.15.m1.1b"><apply id="alg1.15.15.m1.1.1.cmml" xref="alg1.15.15.m1.1.1"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.1.cmml" xref="alg1.15.15.m1.1.1">subscript</csymbol><ci id="alg1.15.15.m1.1.1.2.cmml" xref="alg1.15.15.m1.1.1.2">𝒟</ci><ci id="alg1.15.15.m1.1.1.3.cmml" xref="alg1.15.15.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m1.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> with the reward model <math id="alg1.16.16.m2.2" class="ltx_Math" alttext="R({\bm{x}},{\bm{y}})" display="inline"><semantics id="alg1.16.16.m2.2a"><mrow id="alg1.16.16.m2.2.3" xref="alg1.16.16.m2.2.3.cmml"><mi id="alg1.16.16.m2.2.3.2" xref="alg1.16.16.m2.2.3.2.cmml">R</mi><mo id="alg1.16.16.m2.2.3.1" xref="alg1.16.16.m2.2.3.1.cmml">⁢</mo><mrow id="alg1.16.16.m2.2.3.3.2" xref="alg1.16.16.m2.2.3.3.1.cmml"><mo stretchy="false" id="alg1.16.16.m2.2.3.3.2.1" xref="alg1.16.16.m2.2.3.3.1.cmml">(</mo><mi id="alg1.16.16.m2.1.1" xref="alg1.16.16.m2.1.1.cmml">𝒙</mi><mo id="alg1.16.16.m2.2.3.3.2.2" xref="alg1.16.16.m2.2.3.3.1.cmml">,</mo><mi id="alg1.16.16.m2.2.2" xref="alg1.16.16.m2.2.2.cmml">𝒚</mi><mo stretchy="false" id="alg1.16.16.m2.2.3.3.2.3" xref="alg1.16.16.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.16.m2.2b"><apply id="alg1.16.16.m2.2.3.cmml" xref="alg1.16.16.m2.2.3"><times id="alg1.16.16.m2.2.3.1.cmml" xref="alg1.16.16.m2.2.3.1"></times><ci id="alg1.16.16.m2.2.3.2.cmml" xref="alg1.16.16.m2.2.3.2">𝑅</ci><interval closure="open" id="alg1.16.16.m2.2.3.3.1.cmml" xref="alg1.16.16.m2.2.3.3.2"><ci id="alg1.16.16.m2.1.1.cmml" xref="alg1.16.16.m2.1.1">𝒙</ci><ci id="alg1.16.16.m2.2.2.cmml" xref="alg1.16.16.m2.2.2">𝒚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m2.2c">R({\bm{x}},{\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.m2.2d">italic_R ( bold_italic_x , bold_italic_y )</annotation></semantics></math>. 
</div>
<div id="alg1.18.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span id="alg1.18.18.3" class="ltx_text ltx_font_bold">for</span> <em id="alg1.18.18.2" class="ltx_emph ltx_font_italic"><math id="alg1.17.17.1.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg1.17.17.1.m1.1a"><mrow id="alg1.17.17.1.m1.1.1" xref="alg1.17.17.1.m1.1.1.cmml"><mi id="alg1.17.17.1.m1.1.1.2" xref="alg1.17.17.1.m1.1.1.2.cmml">i</mi><mo mathvariant="normal" id="alg1.17.17.1.m1.1.1.1" xref="alg1.17.17.1.m1.1.1.1.cmml">=</mo><mn mathvariant="normal" id="alg1.17.17.1.m1.1.1.3" xref="alg1.17.17.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.1.m1.1b"><apply id="alg1.17.17.1.m1.1.1.cmml" xref="alg1.17.17.1.m1.1.1"><eq id="alg1.17.17.1.m1.1.1.1.cmml" xref="alg1.17.17.1.m1.1.1.1"></eq><ci id="alg1.17.17.1.m1.1.1.2.cmml" xref="alg1.17.17.1.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.17.17.1.m1.1.1.3.cmml" xref="alg1.17.17.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.1.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.1.m1.1d">italic_i = 1</annotation></semantics></math> to <math id="alg1.18.18.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.18.18.2.m2.1a"><mi id="alg1.18.18.2.m2.1.1" xref="alg1.18.18.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.18.18.2.m2.1b"><ci id="alg1.18.18.2.m2.1.1.cmml" xref="alg1.18.18.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.2.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.2.m2.1d">italic_I</annotation></semantics></math></em> <span id="alg1.18.18.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.25.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span id="alg1.25.27.1" class="ltx_text ltx_font_typewriter" style="color:#6932E6;">// Improve</span> 
</div>
<div id="alg1.21.21" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    Choose threshold s.t. <math id="alg1.19.19.m1.1" class="ltx_Math" alttext="\tau_{1}&gt;V_{\pi_{\theta}}" display="inline"><semantics id="alg1.19.19.m1.1a"><mrow id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml"><msub id="alg1.19.19.m1.1.1.2" xref="alg1.19.19.m1.1.1.2.cmml"><mi id="alg1.19.19.m1.1.1.2.2" xref="alg1.19.19.m1.1.1.2.2.cmml">τ</mi><mn id="alg1.19.19.m1.1.1.2.3" xref="alg1.19.19.m1.1.1.2.3.cmml">1</mn></msub><mo id="alg1.19.19.m1.1.1.1" xref="alg1.19.19.m1.1.1.1.cmml">&gt;</mo><msub id="alg1.19.19.m1.1.1.3" xref="alg1.19.19.m1.1.1.3.cmml"><mi id="alg1.19.19.m1.1.1.3.2" xref="alg1.19.19.m1.1.1.3.2.cmml">V</mi><msub id="alg1.19.19.m1.1.1.3.3" xref="alg1.19.19.m1.1.1.3.3.cmml"><mi id="alg1.19.19.m1.1.1.3.3.2" xref="alg1.19.19.m1.1.1.3.3.2.cmml">π</mi><mi id="alg1.19.19.m1.1.1.3.3.3" xref="alg1.19.19.m1.1.1.3.3.3.cmml">θ</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1"><gt id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1.1"></gt><apply id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.2.1.cmml" xref="alg1.19.19.m1.1.1.2">subscript</csymbol><ci id="alg1.19.19.m1.1.1.2.2.cmml" xref="alg1.19.19.m1.1.1.2.2">𝜏</ci><cn type="integer" id="alg1.19.19.m1.1.1.2.3.cmml" xref="alg1.19.19.m1.1.1.2.3">1</cn></apply><apply id="alg1.19.19.m1.1.1.3.cmml" xref="alg1.19.19.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.3.1.cmml" xref="alg1.19.19.m1.1.1.3">subscript</csymbol><ci id="alg1.19.19.m1.1.1.3.2.cmml" xref="alg1.19.19.m1.1.1.3.2">𝑉</ci><apply id="alg1.19.19.m1.1.1.3.3.cmml" xref="alg1.19.19.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.3.3.1.cmml" xref="alg1.19.19.m1.1.1.3.3">subscript</csymbol><ci id="alg1.19.19.m1.1.1.3.3.2.cmml" xref="alg1.19.19.m1.1.1.3.3.2">𝜋</ci><ci id="alg1.19.19.m1.1.1.3.3.3.cmml" xref="alg1.19.19.m1.1.1.3.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">\tau_{1}&gt;V_{\pi_{\theta}}</annotation><annotation encoding="application/x-llamapun" id="alg1.19.19.m1.1d">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &gt; italic_V start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> for <math id="alg1.20.20.m2.3" class="ltx_Math" alttext="V_{\pi_{\theta}}=\mathbb{E}_{{\cal D}_{g}}[R({\bm{x}},{\bm{y}})]" display="inline"><semantics id="alg1.20.20.m2.3a"><mrow id="alg1.20.20.m2.3.3" xref="alg1.20.20.m2.3.3.cmml"><msub id="alg1.20.20.m2.3.3.3" xref="alg1.20.20.m2.3.3.3.cmml"><mi id="alg1.20.20.m2.3.3.3.2" xref="alg1.20.20.m2.3.3.3.2.cmml">V</mi><msub id="alg1.20.20.m2.3.3.3.3" xref="alg1.20.20.m2.3.3.3.3.cmml"><mi id="alg1.20.20.m2.3.3.3.3.2" xref="alg1.20.20.m2.3.3.3.3.2.cmml">π</mi><mi id="alg1.20.20.m2.3.3.3.3.3" xref="alg1.20.20.m2.3.3.3.3.3.cmml">θ</mi></msub></msub><mo id="alg1.20.20.m2.3.3.2" xref="alg1.20.20.m2.3.3.2.cmml">=</mo><mrow id="alg1.20.20.m2.3.3.1" xref="alg1.20.20.m2.3.3.1.cmml"><msub id="alg1.20.20.m2.3.3.1.3" xref="alg1.20.20.m2.3.3.1.3.cmml"><mi id="alg1.20.20.m2.3.3.1.3.2" xref="alg1.20.20.m2.3.3.1.3.2.cmml">𝔼</mi><msub id="alg1.20.20.m2.3.3.1.3.3" xref="alg1.20.20.m2.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.20.20.m2.3.3.1.3.3.2" xref="alg1.20.20.m2.3.3.1.3.3.2.cmml">𝒟</mi><mi id="alg1.20.20.m2.3.3.1.3.3.3" xref="alg1.20.20.m2.3.3.1.3.3.3.cmml">g</mi></msub></msub><mo id="alg1.20.20.m2.3.3.1.2" xref="alg1.20.20.m2.3.3.1.2.cmml">⁢</mo><mrow id="alg1.20.20.m2.3.3.1.1.1" xref="alg1.20.20.m2.3.3.1.1.2.cmml"><mo stretchy="false" id="alg1.20.20.m2.3.3.1.1.1.2" xref="alg1.20.20.m2.3.3.1.1.2.1.cmml">[</mo><mrow id="alg1.20.20.m2.3.3.1.1.1.1" xref="alg1.20.20.m2.3.3.1.1.1.1.cmml"><mi id="alg1.20.20.m2.3.3.1.1.1.1.2" xref="alg1.20.20.m2.3.3.1.1.1.1.2.cmml">R</mi><mo id="alg1.20.20.m2.3.3.1.1.1.1.1" xref="alg1.20.20.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.20.20.m2.3.3.1.1.1.1.3.2" xref="alg1.20.20.m2.3.3.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.20.20.m2.3.3.1.1.1.1.3.2.1" xref="alg1.20.20.m2.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="alg1.20.20.m2.1.1" xref="alg1.20.20.m2.1.1.cmml">𝒙</mi><mo id="alg1.20.20.m2.3.3.1.1.1.1.3.2.2" xref="alg1.20.20.m2.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="alg1.20.20.m2.2.2" xref="alg1.20.20.m2.2.2.cmml">𝒚</mi><mo stretchy="false" id="alg1.20.20.m2.3.3.1.1.1.1.3.2.3" xref="alg1.20.20.m2.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.20.20.m2.3.3.1.1.1.3" xref="alg1.20.20.m2.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m2.3b"><apply id="alg1.20.20.m2.3.3.cmml" xref="alg1.20.20.m2.3.3"><eq id="alg1.20.20.m2.3.3.2.cmml" xref="alg1.20.20.m2.3.3.2"></eq><apply id="alg1.20.20.m2.3.3.3.cmml" xref="alg1.20.20.m2.3.3.3"><csymbol cd="ambiguous" id="alg1.20.20.m2.3.3.3.1.cmml" xref="alg1.20.20.m2.3.3.3">subscript</csymbol><ci id="alg1.20.20.m2.3.3.3.2.cmml" xref="alg1.20.20.m2.3.3.3.2">𝑉</ci><apply id="alg1.20.20.m2.3.3.3.3.cmml" xref="alg1.20.20.m2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.20.20.m2.3.3.3.3.1.cmml" xref="alg1.20.20.m2.3.3.3.3">subscript</csymbol><ci id="alg1.20.20.m2.3.3.3.3.2.cmml" xref="alg1.20.20.m2.3.3.3.3.2">𝜋</ci><ci id="alg1.20.20.m2.3.3.3.3.3.cmml" xref="alg1.20.20.m2.3.3.3.3.3">𝜃</ci></apply></apply><apply id="alg1.20.20.m2.3.3.1.cmml" xref="alg1.20.20.m2.3.3.1"><times id="alg1.20.20.m2.3.3.1.2.cmml" xref="alg1.20.20.m2.3.3.1.2"></times><apply id="alg1.20.20.m2.3.3.1.3.cmml" xref="alg1.20.20.m2.3.3.1.3"><csymbol cd="ambiguous" id="alg1.20.20.m2.3.3.1.3.1.cmml" xref="alg1.20.20.m2.3.3.1.3">subscript</csymbol><ci id="alg1.20.20.m2.3.3.1.3.2.cmml" xref="alg1.20.20.m2.3.3.1.3.2">𝔼</ci><apply id="alg1.20.20.m2.3.3.1.3.3.cmml" xref="alg1.20.20.m2.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.20.20.m2.3.3.1.3.3.1.cmml" xref="alg1.20.20.m2.3.3.1.3.3">subscript</csymbol><ci id="alg1.20.20.m2.3.3.1.3.3.2.cmml" xref="alg1.20.20.m2.3.3.1.3.3.2">𝒟</ci><ci id="alg1.20.20.m2.3.3.1.3.3.3.cmml" xref="alg1.20.20.m2.3.3.1.3.3.3">𝑔</ci></apply></apply><apply id="alg1.20.20.m2.3.3.1.1.2.cmml" xref="alg1.20.20.m2.3.3.1.1.1"><csymbol cd="latexml" id="alg1.20.20.m2.3.3.1.1.2.1.cmml" xref="alg1.20.20.m2.3.3.1.1.1.2">delimited-[]</csymbol><apply id="alg1.20.20.m2.3.3.1.1.1.1.cmml" xref="alg1.20.20.m2.3.3.1.1.1.1"><times id="alg1.20.20.m2.3.3.1.1.1.1.1.cmml" xref="alg1.20.20.m2.3.3.1.1.1.1.1"></times><ci id="alg1.20.20.m2.3.3.1.1.1.1.2.cmml" xref="alg1.20.20.m2.3.3.1.1.1.1.2">𝑅</ci><interval closure="open" id="alg1.20.20.m2.3.3.1.1.1.1.3.1.cmml" xref="alg1.20.20.m2.3.3.1.1.1.1.3.2"><ci id="alg1.20.20.m2.1.1.cmml" xref="alg1.20.20.m2.1.1">𝒙</ci><ci id="alg1.20.20.m2.2.2.cmml" xref="alg1.20.20.m2.2.2">𝒚</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m2.3c">V_{\pi_{\theta}}=\mathbb{E}_{{\cal D}_{g}}[R({\bm{x}},{\bm{y}})]</annotation><annotation encoding="application/x-llamapun" id="alg1.20.20.m2.3d">italic_V start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_R ( bold_italic_x , bold_italic_y ) ]</annotation></semantics></math> and <math id="alg1.21.21.m3.1" class="ltx_Math" alttext="\tau_{i+1}&gt;\tau_{i}" display="inline"><semantics id="alg1.21.21.m3.1a"><mrow id="alg1.21.21.m3.1.1" xref="alg1.21.21.m3.1.1.cmml"><msub id="alg1.21.21.m3.1.1.2" xref="alg1.21.21.m3.1.1.2.cmml"><mi id="alg1.21.21.m3.1.1.2.2" xref="alg1.21.21.m3.1.1.2.2.cmml">τ</mi><mrow id="alg1.21.21.m3.1.1.2.3" xref="alg1.21.21.m3.1.1.2.3.cmml"><mi id="alg1.21.21.m3.1.1.2.3.2" xref="alg1.21.21.m3.1.1.2.3.2.cmml">i</mi><mo id="alg1.21.21.m3.1.1.2.3.1" xref="alg1.21.21.m3.1.1.2.3.1.cmml">+</mo><mn id="alg1.21.21.m3.1.1.2.3.3" xref="alg1.21.21.m3.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.21.21.m3.1.1.1" xref="alg1.21.21.m3.1.1.1.cmml">&gt;</mo><msub id="alg1.21.21.m3.1.1.3" xref="alg1.21.21.m3.1.1.3.cmml"><mi id="alg1.21.21.m3.1.1.3.2" xref="alg1.21.21.m3.1.1.3.2.cmml">τ</mi><mi id="alg1.21.21.m3.1.1.3.3" xref="alg1.21.21.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.m3.1b"><apply id="alg1.21.21.m3.1.1.cmml" xref="alg1.21.21.m3.1.1"><gt id="alg1.21.21.m3.1.1.1.cmml" xref="alg1.21.21.m3.1.1.1"></gt><apply id="alg1.21.21.m3.1.1.2.cmml" xref="alg1.21.21.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.21.21.m3.1.1.2.1.cmml" xref="alg1.21.21.m3.1.1.2">subscript</csymbol><ci id="alg1.21.21.m3.1.1.2.2.cmml" xref="alg1.21.21.m3.1.1.2.2">𝜏</ci><apply id="alg1.21.21.m3.1.1.2.3.cmml" xref="alg1.21.21.m3.1.1.2.3"><plus id="alg1.21.21.m3.1.1.2.3.1.cmml" xref="alg1.21.21.m3.1.1.2.3.1"></plus><ci id="alg1.21.21.m3.1.1.2.3.2.cmml" xref="alg1.21.21.m3.1.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.21.21.m3.1.1.2.3.3.cmml" xref="alg1.21.21.m3.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.21.21.m3.1.1.3.cmml" xref="alg1.21.21.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.21.21.m3.1.1.3.1.cmml" xref="alg1.21.21.m3.1.1.3">subscript</csymbol><ci id="alg1.21.21.m3.1.1.3.2.cmml" xref="alg1.21.21.m3.1.1.3.2">𝜏</ci><ci id="alg1.21.21.m3.1.1.3.3.cmml" xref="alg1.21.21.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m3.1c">\tau_{i+1}&gt;\tau_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.21.21.m3.1d">italic_τ start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT &gt; italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. 
</div>
<div id="alg1.22.22" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span id="alg1.22.22.2" class="ltx_text ltx_font_bold">while</span> <em id="alg1.22.22.1" class="ltx_emph ltx_font_italic">reward improves on <math id="alg1.22.22.1.m1.1" class="ltx_Math" alttext="{\cal D}_{eval}" display="inline"><semantics id="alg1.22.22.1.m1.1a"><msub id="alg1.22.22.1.m1.1.1" xref="alg1.22.22.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.22.22.1.m1.1.1.2" xref="alg1.22.22.1.m1.1.1.2.cmml">𝒟</mi><mrow id="alg1.22.22.1.m1.1.1.3" xref="alg1.22.22.1.m1.1.1.3.cmml"><mi id="alg1.22.22.1.m1.1.1.3.2" xref="alg1.22.22.1.m1.1.1.3.2.cmml">e</mi><mo mathvariant="italic" id="alg1.22.22.1.m1.1.1.3.1" xref="alg1.22.22.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.22.22.1.m1.1.1.3.3" xref="alg1.22.22.1.m1.1.1.3.3.cmml">v</mi><mo mathvariant="italic" id="alg1.22.22.1.m1.1.1.3.1a" xref="alg1.22.22.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.22.22.1.m1.1.1.3.4" xref="alg1.22.22.1.m1.1.1.3.4.cmml">a</mi><mo mathvariant="italic" id="alg1.22.22.1.m1.1.1.3.1b" xref="alg1.22.22.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.22.22.1.m1.1.1.3.5" xref="alg1.22.22.1.m1.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.22.22.1.m1.1b"><apply id="alg1.22.22.1.m1.1.1.cmml" xref="alg1.22.22.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.1.1.1.cmml" xref="alg1.22.22.1.m1.1.1">subscript</csymbol><ci id="alg1.22.22.1.m1.1.1.2.cmml" xref="alg1.22.22.1.m1.1.1.2">𝒟</ci><apply id="alg1.22.22.1.m1.1.1.3.cmml" xref="alg1.22.22.1.m1.1.1.3"><times id="alg1.22.22.1.m1.1.1.3.1.cmml" xref="alg1.22.22.1.m1.1.1.3.1"></times><ci id="alg1.22.22.1.m1.1.1.3.2.cmml" xref="alg1.22.22.1.m1.1.1.3.2">𝑒</ci><ci id="alg1.22.22.1.m1.1.1.3.3.cmml" xref="alg1.22.22.1.m1.1.1.3.3">𝑣</ci><ci id="alg1.22.22.1.m1.1.1.3.4.cmml" xref="alg1.22.22.1.m1.1.1.3.4">𝑎</ci><ci id="alg1.22.22.1.m1.1.1.3.5.cmml" xref="alg1.22.22.1.m1.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.1.m1.1c">{\cal D}_{eval}</annotation><annotation encoding="application/x-llamapun" id="alg1.22.22.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_e italic_v italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math></em> <span id="alg1.22.22.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.24.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    Optimise <math id="alg1.23.23.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.23.23.m1.1a"><mi id="alg1.23.23.m1.1.1" xref="alg1.23.23.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.1b"><ci id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.23.23.m1.1d">italic_θ</annotation></semantics></math> on objective: <math id="alg1.24.24.m2.9" class="ltx_Math" alttext="J(\theta)=\mathbb{E}_{({\bm{x}},{\bm{y}})\sim{\cal D}_{g}}\left[F({\bm{x}},{\bm{y}};\tau_{i})\;{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)\right]" display="inline"><semantics id="alg1.24.24.m2.9a"><mrow id="alg1.24.24.m2.9.9" xref="alg1.24.24.m2.9.9.cmml"><mrow id="alg1.24.24.m2.9.9.3" xref="alg1.24.24.m2.9.9.3.cmml"><mi id="alg1.24.24.m2.9.9.3.2" xref="alg1.24.24.m2.9.9.3.2.cmml">J</mi><mo id="alg1.24.24.m2.9.9.3.1" xref="alg1.24.24.m2.9.9.3.1.cmml">⁢</mo><mrow id="alg1.24.24.m2.9.9.3.3.2" xref="alg1.24.24.m2.9.9.3.cmml"><mo stretchy="false" id="alg1.24.24.m2.9.9.3.3.2.1" xref="alg1.24.24.m2.9.9.3.cmml">(</mo><mi id="alg1.24.24.m2.3.3" xref="alg1.24.24.m2.3.3.cmml">θ</mi><mo stretchy="false" id="alg1.24.24.m2.9.9.3.3.2.2" xref="alg1.24.24.m2.9.9.3.cmml">)</mo></mrow></mrow><mo id="alg1.24.24.m2.9.9.2" xref="alg1.24.24.m2.9.9.2.cmml">=</mo><mrow id="alg1.24.24.m2.9.9.1" xref="alg1.24.24.m2.9.9.1.cmml"><msub id="alg1.24.24.m2.9.9.1.3" xref="alg1.24.24.m2.9.9.1.3.cmml"><mi id="alg1.24.24.m2.9.9.1.3.2" xref="alg1.24.24.m2.9.9.1.3.2.cmml">𝔼</mi><mrow id="alg1.24.24.m2.2.2.2" xref="alg1.24.24.m2.2.2.2.cmml"><mrow id="alg1.24.24.m2.2.2.2.4.2" xref="alg1.24.24.m2.2.2.2.4.1.cmml"><mo stretchy="false" id="alg1.24.24.m2.2.2.2.4.2.1" xref="alg1.24.24.m2.2.2.2.4.1.cmml">(</mo><mi id="alg1.24.24.m2.1.1.1.1" xref="alg1.24.24.m2.1.1.1.1.cmml">𝒙</mi><mo id="alg1.24.24.m2.2.2.2.4.2.2" xref="alg1.24.24.m2.2.2.2.4.1.cmml">,</mo><mi id="alg1.24.24.m2.2.2.2.2" xref="alg1.24.24.m2.2.2.2.2.cmml">𝒚</mi><mo stretchy="false" id="alg1.24.24.m2.2.2.2.4.2.3" xref="alg1.24.24.m2.2.2.2.4.1.cmml">)</mo></mrow><mo id="alg1.24.24.m2.2.2.2.3" xref="alg1.24.24.m2.2.2.2.3.cmml">∼</mo><msub id="alg1.24.24.m2.2.2.2.5" xref="alg1.24.24.m2.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.24.24.m2.2.2.2.5.2" xref="alg1.24.24.m2.2.2.2.5.2.cmml">𝒟</mi><mi id="alg1.24.24.m2.2.2.2.5.3" xref="alg1.24.24.m2.2.2.2.5.3.cmml">g</mi></msub></mrow></msub><mo id="alg1.24.24.m2.9.9.1.2" xref="alg1.24.24.m2.9.9.1.2.cmml">⁢</mo><mrow id="alg1.24.24.m2.9.9.1.1.1" xref="alg1.24.24.m2.9.9.1.1.2.cmml"><mo id="alg1.24.24.m2.9.9.1.1.1.2" xref="alg1.24.24.m2.9.9.1.1.2.1.cmml">[</mo><mrow id="alg1.24.24.m2.9.9.1.1.1.1" xref="alg1.24.24.m2.9.9.1.1.1.1.cmml"><mi id="alg1.24.24.m2.9.9.1.1.1.1.3" xref="alg1.24.24.m2.9.9.1.1.1.1.3.cmml">F</mi><mo id="alg1.24.24.m2.9.9.1.1.1.1.2" xref="alg1.24.24.m2.9.9.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.24.24.m2.9.9.1.1.1.1.1.1" xref="alg1.24.24.m2.9.9.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.24.24.m2.9.9.1.1.1.1.1.1.2" xref="alg1.24.24.m2.9.9.1.1.1.1.1.2.cmml">(</mo><mi id="alg1.24.24.m2.4.4" xref="alg1.24.24.m2.4.4.cmml">𝒙</mi><mo id="alg1.24.24.m2.9.9.1.1.1.1.1.1.3" xref="alg1.24.24.m2.9.9.1.1.1.1.1.2.cmml">,</mo><mi id="alg1.24.24.m2.5.5" xref="alg1.24.24.m2.5.5.cmml">𝒚</mi><mo id="alg1.24.24.m2.9.9.1.1.1.1.1.1.4" xref="alg1.24.24.m2.9.9.1.1.1.1.1.2.cmml">;</mo><msub id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.cmml"><mi id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.2" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.2.cmml">τ</mi><mi id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.3" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.24.24.m2.9.9.1.1.1.1.1.1.5" xref="alg1.24.24.m2.9.9.1.1.1.1.1.2.cmml">)</mo></mrow><mo lspace="0.280em" id="alg1.24.24.m2.9.9.1.1.1.1.2a" xref="alg1.24.24.m2.9.9.1.1.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="alg1.24.24.m2.9.9.1.1.1.1.4" xref="alg1.24.24.m2.9.9.1.1.1.1.4.cmml">ℒ</mi><mo id="alg1.24.24.m2.9.9.1.1.1.1.2b" xref="alg1.24.24.m2.9.9.1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.24.24.m2.9.9.1.1.1.1.5.2" xref="alg1.24.24.m2.9.9.1.1.1.1.5.1.cmml"><mo stretchy="false" id="alg1.24.24.m2.9.9.1.1.1.1.5.2.1" xref="alg1.24.24.m2.9.9.1.1.1.1.5.1.cmml">(</mo><mi id="alg1.24.24.m2.6.6" xref="alg1.24.24.m2.6.6.cmml">𝒙</mi><mo id="alg1.24.24.m2.9.9.1.1.1.1.5.2.2" xref="alg1.24.24.m2.9.9.1.1.1.1.5.1.cmml">,</mo><mi id="alg1.24.24.m2.7.7" xref="alg1.24.24.m2.7.7.cmml">𝒚</mi><mo id="alg1.24.24.m2.9.9.1.1.1.1.5.2.3" xref="alg1.24.24.m2.9.9.1.1.1.1.5.1.cmml">;</mo><mi id="alg1.24.24.m2.8.8" xref="alg1.24.24.m2.8.8.cmml">θ</mi><mo stretchy="false" id="alg1.24.24.m2.9.9.1.1.1.1.5.2.4" xref="alg1.24.24.m2.9.9.1.1.1.1.5.1.cmml">)</mo></mrow></mrow><mo id="alg1.24.24.m2.9.9.1.1.1.3" xref="alg1.24.24.m2.9.9.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.24.24.m2.9b"><apply id="alg1.24.24.m2.9.9.cmml" xref="alg1.24.24.m2.9.9"><eq id="alg1.24.24.m2.9.9.2.cmml" xref="alg1.24.24.m2.9.9.2"></eq><apply id="alg1.24.24.m2.9.9.3.cmml" xref="alg1.24.24.m2.9.9.3"><times id="alg1.24.24.m2.9.9.3.1.cmml" xref="alg1.24.24.m2.9.9.3.1"></times><ci id="alg1.24.24.m2.9.9.3.2.cmml" xref="alg1.24.24.m2.9.9.3.2">𝐽</ci><ci id="alg1.24.24.m2.3.3.cmml" xref="alg1.24.24.m2.3.3">𝜃</ci></apply><apply id="alg1.24.24.m2.9.9.1.cmml" xref="alg1.24.24.m2.9.9.1"><times id="alg1.24.24.m2.9.9.1.2.cmml" xref="alg1.24.24.m2.9.9.1.2"></times><apply id="alg1.24.24.m2.9.9.1.3.cmml" xref="alg1.24.24.m2.9.9.1.3"><csymbol cd="ambiguous" id="alg1.24.24.m2.9.9.1.3.1.cmml" xref="alg1.24.24.m2.9.9.1.3">subscript</csymbol><ci id="alg1.24.24.m2.9.9.1.3.2.cmml" xref="alg1.24.24.m2.9.9.1.3.2">𝔼</ci><apply id="alg1.24.24.m2.2.2.2.cmml" xref="alg1.24.24.m2.2.2.2"><csymbol cd="latexml" id="alg1.24.24.m2.2.2.2.3.cmml" xref="alg1.24.24.m2.2.2.2.3">similar-to</csymbol><interval closure="open" id="alg1.24.24.m2.2.2.2.4.1.cmml" xref="alg1.24.24.m2.2.2.2.4.2"><ci id="alg1.24.24.m2.1.1.1.1.cmml" xref="alg1.24.24.m2.1.1.1.1">𝒙</ci><ci id="alg1.24.24.m2.2.2.2.2.cmml" xref="alg1.24.24.m2.2.2.2.2">𝒚</ci></interval><apply id="alg1.24.24.m2.2.2.2.5.cmml" xref="alg1.24.24.m2.2.2.2.5"><csymbol cd="ambiguous" id="alg1.24.24.m2.2.2.2.5.1.cmml" xref="alg1.24.24.m2.2.2.2.5">subscript</csymbol><ci id="alg1.24.24.m2.2.2.2.5.2.cmml" xref="alg1.24.24.m2.2.2.2.5.2">𝒟</ci><ci id="alg1.24.24.m2.2.2.2.5.3.cmml" xref="alg1.24.24.m2.2.2.2.5.3">𝑔</ci></apply></apply></apply><apply id="alg1.24.24.m2.9.9.1.1.2.cmml" xref="alg1.24.24.m2.9.9.1.1.1"><csymbol cd="latexml" id="alg1.24.24.m2.9.9.1.1.2.1.cmml" xref="alg1.24.24.m2.9.9.1.1.1.2">delimited-[]</csymbol><apply id="alg1.24.24.m2.9.9.1.1.1.1.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1"><times id="alg1.24.24.m2.9.9.1.1.1.1.2.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.2"></times><ci id="alg1.24.24.m2.9.9.1.1.1.1.3.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.3">𝐹</ci><vector id="alg1.24.24.m2.9.9.1.1.1.1.1.2.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1"><ci id="alg1.24.24.m2.4.4.cmml" xref="alg1.24.24.m2.4.4">𝒙</ci><ci id="alg1.24.24.m2.5.5.cmml" xref="alg1.24.24.m2.5.5">𝒚</ci><apply id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.2.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.2">𝜏</ci><ci id="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.3.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.1.1.1.3">𝑖</ci></apply></vector><ci id="alg1.24.24.m2.9.9.1.1.1.1.4.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.4">ℒ</ci><vector id="alg1.24.24.m2.9.9.1.1.1.1.5.1.cmml" xref="alg1.24.24.m2.9.9.1.1.1.1.5.2"><ci id="alg1.24.24.m2.6.6.cmml" xref="alg1.24.24.m2.6.6">𝒙</ci><ci id="alg1.24.24.m2.7.7.cmml" xref="alg1.24.24.m2.7.7">𝒚</ci><ci id="alg1.24.24.m2.8.8.cmml" xref="alg1.24.24.m2.8.8">𝜃</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m2.9c">J(\theta)=\mathbb{E}_{({\bm{x}},{\bm{y}})\sim{\cal D}_{g}}\left[F({\bm{x}},{\bm{y}};\tau_{i})\;{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)\right]</annotation><annotation encoding="application/x-llamapun" id="alg1.24.24.m2.9d">italic_J ( italic_θ ) = blackboard_E start_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) ∼ caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_F ( bold_italic_x , bold_italic_y ; italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) caligraphic_L ( bold_italic_x , bold_italic_y ; italic_θ ) ]</annotation></semantics></math> 
</div>
<div id="alg1.25.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end while
</div>
<div id="alg1.25.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.25.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="alg1.25.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.25.32" class="ltx_listingline"> end for
</div>
<div id="alg1.25.25" class="ltx_listingline">
<span id="alg1.25.25.1" class="ltx_text" style="color:#000000;"><span id="alg1.25.25.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Policy <math id="alg1.25.25.m1.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="alg1.25.25.m1.1a"><msub id="alg1.25.25.m1.1.1" xref="alg1.25.25.m1.1.1.cmml"><mi id="alg1.25.25.m1.1.1.2" xref="alg1.25.25.m1.1.1.2.cmml">π</mi><mi id="alg1.25.25.m1.1.1.3" xref="alg1.25.25.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.25.25.m1.1b"><apply id="alg1.25.25.m1.1.1.cmml" xref="alg1.25.25.m1.1.1"><csymbol cd="ambiguous" id="alg1.25.25.m1.1.1.1.cmml" xref="alg1.25.25.m1.1.1">subscript</csymbol><ci id="alg1.25.25.m1.1.1.2.cmml" xref="alg1.25.25.m1.1.1.2">𝜋</ci><ci id="alg1.25.25.m1.1.1.3.cmml" xref="alg1.25.25.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.25.25.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div id="alg1.25.33" class="ltx_listingline">  
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.36.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span><span id="alg1.37.2" class="ltx_ERROR undefined">\rest</span><span id="alg1.38.3" class="ltx_text ltx_font_bold"> algorithm.</span> <span id="alg1.39.4" class="ltx_ERROR undefined">\rest</span> is a growing-batch RL algorithm. Given an initial policy of reasonable quality (for example, pre-trained using BC) iteratively applies <span id="alg1.40.5" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="alg1.41.6" class="ltx_text ltx_font_typewriter">Improve</span> steps to update the policy. Here <math id="alg1.28.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="alg1.28.m1.1b"><mi id="alg1.28.m1.1.1" xref="alg1.28.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg1.28.m1.1c"><ci id="alg1.28.m1.1.1.cmml" xref="alg1.28.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.m1.1d">F</annotation><annotation encoding="application/x-llamapun" id="alg1.28.m1.1e">italic_F</annotation></semantics></math> is a filtering function, and <math id="alg1.29.m2.1" class="ltx_Math" alttext="{\mathcal{L}}" display="inline"><semantics id="alg1.29.m2.1b"><mi class="ltx_font_mathcaligraphic" id="alg1.29.m2.1.1" xref="alg1.29.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg1.29.m2.1c"><ci id="alg1.29.m2.1.1.cmml" xref="alg1.29.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.m2.1d">{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="alg1.29.m2.1e">caligraphic_L</annotation></semantics></math> is an loss function.</figcaption>
</figure>
<section id="S3.SS0.SSSx2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Probabilistic interpretation of the <span id="S3.SS0.SSSx2.Px1.1.1" class="ltx_text ltx_font_typewriter">Improve</span> step</h5>

<div id="S3.SS0.SSSx2.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSSx2.Px1.p1.4" class="ltx_p">Let us consider the particular choice <math id="S3.SS0.SSSx2.Px1.p1.1.m1.1" class="ltx_Math" alttext="{\mathcal{L}}={\mathcal{L}}_{\text{NLL}}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.1.m1.1a"><mrow id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.2.cmml">ℒ</mi><mo id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.1.cmml">=</mo><msub id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.2" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.3" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.3a.cmml">NLL</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.1.m1.1b"><apply id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1"><eq id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.1"></eq><ci id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.2">ℒ</ci><apply id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.2">ℒ</ci><ci id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.3a.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.1.m1.1.1.3.3">NLL</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.1.m1.1c">{\mathcal{L}}={\mathcal{L}}_{\text{NLL}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.1.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT</annotation></semantics></math>, with <math id="S3.SS0.SSSx2.Px1.p1.2.m2.1" class="ltx_Math" alttext="\theta^{\prime}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.2.m2.1a"><msup id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.2.cmml">θ</mi><mo id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.2.m2.1b"><apply id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.2">𝜃</ci><ci id="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.2.m2.1c">\theta^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.2.m2.1d">italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> being the parameters of the model from the last <span id="S3.SS0.SSSx2.Px1.p1.4.1" class="ltx_text ltx_font_typewriter">Grow</span> step, <math id="S3.SS0.SSSx2.Px1.p1.3.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.3.m3.1a"><mi id="S3.SS0.SSSx2.Px1.p1.3.m3.1.1" xref="S3.SS0.SSSx2.Px1.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.3.m3.1b"><ci id="S3.SS0.SSSx2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.3.m3.1d">italic_λ</annotation></semantics></math> the proportion of data sampled from this model in <math id="S3.SS0.SSSx2.Px1.p1.4.m4.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.4.m4.1a"><msub id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.4.m4.1b"><apply id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.4.m4.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.4.m4.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and a single step of growth. The expression for the gradient in this case takes the following form:</p>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.10" class="ltx_Math" alttext="\displaystyle\nabla J(\theta)=-\mathbb{E}_{{\bm{x}}\sim{\cal D}}\left[\lambda\mathbb{E}_{{\bm{y}}\sim\pi_{\theta^{\prime}}({\bm{y}}|{\bm{x}})}\left[F({\bm{x}},{\bm{y}};\tau)\nabla\log\pi_{\theta}({\bm{y}}\mid{\bm{x}})\right]+(1-\lambda)\mathbb{E}_{{\bm{y}}\sim p({\bm{y}}|{\bm{x}})}\left[F({\bm{x}},{\bm{y}};\tau)\nabla\log\pi_{\theta}({\bm{y}}\mid{\bm{x}})\right]\right]." display="inline"><semantics id="S3.E3.m1.10a"><mrow id="S3.E3.m1.10.10.1" xref="S3.E3.m1.10.10.1.1.cmml"><mrow id="S3.E3.m1.10.10.1.1" xref="S3.E3.m1.10.10.1.1.cmml"><mrow id="S3.E3.m1.10.10.1.1.3" xref="S3.E3.m1.10.10.1.1.3.cmml"><mrow id="S3.E3.m1.10.10.1.1.3.2" xref="S3.E3.m1.10.10.1.1.3.2.cmml"><mo rspace="0.167em" id="S3.E3.m1.10.10.1.1.3.2.1" xref="S3.E3.m1.10.10.1.1.3.2.1.cmml">∇</mo><mi id="S3.E3.m1.10.10.1.1.3.2.2" xref="S3.E3.m1.10.10.1.1.3.2.2.cmml">J</mi></mrow><mo id="S3.E3.m1.10.10.1.1.3.1" xref="S3.E3.m1.10.10.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.3.3.2" xref="S3.E3.m1.10.10.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.1.1.3.3.2.1" xref="S3.E3.m1.10.10.1.1.3.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E3.m1.10.10.1.1.3.3.2.2" xref="S3.E3.m1.10.10.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.10.10.1.1.2" xref="S3.E3.m1.10.10.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.10.10.1.1.1" xref="S3.E3.m1.10.10.1.1.1.cmml"><mo id="S3.E3.m1.10.10.1.1.1a" xref="S3.E3.m1.10.10.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.10.10.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.cmml"><msub id="S3.E3.m1.10.10.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.3.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.3.2" xref="S3.E3.m1.10.10.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.10.10.1.1.1.1.3.3" xref="S3.E3.m1.10.10.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.3.3.2" xref="S3.E3.m1.10.10.1.1.1.1.3.3.2.cmml">𝒙</mi><mo id="S3.E3.m1.10.10.1.1.1.1.3.3.1" xref="S3.E3.m1.10.10.1.1.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.10.10.1.1.1.1.3.3.3" xref="S3.E3.m1.10.10.1.1.1.1.3.3.3.cmml">𝒟</mi></mrow></msub><mo id="S3.E3.m1.10.10.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.3.cmml">λ</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.2.cmml">𝔼</mi><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">𝒚</mi><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.2.cmml">π</mi><msup id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.1.3.3.2.cmml">θ</mi><mo id="S3.E3.m1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.3.cmml">F</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.2.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">𝒙</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml">,</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝒚</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml">;</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">τ</mi><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.2.4" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml">)</mo></mrow><mo lspace="0.167em" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.cmml"><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml"><mo rspace="0.167em" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.1.cmml">∇</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.cmml">⁡</mo><msub id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.2.cmml">π</mi><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2b" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.4" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.3.cmml">⁢</mo><msub id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.2.cmml">𝔼</mi><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mi id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml">𝒚</mi><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.2.cmml">∼</mo><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml">p</mi><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.3a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.2.cmml"><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.2.1.cmml">[</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.3.cmml">F</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.2.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.1.cmml">(</mo><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">𝒙</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.2.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.1.cmml">,</mo><mi id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml">𝒚</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.2.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.1.cmml">;</mo><mi id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml">τ</mi><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.2.4" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.1.cmml">)</mo></mrow><mo lspace="0.167em" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.cmml"><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.cmml"><mo rspace="0.167em" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.1.cmml">∇</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5a" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.cmml">⁡</mo><msub id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.2.cmml">π</mi><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2b" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.2" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.1" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E3.m1.10.10.1.1.1.1.1.1.3" xref="S3.E3.m1.10.10.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.10.10.1.2" xref="S3.E3.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.10b"><apply id="S3.E3.m1.10.10.1.1.cmml" xref="S3.E3.m1.10.10.1"><eq id="S3.E3.m1.10.10.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.2"></eq><apply id="S3.E3.m1.10.10.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.3"><times id="S3.E3.m1.10.10.1.1.3.1.cmml" xref="S3.E3.m1.10.10.1.1.3.1"></times><apply id="S3.E3.m1.10.10.1.1.3.2.cmml" xref="S3.E3.m1.10.10.1.1.3.2"><ci id="S3.E3.m1.10.10.1.1.3.2.1.cmml" xref="S3.E3.m1.10.10.1.1.3.2.1">∇</ci><ci id="S3.E3.m1.10.10.1.1.3.2.2.cmml" xref="S3.E3.m1.10.10.1.1.3.2.2">𝐽</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝜃</ci></apply><apply id="S3.E3.m1.10.10.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1"><minus id="S3.E3.m1.10.10.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1"></minus><apply id="S3.E3.m1.10.10.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1"><times id="S3.E3.m1.10.10.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.2"></times><apply id="S3.E3.m1.10.10.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.3.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.3.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3.2">𝔼</ci><apply id="S3.E3.m1.10.10.1.1.1.1.3.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3.3"><csymbol cd="latexml" id="S3.E3.m1.10.10.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3.3.1">similar-to</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3.3.2">𝒙</ci><ci id="S3.E3.m1.10.10.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.3.3.3">𝒟</ci></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.10.10.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1"><plus id="S3.E3.m1.10.10.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.4"></plus><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.3">𝜆</ci><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.4.2">𝔼</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2">similar-to</csymbol><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝒚</ci><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.2">𝜋</ci><apply id="S3.E3.m1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.3.2">𝜃</ci><ci id="S3.E3.m1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3.3">′</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2">𝒚</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.3">𝐹</ci><vector id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝒙</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝒚</ci><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝜏</ci></vector><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5"><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1"><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.1">∇</ci><log id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.1.2"></log></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.2">𝜋</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.5.2.3">𝜃</ci></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒚</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3"><times id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.3"></times><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1"><minus id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.2">1</cn><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.2.1.1.1.3">𝜆</ci></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.4.2">𝔼</ci><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.2">similar-to</csymbol><ci id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3">𝒚</ci><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1"><times id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"></times><ci id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3">𝑝</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2">𝒚</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1"><csymbol cd="latexml" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1"><times id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.2"></times><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.3">𝐹</ci><vector id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.4.2"><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">𝒙</ci><ci id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8">𝒚</ci><ci id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9">𝜏</ci></vector><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5"><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1"><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.1">∇</ci><log id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.1.2"></log></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2">subscript</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.2">𝜋</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.5.2.3">𝜃</ci></apply></apply><apply id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.2">𝒚</ci><ci id="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.10.10.1.1.1.1.1.1.1.3.2.1.1.1.1.1.3">𝒙</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.10c">\displaystyle\nabla J(\theta)=-\mathbb{E}_{{\bm{x}}\sim{\cal D}}\left[\lambda\mathbb{E}_{{\bm{y}}\sim\pi_{\theta^{\prime}}({\bm{y}}|{\bm{x}})}\left[F({\bm{x}},{\bm{y}};\tau)\nabla\log\pi_{\theta}({\bm{y}}\mid{\bm{x}})\right]+(1-\lambda)\mathbb{E}_{{\bm{y}}\sim p({\bm{y}}|{\bm{x}})}\left[F({\bm{x}},{\bm{y}};\tau)\nabla\log\pi_{\theta}({\bm{y}}\mid{\bm{x}})\right]\right].</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.10d">∇ italic_J ( italic_θ ) = - blackboard_E start_POSTSUBSCRIPT bold_italic_x ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_λ blackboard_E start_POSTSUBSCRIPT bold_italic_y ∼ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x ) end_POSTSUBSCRIPT [ italic_F ( bold_italic_x , bold_italic_y ; italic_τ ) ∇ roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x ) ] + ( 1 - italic_λ ) blackboard_E start_POSTSUBSCRIPT bold_italic_y ∼ italic_p ( bold_italic_y | bold_italic_x ) end_POSTSUBSCRIPT [ italic_F ( bold_italic_x , bold_italic_y ; italic_τ ) ∇ roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x ) ] ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSSx2.Px1.p1.18" class="ltx_p">The first term on the RHS of (<a href="#S3.E3" title="3 ‣ Probabilistic interpretation of the Improve step ‣ Improve ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) is similar to an online policy gradient term at the beginning of training when <math id="S3.SS0.SSSx2.Px1.p1.5.m1.1" class="ltx_Math" alttext="\theta\approx\theta^{\prime}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.5.m1.1a"><mrow id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.2.cmml">θ</mi><mo id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.1.cmml">≈</mo><msup id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.2" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.2.cmml">θ</mi><mo id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.3" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.5.m1.1b"><apply id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1"><approx id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.1"></approx><ci id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.2">𝜃</ci><apply id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3">superscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.2">𝜃</ci><ci id="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.5.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.5.m1.1c">\theta\approx\theta^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.5.m1.1d">italic_θ ≈ italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> with <math id="S3.SS0.SSSx2.Px1.p1.6.m2.3" class="ltx_Math" alttext="F({\bm{x}},{\bm{y}};\tau)" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.6.m2.3a"><mrow id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.2" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.2.cmml">F</mi><mo id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.1" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.1.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.2" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.2.1" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.1.cmml">(</mo><mi id="S3.SS0.SSSx2.Px1.p1.6.m2.1.1" xref="S3.SS0.SSSx2.Px1.p1.6.m2.1.1.cmml">𝒙</mi><mo id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.2.2" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS0.SSSx2.Px1.p1.6.m2.2.2" xref="S3.SS0.SSSx2.Px1.p1.6.m2.2.2.cmml">𝒚</mi><mo id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.2.3" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.1.cmml">;</mo><mi id="S3.SS0.SSSx2.Px1.p1.6.m2.3.3" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.3.cmml">τ</mi><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.2.4" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.6.m2.3b"><apply id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4"><times id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.1"></times><ci id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.2">𝐹</ci><vector id="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.4.3.2"><ci id="S3.SS0.SSSx2.Px1.p1.6.m2.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.1.1">𝒙</ci><ci id="S3.SS0.SSSx2.Px1.p1.6.m2.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.2.2">𝒚</ci><ci id="S3.SS0.SSSx2.Px1.p1.6.m2.3.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.6.m2.3.3">𝜏</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.6.m2.3c">F({\bm{x}},{\bm{y}};\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.6.m2.3d">italic_F ( bold_italic_x , bold_italic_y ; italic_τ )</annotation></semantics></math> replacing the state-action value function <math id="S3.SS0.SSSx2.Px1.p1.7.m3.2" class="ltx_Math" alttext="Q^{\pi}({\bm{x}},{\bm{y}})" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.7.m3.2a"><mrow id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.cmml"><msup id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.2" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.2.cmml">Q</mi><mi id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.3" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.3.cmml">π</mi></msup><mo id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.1" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.1.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.2" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.2.1" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.1.cmml">(</mo><mi id="S3.SS0.SSSx2.Px1.p1.7.m3.1.1" xref="S3.SS0.SSSx2.Px1.p1.7.m3.1.1.cmml">𝒙</mi><mo id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.2.2" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.1.cmml">,</mo><mi id="S3.SS0.SSSx2.Px1.p1.7.m3.2.2" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.2.cmml">𝒚</mi><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.2.3" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.7.m3.2b"><apply id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3"><times id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.1"></times><apply id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2">superscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.2">𝑄</ci><ci id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.2.3">𝜋</ci></apply><interval closure="open" id="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.3.3.2"><ci id="S3.SS0.SSSx2.Px1.p1.7.m3.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.1.1">𝒙</ci><ci id="S3.SS0.SSSx2.Px1.p1.7.m3.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.7.m3.2.2">𝒚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.7.m3.2c">Q^{\pi}({\bm{x}},{\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.7.m3.2d">italic_Q start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( bold_italic_x , bold_italic_y )</annotation></semantics></math>, when starting in state <math id="S3.SS0.SSSx2.Px1.p1.8.m4.1" class="ltx_Math" alttext="{\bm{x}}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.8.m4.1a"><mi id="S3.SS0.SSSx2.Px1.p1.8.m4.1.1" xref="S3.SS0.SSSx2.Px1.p1.8.m4.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.8.m4.1b"><ci id="S3.SS0.SSSx2.Px1.p1.8.m4.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.8.m4.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.8.m4.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.8.m4.1d">bold_italic_x</annotation></semantics></math> and taking sequential actions <math id="S3.SS0.SSSx2.Px1.p1.9.m5.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.9.m5.1a"><mi id="S3.SS0.SSSx2.Px1.p1.9.m5.1.1" xref="S3.SS0.SSSx2.Px1.p1.9.m5.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.9.m5.1b"><ci id="S3.SS0.SSSx2.Px1.p1.9.m5.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.9.m5.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.9.m5.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.9.m5.1d">bold_italic_y</annotation></semantics></math>, that is generating synthetic data <math id="S3.SS0.SSSx2.Px1.p1.10.m6.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.10.m6.1a"><mi id="S3.SS0.SSSx2.Px1.p1.10.m6.1.1" xref="S3.SS0.SSSx2.Px1.p1.10.m6.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.10.m6.1b"><ci id="S3.SS0.SSSx2.Px1.p1.10.m6.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.10.m6.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.10.m6.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.10.m6.1d">bold_italic_y</annotation></semantics></math> using policy <math id="S3.SS0.SSSx2.Px1.p1.11.m7.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.11.m7.1a"><msub id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.2.cmml">π</mi><mi id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.11.m7.1b"><apply id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.2">𝜋</ci><ci id="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.11.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.11.m7.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.11.m7.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> in our context. For the second term on the RHS of (<a href="#S3.E3" title="3 ‣ Probabilistic interpretation of the Improve step ‣ Improve ‣ 3 Reinforced Self-Training (\rest) ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), we consider the original data <math id="S3.SS0.SSSx2.Px1.p1.12.m8.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.12.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.Px1.p1.12.m8.1.1" xref="S3.SS0.SSSx2.Px1.p1.12.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.12.m8.1b"><ci id="S3.SS0.SSSx2.Px1.p1.12.m8.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.12.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.12.m8.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.12.m8.1d">caligraphic_D</annotation></semantics></math>, but we still ensure that it passes the threshold <math id="S3.SS0.SSSx2.Px1.p1.13.m9.3" class="ltx_Math" alttext="F({\bm{x}},{\bm{y}};\tau)" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.13.m9.3a"><mrow id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.2" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.2.cmml">F</mi><mo id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.1" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.1.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.2" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.2.1" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.1.cmml">(</mo><mi id="S3.SS0.SSSx2.Px1.p1.13.m9.1.1" xref="S3.SS0.SSSx2.Px1.p1.13.m9.1.1.cmml">𝒙</mi><mo id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.2.2" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS0.SSSx2.Px1.p1.13.m9.2.2" xref="S3.SS0.SSSx2.Px1.p1.13.m9.2.2.cmml">𝒚</mi><mo id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.2.3" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.1.cmml">;</mo><mi id="S3.SS0.SSSx2.Px1.p1.13.m9.3.3" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.3.cmml">τ</mi><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.2.4" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.13.m9.3b"><apply id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4"><times id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.1"></times><ci id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.2">𝐹</ci><vector id="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.4.3.2"><ci id="S3.SS0.SSSx2.Px1.p1.13.m9.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.1.1">𝒙</ci><ci id="S3.SS0.SSSx2.Px1.p1.13.m9.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.2.2">𝒚</ci><ci id="S3.SS0.SSSx2.Px1.p1.13.m9.3.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.13.m9.3.3">𝜏</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.13.m9.3c">F({\bm{x}},{\bm{y}};\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.13.m9.3d">italic_F ( bold_italic_x , bold_italic_y ; italic_τ )</annotation></semantics></math>. Intuitively, people choose <math id="S3.SS0.SSSx2.Px1.p1.14.m10.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.14.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSSx2.Px1.p1.14.m10.1.1" xref="S3.SS0.SSSx2.Px1.p1.14.m10.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.14.m10.1b"><ci id="S3.SS0.SSSx2.Px1.p1.14.m10.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.14.m10.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.14.m10.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.14.m10.1d">caligraphic_D</annotation></semantics></math> for training according to some possibly unknown criteria. In this work, we make the criterion <math id="S3.SS0.SSSx2.Px1.p1.15.m11.3" class="ltx_Math" alttext="F({\bm{x}},{\bm{y}};\tau)" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.15.m11.3a"><mrow id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.2" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.2.cmml">F</mi><mo id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.1" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.1.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.2" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.2.1" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.1.cmml">(</mo><mi id="S3.SS0.SSSx2.Px1.p1.15.m11.1.1" xref="S3.SS0.SSSx2.Px1.p1.15.m11.1.1.cmml">𝒙</mi><mo id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.2.2" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.1.cmml">,</mo><mi id="S3.SS0.SSSx2.Px1.p1.15.m11.2.2" xref="S3.SS0.SSSx2.Px1.p1.15.m11.2.2.cmml">𝒚</mi><mo id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.2.3" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.1.cmml">;</mo><mi id="S3.SS0.SSSx2.Px1.p1.15.m11.3.3" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.3.cmml">τ</mi><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.2.4" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.15.m11.3b"><apply id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4"><times id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.1"></times><ci id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.2">𝐹</ci><vector id="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.4.3.2"><ci id="S3.SS0.SSSx2.Px1.p1.15.m11.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.1.1">𝒙</ci><ci id="S3.SS0.SSSx2.Px1.p1.15.m11.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.2.2">𝒚</ci><ci id="S3.SS0.SSSx2.Px1.p1.15.m11.3.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.15.m11.3.3">𝜏</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.15.m11.3c">F({\bm{x}},{\bm{y}};\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.15.m11.3d">italic_F ( bold_italic_x , bold_italic_y ; italic_τ )</annotation></semantics></math> explicit. The last term is therefore a form of offline policy gradients which prevents <math id="S3.SS0.SSSx2.Px1.p1.16.m12.1" class="ltx_Math" alttext="\pi_{\theta}({\bm{y}}\mid{\bm{x}})" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.16.m12.1a"><mrow id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.cmml"><msub id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.2" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.2.cmml">π</mi><mi id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.3" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.2.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.16.m12.1b"><apply id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1"><times id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.2"></times><apply id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3">subscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.2">𝜋</ci><ci id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.3.3">𝜃</ci></apply><apply id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1"><csymbol cd="latexml" id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.2">𝒚</ci><ci id="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.16.m12.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.16.m12.1c">\pi_{\theta}({\bm{y}}\mid{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.16.m12.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y ∣ bold_italic_x )</annotation></semantics></math> to move too far from <math id="S3.SS0.SSSx2.Px1.p1.17.m13.1" class="ltx_Math" alttext="p({\bm{y}}\mid{\bm{x}})" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.17.m13.1a"><mrow id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.3.cmml">p</mi><mo id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.2.cmml">⁢</mo><mrow id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.2.cmml">𝒚</mi><mo id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.17.m13.1b"><apply id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1"><times id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.2"></times><ci id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.3">𝑝</ci><apply id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1"><csymbol cd="latexml" id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.2">𝒚</ci><ci id="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.17.m13.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.17.m13.1c">p({\bm{y}}\mid{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.17.m13.1d">italic_p ( bold_italic_y ∣ bold_italic_x )</annotation></semantics></math> which could lead to <em id="S3.SS0.SSSx2.Px1.p1.18.1" class="ltx_emph ltx_font_italic">model collapse</em> <cite class="ltx_cite ltx_citemacro_citep">(Shumailov et al., <a href="#bib.bib50" title="" class="ltx_ref">2023</a>)</cite>. Finally, note the similarity of this approach with self-training <cite class="ltx_cite ltx_citemacro_citep">(Clark et al., <a href="#bib.bib12" title="" class="ltx_ref">2003</a>; Scudder, <a href="#bib.bib48" title="" class="ltx_ref">1965</a>; Xie et al., <a href="#bib.bib60" title="" class="ltx_ref">2020</a>)</cite> techniques. We provide a population interpretation (i.e., as <math id="S3.SS0.SSSx2.Px1.p1.18.m14.2" class="ltx_Math" alttext="N,N_{g}\rightarrow\infty" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p1.18.m14.2a"><mrow id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.cmml"><mrow id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.2.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.18.m14.1.1" xref="S3.SS0.SSSx2.Px1.p1.18.m14.1.1.cmml">N</mi><mo id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.2.cmml">,</mo><msub id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.2" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.2.cmml">N</mi><mi id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.3" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.3.cmml">g</mi></msub></mrow><mo stretchy="false" id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.2" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.2.cmml">→</mo><mi mathvariant="normal" id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.3" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p1.18.m14.2b"><apply id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2"><ci id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.2">→</ci><list id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1"><ci id="S3.SS0.SSSx2.Px1.p1.18.m14.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.1.1">𝑁</ci><apply id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.2">𝑁</ci><ci id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.1.1.1.3">𝑔</ci></apply></list><infinity id="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.3.cmml" xref="S3.SS0.SSSx2.Px1.p1.18.m14.2.2.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p1.18.m14.2c">N,N_{g}\rightarrow\infty</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p1.18.m14.2d">italic_N , italic_N start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT → ∞</annotation></semantics></math>) of <span id="S3.SS0.SSSx2.Px1.p1.18.2" class="ltx_ERROR undefined">\rest</span> in Appendix <a href="#A1.SS9" title="A.9 \rest: Population interpretation ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.9</span></a>.</p>
</div>
<div id="S3.SS0.SSSx2.Px1.p2" class="ltx_para">
<p id="S3.SS0.SSSx2.Px1.p2.1" class="ltx_p">In the following section, we explore how the choice of loss, filtering function and threshold, and synthetic data generated by language policy via sampling (exploration data) empirically affect the performance of the resulting policies <math id="S3.SS0.SSSx2.Px1.p2.1.m1.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS0.SSSx2.Px1.p2.1.m1.1a"><msub id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.2" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.2.cmml">π</mi><mi id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.3" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSSx2.Px1.p2.1.m1.1b"><apply id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.2">𝜋</ci><ci id="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS0.SSSx2.Px1.p2.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSSx2.Px1.p2.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSSx2.Px1.p2.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>.
</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and analysis</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We chose machine translation as a testbed for <span id="S4.p1.1.1" class="ltx_ERROR undefined">\rest</span> as it is an impactful application of conditional language modeling where established reward models are available, for example, Metric X <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>, BLEURT <cite class="ltx_cite ltx_citemacro_citep">(Sellam et al., <a href="#bib.bib49" title="" class="ltx_ref">2020</a>)</cite> and COMET <cite class="ltx_cite ltx_citemacro_citep">(Rei et al., <a href="#bib.bib46" title="" class="ltx_ref">2020</a>)</cite>. We ran experiments on two common benchmarks: IWSLT 2014 <cite class="ltx_cite ltx_citemacro_citep">(Cettolo et al., <a href="#bib.bib10" title="" class="ltx_ref">2014</a>)</cite>, and WMT 2020 <cite class="ltx_cite ltx_citemacro_citep">(Koehn et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>, as well as an internal benchmark dataset which we call <span id="S4.p1.1.2" class="ltx_text ltx_font_italic">Web Domain</span> (a version of this dataset was previously used by <cite class="ltx_cite ltx_citemacro_cite">Ghorbani et al. (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>). These datasets contain a set of sentences in the source language and the corresponding human “reference” translation. We selected a different language pair for each dataset to test the generality of the results. We kept a separate validation and test sets with unseen source sentences for the evaluation purposes.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">We used Metric X in our experiments, a state-of-art reference-free reward model <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> which, for a given source text and a proposed translation, outputs a numerical score. We report results in terms of average rewards on samples generated by a policy on the validation set <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Performance on the test set follows the same trends (see Appendix <a href="#A1.SS4" title="A.4 Reward model ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.4</span></a>). We also experimented with BLEURT and BLEU scores, and <span id="footnote1.1" class="ltx_ERROR undefined">\rest</span> improved those scores as well. We noticed that online PPO algorithm can learn to exploit the weaknesses and biases of these two metrics quickly, which can cause the model to generate samples that maximize the rewards but deteriorate the quality of the model’s output.</span></span></span>. For the details of the datasets and models, we refer to Appendix <a href="#A1.SS3" title="A.3 Data and Model details ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a>. Also, Table <a href="#A1.T2" title="Table 2 ‣ Web Domain En-Zh ‣ A.3 Data and Model details ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> indicates the size of the datasets by reporting the number of samples per source sentence generated at each <span id="S4.p2.1.1" class="ltx_text ltx_font_typewriter">Grow</span> step.</p>
</div>
<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Nomenclature</h5>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px1.p1.3" class="ltx_p">We named variants of <span id="S4.SS0.SSS0.Px1.p1.3.1" class="ltx_ERROR undefined">\rest</span> by the loss type, number of <span id="S4.SS0.SSS0.Px1.p1.3.2" class="ltx_text ltx_font_typewriter">Grow</span> steps, and number of <span id="S4.SS0.SSS0.Px1.p1.3.3" class="ltx_text ltx_font_typewriter">Improve</span> steps, for example <span id="S4.SS0.SSS0.Px1.p1.3.4" class="ltx_text ltx_markedasmath ltx_font_typewriter">GOLD G=1 I=2</span>. With this convention, <span id="S4.SS0.SSS0.Px1.p1.3.5" class="ltx_text ltx_markedasmath ltx_font_typewriter">BC G=0 I=0</span> refers to standard supervised learning, which is trained only on the original dataset <math id="S4.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S4.SS0.SSS0.Px1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S4.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.3.m3.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.3.m3.1d">caligraphic_D</annotation></semantics></math> and performs neither <span id="S4.SS0.SSS0.Px1.p1.3.6" class="ltx_text ltx_font_typewriter">Grow</span> nor <span id="S4.SS0.SSS0.Px1.p1.3.7" class="ltx_text ltx_font_typewriter">Improve</span> steps. When the loss type is not specified, the <span id="S4.SS0.SSS0.Px1.p1.3.8" class="ltx_text ltx_font_typewriter">BC</span> loss is used, i.e., the model is trained with auto-regressive supervised learning with the NLL loss as typical in training language models. In all plots, we colored supervised learning in grey and <span id="S4.SS0.SSS0.Px1.p1.3.9" class="ltx_ERROR undefined">\rest</span> variants in shades of purple.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines</h5>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px2.p1.1" class="ltx_p">We reported the results with several different offline RL method, including Offline Actor Critic (<span id="S4.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">OAC</span>) <cite class="ltx_cite ltx_citemacro_citep">(Mathieu et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>, Behavior VMPO (<span id="S4.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_typewriter">BVMPO</span>), Generation by Off-policy Learning from Demonstrations (<span id="S4.SS0.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_typewriter">GOLD</span>) <cite class="ltx_cite ltx_citemacro_citep">(Pang and He, <a href="#bib.bib41" title="" class="ltx_ref">2021</a>)</cite>, and <span id="S4.SS0.SSS0.Px2.p1.1.4" class="ltx_text ltx_font_typewriter">BC</span> <cite class="ltx_cite ltx_citemacro_citep">(Pomerleau, <a href="#bib.bib43" title="" class="ltx_ref">1989</a>)</cite> <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Details on our baselines are in Appendix <a href="#A1.SS8" title="A.8 Baseline Algorithms ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.8</span></a> and the experiments with additional losses are in Appendix <a href="#A1.SS2" title="A.2 Negative results with offline RL ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a></span></span></span>.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_3"><img src="assets/plots/iwslt_multiple_improve_steps.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_flex_size_3 ltx_img_landscape" width="193" height="122" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_3"><img src="assets/plots/wmt_multiple_improve_steps.png" id="S4.F3.g2" class="ltx_graphics ltx_centering ltx_flex_size_3 ltx_img_landscape" width="161" height="122" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_3"><img src="assets/plots/webdomain_multiple_improve_steps.png" id="S4.F3.g3" class="ltx_graphics ltx_centering ltx_flex_size_3 ltx_img_portrait" width="92" height="117" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.10.1" class="ltx_text ltx_font_bold">ReST with multiple <span id="S4.F3.10.1.1" class="ltx_text ltx_font_typewriter">Improve</span> steps.</span> Average reward model scores on IWSLT 2014 De-En, WMT 2020 Zh-En, and Web Domain En-Zh validation sets. On each dataset, we report results with <span id="S4.F3.11.2" class="ltx_text ltx_font_typewriter">BC</span> (<math id="S4.F3.2.m1.2" class="ltx_Math" alttext="G=0,\leavevmode\nobreak\ I=0" display="inline"><semantics id="S4.F3.2.m1.2b"><mrow id="S4.F3.2.m1.2.2.2" xref="S4.F3.2.m1.2.2.3.cmml"><mrow id="S4.F3.2.m1.1.1.1.1" xref="S4.F3.2.m1.1.1.1.1.cmml"><mi id="S4.F3.2.m1.1.1.1.1.2" xref="S4.F3.2.m1.1.1.1.1.2.cmml">G</mi><mo id="S4.F3.2.m1.1.1.1.1.1" xref="S4.F3.2.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.F3.2.m1.1.1.1.1.3" xref="S4.F3.2.m1.1.1.1.1.3.cmml">0</mn></mrow><mo rspace="0.667em" id="S4.F3.2.m1.2.2.2.3" xref="S4.F3.2.m1.2.2.3a.cmml">,</mo><mrow id="S4.F3.2.m1.2.2.2.2" xref="S4.F3.2.m1.2.2.2.2.cmml"><mi id="S4.F3.2.m1.2.2.2.2.2" xref="S4.F3.2.m1.2.2.2.2.2.cmml">I</mi><mo id="S4.F3.2.m1.2.2.2.2.1" xref="S4.F3.2.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.F3.2.m1.2.2.2.2.3" xref="S4.F3.2.m1.2.2.2.2.3.cmml">0</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.2.m1.2c"><apply id="S4.F3.2.m1.2.2.3.cmml" xref="S4.F3.2.m1.2.2.2"><csymbol cd="ambiguous" id="S4.F3.2.m1.2.2.3a.cmml" xref="S4.F3.2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.F3.2.m1.1.1.1.1.cmml" xref="S4.F3.2.m1.1.1.1.1"><eq id="S4.F3.2.m1.1.1.1.1.1.cmml" xref="S4.F3.2.m1.1.1.1.1.1"></eq><ci id="S4.F3.2.m1.1.1.1.1.2.cmml" xref="S4.F3.2.m1.1.1.1.1.2">𝐺</ci><cn type="integer" id="S4.F3.2.m1.1.1.1.1.3.cmml" xref="S4.F3.2.m1.1.1.1.1.3">0</cn></apply><apply id="S4.F3.2.m1.2.2.2.2.cmml" xref="S4.F3.2.m1.2.2.2.2"><eq id="S4.F3.2.m1.2.2.2.2.1.cmml" xref="S4.F3.2.m1.2.2.2.2.1"></eq><ci id="S4.F3.2.m1.2.2.2.2.2.cmml" xref="S4.F3.2.m1.2.2.2.2.2">𝐼</ci><cn type="integer" id="S4.F3.2.m1.2.2.2.2.3.cmml" xref="S4.F3.2.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.m1.2d">G=0,\leavevmode\nobreak\ I=0</annotation><annotation encoding="application/x-llamapun" id="S4.F3.2.m1.2e">italic_G = 0 , italic_I = 0</annotation></semantics></math>) and ReST with a single <span id="S4.F3.12.3" class="ltx_text ltx_font_typewriter">Grow</span> step and several <span id="S4.F3.13.4" class="ltx_text ltx_font_typewriter">Improve</span> steps with an increasing reward threshold. Each <span id="S4.F3.14.5" class="ltx_text ltx_font_typewriter">Improve</span> step increases the reward model score in all three validation datasets. We found the suitable number of <span id="S4.F3.15.6" class="ltx_text ltx_font_typewriter">Improve</span> steps to be a dataset-dependent hyperparameter.
</figcaption>
</figure>
</section>
<section id="S4.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Do multiple <span id="S4.SS0.SSS0.Px3.1.1" class="ltx_text ltx_font_typewriter">Improve</span> steps in <span id="S4.SS0.SSS0.Px3.2.2" class="ltx_ERROR undefined">\rest</span> increase the reward model scores?</h5>

<div id="S4.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px3.p1.5" class="ltx_p">We evaluated <span id="S4.SS0.SSS0.Px3.p1.5.1" class="ltx_ERROR undefined">\rest</span> on three different datasets by fixing the loss function to <span id="S4.SS0.SSS0.Px3.p1.5.2" class="ltx_text ltx_font_typewriter">BC</span> and increasing the number of <span id="S4.SS0.SSS0.Px3.p1.5.3" class="ltx_text ltx_font_typewriter">Improve</span> steps.
The range of rewards for training was normalized between <math id="S4.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS0.SSS0.Px3.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.1.m1.1b"><cn type="integer" id="S4.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.1.m1.1.1">0</cn></annotation-xml></semantics></math> and <math id="S4.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS0.SSS0.Px3.p1.2.m2.1a"><mn id="S4.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.2.m2.1b"><cn type="integer" id="S4.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.2.m2.1d">1</annotation></semantics></math> <span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Note that the plots show rewards between <math id="footnote3.m1.1" class="ltx_Math" alttext="0" display="inline"><semantics id="footnote3.m1.1b"><mn id="footnote3.m1.1.1" xref="footnote3.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="footnote3.m1.1c"><cn type="integer" id="footnote3.m1.1.1.cmml" xref="footnote3.m1.1.1">0</cn></annotation-xml></semantics></math> and <math id="footnote3.m2.1" class="ltx_Math" alttext="100" display="inline"><semantics id="footnote3.m2.1b"><mn id="footnote3.m2.1.1" xref="footnote3.m2.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="footnote3.m2.1c"><cn type="integer" id="footnote3.m2.1.1.cmml" xref="footnote3.m2.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote3.m2.1d">100</annotation><annotation encoding="application/x-llamapun" id="footnote3.m2.1e">100</annotation></semantics></math>.</span></span></span>. For our experiments, we picked the filtering thresholds <math id="S4.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\tau_{i}" display="inline"><semantics id="S4.SS0.SSS0.Px3.p1.3.m3.1a"><msub id="S4.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml">τ</mi><mi id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1.2">𝜏</ci><ci id="S4.SS0.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS0.SSS0.Px3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.3.m3.1c">\tau_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.3.m3.1d">italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from a sequence of increasing values <math id="S4.SS0.SSS0.Px3.p1.4.m4.6" class="ltx_Math" alttext="\left[0.0,0.7,0.8,0.9,0.95,0.99\right]" display="inline"><semantics id="S4.SS0.SSS0.Px3.p1.4.m4.6a"><mrow id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml"><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.1" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">[</mo><mn id="S4.SS0.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS0.SSS0.Px3.p1.4.m4.1.1.cmml">0.0</mn><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.2" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px3.p1.4.m4.2.2" xref="S4.SS0.SSS0.Px3.p1.4.m4.2.2.cmml">0.7</mn><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.3" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px3.p1.4.m4.3.3" xref="S4.SS0.SSS0.Px3.p1.4.m4.3.3.cmml">0.8</mn><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.4" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px3.p1.4.m4.4.4" xref="S4.SS0.SSS0.Px3.p1.4.m4.4.4.cmml">0.9</mn><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.5" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px3.p1.4.m4.5.5" xref="S4.SS0.SSS0.Px3.p1.4.m4.5.5.cmml">0.95</mn><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.6" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">,</mo><mn id="S4.SS0.SSS0.Px3.p1.4.m4.6.6" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.6.cmml">0.99</mn><mo id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2.7" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.4.m4.6b"><list id="S4.SS0.SSS0.Px3.p1.4.m4.6.7.1.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.7.2"><cn type="float" id="S4.SS0.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.1.1">0.0</cn><cn type="float" id="S4.SS0.SSS0.Px3.p1.4.m4.2.2.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.2.2">0.7</cn><cn type="float" id="S4.SS0.SSS0.Px3.p1.4.m4.3.3.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.3.3">0.8</cn><cn type="float" id="S4.SS0.SSS0.Px3.p1.4.m4.4.4.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.4.4">0.9</cn><cn type="float" id="S4.SS0.SSS0.Px3.p1.4.m4.5.5.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.5.5">0.95</cn><cn type="float" id="S4.SS0.SSS0.Px3.p1.4.m4.6.6.cmml" xref="S4.SS0.SSS0.Px3.p1.4.m4.6.6">0.99</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.4.m4.6c">\left[0.0,0.7,0.8,0.9,0.95,0.99\right]</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.4.m4.6d">[ 0.0 , 0.7 , 0.8 , 0.9 , 0.95 , 0.99 ]</annotation></semantics></math> <span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>If we used less than 6 steps, we skipped the initial smaller thresholds. Details are given in Appendix <a href="#A1.SS3" title="A.3 Data and Model details ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a>. We ensured that in all our datasets <math id="footnote4.m1.1" class="ltx_Math" alttext="\tau_{1}&gt;0.7\geq V_{\pi_{\theta}}" display="inline"><semantics id="footnote4.m1.1b"><mrow id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml"><msub id="footnote4.m1.1.1.2" xref="footnote4.m1.1.1.2.cmml"><mi id="footnote4.m1.1.1.2.2" xref="footnote4.m1.1.1.2.2.cmml">τ</mi><mn id="footnote4.m1.1.1.2.3" xref="footnote4.m1.1.1.2.3.cmml">1</mn></msub><mo id="footnote4.m1.1.1.3" xref="footnote4.m1.1.1.3.cmml">&gt;</mo><mn id="footnote4.m1.1.1.4" xref="footnote4.m1.1.1.4.cmml">0.7</mn><mo id="footnote4.m1.1.1.5" xref="footnote4.m1.1.1.5.cmml">≥</mo><msub id="footnote4.m1.1.1.6" xref="footnote4.m1.1.1.6.cmml"><mi id="footnote4.m1.1.1.6.2" xref="footnote4.m1.1.1.6.2.cmml">V</mi><msub id="footnote4.m1.1.1.6.3" xref="footnote4.m1.1.1.6.3.cmml"><mi id="footnote4.m1.1.1.6.3.2" xref="footnote4.m1.1.1.6.3.2.cmml">π</mi><mi id="footnote4.m1.1.1.6.3.3" xref="footnote4.m1.1.1.6.3.3.cmml">θ</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="footnote4.m1.1c"><apply id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1"><and id="footnote4.m1.1.1a.cmml" xref="footnote4.m1.1.1"></and><apply id="footnote4.m1.1.1b.cmml" xref="footnote4.m1.1.1"><gt id="footnote4.m1.1.1.3.cmml" xref="footnote4.m1.1.1.3"></gt><apply id="footnote4.m1.1.1.2.cmml" xref="footnote4.m1.1.1.2"><csymbol cd="ambiguous" id="footnote4.m1.1.1.2.1.cmml" xref="footnote4.m1.1.1.2">subscript</csymbol><ci id="footnote4.m1.1.1.2.2.cmml" xref="footnote4.m1.1.1.2.2">𝜏</ci><cn type="integer" id="footnote4.m1.1.1.2.3.cmml" xref="footnote4.m1.1.1.2.3">1</cn></apply><cn type="float" id="footnote4.m1.1.1.4.cmml" xref="footnote4.m1.1.1.4">0.7</cn></apply><apply id="footnote4.m1.1.1c.cmml" xref="footnote4.m1.1.1"><geq id="footnote4.m1.1.1.5.cmml" xref="footnote4.m1.1.1.5"></geq><share href="#footnote4.m1.1.1.4.cmml" id="footnote4.m1.1.1d.cmml" xref="footnote4.m1.1.1"></share><apply id="footnote4.m1.1.1.6.cmml" xref="footnote4.m1.1.1.6"><csymbol cd="ambiguous" id="footnote4.m1.1.1.6.1.cmml" xref="footnote4.m1.1.1.6">subscript</csymbol><ci id="footnote4.m1.1.1.6.2.cmml" xref="footnote4.m1.1.1.6.2">𝑉</ci><apply id="footnote4.m1.1.1.6.3.cmml" xref="footnote4.m1.1.1.6.3"><csymbol cd="ambiguous" id="footnote4.m1.1.1.6.3.1.cmml" xref="footnote4.m1.1.1.6.3">subscript</csymbol><ci id="footnote4.m1.1.1.6.3.2.cmml" xref="footnote4.m1.1.1.6.3.2">𝜋</ci><ci id="footnote4.m1.1.1.6.3.3.cmml" xref="footnote4.m1.1.1.6.3.3">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m1.1d">\tau_{1}&gt;0.7\geq V_{\pi_{\theta}}</annotation><annotation encoding="application/x-llamapun" id="footnote4.m1.1e">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &gt; 0.7 ≥ italic_V start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> by empirically measuring <math id="footnote4.m2.1" class="ltx_Math" alttext="V_{\pi_{\theta}}" display="inline"><semantics id="footnote4.m2.1b"><msub id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml"><mi id="footnote4.m2.1.1.2" xref="footnote4.m2.1.1.2.cmml">V</mi><msub id="footnote4.m2.1.1.3" xref="footnote4.m2.1.1.3.cmml"><mi id="footnote4.m2.1.1.3.2" xref="footnote4.m2.1.1.3.2.cmml">π</mi><mi id="footnote4.m2.1.1.3.3" xref="footnote4.m2.1.1.3.3.cmml">θ</mi></msub></msub><annotation-xml encoding="MathML-Content" id="footnote4.m2.1c"><apply id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1"><csymbol cd="ambiguous" id="footnote4.m2.1.1.1.cmml" xref="footnote4.m2.1.1">subscript</csymbol><ci id="footnote4.m2.1.1.2.cmml" xref="footnote4.m2.1.1.2">𝑉</ci><apply id="footnote4.m2.1.1.3.cmml" xref="footnote4.m2.1.1.3"><csymbol cd="ambiguous" id="footnote4.m2.1.1.3.1.cmml" xref="footnote4.m2.1.1.3">subscript</csymbol><ci id="footnote4.m2.1.1.3.2.cmml" xref="footnote4.m2.1.1.3.2">𝜋</ci><ci id="footnote4.m2.1.1.3.3.cmml" xref="footnote4.m2.1.1.3.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote4.m2.1d">V_{\pi_{\theta}}</annotation><annotation encoding="application/x-llamapun" id="footnote4.m2.1e">italic_V start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> over the dataset.</span></span></span>.
The <math id="S4.SS0.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="\tau_{0}=0.0" display="inline"><semantics id="S4.SS0.SSS0.Px3.p1.5.m5.1a"><mrow id="S4.SS0.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.cmml"><msub id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml"><mi id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.2" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.2.cmml">τ</mi><mn id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.3" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.1" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.3" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px3.p1.5.m5.1b"><apply id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1"><eq id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.1"></eq><apply id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.1.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.2.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.2">𝜏</ci><cn type="integer" id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.3.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.2.3">0</cn></apply><cn type="float" id="S4.SS0.SSS0.Px3.p1.5.m5.1.1.3.cmml" xref="S4.SS0.SSS0.Px3.p1.5.m5.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px3.p1.5.m5.1c">\tau_{0}=0.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px3.p1.5.m5.1d">italic_τ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 0.0</annotation></semantics></math> case corresponds to using the full dataset. We did five <span id="S4.SS0.SSS0.Px3.p1.5.4" class="ltx_text ltx_font_typewriter">Improve</span> steps on IWSLT 2014, four on WMT-2020, and two on Web Domain. In Figure <a href="#S4.F3" title="Figure 3 ‣ Baselines ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we plotted the average reward of different variants of <span id="S4.SS0.SSS0.Px3.p1.5.5" class="ltx_ERROR undefined">\rest</span>. We see that each subsequent <span id="S4.SS0.SSS0.Px3.p1.5.6" class="ltx_text ltx_font_typewriter">Improve</span> step improves the performance of the translation model significantly across all three datasets.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_second_grow_step.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" width="202" height="128" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/webdomain_second_grow_step.png" id="S4.F4.g2" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_portrait" width="96" height="122" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.10.1" class="ltx_text ltx_font_bold">ReST with two <span id="S4.F4.10.1.1" class="ltx_text ltx_font_typewriter">Grow</span> steps.</span> The second <span id="S4.F4.11.2" class="ltx_text ltx_font_typewriter">Grow</span> step with subsequent <span id="S4.F4.12.3" class="ltx_text ltx_font_typewriter">Improve</span> steps improves the performance by <math id="S4.F4.3.m1.1" class="ltx_Math" alttext="5.3" display="inline"><semantics id="S4.F4.3.m1.1b"><mn id="S4.F4.3.m1.1.1" xref="S4.F4.3.m1.1.1.cmml">5.3</mn><annotation-xml encoding="MathML-Content" id="S4.F4.3.m1.1c"><cn type="float" id="S4.F4.3.m1.1.1.cmml" xref="S4.F4.3.m1.1.1">5.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.m1.1d">5.3</annotation><annotation encoding="application/x-llamapun" id="S4.F4.3.m1.1e">5.3</annotation></semantics></math> points on IWSLT 2014 De-En and <math id="S4.F4.4.m2.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S4.F4.4.m2.1b"><mn id="S4.F4.4.m2.1.1" xref="S4.F4.4.m2.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S4.F4.4.m2.1c"><cn type="float" id="S4.F4.4.m2.1.1.cmml" xref="S4.F4.4.m2.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.m2.1d">0.8</annotation><annotation encoding="application/x-llamapun" id="S4.F4.4.m2.1e">0.8</annotation></semantics></math> points on Web Domain En-Zh task over the first <span id="S4.F4.13.4" class="ltx_text ltx_font_typewriter">Grow</span> step.</figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure"><img src="assets/plots/wmt_baseline_comparisons.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="193" height="122" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S4.F5.16.1" class="ltx_text ltx_font_bold">WMT 2020 zh-en (test)</span>: <span id="S4.F5.17.2" class="ltx_text ltx_font_typewriter">BC</span> (in grey, <math id="S4.F5.3.m1.1" class="ltx_Math" alttext="G=0\leavevmode\nobreak\ I=0" display="inline"><semantics id="S4.F5.3.m1.1b"><mrow id="S4.F5.3.m1.1.1" xref="S4.F5.3.m1.1.1.cmml"><mi id="S4.F5.3.m1.1.1.2" xref="S4.F5.3.m1.1.1.2.cmml">G</mi><mo id="S4.F5.3.m1.1.1.3" xref="S4.F5.3.m1.1.1.3.cmml">=</mo><mrow id="S4.F5.3.m1.1.1.4" xref="S4.F5.3.m1.1.1.4.cmml"><mn id="S4.F5.3.m1.1.1.4.2" xref="S4.F5.3.m1.1.1.4.2.cmml">0</mn><mo lspace="0.500em" id="S4.F5.3.m1.1.1.4.1" xref="S4.F5.3.m1.1.1.4.1.cmml">⁢</mo><mi id="S4.F5.3.m1.1.1.4.3" xref="S4.F5.3.m1.1.1.4.3.cmml">I</mi></mrow><mo id="S4.F5.3.m1.1.1.5" xref="S4.F5.3.m1.1.1.5.cmml">=</mo><mn id="S4.F5.3.m1.1.1.6" xref="S4.F5.3.m1.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.3.m1.1c"><apply id="S4.F5.3.m1.1.1.cmml" xref="S4.F5.3.m1.1.1"><and id="S4.F5.3.m1.1.1a.cmml" xref="S4.F5.3.m1.1.1"></and><apply id="S4.F5.3.m1.1.1b.cmml" xref="S4.F5.3.m1.1.1"><eq id="S4.F5.3.m1.1.1.3.cmml" xref="S4.F5.3.m1.1.1.3"></eq><ci id="S4.F5.3.m1.1.1.2.cmml" xref="S4.F5.3.m1.1.1.2">𝐺</ci><apply id="S4.F5.3.m1.1.1.4.cmml" xref="S4.F5.3.m1.1.1.4"><times id="S4.F5.3.m1.1.1.4.1.cmml" xref="S4.F5.3.m1.1.1.4.1"></times><cn type="integer" id="S4.F5.3.m1.1.1.4.2.cmml" xref="S4.F5.3.m1.1.1.4.2">0</cn><ci id="S4.F5.3.m1.1.1.4.3.cmml" xref="S4.F5.3.m1.1.1.4.3">𝐼</ci></apply></apply><apply id="S4.F5.3.m1.1.1c.cmml" xref="S4.F5.3.m1.1.1"><eq id="S4.F5.3.m1.1.1.5.cmml" xref="S4.F5.3.m1.1.1.5"></eq><share href="#S4.F5.3.m1.1.1.4.cmml" id="S4.F5.3.m1.1.1d.cmml" xref="S4.F5.3.m1.1.1"></share><cn type="integer" id="S4.F5.3.m1.1.1.6.cmml" xref="S4.F5.3.m1.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.3.m1.1d">G=0\leavevmode\nobreak\ I=0</annotation><annotation encoding="application/x-llamapun" id="S4.F5.3.m1.1e">italic_G = 0 italic_I = 0</annotation></semantics></math>) and <span id="S4.F5.18.3" class="ltx_ERROR undefined">\rest</span> trained with different offline RL losses. <span id="S4.F5.19.4" class="ltx_ERROR undefined">\rest</span> is trained with one <span id="S4.F5.20.5" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S4.F5.21.6" class="ltx_text ltx_font_typewriter">Improve</span> step except <math id="S4.F5.4.m2.1" class="ltx_Math" alttext="G=1\leavevmode\nobreak\ I=0" display="inline"><semantics id="S4.F5.4.m2.1b"><mrow id="S4.F5.4.m2.1.1" xref="S4.F5.4.m2.1.1.cmml"><mi id="S4.F5.4.m2.1.1.2" xref="S4.F5.4.m2.1.1.2.cmml">G</mi><mo id="S4.F5.4.m2.1.1.3" xref="S4.F5.4.m2.1.1.3.cmml">=</mo><mrow id="S4.F5.4.m2.1.1.4" xref="S4.F5.4.m2.1.1.4.cmml"><mn id="S4.F5.4.m2.1.1.4.2" xref="S4.F5.4.m2.1.1.4.2.cmml">1</mn><mo lspace="0.500em" id="S4.F5.4.m2.1.1.4.1" xref="S4.F5.4.m2.1.1.4.1.cmml">⁢</mo><mi id="S4.F5.4.m2.1.1.4.3" xref="S4.F5.4.m2.1.1.4.3.cmml">I</mi></mrow><mo id="S4.F5.4.m2.1.1.5" xref="S4.F5.4.m2.1.1.5.cmml">=</mo><mn id="S4.F5.4.m2.1.1.6" xref="S4.F5.4.m2.1.1.6.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.4.m2.1c"><apply id="S4.F5.4.m2.1.1.cmml" xref="S4.F5.4.m2.1.1"><and id="S4.F5.4.m2.1.1a.cmml" xref="S4.F5.4.m2.1.1"></and><apply id="S4.F5.4.m2.1.1b.cmml" xref="S4.F5.4.m2.1.1"><eq id="S4.F5.4.m2.1.1.3.cmml" xref="S4.F5.4.m2.1.1.3"></eq><ci id="S4.F5.4.m2.1.1.2.cmml" xref="S4.F5.4.m2.1.1.2">𝐺</ci><apply id="S4.F5.4.m2.1.1.4.cmml" xref="S4.F5.4.m2.1.1.4"><times id="S4.F5.4.m2.1.1.4.1.cmml" xref="S4.F5.4.m2.1.1.4.1"></times><cn type="integer" id="S4.F5.4.m2.1.1.4.2.cmml" xref="S4.F5.4.m2.1.1.4.2">1</cn><ci id="S4.F5.4.m2.1.1.4.3.cmml" xref="S4.F5.4.m2.1.1.4.3">𝐼</ci></apply></apply><apply id="S4.F5.4.m2.1.1c.cmml" xref="S4.F5.4.m2.1.1"><eq id="S4.F5.4.m2.1.1.5.cmml" xref="S4.F5.4.m2.1.1.5"></eq><share href="#S4.F5.4.m2.1.1.4.cmml" id="S4.F5.4.m2.1.1d.cmml" xref="S4.F5.4.m2.1.1"></share><cn type="integer" id="S4.F5.4.m2.1.1.6.cmml" xref="S4.F5.4.m2.1.1.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.m2.1d">G=1\leavevmode\nobreak\ I=0</annotation><annotation encoding="application/x-llamapun" id="S4.F5.4.m2.1e">italic_G = 1 italic_I = 0</annotation></semantics></math>, which is trained on the entire dataset generated after the first <span id="S4.F5.22.7" class="ltx_text ltx_font_typewriter">Grow</span> step without any <span id="S4.F5.23.8" class="ltx_text ltx_font_typewriter">Improve</span> (all in purple). All variants of <span id="S4.F5.24.9" class="ltx_ERROR undefined">\rest</span> outperform the initial <span id="S4.F5.25.10" class="ltx_text ltx_font_typewriter">BC</span> baseline, with <span id="S4.F5.26.11" class="ltx_text ltx_font_typewriter">BC</span> loss resulting in the best performance.</figcaption>
</figure>
</section>
<section id="S4.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Do additional <span id="S4.SS0.SSS0.Px4.1.1" class="ltx_text ltx_font_typewriter">Grow</span> steps improve reward model scores?</h5>

<div id="S4.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px4.p1.1" class="ltx_p">We performed a second <span id="S4.SS0.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_typewriter">Grow</span> step with successive <span id="S4.SS0.SSS0.Px4.p1.1.2" class="ltx_text ltx_font_typewriter">Improve</span> steps to measure the effect of the extra <span id="S4.SS0.SSS0.Px4.p1.1.3" class="ltx_text ltx_font_typewriter">Grow</span> step on the performance. In Figure <a href="#S4.F4" title="Figure 4 ‣ Do multiple Improve steps in \rest increase the reward model scores? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, a method with an additional <span id="S4.SS0.SSS0.Px4.p1.1.4" class="ltx_text ltx_font_typewriter">Grow</span> step achieves further improvement on the IWSLT 2014 and Web Domain datasets. We noticed a <math id="S4.SS0.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="5.3" display="inline"><semantics id="S4.SS0.SSS0.Px4.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1.cmml">5.3</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px4.p1.1.m1.1b"><cn type="float" id="S4.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px4.p1.1.m1.1.1">5.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px4.p1.1.m1.1c">5.3</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px4.p1.1.m1.1d">5.3</annotation></semantics></math> point improvement between the end of the first and the second <span id="S4.SS0.SSS0.Px4.p1.1.5" class="ltx_text ltx_font_typewriter">Grow</span> step.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Does <span id="S4.SS0.SSS0.Px5.1.1" class="ltx_ERROR undefined">\rest</span> improve over supervised training?</h5>

<div id="S4.SS0.SSS0.Px5.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px5.p1.1" class="ltx_p">To answer this question, in Figure <a href="#S4.F5" title="Figure 5 ‣ Do multiple Improve steps in \rest increase the reward model scores? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we plotted the average reward achieved by the supervised learning model as well as several variants of <span id="S4.SS0.SSS0.Px5.p1.1.1" class="ltx_ERROR undefined">\rest</span> with different losses and the number of <span id="S4.SS0.SSS0.Px5.p1.1.2" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S4.SS0.SSS0.Px5.p1.1.3" class="ltx_text ltx_font_typewriter">Improve</span> steps. Different variants of <span id="S4.SS0.SSS0.Px5.p1.1.4" class="ltx_ERROR undefined">\rest</span> (purple) significantly outperform supervised learning (gray) even after just the first grow step. This observation was consistent across different datasets and language pairs that we tested.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px6" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Which loss is the best for a single step of <span id="S4.SS0.SSS0.Px6.1.1" class="ltx_ERROR undefined">\rest</span>?</h5>

<div id="S4.SS0.SSS0.Px6.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px6.p1.3" class="ltx_p">Figure <a href="#S4.F5" title="Figure 5 ‣ Do multiple Improve steps in \rest increase the reward model scores? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> depicts variants of <span id="S4.SS0.SSS0.Px6.p1.3.1" class="ltx_ERROR undefined">\rest</span> with different offline RL losses <math id="S4.SS0.SSS0.Px6.p1.1.m1.3" class="ltx_Math" alttext="{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)" display="inline"><semantics id="S4.SS0.SSS0.Px6.p1.1.m1.3a"><mrow id="S4.SS0.SSS0.Px6.p1.1.m1.3.4" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.2" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.2.cmml">ℒ</mi><mo id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.1" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.1.cmml">⁢</mo><mrow id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.2" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.2.1" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.1.cmml">(</mo><mi id="S4.SS0.SSS0.Px6.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px6.p1.1.m1.1.1.cmml">𝒙</mi><mo id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.2.2" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="S4.SS0.SSS0.Px6.p1.1.m1.2.2" xref="S4.SS0.SSS0.Px6.p1.1.m1.2.2.cmml">𝒚</mi><mo id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.2.3" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.1.cmml">;</mo><mi id="S4.SS0.SSS0.Px6.p1.1.m1.3.3" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.2.4" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px6.p1.1.m1.3b"><apply id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4"><times id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.1.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.1"></times><ci id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.2.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.2">ℒ</ci><vector id="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.1.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.4.3.2"><ci id="S4.SS0.SSS0.Px6.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.1.1">𝒙</ci><ci id="S4.SS0.SSS0.Px6.p1.1.m1.2.2.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.2.2">𝒚</ci><ci id="S4.SS0.SSS0.Px6.p1.1.m1.3.3.cmml" xref="S4.SS0.SSS0.Px6.p1.1.m1.3.3">𝜃</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px6.p1.1.m1.3c">{\mathcal{L}}({\bm{x}},{\bm{y}};\theta)</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px6.p1.1.m1.3d">caligraphic_L ( bold_italic_x , bold_italic_y ; italic_θ )</annotation></semantics></math>. We find that <span id="S4.SS0.SSS0.Px6.p1.3.2" class="ltx_text ltx_font_typewriter">BC</span> loss outperforms other loss functions. Note that normally <span id="S4.SS0.SSS0.Px6.p1.3.3" class="ltx_text ltx_font_typewriter">BC</span> algorithm does not depend on the reward, but in <span id="S4.SS0.SSS0.Px6.p1.3.4" class="ltx_ERROR undefined">\rest</span>, the reward is taken into account through the reward filtering stage for <math id="S4.SS0.SSS0.Px6.p1.2.m2.1" class="ltx_Math" alttext="I\geq 1" display="inline"><semantics id="S4.SS0.SSS0.Px6.p1.2.m2.1a"><mrow id="S4.SS0.SSS0.Px6.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.cmml"><mi id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.2" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.2.cmml">I</mi><mo id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.1" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.1.cmml">≥</mo><mn id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.3" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px6.p1.2.m2.1b"><apply id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1"><geq id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.1.cmml" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.1"></geq><ci id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.2.cmml" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.2">𝐼</ci><cn type="integer" id="S4.SS0.SSS0.Px6.p1.2.m2.1.1.3.cmml" xref="S4.SS0.SSS0.Px6.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px6.p1.2.m2.1c">I\geq 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px6.p1.2.m2.1d">italic_I ≥ 1</annotation></semantics></math> (with <math id="S4.SS0.SSS0.Px6.p1.3.m3.1" class="ltx_Math" alttext="\tau_{1}=0.8" display="inline"><semantics id="S4.SS0.SSS0.Px6.p1.3.m3.1a"><mrow id="S4.SS0.SSS0.Px6.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.cmml"><msub id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.cmml"><mi id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.2" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.2.cmml">τ</mi><mn id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.3" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.1" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.3" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px6.p1.3.m3.1b"><apply id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1"><eq id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.1.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.1"></eq><apply id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.1.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.2.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.2">𝜏</ci><cn type="integer" id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.3.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.2.3">1</cn></apply><cn type="float" id="S4.SS0.SSS0.Px6.p1.3.m3.1.1.3.cmml" xref="S4.SS0.SSS0.Px6.p1.3.m3.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px6.p1.3.m3.1c">\tau_{1}=0.8</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px6.p1.3.m3.1d">italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.8</annotation></semantics></math> for WMT 2020.) Results with multiple <span id="S4.SS0.SSS0.Px6.p1.3.5" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S4.SS0.SSS0.Px6.p1.3.6" class="ltx_text ltx_font_typewriter">Improve</span> steps are displayed in Figure <a href="#S4.F4" title="Figure 4 ‣ Do multiple Improve steps in \rest increase the reward model scores? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (see also Appendix <a href="#A1.SS6" title="A.6 Results on test sets ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.6</span></a>).</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px7" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Can <span id="S4.SS0.SSS0.Px7.1.1" class="ltx_ERROR undefined">\rest</span> be improved further with Best-of-N sampling at inference time?</h5>

<div id="S4.SS0.SSS0.Px7.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px7.p1.8" class="ltx_p">Best-of-N sampling technique at inference time generates <math id="S4.SS0.SSS0.Px7.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.1.m1.1a"><mi id="S4.SS0.SSS0.Px7.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px7.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.1.m1.1b"><ci id="S4.SS0.SSS0.Px7.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.1.m1.1d">italic_N</annotation></semantics></math> samples which are then ranked by the reward model. Then, the top ranked candidate is selected <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a href="#bib.bib19" title="" class="ltx_ref">2022</a>)</cite>. We show results with Best-of-N sampling on top of <span id="S4.SS0.SSS0.Px7.p1.8.1" class="ltx_text ltx_font_typewriter">BC</span> (<span id="S4.SS0.SSS0.Px7.p1.8.2" class="ltx_text ltx_markedasmath ltx_font_typewriter">G=0 I=0</span>) and <span id="S4.SS0.SSS0.Px7.p1.8.3" class="ltx_ERROR undefined">\rest</span> variants in Figure <a href="#S4.F6" title="Figure 6 ‣ Can \rest be improved further with Best-of-N sampling at inference time? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. The performance of <span id="S4.SS0.SSS0.Px7.p1.8.4" class="ltx_ERROR undefined">\rest</span> improves both with <math id="S4.SS0.SSS0.Px7.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.3.m3.1a"><mi id="S4.SS0.SSS0.Px7.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px7.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.3.m3.1b"><ci id="S4.SS0.SSS0.Px7.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.3.m3.1d">italic_N</annotation></semantics></math> and with the number of <span id="S4.SS0.SSS0.Px7.p1.8.5" class="ltx_text ltx_font_typewriter">Improve</span> steps. The best <span id="S4.SS0.SSS0.Px7.p1.8.6" class="ltx_ERROR undefined">\rest</span> variant with <math id="S4.SS0.SSS0.Px7.p1.4.m4.1" class="ltx_Math" alttext="N&lt;10" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.4.m4.1a"><mrow id="S4.SS0.SSS0.Px7.p1.4.m4.1.1" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.cmml"><mi id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.2" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.2.cmml">N</mi><mo id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.1" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.1.cmml">&lt;</mo><mn id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.3" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.4.m4.1b"><apply id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1"><lt id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.1"></lt><ci id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.2.cmml" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.2">𝑁</ci><cn type="integer" id="S4.SS0.SSS0.Px7.p1.4.m4.1.1.3.cmml" xref="S4.SS0.SSS0.Px7.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.4.m4.1c">N&lt;10</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.4.m4.1d">italic_N &lt; 10</annotation></semantics></math> matches the performance of the <span id="S4.SS0.SSS0.Px7.p1.8.7" class="ltx_text ltx_font_typewriter">BC</span> model with <math id="S4.SS0.SSS0.Px7.p1.5.m5.1" class="ltx_Math" alttext="N=200" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.5.m5.1a"><mrow id="S4.SS0.SSS0.Px7.p1.5.m5.1.1" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.cmml"><mi id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.2" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.2.cmml">N</mi><mo id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.1" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.3" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.5.m5.1b"><apply id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1"><eq id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.1"></eq><ci id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.2.cmml" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.2">𝑁</ci><cn type="integer" id="S4.SS0.SSS0.Px7.p1.5.m5.1.1.3.cmml" xref="S4.SS0.SSS0.Px7.p1.5.m5.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.5.m5.1c">N=200</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.5.m5.1d">italic_N = 200</annotation></semantics></math>. Even though RL is known to limit the diversity of samples, this experiment shows that <span id="S4.SS0.SSS0.Px7.p1.8.8" class="ltx_ERROR undefined">\rest</span> can still benefit from Best-of-N sampling. After three <span id="S4.SS0.SSS0.Px7.p1.8.9" class="ltx_text ltx_font_typewriter">Improve</span> steps with <math id="S4.SS0.SSS0.Px7.p1.6.m6.1" class="ltx_Math" alttext="N=200" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.6.m6.1a"><mrow id="S4.SS0.SSS0.Px7.p1.6.m6.1.1" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.cmml"><mi id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.2" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.2.cmml">N</mi><mo id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.1" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.3" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.6.m6.1b"><apply id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1"><eq id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.1"></eq><ci id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.2.cmml" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.2">𝑁</ci><cn type="integer" id="S4.SS0.SSS0.Px7.p1.6.m6.1.1.3.cmml" xref="S4.SS0.SSS0.Px7.p1.6.m6.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.6.m6.1c">N=200</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.6.m6.1d">italic_N = 200</annotation></semantics></math>, <span id="S4.SS0.SSS0.Px7.p1.8.10" class="ltx_ERROR undefined">\rest</span> achieves the highest possible reward of <math id="S4.SS0.SSS0.Px7.p1.7.m7.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.7.m7.1a"><mn id="S4.SS0.SSS0.Px7.p1.7.m7.1.1" xref="S4.SS0.SSS0.Px7.p1.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.7.m7.1b"><cn type="integer" id="S4.SS0.SSS0.Px7.p1.7.m7.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.7.m7.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.7.m7.1d">1</annotation></semantics></math>, outperforming the “reference” translations in <math id="S4.SS0.SSS0.Px7.p1.8.m8.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="S4.SS0.SSS0.Px7.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSS0.Px7.p1.8.m8.1.1" xref="S4.SS0.SSS0.Px7.p1.8.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px7.p1.8.m8.1b"><ci id="S4.SS0.SSS0.Px7.p1.8.m8.1.1.cmml" xref="S4.SS0.SSS0.Px7.p1.8.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px7.p1.8.m8.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px7.p1.8.m8.1d">caligraphic_D</annotation></semantics></math>.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="assets/plots/wmt_rejection_sampling_sized.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="164" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S4.F6.3.1" class="ltx_text ltx_font_bold">Best-of-N sampling at inference time.</span> All variants of <span id="S4.F6.4.2" class="ltx_ERROR undefined">\rest</span> benefit as much from Best-of-N sampling as supervised models.</figcaption>
</figure>
</section>
<section id="S4.SS0.SSS0.Px8" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">How does <span id="S4.SS0.SSS0.Px8.1.1" class="ltx_ERROR undefined">\rest</span> compare with Online RL?</h5>

<div id="S4.SS0.SSS0.Px8.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px8.p1.3" class="ltx_p">We compared <span id="S4.SS0.SSS0.Px8.p1.3.1" class="ltx_ERROR undefined">\rest</span> with PPO <cite class="ltx_cite ltx_citemacro_citep">(Schulman et al., <a href="#bib.bib47" title="" class="ltx_ref">2017</a>)</cite>, an online RL algorithm widely used for RLHF <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a href="#bib.bib39" title="" class="ltx_ref">2022a</a>; Glaese et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>. For our online RL experiments, we used the setup of <cite class="ltx_cite ltx_citemacro_cite">Donato et al. (<a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite> where PPO had access to a similar amount of training data as <span id="S4.SS0.SSS0.Px8.p1.3.2" class="ltx_ERROR undefined">\rest</span> with <math id="S4.SS0.SSS0.Px8.p1.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS0.SSS0.Px8.p1.1.m1.1a"><mn id="S4.SS0.SSS0.Px8.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px8.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px8.p1.1.m1.1b"><cn type="integer" id="S4.SS0.SSS0.Px8.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px8.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px8.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px8.p1.1.m1.1d">1</annotation></semantics></math> <span id="S4.SS0.SSS0.Px8.p1.3.3" class="ltx_text ltx_font_typewriter">Grow</span> step. The results are summarized in Table <a href="#S4.T1" title="Table 1 ‣ How does \rest compare with Online RL? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Online RL performs as well as <span id="S4.SS0.SSS0.Px8.p1.3.4" class="ltx_ERROR undefined">\rest</span> with one <span id="S4.SS0.SSS0.Px8.p1.3.5" class="ltx_text ltx_font_typewriter">Grow</span> and no <span id="S4.SS0.SSS0.Px8.p1.3.6" class="ltx_text ltx_font_typewriter">Improve</span> steps which is equivalent to <span id="S4.SS0.SSS0.Px8.p1.3.7" class="ltx_text ltx_font_typewriter">BC</span> on the <math id="S4.SS0.SSS0.Px8.p1.2.m2.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="S4.SS0.SSS0.Px8.p1.2.m2.1a"><msub id="S4.SS0.SSS0.Px8.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS0.SSS0.Px8.p1.2.m2.1.1.2" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS0.SSS0.Px8.p1.2.m2.1.1.3" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px8.p1.2.m2.1b"><apply id="S4.SS0.SSS0.Px8.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px8.p1.2.m2.1.1.1.cmml" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px8.p1.2.m2.1.1.2.cmml" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1.2">𝒟</ci><ci id="S4.SS0.SSS0.Px8.p1.2.m2.1.1.3.cmml" xref="S4.SS0.SSS0.Px8.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px8.p1.2.m2.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px8.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> dataset. With the same amount of training data, <span id="S4.SS0.SSS0.Px8.p1.3.8" class="ltx_ERROR undefined">\rest</span> with multiple <span id="S4.SS0.SSS0.Px8.p1.3.9" class="ltx_text ltx_font_typewriter">Improve</span> steps achieves significantly higher rewards. Furthermore, we noticed that the BLEU score for the online RL policy on the validation set dropped by nearly <math id="S4.SS0.SSS0.Px8.p1.3.m3.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S4.SS0.SSS0.Px8.p1.3.m3.1a"><mn id="S4.SS0.SSS0.Px8.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px8.p1.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px8.p1.3.m3.1b"><cn type="integer" id="S4.SS0.SSS0.Px8.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px8.p1.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px8.p1.3.m3.1c">8</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px8.p1.3.m3.1d">8</annotation></semantics></math> points (BLEU score of <span id="S4.SS0.SSS0.Px8.p1.3.10" class="ltx_ERROR undefined">\rest</span> did not change) which indicates a potential reward hacking behaviour. <span id="S4.SS0.SSS0.Px8.p1.3.11" class="ltx_ERROR undefined">\rest</span>’s ability to improve the reward model score without deteriorating the performance on other metrics suggests that the “alignment tax” it pays is lower than for online RL approaches.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.5.6.1" class="ltx_tr">
<th id="S4.T1.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Algorithm</th>
<th id="S4.T1.5.6.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Average Reward</th>
<th id="S4.T1.5.6.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">Distinct samples</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.2.1" class="ltx_text ltx_font_typewriter">BC</span> (G=0, I=0)</td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">70.9</td>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="16\,000\,000" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mn id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">16 000 000</mn><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><cn type="integer" id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">16000000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">16\,000\,000</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">16 000 000</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr" style="background-color:#BFBFBF;">
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.2.2.2.1" class="ltx_ERROR undefined">\rest</span><span id="S4.T1.2.2.2.2" class="ltx_text" style="background-color:#BFBFBF;"> (G=1, I=0)</span>
</td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.2.2.3.1" class="ltx_text" style="background-color:#BFBFBF;">71.9</span></td>
<td id="S4.T1.2.2.1" class="ltx_td ltx_align_center"><math id="S4.T1.2.2.1.m1.1" class="ltx_Math" style="background-color:#BFBFBF;" alttext="16\,000\,000" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><mn mathbackground="#BFBFBF" id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">16 000 000</mn><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><cn type="integer" id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">16000000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">16\,000\,000</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">16 000 000</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.3.3.2.1" class="ltx_ERROR undefined">\rest</span> (G=1, I=4)</td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_r">77.8</td>
<td id="S4.T1.3.3.1" class="ltx_td ltx_align_center"><math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="16\,000\,000" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><mn id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">16 000 000</mn><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><cn type="integer" id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">16000000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">16\,000\,000</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.1.m1.1d">16 000 000</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.4.4" class="ltx_tr" style="background-color:#BFBFBF;">
<td id="S4.T1.4.4.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.4.4.2.1" class="ltx_text ltx_font_bold" style="background-color:#BFBFBF;"><span id="S4.T1.4.4.2.1.1" class="ltx_ERROR undefined">\rest</span> (G=2, I=3)</span></td>
<td id="S4.T1.4.4.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.4.4.3.1" class="ltx_text ltx_font_bold" style="background-color:#BFBFBF;">83.1</span></td>
<td id="S4.T1.4.4.1" class="ltx_td ltx_align_center"><math id="S4.T1.4.4.1.m1.1" class="ltx_Math" style="background-color:#BFBFBF;" alttext="32\,000\,000" display="inline"><semantics id="S4.T1.4.4.1.m1.1a"><mn mathbackground="#BFBFBF" id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml">32 000 000</mn><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><cn type="integer" id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1">32000000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">32\,000\,000</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.1.m1.1d">32 000 000</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.5.5" class="ltx_tr">
<td id="S4.T1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">Online RL</td>
<td id="S4.T1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">71.6</td>
<td id="S4.T1.5.5.1" class="ltx_td ltx_align_center"><math id="S4.T1.5.5.1.m1.1" class="ltx_Math" alttext="24\,000\,000" display="inline"><semantics id="S4.T1.5.5.1.m1.1a"><mn id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml">24 000 000</mn><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><cn type="integer" id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1">24000000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">24\,000\,000</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.1.m1.1d">24 000 000</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S4.T1.9.1" class="ltx_text ltx_font_bold">Online RL for IWSLT 2014:</span> Online RL performs as well as <span id="S4.T1.10.2" class="ltx_ERROR undefined">\rest</span> (G=1, I=0) and <span id="S4.T1.11.3" class="ltx_ERROR undefined">\rest</span> (G=1, I=4) is significantly better.</figcaption>
</figure>
</section>
<section id="S4.SS0.SSS0.Px9" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Does <span id="S4.SS0.SSS0.Px9.1.1" class="ltx_ERROR undefined">\rest</span> improve human preferences?</h5>

<div id="S4.SS0.SSS0.Px9.p1" class="ltx_para">
<p id="S4.SS0.SSS0.Px9.p1.3" class="ltx_p">We evaluated the <span id="S4.SS0.SSS0.Px9.p1.3.1" class="ltx_ERROR undefined">\rest</span> models by human raters to investigate if <span id="S4.SS0.SSS0.Px9.p1.3.2" class="ltx_ERROR undefined">\rest</span> can outperform <span id="S4.SS0.SSS0.Px9.p1.3.3" class="ltx_text ltx_font_typewriter">BC</span> in human evaluations as well. We displayed a sentence in the source language and two generated translations: one by <span id="S4.SS0.SSS0.Px9.p1.3.4" class="ltx_text ltx_font_typewriter">BC</span> model (<span id="S4.SS0.SSS0.Px9.p1.3.5" class="ltx_text ltx_markedasmath ltx_font_typewriter">G=0 I=0</span>) and one by a <span id="S4.SS0.SSS0.Px9.p1.3.6" class="ltx_ERROR undefined">\rest</span> variant. Human raters scored each translation on a scale from <math id="S4.SS0.SSS0.Px9.p1.2.m2.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS0.SSS0.Px9.p1.2.m2.1a"><mn id="S4.SS0.SSS0.Px9.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px9.p1.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px9.p1.2.m2.1b"><cn type="integer" id="S4.SS0.SSS0.Px9.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px9.p1.2.m2.1.1">0</cn></annotation-xml></semantics></math> to <math id="S4.SS0.SSS0.Px9.p1.3.m3.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S4.SS0.SSS0.Px9.p1.3.m3.1a"><mn id="S4.SS0.SSS0.Px9.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px9.p1.3.m3.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px9.p1.3.m3.1b"><cn type="integer" id="S4.SS0.SSS0.Px9.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px9.p1.3.m3.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px9.p1.3.m3.1c">6</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px9.p1.3.m3.1d">6</annotation></semantics></math>, and we measured the difference between the average score of <span id="S4.SS0.SSS0.Px9.p1.3.7" class="ltx_ERROR undefined">\rest</span> method and of <span id="S4.SS0.SSS0.Px9.p1.3.8" class="ltx_text ltx_font_typewriter">BC</span> which we refer as <em id="S4.SS0.SSS0.Px9.p1.3.9" class="ltx_emph ltx_font_italic">"Human eval diff"</em>. In Figure <a href="#S4.F7" title="Figure 7 ‣ Does \rest improve human preferences? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> (right), we see that all variants of <span id="S4.SS0.SSS0.Px9.p1.3.10" class="ltx_ERROR undefined">\rest</span> outperform the <span id="S4.SS0.SSS0.Px9.p1.3.11" class="ltx_text ltx_font_typewriter">BC</span> baseline significantly. However, if we compare the human score gains with the gains in the learned reward (Figure <a href="#S4.F7" title="Figure 7 ‣ Does \rest improve human preferences? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, left), the rankings do not match. We hypothesise that the difference is due to the fact that the reward models cannot generalize well on OOD data since the learned reward models are an imperfect proxy of human preferences. In particular, we found that the reward models generalise worse as our policy moves away from the behaviour model which can happen as the number of <span id="S4.SS0.SSS0.Px9.p1.3.12" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S4.SS0.SSS0.Px9.p1.3.13" class="ltx_text ltx_font_typewriter">Improve</span> steps increases at which point <span id="S4.SS0.SSS0.Px9.p1.3.14" class="ltx_ERROR undefined">\rest</span> can start overfitting to the reward model. Thus, in our analysis, we focused on evaluating models based on how well they align with a reward signal and we treat reward model generalisation as an independent issue that could be mitigated by, for example, finetuning the reward model between the consecutive <span id="S4.SS0.SSS0.Px9.p1.3.15" class="ltx_text ltx_font_typewriter">Grow</span> steps on the human-annotated data from the most recent policy. <span id="S4.SS0.SSS0.Px9.p1.3.16" class="ltx_ERROR undefined">\rest</span> with the B-VMPO loss utilises a learned value function and KL regularisation term to prevent over-fitting and thus attains high human preference scores.</p>
</div>
<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_human_eval_rewards.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_square" width="165" height="156" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_human_eval_diff.png" id="S4.F7.g2" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_square" width="165" height="156" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="S4.F7.4.1" class="ltx_text ltx_font_bold">Comparison of performance based on learned reward and on human evaluation.</span> All <span id="S4.F7.5.2" class="ltx_ERROR undefined">\rest</span> variants outperform BC in terms of human ratings, but the rankings of the methods based on reward model scores and human scores are different.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Related works</h2>

<figure id="S5.F8" class="ltx_figure"><img src="assets/plots/comparison.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="200" height="100" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="S5.F8.4.1" class="ltx_ERROR undefined">\rest</span><span id="S5.F8.5.2" class="ltx_text ltx_font_bold"> vs alternatives:</span> <span id="S5.F8.6.3" class="ltx_ERROR undefined">\rest</span> is the only approach that can leverage the exploration data and rewards, but is also computationally efficient.</figcaption>
</figure>
<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">There has been large number of works recently on self-improving alignment algorithms for language modelling. In Figure <a href="#S5.F8" title="Figure 8 ‣ 5 Related works ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we also compare <span id="S5.p1.1.1" class="ltx_ERROR undefined">\rest</span> against different approaches: supervised learning, self-training, online and offline RL. We conclude from this comparison that <span id="S5.p1.1.2" class="ltx_ERROR undefined">\rest</span> is the only approach that is compute efficient, but also can leverage exploration data and rewards. Next, we describe some of the particular works related to <span id="S5.p1.1.3" class="ltx_ERROR undefined">\rest</span>.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Self-training</h5>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">Self-training is an established semi-supervised learning approach which utilizes unlabeled data to improve a model <cite class="ltx_cite ltx_citemacro_citep">(Scudder, <a href="#bib.bib48" title="" class="ltx_ref">1965</a>)</cite>. Since its introduction, self-training has been successfully applied to many tasks, including image classification and recognition <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a href="#bib.bib60" title="" class="ltx_ref">2020</a>)</cite>, protein folding <cite class="ltx_cite ltx_citemacro_citep">(Jumper et al., <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite>, as well as several language tasks <cite class="ltx_cite ltx_citemacro_citep">(Yarowsky, <a href="#bib.bib62" title="" class="ltx_ref">1995</a>; Sun et al., <a href="#bib.bib55" title="" class="ltx_ref">2021</a>; Zhang and Zong, <a href="#bib.bib65" title="" class="ltx_ref">2016</a>; He et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite>. <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> empirically demonstrated that noisy self-training improves the performance of translation models. The <span id="S5.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter">Improve</span> step of <span id="S5.SS0.SSS0.Px1.p1.1.2" class="ltx_ERROR undefined">\rest</span> resembles self-training. <span id="S5.SS0.SSS0.Px1.p1.1.3" class="ltx_ERROR undefined">\rest</span>’s main difference from self-training is that the <span id="S5.SS0.SSS0.Px1.p1.1.4" class="ltx_text ltx_font_typewriter">Grow</span> step of <span id="S5.SS0.SSS0.Px1.p1.1.5" class="ltx_ERROR undefined">\rest</span> generates synthetic exploration data for training with RL.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Expert Iteration (EI)</h5>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">Anthony (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite> proposed an RL framework which is a form of policy iteration approach that makes use of a planning mechanism. EI explicitly decomposes the RL problem into two parts: planning and generalisation. Similar to <span id="S5.SS0.SSS0.Px2.p1.1.1" class="ltx_ERROR undefined">\rest</span>, EI uses the policy to generate data and exploit it to learn a policy with RL. Unlike EI, <span id="S5.SS0.SSS0.Px2.p1.1.2" class="ltx_ERROR undefined">\rest</span> does not require any planning mechanism and it makes use of iterative <span id="S5.SS0.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_typewriter">Improve</span> steps that enables it to leverage the gathered data more effectively.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reasoning with language models</h5>

<div id="S5.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px3.p1.1" class="ltx_p">The EI method inspired several related approaches <cite class="ltx_cite ltx_citemacro_citep">(Zelikman et al., <a href="#bib.bib64" title="" class="ltx_ref">2022</a>; Uesato et al., <a href="#bib.bib57" title="" class="ltx_ref">2022</a>)</cite>. <cite class="ltx_cite ltx_citemacro_cite">Zelikman et al. (<a href="#bib.bib64" title="" class="ltx_ref">2022</a>)</cite> proposed a technique called STAR that iteratively leverages a small number of rationales to fine-tune the model. Then, they sample rationales with the answers from the model and filter the generated answers by their correctness. <cite class="ltx_cite ltx_citemacro_cite">Uesato et al. (<a href="#bib.bib57" title="" class="ltx_ref">2022</a>)</cite> proposed a similar method which learns to solve math problems using learned reward models. Recently, <cite class="ltx_cite ltx_citemacro_cite">Jung et al. (<a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite> proposed a method called “Impossible Distillation” similar to ours, which generates datasets for large language models by sampling from a suboptimal model and filters the low-quality examples with a filtering mechanism. This approach corresponds to <span id="S5.SS0.SSS0.Px3.p1.1.1" class="ltx_ERROR undefined">\rest</span> with a single <span id="S5.SS0.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S5.SS0.SSS0.Px3.p1.1.3" class="ltx_text ltx_font_typewriter">Improve</span> steps. In contrast to these methods, <span id="S5.SS0.SSS0.Px3.p1.1.4" class="ltx_ERROR undefined">\rest</span> can be trained with any offline RL losses, with or without planning and various filtering mechanisms. It can also deal with continuous-valued reward scores. Furthermore, <span id="S5.SS0.SSS0.Px3.p1.1.5" class="ltx_ERROR undefined">\rest</span> can perform iterative policy improvement on a fixed dataset with the <span id="S5.SS0.SSS0.Px3.p1.1.6" class="ltx_text ltx_font_typewriter">Improve</span> steps.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Iterated Learning (IL)</h5>

<div id="S5.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px4.p1.1" class="ltx_p">IL is the process where an agent learns its behavior by being exposed to another agent’s behavior, which itself learned it in the same way <cite class="ltx_cite ltx_citemacro_citep">(Kirby et al., <a href="#bib.bib27" title="" class="ltx_ref">2014</a>)</cite>. Recently, this approach was adopted for interactive language learning using deep learning <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib34" title="" class="ltx_ref">2020a</a>, <a href="#bib.bib35" title="" class="ltx_ref">b</a>)</cite>. IL differs from <span id="S5.SS0.SSS0.Px4.p1.1.1" class="ltx_ERROR undefined">\rest</span> as it operates in a multi-agent setting and does not use RL.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Self Imitation Learning (SIL)</h5>

<div id="S5.SS0.SSS0.Px5.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px5.p1.1" class="ltx_p">SIL learns a policy for an off-policy actor-critic algorithm where the policy tries to reproduce the good behaviour demonstrated by the agent <cite class="ltx_cite ltx_citemacro_citep">(Oh et al., <a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>. SIL achieves it by filtering out the unsuccessful trajectories from the replay buffer and training the agent only on the high-reward trajectories. In that sense, <span id="S5.SS0.SSS0.Px5.p1.1.1" class="ltx_ERROR undefined">\rest</span> can be considered to be closely related to the SIL-based approaches. The main difference is that <span id="S5.SS0.SSS0.Px5.p1.1.2" class="ltx_ERROR undefined">\rest</span> is agnostic to the underlying RL algorithm used to train the policy and, unlike SIL, does not necessitate a value function to filter out the unsuccessful trajectories. Also, <span id="S5.SS0.SSS0.Px5.p1.1.3" class="ltx_ERROR undefined">\rest</span> is applied to generative AI settings, which do not require interactions with an environment in an online fashion.
</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px6" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reward ranked Fine-Tuning (RAFT)</h5>

<div id="S5.SS0.SSS0.Px6.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px6.p1.1" class="ltx_p">Concurrently to our work, <cite class="ltx_cite ltx_citemacro_cite">Dong et al. (<a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> proposed RAFT. RAFT can be interpreted as a particular case of <span id="S5.SS0.SSS0.Px6.p1.1.1" class="ltx_ERROR undefined">\rest</span> which uses only one <span id="S5.SS0.SSS0.Px6.p1.1.2" class="ltx_text ltx_font_typewriter">Improve</span> step for each <span id="S5.SS0.SSS0.Px6.p1.1.3" class="ltx_text ltx_font_typewriter">Grow</span> step, and relies on a filtering threshold which is a fixed quantile of the empirical distribution of the rewards of the current samples. The authors reported improvements over BC and PPO on a variety of language modeling and image generation tasks. Our experiments with <span id="S5.SS0.SSS0.Px6.p1.1.4" class="ltx_ERROR undefined">\rest</span> showed that multiple <span id="S5.SS0.SSS0.Px6.p1.1.5" class="ltx_text ltx_font_typewriter">Improve</span> steps with an increasing filtering threshold for one <span id="S5.SS0.SSS0.Px6.p1.1.6" class="ltx_text ltx_font_typewriter">Grow</span> step lead to further performance improvements.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we proposed an algorithm called <span id="S6.p1.1.2" class="ltx_ERROR undefined">\rest</span> which is simple, has minimal hyper-parameters to tune, and is flexible to work with many designs of <span id="S6.p1.1.3" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="S6.p1.1.4" class="ltx_text ltx_font_typewriter">Improve</span> steps. We studied the performance of <span id="S6.p1.1.5" class="ltx_ERROR undefined">\rest</span> in machine translation as robust and established reward models are available for this task. We experimented with different offline RL losses in the <span id="S6.p1.1.6" class="ltx_ERROR undefined">\rest</span> loop, but found BC to perform the best for improving the reward model scores. Multiple steps of NLL training with progressively increasing filtering thresholds in the <span id="S6.p1.1.7" class="ltx_text ltx_font_typewriter">Improve</span> step lead to continuous improvements in the model’s reward on the holdout set. However, improvements in reward model scores do not necessarily reflect human preferences since the reward model is only a proxy for human preferences. The results indicate that one <span id="S6.p1.1.8" class="ltx_text ltx_font_typewriter">Grow</span> step is the best option when considering human evaluation scores, even though rewards continue to grow with more <span id="S6.p1.1.9" class="ltx_text ltx_font_typewriter">Grow</span> steps. To overcome this limitation, the reward models could be fine-tuned on the subset of <span id="S6.p1.1.1" class="ltx_text ltx_font_caligraphic">D<math id="S6.p1.1.1.m1.1" class="ltx_Math" alttext="{{}_{g}}" display="inline"><semantics id="S6.p1.1.1.m1.1a"><msub id="S6.p1.1.1.m1.1.1" xref="S6.p1.1.1.m1.1.1.cmml"><mi id="S6.p1.1.1.m1.1.1a" xref="S6.p1.1.1.m1.1.1.cmml"></mi><mi id="S6.p1.1.1.m1.1.1.1" xref="S6.p1.1.1.m1.1.1.1.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S6.p1.1.1.m1.1b"><apply id="S6.p1.1.1.m1.1.1.cmml" xref="S6.p1.1.1.m1.1.1"><ci id="S6.p1.1.1.m1.1.1.1.cmml" xref="S6.p1.1.1.m1.1.1.1">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.1.m1.1c">{{}_{g}}</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.1.m1.1d">start_FLOATSUBSCRIPT italic_g end_FLOATSUBSCRIPT</annotation></semantics></math></span> annotated with human preferences similar to <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Glaese et al. (<a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>, which we leave as future work. Let us note that the risk of overfitting to the reward model increases with the repeated iterations of the <span id="S6.p1.1.10" class="ltx_text ltx_font_typewriter">Grow</span> steps; thus we believe it is essential to address this issue, especially in cases where multiple <span id="S6.p1.1.11" class="ltx_text ltx_font_typewriter">Grow</span> steps are needed to train the model.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">As we have seen, simple BC loss still outperforms many offline RL losses in terms of aligning the model with the reward model scores. However, we found that BC can overfit to the reward model so we explain it by the fact that learning value functions in RL is challenging due to sparse rewards, credit assignment problems, sensitivity to hyperparameters, and limited exploration in the <span id="S6.p2.1.1" class="ltx_text ltx_font_typewriter">Grow</span> step. <span id="S6.p2.1.2" class="ltx_ERROR undefined">\rest</span> could benefit from better RL exploration strategies at <span id="S6.p2.1.3" class="ltx_text ltx_font_typewriter">Grow</span> step, such as MCTS <cite class="ltx_cite ltx_citemacro_citep">(Leblond et al., <a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>. The ability to exploit the generated data during the <span id="S6.p2.1.4" class="ltx_text ltx_font_typewriter">Grow</span> step could result in a broader exploration of the state-action space and better generalization. Additionally, the determinism of the environment does not allow for large gains over BC for offline RL losses.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">To conclude, <span id="S6.p3.1.1" class="ltx_ERROR undefined">\rest</span> is a general and efficient approach. It can be applied when 1) a robust reward model of human preferences is available and 2) we are able to generate samples from the model at scale. Thus, it can be applied to many tasks within the language domain, such as summarization, turn-based dialogue, and other generative audio and video models. With several avenues for future exploration and applications, we believe that <span id="S6.p3.1.2" class="ltx_ERROR undefined">\rest</span> is a useful growing batch RL methodology for RLHF.</p>
</div>
<section id="S6.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Acknowledgements</h5>

<div id="S6.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S6.SS0.SSS0.Px1.p1.1" class="ltx_p">We would like to thank the members from the machine translation teams at Google and Google DeepMind for their inputs to the project during the brainstorming phases and for setting up the codebase that this project was developed upon <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a href="#bib.bib63" title="" class="ltx_ref">2020</a>)</cite>. We would like to thank Matt Hoffman, Bobak Shahriari, Taylan Cemgil and Chris Dyer for the discussions about this project. We are grateful for the feedback provided by Bilal Piot for an early draft of this paper. We would also like to thank those responsible for various different frameworks that we used during the project such as the DeepMind JAX ecosystem <cite class="ltx_cite ltx_citemacro_citep">(Babuschkin et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite> and Launchpad <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib61" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography" lang="en">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abdolmaleki et al. (2021)</span>
<span class="ltx_bibblock">
A. Abdolmaleki, S. Huang, G. Vezzani, B. Shahriari, J. T. Springenberg,
S. Mishra, D. Tirumala, A. Byravan, K. Bousmalis, A. György, et al.

</span>
<span class="ltx_bibblock">On multi-objective policy optimization as a tool for reinforcement
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.08199</em>, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et al. (2022)</span>
<span class="ltx_bibblock">
R. Agarwal, M. Schwarzer, P. S. Castro, A. Courville, and M. G. Bellemare.

</span>
<span class="ltx_bibblock">Beyond tabula rasa: Reincarnating reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.01626</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anthony (2021)</span>
<span class="ltx_bibblock">
T. W. Anthony.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Expert iteration</em>.

</span>
<span class="ltx_bibblock">PhD thesis, UCL (University College London), 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Babuschkin et al. (2020)</span>
<span class="ltx_bibblock">
I. Babuschkin, K. Baumli, A. Bell, S. Bhupatiraju, J. Bruce, P. Buchlovsky,
D. Budden, T. Cai, A. Clark, I. Danihelka, C. Fantacci, J. Godwin, C. Jones,
R. Hemsley, T. Hennigan, M. Hessel, S. Hou, S. Kapturowski, T. Keck,
I. Kemaev, M. King, M. Kunesch, L. Martens, H. Merzic, V. Mikulik, T. Norman,
J. Quan, G. Papamakarios, R. Ring, F. Ruiz, A. Sanchez, R. Schneider,
E. Sezener, S. Spencer, S. Srinivasan, L. Wang, W. Stokowiec, and F. Viola.

</span>
<span class="ltx_bibblock">The DeepMind JAX Ecosystem, 2020.

</span>
<span class="ltx_bibblock">URL <a href="http://github.com/deepmind" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://github.com/deepmind</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022)</span>
<span class="ltx_bibblock">
Y. Bai, A. Jones, K. Ndousse, A. Askell, A. Chen, N. DasSarma, D. Drain,
S. Fort, D. Ganguli, T. Henighan, et al.

</span>
<span class="ltx_bibblock">Training a helpful and harmless assistant with reinforcement learning
from human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2204.05862</em>, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellman (1957)</span>
<span class="ltx_bibblock">
R. Bellman.

</span>
<span class="ltx_bibblock">A Markovian decision process.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Journal of Mathematics and Mechanics</em>, 6(5):679–684, 1957.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brandfonbrener et al. (2022)</span>
<span class="ltx_bibblock">
D. Brandfonbrener, A. Bietti, J. Buckman, R. Laroche, and J. Bruna.

</span>
<span class="ltx_bibblock">When does return-conditioned supervised learning work for offline
reinforcement learning?

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
35:1542–1553, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal,
A. Neelakantan, P. Shyam, G. Sastry, A. Askell, et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bubeck et al. (2023)</span>
<span class="ltx_bibblock">
S. Bubeck, V. Chandrasekaran, R. Eldan, J. Gehrke, E. Horvitz, E. Kamar,
P. Lee, Y. T. Lee, Y. Li, S. Lundberg, et al.

</span>
<span class="ltx_bibblock">Sparks of artificial general intelligence: Early experiments with
GPT-4.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2303.12712</em>, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cettolo et al. (2014)</span>
<span class="ltx_bibblock">
M. Cettolo, J. Niehues, S. Stüker, L. Bentivogli, and M. Federico.

</span>
<span class="ltx_bibblock">Report on the 11th iwslt evaluation campaign.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 11th International Workshop on Spoken
Language Translation: Evaluation Campaign</em>, 2014.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
L. Chen, K. Lu, A. Rajeswaran, K. Lee, A. Grover, M. Laskin, P. Abbeel,
A. Srinivas, and I. Mordatch.

</span>
<span class="ltx_bibblock">Decision transformer: Reinforcement learning via sequence modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2003)</span>
<span class="ltx_bibblock">
S. Clark, J. R. Curran, and M. Osborne.

</span>
<span class="ltx_bibblock">Bootstrapping pos-taggers using unlabelled data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the seventh conference on Natural language
learning at HLT-NAACL 2003</em>, pages 49–55, 2003.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Donato et al. (2022)</span>
<span class="ltx_bibblock">
D. Donato, L. Yu, W. Ling, and C. Dyer.

</span>
<span class="ltx_bibblock">Mad for robust reinforcement learning in machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2207.08583</em>, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2023)</span>
<span class="ltx_bibblock">
H. Dong, W. Xiong, D. Goyal, R. Pan, S. Diao, J. Zhang, K. Shum, and T. Zhang.

</span>
<span class="ltx_bibblock">Raft: Reward ranked finetuning for generative foundation model
alignment.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2304.06767</em>, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Espeholt et al. (2018)</span>
<span class="ltx_bibblock">
L. Espeholt, H. Soyer, R. Munos, K. Simonyan, V. Mnih, T. Ward, Y. Doron,
V. Firoiu, T. Harley, I. Dunning, S. Legg, and K. Kavukcuoglu.

</span>
<span class="ltx_bibblock">Impala: Scalable distributed deep-rl with importance weighted
actor-learner architectures.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freitag et al. (2021)</span>
<span class="ltx_bibblock">
M. Freitag, R. Rei, N. Mathur, C.-k. Lo, C. Stewart, G. Foster, A. Lavie, and
O. Bojar.

</span>
<span class="ltx_bibblock">Results of the wmt21 metrics shared task: Evaluating metrics with
expert-based human evaluations on ted and news domain.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Sixth Conference on Machine Translation</em>,
pages 733–774, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freitag et al. (2022)</span>
<span class="ltx_bibblock">
M. Freitag, R. Rei, N. Mathur, C.-k. Lo, C. Stewart, E. Avramidis, T. Kocmi,
G. Foster, A. Lavie, and A. F. T. Martins.

</span>
<span class="ltx_bibblock">Results of WMT22 metrics shared task: Stop using BLEU – neural
metrics are better and more robust.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Seventh Conference on Machine Translation
(WMT)</em>, pages 46–68, Abu Dhabi, United Arab Emirates (Hybrid), Dec. 2022.
Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a href="https://aclanthology.org/2022.wmt-1.2" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2022.wmt-1.2</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. (2020)</span>
<span class="ltx_bibblock">
J. Fu, A. Kumar, O. Nachum, G. Tucker, and S. Levine.

</span>
<span class="ltx_bibblock">D4RL: Datasets for deep data-driven reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2004.07219</em>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2022)</span>
<span class="ltx_bibblock">
L. Gao, J. Schulman, and J. Hilton.

</span>
<span class="ltx_bibblock">Scaling laws for reward model overoptimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.10760</em>, 2022.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghorbani et al. (2021)</span>
<span class="ltx_bibblock">
B. Ghorbani, O. Firat, M. Freitag, A. Bapna, M. Krikun, X. Garcia, C. Chelba,
and C. Cherry.

</span>
<span class="ltx_bibblock">Scaling laws for neural machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.07740</em>, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Glaese et al. (2022)</span>
<span class="ltx_bibblock">
A. Glaese, N. McAleese, M. Trębacz, J. Aslanides, V. Firoiu, T. Ewalds,
M. Rauh, L. Weidinger, M. Chadwick, P. Thacker, et al.

</span>
<span class="ltx_bibblock">Improving alignment of dialogue agents via targeted human judgements.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.14375</em>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gulcehre et al. (2021)</span>
<span class="ltx_bibblock">
C. Gulcehre, S. G. Colmenarejo, Z. Wang, J. Sygnowski, T. Paine, K. Zolna,
Y. Chen, M. Hoffman, R. Pascanu, and N. de Freitas.

</span>
<span class="ltx_bibblock">Regularized behavior value estimation.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2103.09575</em>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2019)</span>
<span class="ltx_bibblock">
J. He, J. Gu, J. Shen, and M. Ranzato.

</span>
<span class="ltx_bibblock">Revisiting self-training for neural sequence generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.13788</em>, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et al. (2022)</span>
<span class="ltx_bibblock">
J. Hoffmann, S. Borgeaud, A. Mensch, E. Buchatskaya, T. Cai, E. Rutherford,
D. de Las Casas, L. A. Hendricks, J. Welbl, A. Clark, et al.

</span>
<span class="ltx_bibblock">An empirical analysis of compute-optimal large language model
training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jumper et al. (2021)</span>
<span class="ltx_bibblock">
J. Jumper, R. Evans, A. Pritzel, T. Green, M. Figurnov, O. Ronneberger,
K. Tunyasuvunakool, R. Bates, A. Žídek, A. Potapenko, et al.

</span>
<span class="ltx_bibblock">Highly accurate protein structure prediction with alphafold.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 596(7873):583–589, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jung et al. (2023)</span>
<span class="ltx_bibblock">
J. Jung, P. West, L. Jiang, F. Brahman, X. Lu, J. Fisher, T. Sorensen, and
Y. Choi.

</span>
<span class="ltx_bibblock">Impossible distillation: from low-quality model to high-quality
dataset &amp; model for summarization and paraphrasing.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.16635</em>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirby et al. (2014)</span>
<span class="ltx_bibblock">
S. Kirby, T. Griffiths, and K. Smith.

</span>
<span class="ltx_bibblock">Iterated learning and the evolution of language.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Current Opinion in Neurobiology</em>, 28:108–114, 2014.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koehn et al. (2020)</span>
<span class="ltx_bibblock">
P. Koehn, V. Chaudhary, A. El-Kishky, N. Goyal, P.-J. Chen, and F. Guzmán.

</span>
<span class="ltx_bibblock">Findings of the wmt 2020 shared task on parallel corpus filtering and
alignment.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Fifth Conference on Machine Translation</em>,
pages 726–742, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kudo (2018)</span>
<span class="ltx_bibblock">
T. Kudo.

</span>
<span class="ltx_bibblock">Subword regularization: Improving neural network translation models
with multiple subword candidates.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 56th Annual Meeting of the Association
for Computational Linguistics</em>, pages 66–75, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2021)</span>
<span class="ltx_bibblock">
A. Kumar, J. Hong, A. Singh, and S. Levine.

</span>
<span class="ltx_bibblock">Should i run offline reinforcement learning or behavioral cloning?

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lange et al. (2012)</span>
<span class="ltx_bibblock">
S. Lange, T. Gabel, and M. Riedmiller.

</span>
<span class="ltx_bibblock">Batch reinforcement learning.

</span>
<span class="ltx_bibblock">In M. Wiering and M. van Otterlo, editors, <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Reinforcement
Learning: State-of-the-Art</em>, pages 45–73. Springer Berlin Heidelberg, 2012.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leblond et al. (2021)</span>
<span class="ltx_bibblock">
R. Leblond, J.-B. Alayrac, L. Sifre, M. Pislar, L. Jean-Baptiste,
I. Antonoglou, K. Simonyan, and O. Vinyals.

</span>
<span class="ltx_bibblock">Machine translation decoding beyond beam search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Empirical Methods in
Natural Language Processing</em>, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Y. Li, D. Choi, J. Chung, N. Kushman, J. Schrittwieser, R. Leblond, T. Eccles,
J. Keeling, F. Gimeno, A. Dal Lago, et al.

</span>
<span class="ltx_bibblock">Competition-level code generation with alphacode.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Science</em>, 378(6624):1092–1097, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2020a)</span>
<span class="ltx_bibblock">
Y. Lu, S. Singhal, F. Strub, A. Courville, and O. Pietquin.

</span>
<span class="ltx_bibblock">Countering language drift with seeded iterated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>,
2020a.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2020b)</span>
<span class="ltx_bibblock">
Y. Lu, S. Singhal, F. Strub, O. Pietquin, and A. Courville.

</span>
<span class="ltx_bibblock">Supervised seeded iterated learning for interactive language
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.02975</em>, 2020b.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mathieu et al. (2021)</span>
<span class="ltx_bibblock">
M. Mathieu, S. Ozair, S. Srinivasan, C. Gulcehre, S. Zhang, R. Jiang,
T. Le Paine, K. Zolna, R. Powell, J. Schrittwieser, et al.

</span>
<span class="ltx_bibblock">Starcraft ii unplugged: Large scale offline reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Deep RL Workshop NeurIPS 2021</em>, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al. (2016)</span>
<span class="ltx_bibblock">
V. Mnih, A. P. Badia, M. Mirza, A. Graves, T. Harley, T. P. Lillicrap,
D. Silver, and K. Kavukcuoglu.

</span>
<span class="ltx_bibblock">Asynchronous methods for deep reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2016.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. (2018)</span>
<span class="ltx_bibblock">
J. Oh, Y. Guo, S. Singh, and H. Lee.

</span>
<span class="ltx_bibblock">Self-imitation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pages
3878–3887. PMLR, 2018.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022a)</span>
<span class="ltx_bibblock">
L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. L. Wainwright, P. Mishkin, C. Zhang,
S. Agarwal, K. Slama, A. Ray, J. Schulman, J. Hilton, F. Kelton, L. Miller,
M. Simens, A. Askell, P. Welinder, P. Christiano, J. Leike, and R. Lowe.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback,
2022a.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022b)</span>
<span class="ltx_bibblock">
L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. L. Wainwright, P. Mishkin, C. Zhang,
S. Agarwal, K. Slama, A. Ray, et al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.02155</em>, 2022b.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang and He (2021)</span>
<span class="ltx_bibblock">
R. Y. Pang and H. He.

</span>
<span class="ltx_bibblock">Text generation by learning from demonstrations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez et al. (2022)</span>
<span class="ltx_bibblock">
E. Perez, S. Huang, F. Song, T. Cai, R. Ring, J. Aslanides, A. Glaese,
N. McAleese, and G. Irving.

</span>
<span class="ltx_bibblock">Red teaming language models with language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2202.03286</em>, 2022.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pomerleau (1989)</span>
<span class="ltx_bibblock">
D. A. Pomerleau.

</span>
<span class="ltx_bibblock">ALVINN: An autonomous land vehicle in a neural network.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pages
305–313, 1989.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et al. (2021)</span>
<span class="ltx_bibblock">
J. W. Rae, S. Borgeaud, T. Cai, K. Millican, J. Hoffmann, F. Song,
J. Aslanides, S. Henderson, R. Ring, S. Young, et al.

</span>
<span class="ltx_bibblock">Scaling language models: Methods, analysis &amp; insights from training
gopher.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.11446</em>, 2021.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2023)</span>
<span class="ltx_bibblock">
R. Rafailov, A. Sharma, E. Mitchell, S. Ermon, C. D. Manning, and C. Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a
reward model.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.18290</em>, 2023.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rei et al. (2020)</span>
<span class="ltx_bibblock">
R. Rei, C. Stewart, A. C. Farinha, and A. Lavie.

</span>
<span class="ltx_bibblock">COMET: A neural framework for MT evaluation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Empirical Methods in
Natural Language Processing</em>, 2020.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2017)</span>
<span class="ltx_bibblock">
J. Schulman, F. Wolski, P. Dhariwal, A. Radford, and O. Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scudder (1965)</span>
<span class="ltx_bibblock">
H. Scudder.

</span>
<span class="ltx_bibblock">Probability of error of some adaptive pattern-recognition machines.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Theory</em>, 11(3):363–371, 1965.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sellam et al. (2020)</span>
<span class="ltx_bibblock">
T. Sellam, D. Das, and A. Parikh.

</span>
<span class="ltx_bibblock">BLEURT: Learning robust metrics for text generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 58th Annual Meeting of the Association
for Computational Linguistics</em>, 2020.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shumailov et al. (2023)</span>
<span class="ltx_bibblock">
I. Shumailov, Z. Shumaylov, Y. Zhao, Y. Gal, N. Papernot, and R. Anderson.

</span>
<span class="ltx_bibblock">The curse of recursion: Training on generated data makes models
forget.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arxiv:2305.17493</em>, 2023.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Skalse et al. (2022)</span>
<span class="ltx_bibblock">
J. Skalse, N. H. R. Howe, D. Krasheninnikov, and D. Krueger.

</span>
<span class="ltx_bibblock">Defining and characterizing reward hacking.

</span>
<span class="ltx_bibblock">In <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2020)</span>
<span class="ltx_bibblock">
H. F. Song, A. Abdolmaleki, J. T. Springenberg, A. Clark, H. Soyer, J. W. Rae,
S. Noury, A. Ahuja, S. Liu, D. Tirumala, N. Heess, D. Belov, M. Riedmiller,
and M. M. Botvinick.

</span>
<span class="ltx_bibblock">V-mpo: On-policy maximum a posteriori policy optimization for
discrete and continuous control.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">International Conference of Learning Representations</em>, 2020.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al. (2022)</span>
<span class="ltx_bibblock">
A. Srivastava, A. Rastogi, A. Rao, A. A. M. Shoeb, A. Abid, A. Fisch, A. R.
Brown, A. Santoro, A. Gupta, A. Garriga-Alonso, et al.

</span>
<span class="ltx_bibblock">Beyond the imitation game: Quantifying and extrapolating the
capabilities of language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.04615</em>, 2022.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon et al. (2020)</span>
<span class="ltx_bibblock">
N. Stiennon, L. Ouyang, J. Wu, D. Ziegler, R. Lowe, C. Voss, A. Radford,
D. Amodei, and P. F. Christiano.

</span>
<span class="ltx_bibblock">Learning to summarize with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2020.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
H. Sun, R. Wang, K. Chen, M. Utiyama, E. Sumita, and T. Zhao.

</span>
<span class="ltx_bibblock">Self-training for unsupervised neural machine translation in
unbalanced training data scenarios.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference of the North American Chapter
of the Association for Computational Linguistics: Human Language
Technologies</em>, 2021.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. (2014)</span>
<span class="ltx_bibblock">
I. Sutskever, O. Vinyals, and Q. V. Le.

</span>
<span class="ltx_bibblock">Sequence to sequence learning with neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2014.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Uesato et al. (2022)</span>
<span class="ltx_bibblock">
J. Uesato, N. Kushman, R. Kumar, F. Song, N. Siegel, L. Wang, A. Creswell,
G. Irving, and I. Higgins.

</span>
<span class="ltx_bibblock">Solving math word problems with process-and outcome-based feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.14275</em>, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
J. Wu, L. Ouyang, D. M. Ziegler, N. Stiennon, R. Lowe, J. Leike, and
P. Christiano.

</span>
<span class="ltx_bibblock">Recursively summarizing books with human feedback.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.10862</em>, 2021.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2020)</span>
<span class="ltx_bibblock">
Q. Xie, M.-T. Luong, E. Hovy, and Q. V. Le.

</span>
<span class="ltx_bibblock">Self-training with noisy student improves imagenet classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pages 10687–10698, 2020.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2021)</span>
<span class="ltx_bibblock">
F. Yang, G. Barth-Maron, P. Stańczyk, M. Hoffman, S. Liu, M. Kroiss, A. Pope,
and A. Rrustemi.

</span>
<span class="ltx_bibblock">Launchpad: A programming model for distributed machine learning
research.

</span>
<span class="ltx_bibblock"><em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.04516</em>, 2021.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yarowsky (1995)</span>
<span class="ltx_bibblock">
D. Yarowsky.

</span>
<span class="ltx_bibblock">Unsupervised word sense disambiguation rivaling supervised methods.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">33rd Annual Meeting of the Association for Computational
Linguistics</em>, 1995.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2020)</span>
<span class="ltx_bibblock">
L. Yu, L. Sartran, P.-S. Huang, W. Stokoweic, D. Donato, S. Srinivasan,
A. Andreev, W. Ling, S. Mokra, A. D. Lago, Y. Doron, S. Young, P. Blunsom,
and C. Dyer.

</span>
<span class="ltx_bibblock">The DeepMind chinese–english document translation system at
wmt2020.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Fifth Conference on Machine Translation</em>,
2020.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zelikman et al. (2022)</span>
<span class="ltx_bibblock">
E. Zelikman, Y. Wu, J. Mu, and N. Goodman.

</span>
<span class="ltx_bibblock">Star: Bootstrapping reasoning with reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Zong (2016)</span>
<span class="ltx_bibblock">
J. Zhang and C. Zong.

</span>
<span class="ltx_bibblock">Exploiting source-side monolingual data in neural machine
translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Conference on Empirical Methods in
Natural Language Processing</em>, 2016.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>RLHF for conditional language modeling as MDP</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.4" class="ltx_p">We can formulate conditional language modeling as a sequence to sequence problem. The goal is to map a source sequence <math id="A1.SS1.p1.1.m1.3" class="ltx_Math" alttext="{\bm{x}}=\left(x_{1},x_{2},...x_{L}\right)" display="inline"><semantics id="A1.SS1.p1.1.m1.3a"><mrow id="A1.SS1.p1.1.m1.3.3" xref="A1.SS1.p1.1.m1.3.3.cmml"><mi id="A1.SS1.p1.1.m1.3.3.5" xref="A1.SS1.p1.1.m1.3.3.5.cmml">𝒙</mi><mo id="A1.SS1.p1.1.m1.3.3.4" xref="A1.SS1.p1.1.m1.3.3.4.cmml">=</mo><mrow id="A1.SS1.p1.1.m1.3.3.3.3" xref="A1.SS1.p1.1.m1.3.3.3.4.cmml"><mo id="A1.SS1.p1.1.m1.3.3.3.3.4" xref="A1.SS1.p1.1.m1.3.3.3.4.cmml">(</mo><msub id="A1.SS1.p1.1.m1.1.1.1.1.1" xref="A1.SS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.1.1.1.2.cmml">x</mi><mn id="A1.SS1.p1.1.m1.1.1.1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.SS1.p1.1.m1.3.3.3.3.5" xref="A1.SS1.p1.1.m1.3.3.3.4.cmml">,</mo><msub id="A1.SS1.p1.1.m1.2.2.2.2.2" xref="A1.SS1.p1.1.m1.2.2.2.2.2.cmml"><mi id="A1.SS1.p1.1.m1.2.2.2.2.2.2" xref="A1.SS1.p1.1.m1.2.2.2.2.2.2.cmml">x</mi><mn id="A1.SS1.p1.1.m1.2.2.2.2.2.3" xref="A1.SS1.p1.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A1.SS1.p1.1.m1.3.3.3.3.6" xref="A1.SS1.p1.1.m1.3.3.3.4.cmml">,</mo><mrow id="A1.SS1.p1.1.m1.3.3.3.3.3" xref="A1.SS1.p1.1.m1.3.3.3.3.3.cmml"><mi mathvariant="normal" id="A1.SS1.p1.1.m1.3.3.3.3.3.2" xref="A1.SS1.p1.1.m1.3.3.3.3.3.2.cmml">…</mi><mo id="A1.SS1.p1.1.m1.3.3.3.3.3.1" xref="A1.SS1.p1.1.m1.3.3.3.3.3.1.cmml">⁢</mo><msub id="A1.SS1.p1.1.m1.3.3.3.3.3.3" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3.cmml"><mi id="A1.SS1.p1.1.m1.3.3.3.3.3.3.2" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3.2.cmml">x</mi><mi id="A1.SS1.p1.1.m1.3.3.3.3.3.3.3" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3.3.cmml">L</mi></msub></mrow><mo id="A1.SS1.p1.1.m1.3.3.3.3.7" xref="A1.SS1.p1.1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.3b"><apply id="A1.SS1.p1.1.m1.3.3.cmml" xref="A1.SS1.p1.1.m1.3.3"><eq id="A1.SS1.p1.1.m1.3.3.4.cmml" xref="A1.SS1.p1.1.m1.3.3.4"></eq><ci id="A1.SS1.p1.1.m1.3.3.5.cmml" xref="A1.SS1.p1.1.m1.3.3.5">𝒙</ci><vector id="A1.SS1.p1.1.m1.3.3.3.4.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3"><apply id="A1.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="A1.SS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="A1.SS1.p1.1.m1.2.2.2.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.2.2.2.2.2.1.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p1.1.m1.2.2.2.2.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="A1.SS1.p1.1.m1.2.2.2.2.2.3.cmml" xref="A1.SS1.p1.1.m1.2.2.2.2.2.3">2</cn></apply><apply id="A1.SS1.p1.1.m1.3.3.3.3.3.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3"><times id="A1.SS1.p1.1.m1.3.3.3.3.3.1.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3.1"></times><ci id="A1.SS1.p1.1.m1.3.3.3.3.3.2.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3.2">…</ci><apply id="A1.SS1.p1.1.m1.3.3.3.3.3.3.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.3.3.3.3.3.3.1.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="A1.SS1.p1.1.m1.3.3.3.3.3.3.2.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3.2">𝑥</ci><ci id="A1.SS1.p1.1.m1.3.3.3.3.3.3.3.cmml" xref="A1.SS1.p1.1.m1.3.3.3.3.3.3.3">𝐿</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.3c">{\bm{x}}=\left(x_{1},x_{2},...x_{L}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.3d">bold_italic_x = ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … italic_x start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math> into a target sequence <math id="A1.SS1.p1.2.m2.1" class="ltx_math_unparsed" alttext="{\bm{y}}=\left(y_{1},y_{2},....y_{T}\right)" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mrow id="A1.SS1.p1.2.m2.1b"><mi id="A1.SS1.p1.2.m2.1.2">𝒚</mi><mo id="A1.SS1.p1.2.m2.1.3">=</mo><mrow id="A1.SS1.p1.2.m2.1.4"><mo id="A1.SS1.p1.2.m2.1.4.1">(</mo><msub id="A1.SS1.p1.2.m2.1.4.2"><mi id="A1.SS1.p1.2.m2.1.4.2.2">y</mi><mn id="A1.SS1.p1.2.m2.1.4.2.3">1</mn></msub><mo id="A1.SS1.p1.2.m2.1.4.3">,</mo><msub id="A1.SS1.p1.2.m2.1.4.4"><mi id="A1.SS1.p1.2.m2.1.4.4.2">y</mi><mn id="A1.SS1.p1.2.m2.1.4.4.3">2</mn></msub><mo id="A1.SS1.p1.2.m2.1.4.5">,</mo><mi mathvariant="normal" id="A1.SS1.p1.2.m2.1.1">…</mi><mo lspace="0em" rspace="0.167em" id="A1.SS1.p1.2.m2.1.4.6">.</mo><msub id="A1.SS1.p1.2.m2.1.4.7"><mi id="A1.SS1.p1.2.m2.1.4.7.2">y</mi><mi id="A1.SS1.p1.2.m2.1.4.7.3">T</mi></msub><mo id="A1.SS1.p1.2.m2.1.4.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">{\bm{y}}=\left(y_{1},y_{2},....y_{T}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.2.m2.1d">bold_italic_y = ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … . italic_y start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math>, that is to learn a mapping from <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="{\bm{x}}" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><mi id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><ci id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.3.m3.1d">bold_italic_x</annotation></semantics></math> to <math id="A1.SS1.p1.4.m4.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="A1.SS1.p1.4.m4.1a"><mi id="A1.SS1.p1.4.m4.1.1" xref="A1.SS1.p1.4.m4.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m4.1b"><ci id="A1.SS1.p1.4.m4.1.1.cmml" xref="A1.SS1.p1.4.m4.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m4.1c">{\bm{y}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.4.m4.1d">bold_italic_y</annotation></semantics></math>. Machine translation is a classic example of a sequence to sequence problem <cite class="ltx_cite ltx_citemacro_citep">(Sutskever et al., <a href="#bib.bib56" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.11" class="ltx_p">The model can be described as a Markov Decision Process (MDP) <cite class="ltx_cite ltx_citemacro_citep">(Bellman, <a href="#bib.bib6" title="" class="ltx_ref">1957</a>)</cite>. An MDP, <math id="A1.SS1.p2.1.m1.5" class="ltx_Math" alttext="{\mathcal{M}}\stackrel{{\scriptstyle\text{def}}}{{=}}({\mathcal{S}},{\mathcal{A}},T,r,d)" display="inline"><semantics id="A1.SS1.p2.1.m1.5a"><mrow id="A1.SS1.p2.1.m1.5.6" xref="A1.SS1.p2.1.m1.5.6.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.1.m1.5.6.2" xref="A1.SS1.p2.1.m1.5.6.2.cmml">ℳ</mi><mover id="A1.SS1.p2.1.m1.5.6.1" xref="A1.SS1.p2.1.m1.5.6.1.cmml"><mo id="A1.SS1.p2.1.m1.5.6.1.2" xref="A1.SS1.p2.1.m1.5.6.1.2.cmml">=</mo><mtext id="A1.SS1.p2.1.m1.5.6.1.3" xref="A1.SS1.p2.1.m1.5.6.1.3a.cmml">def</mtext></mover><mrow id="A1.SS1.p2.1.m1.5.6.3.2" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="A1.SS1.p2.1.m1.5.6.3.2.1" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.1.m1.1.1" xref="A1.SS1.p2.1.m1.1.1.cmml">𝒮</mi><mo id="A1.SS1.p2.1.m1.5.6.3.2.2" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.1.m1.2.2" xref="A1.SS1.p2.1.m1.2.2.cmml">𝒜</mi><mo id="A1.SS1.p2.1.m1.5.6.3.2.3" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">,</mo><mi id="A1.SS1.p2.1.m1.3.3" xref="A1.SS1.p2.1.m1.3.3.cmml">T</mi><mo id="A1.SS1.p2.1.m1.5.6.3.2.4" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">,</mo><mi id="A1.SS1.p2.1.m1.4.4" xref="A1.SS1.p2.1.m1.4.4.cmml">r</mi><mo id="A1.SS1.p2.1.m1.5.6.3.2.5" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">,</mo><mi id="A1.SS1.p2.1.m1.5.5" xref="A1.SS1.p2.1.m1.5.5.cmml">d</mi><mo stretchy="false" id="A1.SS1.p2.1.m1.5.6.3.2.6" xref="A1.SS1.p2.1.m1.5.6.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.1.m1.5b"><apply id="A1.SS1.p2.1.m1.5.6.cmml" xref="A1.SS1.p2.1.m1.5.6"><apply id="A1.SS1.p2.1.m1.5.6.1.cmml" xref="A1.SS1.p2.1.m1.5.6.1"><csymbol cd="ambiguous" id="A1.SS1.p2.1.m1.5.6.1.1.cmml" xref="A1.SS1.p2.1.m1.5.6.1">superscript</csymbol><eq id="A1.SS1.p2.1.m1.5.6.1.2.cmml" xref="A1.SS1.p2.1.m1.5.6.1.2"></eq><ci id="A1.SS1.p2.1.m1.5.6.1.3a.cmml" xref="A1.SS1.p2.1.m1.5.6.1.3"><mtext mathsize="70%" id="A1.SS1.p2.1.m1.5.6.1.3.cmml" xref="A1.SS1.p2.1.m1.5.6.1.3">def</mtext></ci></apply><ci id="A1.SS1.p2.1.m1.5.6.2.cmml" xref="A1.SS1.p2.1.m1.5.6.2">ℳ</ci><vector id="A1.SS1.p2.1.m1.5.6.3.1.cmml" xref="A1.SS1.p2.1.m1.5.6.3.2"><ci id="A1.SS1.p2.1.m1.1.1.cmml" xref="A1.SS1.p2.1.m1.1.1">𝒮</ci><ci id="A1.SS1.p2.1.m1.2.2.cmml" xref="A1.SS1.p2.1.m1.2.2">𝒜</ci><ci id="A1.SS1.p2.1.m1.3.3.cmml" xref="A1.SS1.p2.1.m1.3.3">𝑇</ci><ci id="A1.SS1.p2.1.m1.4.4.cmml" xref="A1.SS1.p2.1.m1.4.4">𝑟</ci><ci id="A1.SS1.p2.1.m1.5.5.cmml" xref="A1.SS1.p2.1.m1.5.5">𝑑</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.1.m1.5c">{\mathcal{M}}\stackrel{{\scriptstyle\text{def}}}{{=}}({\mathcal{S}},{\mathcal{A}},T,r,d)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.1.m1.5d">caligraphic_M start_RELOP SUPERSCRIPTOP start_ARG = end_ARG start_ARG def end_ARG end_RELOP ( caligraphic_S , caligraphic_A , italic_T , italic_r , italic_d )</annotation></semantics></math>, consists of finite sets of states <math id="A1.SS1.p2.2.m2.1" class="ltx_Math" alttext="{\mathcal{S}}" display="inline"><semantics id="A1.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.2.m2.1.1" xref="A1.SS1.p2.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.2.m2.1b"><ci id="A1.SS1.p2.2.m2.1.1.cmml" xref="A1.SS1.p2.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.2.m2.1c">{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.2.m2.1d">caligraphic_S</annotation></semantics></math> and actions <math id="A1.SS1.p2.3.m3.1" class="ltx_Math" alttext="{\mathcal{A}}" display="inline"><semantics id="A1.SS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.3.m3.1.1" xref="A1.SS1.p2.3.m3.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.3.m3.1b"><ci id="A1.SS1.p2.3.m3.1.1.cmml" xref="A1.SS1.p2.3.m3.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.3.m3.1c">{\mathcal{A}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.3.m3.1d">caligraphic_A</annotation></semantics></math>, a transition distribution <math id="A1.SS1.p2.4.m4.5" class="ltx_Math" alttext="T(s^{\prime}|s,a),s,s^{\prime}\in{\mathcal{S}},a\in{\mathcal{A}}" display="inline"><semantics id="A1.SS1.p2.4.m4.5a"><mrow id="A1.SS1.p2.4.m4.5.5.2" xref="A1.SS1.p2.4.m4.5.5.3.cmml"><mrow id="A1.SS1.p2.4.m4.4.4.1.1" xref="A1.SS1.p2.4.m4.4.4.1.1.cmml"><mrow id="A1.SS1.p2.4.m4.4.4.1.1.2.2" xref="A1.SS1.p2.4.m4.4.4.1.1.2.3.cmml"><mrow id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.cmml"><mi id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.3" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.3.cmml">T</mi><mo id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.2" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.2" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml"><msup id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.2" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.3" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.1" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.3.2" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.3.1.cmml"><mi id="A1.SS1.p2.4.m4.1.1" xref="A1.SS1.p2.4.m4.1.1.cmml">s</mi><mo id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.3.2.1" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A1.SS1.p2.4.m4.2.2" xref="A1.SS1.p2.4.m4.2.2.cmml">a</mi></mrow></mrow><mo stretchy="false" id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.3" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS1.p2.4.m4.4.4.1.1.2.2.3" xref="A1.SS1.p2.4.m4.4.4.1.1.2.3.cmml">,</mo><mi id="A1.SS1.p2.4.m4.3.3" xref="A1.SS1.p2.4.m4.3.3.cmml">s</mi><mo id="A1.SS1.p2.4.m4.4.4.1.1.2.2.4" xref="A1.SS1.p2.4.m4.4.4.1.1.2.3.cmml">,</mo><msup id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.cmml"><mi id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.2" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.2.cmml">s</mi><mo id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.3" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.3.cmml">′</mo></msup></mrow><mo id="A1.SS1.p2.4.m4.4.4.1.1.3" xref="A1.SS1.p2.4.m4.4.4.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.4.m4.4.4.1.1.4" xref="A1.SS1.p2.4.m4.4.4.1.1.4.cmml">𝒮</mi></mrow><mo id="A1.SS1.p2.4.m4.5.5.2.3" xref="A1.SS1.p2.4.m4.5.5.3a.cmml">,</mo><mrow id="A1.SS1.p2.4.m4.5.5.2.2" xref="A1.SS1.p2.4.m4.5.5.2.2.cmml"><mi id="A1.SS1.p2.4.m4.5.5.2.2.2" xref="A1.SS1.p2.4.m4.5.5.2.2.2.cmml">a</mi><mo id="A1.SS1.p2.4.m4.5.5.2.2.1" xref="A1.SS1.p2.4.m4.5.5.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.4.m4.5.5.2.2.3" xref="A1.SS1.p2.4.m4.5.5.2.2.3.cmml">𝒜</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.4.m4.5b"><apply id="A1.SS1.p2.4.m4.5.5.3.cmml" xref="A1.SS1.p2.4.m4.5.5.2"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m4.5.5.3a.cmml" xref="A1.SS1.p2.4.m4.5.5.2.3">formulae-sequence</csymbol><apply id="A1.SS1.p2.4.m4.4.4.1.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1"><in id="A1.SS1.p2.4.m4.4.4.1.1.3.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.3"></in><list id="A1.SS1.p2.4.m4.4.4.1.1.2.3.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2"><apply id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1"><times id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.2"></times><ci id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.3">𝑇</ci><apply id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.2.3">′</ci></apply><list id="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.1.1.1.1.1.1.3.2"><ci id="A1.SS1.p2.4.m4.1.1.cmml" xref="A1.SS1.p2.4.m4.1.1">𝑠</ci><ci id="A1.SS1.p2.4.m4.2.2.cmml" xref="A1.SS1.p2.4.m4.2.2">𝑎</ci></list></apply></apply><ci id="A1.SS1.p2.4.m4.3.3.cmml" xref="A1.SS1.p2.4.m4.3.3">𝑠</ci><apply id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.1.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2">superscript</csymbol><ci id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.2.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.2">𝑠</ci><ci id="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.3.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.2.2.2.3">′</ci></apply></list><ci id="A1.SS1.p2.4.m4.4.4.1.1.4.cmml" xref="A1.SS1.p2.4.m4.4.4.1.1.4">𝒮</ci></apply><apply id="A1.SS1.p2.4.m4.5.5.2.2.cmml" xref="A1.SS1.p2.4.m4.5.5.2.2"><in id="A1.SS1.p2.4.m4.5.5.2.2.1.cmml" xref="A1.SS1.p2.4.m4.5.5.2.2.1"></in><ci id="A1.SS1.p2.4.m4.5.5.2.2.2.cmml" xref="A1.SS1.p2.4.m4.5.5.2.2.2">𝑎</ci><ci id="A1.SS1.p2.4.m4.5.5.2.2.3.cmml" xref="A1.SS1.p2.4.m4.5.5.2.2.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.4.m4.5c">T(s^{\prime}|s,a),s,s^{\prime}\in{\mathcal{S}},a\in{\mathcal{A}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.4.m4.5d">italic_T ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_s , italic_a ) , italic_s , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ caligraphic_S , italic_a ∈ caligraphic_A</annotation></semantics></math>, a reward function <math id="A1.SS1.p2.5.m5.1" class="ltx_Math" alttext="r:{\mathcal{S}}\times{\mathcal{A}}\rightarrow\mathbb{R}" display="inline"><semantics id="A1.SS1.p2.5.m5.1a"><mrow id="A1.SS1.p2.5.m5.1.1" xref="A1.SS1.p2.5.m5.1.1.cmml"><mi id="A1.SS1.p2.5.m5.1.1.2" xref="A1.SS1.p2.5.m5.1.1.2.cmml">r</mi><mo lspace="0.278em" rspace="0.278em" id="A1.SS1.p2.5.m5.1.1.1" xref="A1.SS1.p2.5.m5.1.1.1.cmml">:</mo><mrow id="A1.SS1.p2.5.m5.1.1.3" xref="A1.SS1.p2.5.m5.1.1.3.cmml"><mrow id="A1.SS1.p2.5.m5.1.1.3.2" xref="A1.SS1.p2.5.m5.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.5.m5.1.1.3.2.2" xref="A1.SS1.p2.5.m5.1.1.3.2.2.cmml">𝒮</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.p2.5.m5.1.1.3.2.1" xref="A1.SS1.p2.5.m5.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.5.m5.1.1.3.2.3" xref="A1.SS1.p2.5.m5.1.1.3.2.3.cmml">𝒜</mi></mrow><mo stretchy="false" id="A1.SS1.p2.5.m5.1.1.3.1" xref="A1.SS1.p2.5.m5.1.1.3.1.cmml">→</mo><mi id="A1.SS1.p2.5.m5.1.1.3.3" xref="A1.SS1.p2.5.m5.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.5.m5.1b"><apply id="A1.SS1.p2.5.m5.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1"><ci id="A1.SS1.p2.5.m5.1.1.1.cmml" xref="A1.SS1.p2.5.m5.1.1.1">:</ci><ci id="A1.SS1.p2.5.m5.1.1.2.cmml" xref="A1.SS1.p2.5.m5.1.1.2">𝑟</ci><apply id="A1.SS1.p2.5.m5.1.1.3.cmml" xref="A1.SS1.p2.5.m5.1.1.3"><ci id="A1.SS1.p2.5.m5.1.1.3.1.cmml" xref="A1.SS1.p2.5.m5.1.1.3.1">→</ci><apply id="A1.SS1.p2.5.m5.1.1.3.2.cmml" xref="A1.SS1.p2.5.m5.1.1.3.2"><times id="A1.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="A1.SS1.p2.5.m5.1.1.3.2.1"></times><ci id="A1.SS1.p2.5.m5.1.1.3.2.2.cmml" xref="A1.SS1.p2.5.m5.1.1.3.2.2">𝒮</ci><ci id="A1.SS1.p2.5.m5.1.1.3.2.3.cmml" xref="A1.SS1.p2.5.m5.1.1.3.2.3">𝒜</ci></apply><ci id="A1.SS1.p2.5.m5.1.1.3.3.cmml" xref="A1.SS1.p2.5.m5.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.5.m5.1c">r:{\mathcal{S}}\times{\mathcal{A}}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.5.m5.1d">italic_r : caligraphic_S × caligraphic_A → blackboard_R</annotation></semantics></math>, and an initial state distribution <math id="A1.SS1.p2.6.m6.2" class="ltx_Math" alttext="d:{\mathcal{S}}\rightarrow[0,1]" display="inline"><semantics id="A1.SS1.p2.6.m6.2a"><mrow id="A1.SS1.p2.6.m6.2.3" xref="A1.SS1.p2.6.m6.2.3.cmml"><mi id="A1.SS1.p2.6.m6.2.3.2" xref="A1.SS1.p2.6.m6.2.3.2.cmml">d</mi><mo lspace="0.278em" rspace="0.278em" id="A1.SS1.p2.6.m6.2.3.1" xref="A1.SS1.p2.6.m6.2.3.1.cmml">:</mo><mrow id="A1.SS1.p2.6.m6.2.3.3" xref="A1.SS1.p2.6.m6.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.6.m6.2.3.3.2" xref="A1.SS1.p2.6.m6.2.3.3.2.cmml">𝒮</mi><mo stretchy="false" id="A1.SS1.p2.6.m6.2.3.3.1" xref="A1.SS1.p2.6.m6.2.3.3.1.cmml">→</mo><mrow id="A1.SS1.p2.6.m6.2.3.3.3.2" xref="A1.SS1.p2.6.m6.2.3.3.3.1.cmml"><mo stretchy="false" id="A1.SS1.p2.6.m6.2.3.3.3.2.1" xref="A1.SS1.p2.6.m6.2.3.3.3.1.cmml">[</mo><mn id="A1.SS1.p2.6.m6.1.1" xref="A1.SS1.p2.6.m6.1.1.cmml">0</mn><mo id="A1.SS1.p2.6.m6.2.3.3.3.2.2" xref="A1.SS1.p2.6.m6.2.3.3.3.1.cmml">,</mo><mn id="A1.SS1.p2.6.m6.2.2" xref="A1.SS1.p2.6.m6.2.2.cmml">1</mn><mo stretchy="false" id="A1.SS1.p2.6.m6.2.3.3.3.2.3" xref="A1.SS1.p2.6.m6.2.3.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.6.m6.2b"><apply id="A1.SS1.p2.6.m6.2.3.cmml" xref="A1.SS1.p2.6.m6.2.3"><ci id="A1.SS1.p2.6.m6.2.3.1.cmml" xref="A1.SS1.p2.6.m6.2.3.1">:</ci><ci id="A1.SS1.p2.6.m6.2.3.2.cmml" xref="A1.SS1.p2.6.m6.2.3.2">𝑑</ci><apply id="A1.SS1.p2.6.m6.2.3.3.cmml" xref="A1.SS1.p2.6.m6.2.3.3"><ci id="A1.SS1.p2.6.m6.2.3.3.1.cmml" xref="A1.SS1.p2.6.m6.2.3.3.1">→</ci><ci id="A1.SS1.p2.6.m6.2.3.3.2.cmml" xref="A1.SS1.p2.6.m6.2.3.3.2">𝒮</ci><interval closure="closed" id="A1.SS1.p2.6.m6.2.3.3.3.1.cmml" xref="A1.SS1.p2.6.m6.2.3.3.3.2"><cn type="integer" id="A1.SS1.p2.6.m6.1.1.cmml" xref="A1.SS1.p2.6.m6.1.1">0</cn><cn type="integer" id="A1.SS1.p2.6.m6.2.2.cmml" xref="A1.SS1.p2.6.m6.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.6.m6.2c">d:{\mathcal{S}}\rightarrow[0,1]</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.6.m6.2d">italic_d : caligraphic_S → [ 0 , 1 ]</annotation></semantics></math>. In the offline setting the agent learns from a dataset <math id="A1.SS1.p2.7.m7.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="A1.SS1.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.7.m7.1.1" xref="A1.SS1.p2.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.7.m7.1b"><ci id="A1.SS1.p2.7.m7.1.1.cmml" xref="A1.SS1.p2.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.7.m7.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.7.m7.1d">caligraphic_D</annotation></semantics></math> which contains sequences <math id="A1.SS1.p2.8.m8.3" class="ltx_Math" alttext="\left(s_{n},a_{n},r_{n+1}\right)" display="inline"><semantics id="A1.SS1.p2.8.m8.3a"><mrow id="A1.SS1.p2.8.m8.3.3.3" xref="A1.SS1.p2.8.m8.3.3.4.cmml"><mo id="A1.SS1.p2.8.m8.3.3.3.4" xref="A1.SS1.p2.8.m8.3.3.4.cmml">(</mo><msub id="A1.SS1.p2.8.m8.1.1.1.1" xref="A1.SS1.p2.8.m8.1.1.1.1.cmml"><mi id="A1.SS1.p2.8.m8.1.1.1.1.2" xref="A1.SS1.p2.8.m8.1.1.1.1.2.cmml">s</mi><mi id="A1.SS1.p2.8.m8.1.1.1.1.3" xref="A1.SS1.p2.8.m8.1.1.1.1.3.cmml">n</mi></msub><mo id="A1.SS1.p2.8.m8.3.3.3.5" xref="A1.SS1.p2.8.m8.3.3.4.cmml">,</mo><msub id="A1.SS1.p2.8.m8.2.2.2.2" xref="A1.SS1.p2.8.m8.2.2.2.2.cmml"><mi id="A1.SS1.p2.8.m8.2.2.2.2.2" xref="A1.SS1.p2.8.m8.2.2.2.2.2.cmml">a</mi><mi id="A1.SS1.p2.8.m8.2.2.2.2.3" xref="A1.SS1.p2.8.m8.2.2.2.2.3.cmml">n</mi></msub><mo id="A1.SS1.p2.8.m8.3.3.3.6" xref="A1.SS1.p2.8.m8.3.3.4.cmml">,</mo><msub id="A1.SS1.p2.8.m8.3.3.3.3" xref="A1.SS1.p2.8.m8.3.3.3.3.cmml"><mi id="A1.SS1.p2.8.m8.3.3.3.3.2" xref="A1.SS1.p2.8.m8.3.3.3.3.2.cmml">r</mi><mrow id="A1.SS1.p2.8.m8.3.3.3.3.3" xref="A1.SS1.p2.8.m8.3.3.3.3.3.cmml"><mi id="A1.SS1.p2.8.m8.3.3.3.3.3.2" xref="A1.SS1.p2.8.m8.3.3.3.3.3.2.cmml">n</mi><mo id="A1.SS1.p2.8.m8.3.3.3.3.3.1" xref="A1.SS1.p2.8.m8.3.3.3.3.3.1.cmml">+</mo><mn id="A1.SS1.p2.8.m8.3.3.3.3.3.3" xref="A1.SS1.p2.8.m8.3.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS1.p2.8.m8.3.3.3.7" xref="A1.SS1.p2.8.m8.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.8.m8.3b"><vector id="A1.SS1.p2.8.m8.3.3.4.cmml" xref="A1.SS1.p2.8.m8.3.3.3"><apply id="A1.SS1.p2.8.m8.1.1.1.1.cmml" xref="A1.SS1.p2.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m8.1.1.1.1.1.cmml" xref="A1.SS1.p2.8.m8.1.1.1.1">subscript</csymbol><ci id="A1.SS1.p2.8.m8.1.1.1.1.2.cmml" xref="A1.SS1.p2.8.m8.1.1.1.1.2">𝑠</ci><ci id="A1.SS1.p2.8.m8.1.1.1.1.3.cmml" xref="A1.SS1.p2.8.m8.1.1.1.1.3">𝑛</ci></apply><apply id="A1.SS1.p2.8.m8.2.2.2.2.cmml" xref="A1.SS1.p2.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m8.2.2.2.2.1.cmml" xref="A1.SS1.p2.8.m8.2.2.2.2">subscript</csymbol><ci id="A1.SS1.p2.8.m8.2.2.2.2.2.cmml" xref="A1.SS1.p2.8.m8.2.2.2.2.2">𝑎</ci><ci id="A1.SS1.p2.8.m8.2.2.2.2.3.cmml" xref="A1.SS1.p2.8.m8.2.2.2.2.3">𝑛</ci></apply><apply id="A1.SS1.p2.8.m8.3.3.3.3.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3"><csymbol cd="ambiguous" id="A1.SS1.p2.8.m8.3.3.3.3.1.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3">subscript</csymbol><ci id="A1.SS1.p2.8.m8.3.3.3.3.2.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3.2">𝑟</ci><apply id="A1.SS1.p2.8.m8.3.3.3.3.3.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3.3"><plus id="A1.SS1.p2.8.m8.3.3.3.3.3.1.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3.3.1"></plus><ci id="A1.SS1.p2.8.m8.3.3.3.3.3.2.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3.3.2">𝑛</ci><cn type="integer" id="A1.SS1.p2.8.m8.3.3.3.3.3.3.cmml" xref="A1.SS1.p2.8.m8.3.3.3.3.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.8.m8.3c">\left(s_{n},a_{n},r_{n+1}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.8.m8.3d">( italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. The dataset <math id="A1.SS1.p2.9.m9.1" class="ltx_Math" alttext="{\cal D}" display="inline"><semantics id="A1.SS1.p2.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p2.9.m9.1.1" xref="A1.SS1.p2.9.m9.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.9.m9.1b"><ci id="A1.SS1.p2.9.m9.1.1.cmml" xref="A1.SS1.p2.9.m9.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.9.m9.1c">{\cal D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.9.m9.1d">caligraphic_D</annotation></semantics></math> is often assumed to be generated by an unknown <span id="A1.SS1.p2.11.1" class="ltx_text ltx_font_italic">behaviour policy</span> <math id="A1.SS1.p2.10.m10.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A1.SS1.p2.10.m10.1a"><mi id="A1.SS1.p2.10.m10.1.1" xref="A1.SS1.p2.10.m10.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.10.m10.1b"><ci id="A1.SS1.p2.10.m10.1.1.cmml" xref="A1.SS1.p2.10.m10.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.10.m10.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.10.m10.1d">italic_μ</annotation></semantics></math> characterised by a distribution over actions conditioned on the state: <math id="A1.SS1.p2.11.m11.1" class="ltx_Math" alttext="\mu(a|s)" display="inline"><semantics id="A1.SS1.p2.11.m11.1a"><mrow id="A1.SS1.p2.11.m11.1.1" xref="A1.SS1.p2.11.m11.1.1.cmml"><mi id="A1.SS1.p2.11.m11.1.1.3" xref="A1.SS1.p2.11.m11.1.1.3.cmml">μ</mi><mo id="A1.SS1.p2.11.m11.1.1.2" xref="A1.SS1.p2.11.m11.1.1.2.cmml">⁢</mo><mrow id="A1.SS1.p2.11.m11.1.1.1.1" xref="A1.SS1.p2.11.m11.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.p2.11.m11.1.1.1.1.2" xref="A1.SS1.p2.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.p2.11.m11.1.1.1.1.1" xref="A1.SS1.p2.11.m11.1.1.1.1.1.cmml"><mi id="A1.SS1.p2.11.m11.1.1.1.1.1.2" xref="A1.SS1.p2.11.m11.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.SS1.p2.11.m11.1.1.1.1.1.1" xref="A1.SS1.p2.11.m11.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS1.p2.11.m11.1.1.1.1.1.3" xref="A1.SS1.p2.11.m11.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="A1.SS1.p2.11.m11.1.1.1.1.3" xref="A1.SS1.p2.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p2.11.m11.1b"><apply id="A1.SS1.p2.11.m11.1.1.cmml" xref="A1.SS1.p2.11.m11.1.1"><times id="A1.SS1.p2.11.m11.1.1.2.cmml" xref="A1.SS1.p2.11.m11.1.1.2"></times><ci id="A1.SS1.p2.11.m11.1.1.3.cmml" xref="A1.SS1.p2.11.m11.1.1.3">𝜇</ci><apply id="A1.SS1.p2.11.m11.1.1.1.1.1.cmml" xref="A1.SS1.p2.11.m11.1.1.1.1"><csymbol cd="latexml" id="A1.SS1.p2.11.m11.1.1.1.1.1.1.cmml" xref="A1.SS1.p2.11.m11.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS1.p2.11.m11.1.1.1.1.1.2.cmml" xref="A1.SS1.p2.11.m11.1.1.1.1.1.2">𝑎</ci><ci id="A1.SS1.p2.11.m11.1.1.1.1.1.3.cmml" xref="A1.SS1.p2.11.m11.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p2.11.m11.1c">\mu(a|s)</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p2.11.m11.1d">italic_μ ( italic_a | italic_s )</annotation></semantics></math>. The elements of MDP have the following meaning in conditional language modeling:</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.4" class="ltx_p"><span id="A1.I1.i1.p1.4.1" class="ltx_text ltx_font_bold">States</span> (<math id="A1.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="A1.I1.i1.p1.1.m1.1a"><mi id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><ci id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">italic_s</annotation></semantics></math>): The state <math id="A1.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="s_{n}" display="inline"><semantics id="A1.I1.i1.p1.2.m2.1a"><msub id="A1.I1.i1.p1.2.m2.1.1" xref="A1.I1.i1.p1.2.m2.1.1.cmml"><mi id="A1.I1.i1.p1.2.m2.1.1.2" xref="A1.I1.i1.p1.2.m2.1.1.2.cmml">s</mi><mi id="A1.I1.i1.p1.2.m2.1.1.3" xref="A1.I1.i1.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.2.m2.1b"><apply id="A1.I1.i1.p1.2.m2.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.1.1.2.cmml" xref="A1.I1.i1.p1.2.m2.1.1.2">𝑠</ci><ci id="A1.I1.i1.p1.2.m2.1.1.3.cmml" xref="A1.I1.i1.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.2.m2.1c">s_{n}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> consists of the input sequence and the partially generated output up to the <math id="A1.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="A1.I1.i1.p1.3.m3.1a"><mi id="A1.I1.i1.p1.3.m3.1.1" xref="A1.I1.i1.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.3.m3.1b"><ci id="A1.I1.i1.p1.3.m3.1.1.cmml" xref="A1.I1.i1.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.3.m3.1d">italic_n</annotation></semantics></math>-th token: <math id="A1.I1.i1.p1.4.m4.2" class="ltx_Math" alttext="s_{n}=[{\bm{x}},{\bm{y}}_{1:n-1}]" display="inline"><semantics id="A1.I1.i1.p1.4.m4.2a"><mrow id="A1.I1.i1.p1.4.m4.2.2" xref="A1.I1.i1.p1.4.m4.2.2.cmml"><msub id="A1.I1.i1.p1.4.m4.2.2.3" xref="A1.I1.i1.p1.4.m4.2.2.3.cmml"><mi id="A1.I1.i1.p1.4.m4.2.2.3.2" xref="A1.I1.i1.p1.4.m4.2.2.3.2.cmml">s</mi><mi id="A1.I1.i1.p1.4.m4.2.2.3.3" xref="A1.I1.i1.p1.4.m4.2.2.3.3.cmml">n</mi></msub><mo id="A1.I1.i1.p1.4.m4.2.2.2" xref="A1.I1.i1.p1.4.m4.2.2.2.cmml">=</mo><mrow id="A1.I1.i1.p1.4.m4.2.2.1.1" xref="A1.I1.i1.p1.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="A1.I1.i1.p1.4.m4.2.2.1.1.2" xref="A1.I1.i1.p1.4.m4.2.2.1.2.cmml">[</mo><mi id="A1.I1.i1.p1.4.m4.1.1" xref="A1.I1.i1.p1.4.m4.1.1.cmml">𝒙</mi><mo id="A1.I1.i1.p1.4.m4.2.2.1.1.3" xref="A1.I1.i1.p1.4.m4.2.2.1.2.cmml">,</mo><msub id="A1.I1.i1.p1.4.m4.2.2.1.1.1" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.cmml"><mi id="A1.I1.i1.p1.4.m4.2.2.1.1.1.2" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.2.cmml">𝒚</mi><mrow id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.cmml"><mn id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.2" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.1" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.1.cmml">:</mo><mrow id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.cmml"><mi id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.2" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.2.cmml">n</mi><mo id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.1" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.3" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="A1.I1.i1.p1.4.m4.2.2.1.1.4" xref="A1.I1.i1.p1.4.m4.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.4.m4.2b"><apply id="A1.I1.i1.p1.4.m4.2.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2"><eq id="A1.I1.i1.p1.4.m4.2.2.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2.2"></eq><apply id="A1.I1.i1.p1.4.m4.2.2.3.cmml" xref="A1.I1.i1.p1.4.m4.2.2.3"><csymbol cd="ambiguous" id="A1.I1.i1.p1.4.m4.2.2.3.1.cmml" xref="A1.I1.i1.p1.4.m4.2.2.3">subscript</csymbol><ci id="A1.I1.i1.p1.4.m4.2.2.3.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2.3.2">𝑠</ci><ci id="A1.I1.i1.p1.4.m4.2.2.3.3.cmml" xref="A1.I1.i1.p1.4.m4.2.2.3.3">𝑛</ci></apply><interval closure="closed" id="A1.I1.i1.p1.4.m4.2.2.1.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1"><ci id="A1.I1.i1.p1.4.m4.1.1.cmml" xref="A1.I1.i1.p1.4.m4.1.1">𝒙</ci><apply id="A1.I1.i1.p1.4.m4.2.2.1.1.1.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.4.m4.2.2.1.1.1.1.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.4.m4.2.2.1.1.1.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.2">𝒚</ci><apply id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3"><ci id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.1.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.1">:</ci><cn type="integer" id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.2">1</cn><apply id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3"><minus id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.1.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.1"></minus><ci id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.2.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.2">𝑛</ci><cn type="integer" id="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.3.cmml" xref="A1.I1.i1.p1.4.m4.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.4.m4.2c">s_{n}=[{\bm{x}},{\bm{y}}_{1:n-1}]</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.4.m4.2d">italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = [ bold_italic_x , bold_italic_y start_POSTSUBSCRIPT 1 : italic_n - 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para">
<p id="A1.I1.i2.p1.3" class="ltx_p"><span id="A1.I1.i2.p1.3.1" class="ltx_text ltx_font_bold">Actions</span> (<math id="A1.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="A1.I1.i2.p1.1.m1.1a"><mi id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><ci id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.1.m1.1d">italic_a</annotation></semantics></math>): The actions are the tokens <math id="A1.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="a_{n}=y_{n}" display="inline"><semantics id="A1.I1.i2.p1.2.m2.1a"><mrow id="A1.I1.i2.p1.2.m2.1.1" xref="A1.I1.i2.p1.2.m2.1.1.cmml"><msub id="A1.I1.i2.p1.2.m2.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.2.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.2.2" xref="A1.I1.i2.p1.2.m2.1.1.2.2.cmml">a</mi><mi id="A1.I1.i2.p1.2.m2.1.1.2.3" xref="A1.I1.i2.p1.2.m2.1.1.2.3.cmml">n</mi></msub><mo id="A1.I1.i2.p1.2.m2.1.1.1" xref="A1.I1.i2.p1.2.m2.1.1.1.cmml">=</mo><msub id="A1.I1.i2.p1.2.m2.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.3.2" xref="A1.I1.i2.p1.2.m2.1.1.3.2.cmml">y</mi><mi id="A1.I1.i2.p1.2.m2.1.1.3.3" xref="A1.I1.i2.p1.2.m2.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.2.m2.1b"><apply id="A1.I1.i2.p1.2.m2.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1"><eq id="A1.I1.i2.p1.2.m2.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.1"></eq><apply id="A1.I1.i2.p1.2.m2.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i2.p1.2.m2.1.1.2.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.2">subscript</csymbol><ci id="A1.I1.i2.p1.2.m2.1.1.2.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.2.2">𝑎</ci><ci id="A1.I1.i2.p1.2.m2.1.1.2.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.2.3">𝑛</ci></apply><apply id="A1.I1.i2.p1.2.m2.1.1.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1.3">subscript</csymbol><ci id="A1.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.3.2">𝑦</ci><ci id="A1.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.2.m2.1c">a_{n}=y_{n}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.2.m2.1d">italic_a start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> to be generated by policy (<math id="A1.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="A1.I1.i2.p1.3.m3.1a"><mi id="A1.I1.i2.p1.3.m3.1.1" xref="A1.I1.i2.p1.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.3.m3.1b"><ci id="A1.I1.i2.p1.3.m3.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.3.m3.1d">italic_π</annotation></semantics></math>).</p>
</div>
</li>
<li id="A1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i3.p1" class="ltx_para">
<p id="A1.I1.i3.p1.1" class="ltx_p"><span id="A1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Rewards</span> (r): Rewards can be given or learned. In our experiments we train a deep neural network on human preferences to assigns a score to the full generated sequence. Reward is produced after end-of-sequence (EOS) token, and it is zero at all other steps.</p>
</div>
</li>
<li id="A1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i4.p1" class="ltx_para">
<p id="A1.I1.i4.p1.1" class="ltx_p"><span id="A1.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Transition operator</span> (T): The transition operator defines the dynamics of an environment: <math id="A1.I1.i4.p1.1.m1.5" class="ltx_Math" alttext="T(s^{\prime}|a,s):=T\left(y_{n}|s_{n}=[{\bm{x}},{\bm{y}}_{1:n-1}]\right)" display="inline"><semantics id="A1.I1.i4.p1.1.m1.5a"><mrow id="A1.I1.i4.p1.1.m1.5.5" xref="A1.I1.i4.p1.1.m1.5.5.cmml"><mrow id="A1.I1.i4.p1.1.m1.4.4.1" xref="A1.I1.i4.p1.1.m1.4.4.1.cmml"><mi id="A1.I1.i4.p1.1.m1.4.4.1.3" xref="A1.I1.i4.p1.1.m1.4.4.1.3.cmml">T</mi><mo id="A1.I1.i4.p1.1.m1.4.4.1.2" xref="A1.I1.i4.p1.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="A1.I1.i4.p1.1.m1.4.4.1.1.1" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A1.I1.i4.p1.1.m1.4.4.1.1.1.2" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.cmml"><msup id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.cmml"><mi id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.2" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.2.cmml">s</mi><mo id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.3" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.1.cmml">|</mo><mrow id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.3.2" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.3.1.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml">a</mi><mo id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.3.2.1" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="A1.I1.i4.p1.1.m1.2.2" xref="A1.I1.i4.p1.1.m1.2.2.cmml">s</mi></mrow></mrow><mo rspace="0.278em" stretchy="false" id="A1.I1.i4.p1.1.m1.4.4.1.1.1.3" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="A1.I1.i4.p1.1.m1.5.5.3" xref="A1.I1.i4.p1.1.m1.5.5.3.cmml">:=</mo><mrow id="A1.I1.i4.p1.1.m1.5.5.2" xref="A1.I1.i4.p1.1.m1.5.5.2.cmml"><mi id="A1.I1.i4.p1.1.m1.5.5.2.3" xref="A1.I1.i4.p1.1.m1.5.5.2.3.cmml">T</mi><mo id="A1.I1.i4.p1.1.m1.5.5.2.2" xref="A1.I1.i4.p1.1.m1.5.5.2.2.cmml">⁢</mo><mrow id="A1.I1.i4.p1.1.m1.5.5.2.1.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.cmml"><mo id="A1.I1.i4.p1.1.m1.5.5.2.1.1.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.cmml"><mrow id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.cmml"><msub id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.cmml"><mi id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.2.cmml">y</mi><mi id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.3.cmml">n</mi></msub><mo fence="false" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.1.cmml">|</mo><msub id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.cmml"><mi id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.2.cmml">s</mi><mi id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.3.cmml">n</mi></msub></mrow><mo id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.2.cmml">=</mo><mrow id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.2.cmml">[</mo><mi id="A1.I1.i4.p1.1.m1.3.3" xref="A1.I1.i4.p1.1.m1.3.3.cmml">𝒙</mi><mo id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.2.cmml">,</mo><msub id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.cmml"><mi id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.2.cmml">𝒚</mi><mrow id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.cmml"><mn id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.cmml"><mi id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.2" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.2.cmml">n</mi><mo id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.1" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.4" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.2.cmml">]</mo></mrow></mrow><mo id="A1.I1.i4.p1.1.m1.5.5.2.1.1.3" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.5b"><apply id="A1.I1.i4.p1.1.m1.5.5.cmml" xref="A1.I1.i4.p1.1.m1.5.5"><csymbol cd="latexml" id="A1.I1.i4.p1.1.m1.5.5.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.3">assign</csymbol><apply id="A1.I1.i4.p1.1.m1.4.4.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1"><times id="A1.I1.i4.p1.1.m1.4.4.1.2.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.2"></times><ci id="A1.I1.i4.p1.1.m1.4.4.1.3.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.3">𝑇</ci><apply id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1"><csymbol cd="latexml" id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.2.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.2">𝑠</ci><ci id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.3.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.2.3">′</ci></apply><list id="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.3.1.cmml" xref="A1.I1.i4.p1.1.m1.4.4.1.1.1.1.3.2"><ci id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">𝑎</ci><ci id="A1.I1.i4.p1.1.m1.2.2.cmml" xref="A1.I1.i4.p1.1.m1.2.2">𝑠</ci></list></apply></apply><apply id="A1.I1.i4.p1.1.m1.5.5.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2"><times id="A1.I1.i4.p1.1.m1.5.5.2.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.2"></times><ci id="A1.I1.i4.p1.1.m1.5.5.2.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.3">𝑇</ci><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1"><eq id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.2"></eq><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3"><csymbol cd="latexml" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.1">conditional</csymbol><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2">subscript</csymbol><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.2">𝑦</ci><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.2.3">𝑛</ci></apply><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3">subscript</csymbol><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.2">𝑠</ci><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.3.3.3">𝑛</ci></apply></apply><interval closure="closed" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1"><ci id="A1.I1.i4.p1.1.m1.3.3.cmml" xref="A1.I1.i4.p1.1.m1.3.3">𝒙</ci><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.2">𝒚</ci><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3"><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.2">1</cn><apply id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3"><minus id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.1.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.1"></minus><ci id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.2.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.2">𝑛</ci><cn type="integer" id="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.3.cmml" xref="A1.I1.i4.p1.1.m1.5.5.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.5c">T(s^{\prime}|a,s):=T\left(y_{n}|s_{n}=[{\bm{x}},{\bm{y}}_{1:n-1}]\right)</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.1.m1.5d">italic_T ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_a , italic_s ) := italic_T ( italic_y start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = [ bold_italic_x , bold_italic_y start_POSTSUBSCRIPT 1 : italic_n - 1 end_POSTSUBSCRIPT ] )</annotation></semantics></math>. In our setup, it is a deterministic operator that concatenates newly produced token (action) to the current sequence (state).</p>
</div>
</li>
</ul>
</div>
<div id="A1.SS1.p3" class="ltx_para">
<p id="A1.SS1.p3.1" class="ltx_p">This RLHF formulation of conditional language modeling can be also seen as a contextual bandit problem with a very large action space.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Negative results with offline RL</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">In addition to the experiments from Section <a href="#S4" title="4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we also run experiments with Q-learning with BVE type of one-step RL approaches and reward conditioned approaches, such as decision transformers <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite>. However, we could not obtain notable improvements with them over the supervised baseline. Q-function-based methods for learning a policy and value function performed worse than supervised learning when used as a policy even after training from initialization from a supervised checkpoint. This matches previous observations by <cite class="ltx_cite ltx_citemacro_cite">Mathieu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> who showed that offline Q-learning has difficulty in large action spaces (vocabulary size of <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="32\,000" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mn id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">32 000</mn><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><cn type="integer" id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">32000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">32\,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">32 000</annotation></semantics></math> tokens) and state-value based methods are preferable. Furthermore, as <cite class="ltx_cite ltx_citemacro_cite">Brandfonbrener et al. (<a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> showed, return-conditioned methods tend to learn sub-optimal policies on tasks with sparse continuous rewards.</p>
</div>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Data and Model details</h3>

<div id="A1.SS3.p1" class="ltx_para">
<p id="A1.SS3.p1.2" class="ltx_p">In all our experiments, the base policy architecture is a minor modification of a standard Transformer architecture <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib58" title="" class="ltx_ref">2017</a>)</cite>. We use a vocabulary of <math id="A1.SS3.p1.1.m1.1" class="ltx_Math" alttext="32\,000" display="inline"><semantics id="A1.SS3.p1.1.m1.1a"><mn id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml">32 000</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><cn type="integer" id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1">32000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">32\,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.1.m1.1d">32 000</annotation></semantics></math> tokens and a max sequence length of <math id="A1.SS3.p1.2.m2.1" class="ltx_Math" alttext="128" display="inline"><semantics id="A1.SS3.p1.2.m2.1a"><mn id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><cn type="integer" id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">128</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.p1.2.m2.1d">128</annotation></semantics></math> at decoding time. We use the <span id="A1.SS3.p1.2.1" class="ltx_text ltx_font_typewriter">sentencepiece</span> tool <cite class="ltx_cite ltx_citemacro_citep">(Kudo, <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite> for building the tokenizers.</p>
</div>
<section id="A1.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">
<span id="A1.SS3.SSS0.Px1.1.1" class="ltx_text ltx_font_typewriter">Grow</span> step</h5>

<div id="A1.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px1.p1.2" class="ltx_p">During the <span id="A1.SS3.SSS0.Px1.p1.2.1" class="ltx_text ltx_font_typewriter">Grow</span> step, we sampled from the latest checkpoint of the policy with tempered softmax using temperature <math id="A1.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="A1.SS3.SSS0.Px1.p1.1.m1.1a"><mn id="A1.SS3.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px1.p1.1.m1.1b"><cn type="float" id="A1.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS0.Px1.p1.1.m1.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px1.p1.1.m1.1c">0.8</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px1.p1.1.m1.1d">0.8</annotation></semantics></math> following the procedure proposed by <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite> to generate the dataset. Morevero, in our analysis, we found that temperature <math id="A1.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="A1.SS3.SSS0.Px1.p1.2.m2.1a"><mn id="A1.SS3.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px1.p1.2.m2.1b"><cn type="float" id="A1.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A1.SS3.SSS0.Px1.p1.2.m2.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px1.p1.2.m2.1c">0.8</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px1.p1.2.m2.1d">0.8</annotation></semantics></math> often covers a broad range of rewards in the dataset.</p>
</div>
</section>
<section id="A1.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Thresholds in <span id="A1.SS3.SSS0.Px2.1.1" class="ltx_text ltx_font_typewriter">Improve</span> step</h5>

<div id="A1.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px2.p1.6" class="ltx_p">If we set the threshold <math id="A1.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A1.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="A1.SS3.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="A1.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px2.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px2.p1.1.m1.1d">italic_τ</annotation></semantics></math> to a value such that <math id="A1.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\tau\geq V^{\pi_{0}}" display="inline"><semantics id="A1.SS3.SSS0.Px2.p1.2.m2.1a"><mrow id="A1.SS3.SSS0.Px2.p1.2.m2.1.1" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">τ</mi><mo id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.1" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml">≥</mo><msup id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.2" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">V</mi><msub id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.cmml"><mi id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.2" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml">π</mi><mn id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.3" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml">0</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1"><geq id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.1"></geq><ci id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.2">𝜏</ci><apply id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.2">𝑉</ci><apply id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.2">𝜋</ci><cn type="integer" id="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml" xref="A1.SS3.SSS0.Px2.p1.2.m2.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px2.p1.2.m2.1c">\tau\geq V^{\pi_{0}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px2.p1.2.m2.1d">italic_τ ≥ italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and learn a policy <math id="A1.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\pi^{1}" display="inline"><semantics id="A1.SS3.SSS0.Px2.p1.3.m3.1a"><msup id="A1.SS3.SSS0.Px2.p1.3.m3.1.1" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="A1.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">π</mi><mn id="A1.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="A1.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1.2">𝜋</ci><cn type="integer" id="A1.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="A1.SS3.SSS0.Px2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px2.p1.3.m3.1c">\pi^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px2.p1.3.m3.1d">italic_π start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> on data filtered with this threshold, the updated average value <math id="A1.SS3.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="V^{\pi_{1}}" display="inline"><semantics id="A1.SS3.SSS0.Px2.p1.4.m4.1a"><msup id="A1.SS3.SSS0.Px2.p1.4.m4.1.1" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.2" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml">V</mi><msub id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mi id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.2" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">π</mi><mn id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.3" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.3.cmml">1</mn></msub></msup><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px2.p1.4.m4.1b"><apply id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1">superscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.2">𝑉</ci><apply id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3">subscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.2">𝜋</ci><cn type="integer" id="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.3.cmml" xref="A1.SS3.SSS0.Px2.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px2.p1.4.m4.1c">V^{\pi_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px2.p1.4.m4.1d">italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> of this policy satisfies <math id="A1.SS3.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="V^{\pi_{1}}&gt;V^{\pi_{0}}" display="inline"><semantics id="A1.SS3.SSS0.Px2.p1.5.m5.1a"><mrow id="A1.SS3.SSS0.Px2.p1.5.m5.1.1" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.cmml"><msup id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml"><mi id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.2" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.2.cmml">V</mi><msub id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.cmml"><mi id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.2" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.2.cmml">π</mi><mn id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.3" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.3.cmml">1</mn></msub></msup><mo id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.1" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml">&gt;</mo><msup id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mi id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.2" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">V</mi><msub id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.cmml"><mi id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2.cmml">π</mi><mn id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3.cmml">0</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px2.p1.5.m5.1b"><apply id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1"><gt id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.1"></gt><apply id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.1.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2">superscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.2.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.2">𝑉</ci><apply id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.1.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.2.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.2">𝜋</ci><cn type="integer" id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.3.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.2.3.3">1</cn></apply></apply><apply id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.1.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3">superscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.2.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.2">𝑉</ci><apply id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.1.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.2">𝜋</ci><cn type="integer" id="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3.cmml" xref="A1.SS3.SSS0.Px2.p1.5.m5.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px2.p1.5.m5.1c">V^{\pi_{1}}&gt;V^{\pi_{0}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px2.p1.5.m5.1d">italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT &gt; italic_V start_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Then, iterative threshold ensures policy improvement in the <span id="A1.SS3.SSS0.Px2.p1.6.1" class="ltx_text ltx_font_typewriter">Improve</span> step. In our experiments, we do several improvement steps until we reach the maximum threshold. At each step, we trained the model for <math id="A1.SS3.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="500\,000" display="inline"><semantics id="A1.SS3.SSS0.Px2.p1.6.m6.1a"><mn id="A1.SS3.SSS0.Px2.p1.6.m6.1.1" xref="A1.SS3.SSS0.Px2.p1.6.m6.1.1.cmml">500 000</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px2.p1.6.m6.1b"><cn type="integer" id="A1.SS3.SSS0.Px2.p1.6.m6.1.1.cmml" xref="A1.SS3.SSS0.Px2.p1.6.m6.1.1">500000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px2.p1.6.m6.1c">500\,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px2.p1.6.m6.1d">500 000</annotation></semantics></math> SGD steps and pick the checkpoint with the best reward model score.</p>
</div>
</section>
<section id="A1.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">IWSLT 2014 De-En</h5>

<div id="A1.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px3.p1.7" class="ltx_p">We use train, validation and test sets from IWSLT 2014 De-En dataset <cite class="ltx_cite ltx_citemacro_citep">(Cettolo et al., <a href="#bib.bib10" title="" class="ltx_ref">2014</a>)</cite> which includes source sentences in German with human translations (references) in English. In each <span id="A1.SS3.SSS0.Px3.p1.7.1" class="ltx_text ltx_font_typewriter">Grow</span> step, we generate <math id="A1.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.1.m1.1a"><mn id="A1.SS3.SSS0.Px3.p1.1.m1.1.1" xref="A1.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.1.m1.1b"><cn type="integer" id="A1.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.1.m1.1d">100</annotation></semantics></math> candidate translation for each source sentence in the training set, effectively yielding us <math id="A1.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="|{\cal D}_{g}|=" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.2.m2.1a"><mrow id="A1.SS3.SSS0.Px3.p1.2.m2.1.1" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mrow id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.2" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.2.1.cmml">|</mo><msub id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.2" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.3" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.3" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml">=</mo><mi id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1"><eq id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.2"></eq><apply id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.2.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1"><abs id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.2.1.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.2"></abs><apply id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.1.1.1.3">𝑔</ci></apply></apply><csymbol cd="latexml" id="A1.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="A1.SS3.SSS0.Px3.p1.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.2.m2.1c">|{\cal D}_{g}|=</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.2.m2.1d">| caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT | =</annotation></semantics></math><math id="A1.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="16\,000\,000" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.3.m3.1a"><mn id="A1.SS3.SSS0.Px3.p1.3.m3.1.1" xref="A1.SS3.SSS0.Px3.p1.3.m3.1.1.cmml">16 000 000</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.3.m3.1b"><cn type="integer" id="A1.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.3.m3.1.1">16000000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.3.m3.1c">16\,000\,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.3.m3.1d">16 000 000</annotation></semantics></math>. For this dataset, we use a tiny version of the Transformer encoder-decoder <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib58" title="" class="ltx_ref">2017</a>)</cite> architecture with the feedforward MLP layers of size <math id="A1.SS3.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.4.m4.1a"><mn id="A1.SS3.SSS0.Px3.p1.4.m4.1.1" xref="A1.SS3.SSS0.Px3.p1.4.m4.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.4.m4.1b"><cn type="integer" id="A1.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.4.m4.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.4.m4.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.4.m4.1d">512</annotation></semantics></math>, feedforward dimension of <math id="A1.SS3.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.5.m5.1a"><mn id="A1.SS3.SSS0.Px3.p1.5.m5.1.1" xref="A1.SS3.SSS0.Px3.p1.5.m5.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.5.m5.1b"><cn type="integer" id="A1.SS3.SSS0.Px3.p1.5.m5.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.5.m5.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.5.m5.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.5.m5.1d">1024</annotation></semantics></math>, <math id="A1.SS3.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="4" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.6.m6.1a"><mn id="A1.SS3.SSS0.Px3.p1.6.m6.1.1" xref="A1.SS3.SSS0.Px3.p1.6.m6.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.6.m6.1b"><cn type="integer" id="A1.SS3.SSS0.Px3.p1.6.m6.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.6.m6.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.6.m6.1c">4</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.6.m6.1d">4</annotation></semantics></math> attention heads and <math id="A1.SS3.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A1.SS3.SSS0.Px3.p1.7.m7.1a"><mn id="A1.SS3.SSS0.Px3.p1.7.m7.1.1" xref="A1.SS3.SSS0.Px3.p1.7.m7.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px3.p1.7.m7.1b"><cn type="integer" id="A1.SS3.SSS0.Px3.p1.7.m7.1.1.cmml" xref="A1.SS3.SSS0.Px3.p1.7.m7.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px3.p1.7.m7.1c">6</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px3.p1.7.m7.1d">6</annotation></semantics></math> encoder and decoder layers.</p>
</div>
</section>
<section id="A1.SS3.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">WMT 2020 Zh-En</h5>

<div id="A1.SS3.SSS0.Px4.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px4.p1.9" class="ltx_p">We use the source-reference pairs in Chinese and English from the work of <cite class="ltx_cite ltx_citemacro_cite">Koehn et al. (<a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> for our training, validation and test sets. Exact details on the datasets and preprocessing can be found in <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a href="#bib.bib63" title="" class="ltx_ref">2020</a>)</cite>. In each <span id="A1.SS3.SSS0.Px4.p1.9.1" class="ltx_text ltx_font_typewriter">Grow</span> step, we generate <math id="A1.SS3.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="25" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.1.m1.1a"><mn id="A1.SS3.SSS0.Px4.p1.1.m1.1.1" xref="A1.SS3.SSS0.Px4.p1.1.m1.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.1.m1.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.1.m1.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.1.m1.1c">25</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.1.m1.1d">25</annotation></semantics></math> candidates for each source sentence in the training set, effectively yielding us <math id="A1.SS3.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="|{\cal D}_{g}|=" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.2.m2.1a"><mrow id="A1.SS3.SSS0.Px4.p1.2.m2.1.1" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.cmml"><mrow id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.2" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.2.1.cmml">|</mo><msub id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.3" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow><mo id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.2" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.2.cmml">=</mo><mi id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.3" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.2.m2.1b"><apply id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1"><eq id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.2"></eq><apply id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.2.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1"><abs id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.2.1.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.2"></abs><apply id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.1.1.1.3">𝑔</ci></apply></apply><csymbol cd="latexml" id="A1.SS3.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="A1.SS3.SSS0.Px4.p1.2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.2.m2.1c">|{\cal D}_{g}|=</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.2.m2.1d">| caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT | =</annotation></semantics></math> <math id="A1.SS3.SSS0.Px4.p1.3.m3.1" class="ltx_Math" alttext="890\,000\,000" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.3.m3.1a"><mn id="A1.SS3.SSS0.Px4.p1.3.m3.1.1" xref="A1.SS3.SSS0.Px4.p1.3.m3.1.1.cmml">890 000 000</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.3.m3.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.3.m3.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.3.m3.1.1">890000000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.3.m3.1c">890\,000\,000</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.3.m3.1d">890 000 000</annotation></semantics></math>. We choose to generate <math id="A1.SS3.SSS0.Px4.p1.4.m4.1" class="ltx_Math" alttext="25" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.4.m4.1a"><mn id="A1.SS3.SSS0.Px4.p1.4.m4.1.1" xref="A1.SS3.SSS0.Px4.p1.4.m4.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.4.m4.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.4.m4.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.4.m4.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.4.m4.1c">25</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.4.m4.1d">25</annotation></semantics></math> candidates per source as the WMT dataset is significantly (<math id="A1.SS3.SSS0.Px4.p1.5.m5.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.5.m5.1a"><mo id="A1.SS3.SSS0.Px4.p1.5.m5.1.1" xref="A1.SS3.SSS0.Px4.p1.5.m5.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.5.m5.1b"><csymbol cd="latexml" id="A1.SS3.SSS0.Px4.p1.5.m5.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.5.m5.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.5.m5.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.5.m5.1d">∼</annotation></semantics></math> 100 times) larger than the IWSLT dataset. We use an architecture that mimics the Transformer-base encoder-decoder <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib58" title="" class="ltx_ref">2017</a>)</cite> architecture with model dimension <math id="A1.SS3.SSS0.Px4.p1.6.m6.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.6.m6.1a"><mn id="A1.SS3.SSS0.Px4.p1.6.m6.1.1" xref="A1.SS3.SSS0.Px4.p1.6.m6.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.6.m6.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.6.m6.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.6.m6.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.6.m6.1c">512</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.6.m6.1d">512</annotation></semantics></math>, feedforward dimension of <math id="A1.SS3.SSS0.Px4.p1.7.m7.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.7.m7.1a"><mn id="A1.SS3.SSS0.Px4.p1.7.m7.1.1" xref="A1.SS3.SSS0.Px4.p1.7.m7.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.7.m7.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.7.m7.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.7.m7.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.7.m7.1c">2048</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.7.m7.1d">2048</annotation></semantics></math>, <math id="A1.SS3.SSS0.Px4.p1.8.m8.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.8.m8.1a"><mn id="A1.SS3.SSS0.Px4.p1.8.m8.1.1" xref="A1.SS3.SSS0.Px4.p1.8.m8.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.8.m8.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.8.m8.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.8.m8.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.8.m8.1c">8</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.8.m8.1d">8</annotation></semantics></math> attention heads and <math id="A1.SS3.SSS0.Px4.p1.9.m9.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A1.SS3.SSS0.Px4.p1.9.m9.1a"><mn id="A1.SS3.SSS0.Px4.p1.9.m9.1.1" xref="A1.SS3.SSS0.Px4.p1.9.m9.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px4.p1.9.m9.1b"><cn type="integer" id="A1.SS3.SSS0.Px4.p1.9.m9.1.1.cmml" xref="A1.SS3.SSS0.Px4.p1.9.m9.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px4.p1.9.m9.1c">6</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px4.p1.9.m9.1d">6</annotation></semantics></math> encoder and decoder layers.</p>
</div>
</section>
<section id="A1.SS3.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Web Domain En-Zh</h5>

<div id="A1.SS3.SSS0.Px5.p1" class="ltx_para">
<p id="A1.SS3.SSS0.Px5.p1.4" class="ltx_p">Finally, we use the in-house dataset for English to Chinese translation with custom training, fine-tuning and test sets. This training corpus is our biggest dataset <span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>For computational reasons, we run <span id="footnote5.1" class="ltx_ERROR undefined">\rest</span> on the fine-tuning corpus with a model warm-started from a supervised model trained on the entire massive training corpus.</span></span></span>, so we use a modified version of Transformer-big encoder-decoder <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib58" title="" class="ltx_ref">2017</a>)</cite> architecture with model dimension <math id="A1.SS3.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="A1.SS3.SSS0.Px5.p1.1.m1.1a"><mn id="A1.SS3.SSS0.Px5.p1.1.m1.1.1" xref="A1.SS3.SSS0.Px5.p1.1.m1.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px5.p1.1.m1.1b"><cn type="integer" id="A1.SS3.SSS0.Px5.p1.1.m1.1.1.cmml" xref="A1.SS3.SSS0.Px5.p1.1.m1.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px5.p1.1.m1.1c">1024</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px5.p1.1.m1.1d">1024</annotation></semantics></math>, feedforward dimension of <math id="A1.SS3.SSS0.Px5.p1.2.m2.1" class="ltx_Math" alttext="8192" display="inline"><semantics id="A1.SS3.SSS0.Px5.p1.2.m2.1a"><mn id="A1.SS3.SSS0.Px5.p1.2.m2.1.1" xref="A1.SS3.SSS0.Px5.p1.2.m2.1.1.cmml">8192</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px5.p1.2.m2.1b"><cn type="integer" id="A1.SS3.SSS0.Px5.p1.2.m2.1.1.cmml" xref="A1.SS3.SSS0.Px5.p1.2.m2.1.1">8192</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px5.p1.2.m2.1c">8192</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px5.p1.2.m2.1d">8192</annotation></semantics></math>, <math id="A1.SS3.SSS0.Px5.p1.3.m3.1" class="ltx_Math" alttext="16" display="inline"><semantics id="A1.SS3.SSS0.Px5.p1.3.m3.1a"><mn id="A1.SS3.SSS0.Px5.p1.3.m3.1.1" xref="A1.SS3.SSS0.Px5.p1.3.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px5.p1.3.m3.1b"><cn type="integer" id="A1.SS3.SSS0.Px5.p1.3.m3.1.1.cmml" xref="A1.SS3.SSS0.Px5.p1.3.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px5.p1.3.m3.1c">16</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px5.p1.3.m3.1d">16</annotation></semantics></math> attention heads and <math id="A1.SS3.SSS0.Px5.p1.4.m4.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A1.SS3.SSS0.Px5.p1.4.m4.1a"><mn id="A1.SS3.SSS0.Px5.p1.4.m4.1.1" xref="A1.SS3.SSS0.Px5.p1.4.m4.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.SSS0.Px5.p1.4.m4.1b"><cn type="integer" id="A1.SS3.SSS0.Px5.p1.4.m4.1.1.cmml" xref="A1.SS3.SSS0.Px5.p1.4.m4.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.SSS0.Px5.p1.4.m4.1c">6</annotation><annotation encoding="application/x-llamapun" id="A1.SS3.SSS0.Px5.p1.4.m4.1d">6</annotation></semantics></math> encoder and decoder layers.</p>
</div>
<div id="A1.SS3.SSS0.Px5.p2" class="ltx_para">
<p id="A1.SS3.SSS0.Px5.p2.1" class="ltx_p">In Table <a href="#A1.T2" title="Table 2 ‣ Web Domain En-Zh ‣ A.3 Data and Model details ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we list all the datasets with their sizes. In all the experiments, unless stated otherwise, we report the average reward scores on the validation set.</p>
</div>
<figure id="A1.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Details of the datasets and their sizes used in <span id="A1.T2.12.1" class="ltx_ERROR undefined">\rest</span> experiments.</figcaption>
<table id="A1.T2.10" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T2.1.1" class="ltx_tr">
<th id="A1.T2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Dataset</th>
<th id="A1.T2.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><math id="A1.T2.1.1.1.m1.1" class="ltx_Math" alttext="|{\cal D}_{g}|" display="inline"><semantics id="A1.T2.1.1.1.m1.1a"><mrow id="A1.T2.1.1.1.m1.1.1.1" xref="A1.T2.1.1.1.m1.1.1.2.cmml"><mo stretchy="false" id="A1.T2.1.1.1.m1.1.1.1.2" xref="A1.T2.1.1.1.m1.1.1.2.1.cmml">|</mo><msub id="A1.T2.1.1.1.m1.1.1.1.1" xref="A1.T2.1.1.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.T2.1.1.1.m1.1.1.1.1.2" xref="A1.T2.1.1.1.m1.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.T2.1.1.1.m1.1.1.1.1.3" xref="A1.T2.1.1.1.m1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="A1.T2.1.1.1.m1.1.1.1.3" xref="A1.T2.1.1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.m1.1b"><apply id="A1.T2.1.1.1.m1.1.1.2.cmml" xref="A1.T2.1.1.1.m1.1.1.1"><abs id="A1.T2.1.1.1.m1.1.1.2.1.cmml" xref="A1.T2.1.1.1.m1.1.1.1.2"></abs><apply id="A1.T2.1.1.1.m1.1.1.1.1.cmml" xref="A1.T2.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.T2.1.1.1.m1.1.1.1.1.1.cmml" xref="A1.T2.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.T2.1.1.1.m1.1.1.1.1.2.cmml" xref="A1.T2.1.1.1.m1.1.1.1.1.2">𝒟</ci><ci id="A1.T2.1.1.1.m1.1.1.1.1.3.cmml" xref="A1.T2.1.1.1.m1.1.1.1.1.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.m1.1c">|{\cal D}_{g}|</annotation><annotation encoding="application/x-llamapun" id="A1.T2.1.1.1.m1.1d">| caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT |</annotation></semantics></math></th>
<th id="A1.T2.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"># Eval samples</th>
<th id="A1.T2.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"># Candidates</th>
</tr>
<tr id="A1.T2.10.11.1" class="ltx_tr">
<th id="A1.T2.10.11.1.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T2.10.11.1.2" class="ltx_td ltx_th ltx_th_column"></th>
<th id="A1.T2.10.11.1.3" class="ltx_td ltx_th ltx_th_column"></th>
<th id="A1.T2.10.11.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column">per source</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T2.4.4" class="ltx_tr">
<th id="A1.T2.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">IWSLT 2014 de-en</th>
<td id="A1.T2.2.2.1" class="ltx_td ltx_align_right ltx_border_t"><math id="A1.T2.2.2.1.m1.1" class="ltx_Math" alttext="16\,000\,000" display="inline"><semantics id="A1.T2.2.2.1.m1.1a"><mn id="A1.T2.2.2.1.m1.1.1" xref="A1.T2.2.2.1.m1.1.1.cmml">16 000 000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.1.m1.1b"><cn type="integer" id="A1.T2.2.2.1.m1.1.1.cmml" xref="A1.T2.2.2.1.m1.1.1">16000000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.1.m1.1c">16\,000\,000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.2.2.1.m1.1d">16 000 000</annotation></semantics></math></td>
<td id="A1.T2.3.3.2" class="ltx_td ltx_align_right ltx_border_t"><math id="A1.T2.3.3.2.m1.1" class="ltx_Math" alttext="7466" display="inline"><semantics id="A1.T2.3.3.2.m1.1a"><mn id="A1.T2.3.3.2.m1.1.1" xref="A1.T2.3.3.2.m1.1.1.cmml">7466</mn><annotation-xml encoding="MathML-Content" id="A1.T2.3.3.2.m1.1b"><cn type="integer" id="A1.T2.3.3.2.m1.1.1.cmml" xref="A1.T2.3.3.2.m1.1.1">7466</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.3.3.2.m1.1c">7466</annotation><annotation encoding="application/x-llamapun" id="A1.T2.3.3.2.m1.1d">7466</annotation></semantics></math></td>
<td id="A1.T2.4.4.3" class="ltx_td ltx_align_right ltx_border_t"><math id="A1.T2.4.4.3.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.T2.4.4.3.m1.1a"><mn id="A1.T2.4.4.3.m1.1.1" xref="A1.T2.4.4.3.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.T2.4.4.3.m1.1b"><cn type="integer" id="A1.T2.4.4.3.m1.1.1.cmml" xref="A1.T2.4.4.3.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.4.4.3.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="A1.T2.4.4.3.m1.1d">100</annotation></semantics></math></td>
</tr>
<tr id="A1.T2.7.7" class="ltx_tr">
<th id="A1.T2.7.7.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">WMT 2020 zh-en</th>
<td id="A1.T2.5.5.1" class="ltx_td ltx_align_right"><math id="A1.T2.5.5.1.m1.1" class="ltx_Math" alttext="890\,000\,000" display="inline"><semantics id="A1.T2.5.5.1.m1.1a"><mn id="A1.T2.5.5.1.m1.1.1" xref="A1.T2.5.5.1.m1.1.1.cmml">890 000 000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.5.5.1.m1.1b"><cn type="integer" id="A1.T2.5.5.1.m1.1.1.cmml" xref="A1.T2.5.5.1.m1.1.1">890000000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.5.5.1.m1.1c">890\,000\,000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.5.5.1.m1.1d">890 000 000</annotation></semantics></math></td>
<td id="A1.T2.6.6.2" class="ltx_td ltx_align_right"><math id="A1.T2.6.6.2.m1.1" class="ltx_Math" alttext="2000" display="inline"><semantics id="A1.T2.6.6.2.m1.1a"><mn id="A1.T2.6.6.2.m1.1.1" xref="A1.T2.6.6.2.m1.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.6.6.2.m1.1b"><cn type="integer" id="A1.T2.6.6.2.m1.1.1.cmml" xref="A1.T2.6.6.2.m1.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.6.6.2.m1.1c">2000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.6.6.2.m1.1d">2000</annotation></semantics></math></td>
<td id="A1.T2.7.7.3" class="ltx_td ltx_align_right"><math id="A1.T2.7.7.3.m1.1" class="ltx_Math" alttext="25" display="inline"><semantics id="A1.T2.7.7.3.m1.1a"><mn id="A1.T2.7.7.3.m1.1.1" xref="A1.T2.7.7.3.m1.1.1.cmml">25</mn><annotation-xml encoding="MathML-Content" id="A1.T2.7.7.3.m1.1b"><cn type="integer" id="A1.T2.7.7.3.m1.1.1.cmml" xref="A1.T2.7.7.3.m1.1.1">25</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.7.7.3.m1.1c">25</annotation><annotation encoding="application/x-llamapun" id="A1.T2.7.7.3.m1.1d">25</annotation></semantics></math></td>
</tr>
<tr id="A1.T2.10.10" class="ltx_tr">
<th id="A1.T2.10.10.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Web Domain Finetuning en-zh</th>
<td id="A1.T2.8.8.1" class="ltx_td ltx_align_right ltx_border_bb"><math id="A1.T2.8.8.1.m1.1" class="ltx_Math" alttext="3\,000\,000" display="inline"><semantics id="A1.T2.8.8.1.m1.1a"><mn id="A1.T2.8.8.1.m1.1.1" xref="A1.T2.8.8.1.m1.1.1.cmml">3 000 000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.8.8.1.m1.1b"><cn type="integer" id="A1.T2.8.8.1.m1.1.1.cmml" xref="A1.T2.8.8.1.m1.1.1">3000000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.8.8.1.m1.1c">3\,000\,000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.8.8.1.m1.1d">3 000 000</annotation></semantics></math></td>
<td id="A1.T2.9.9.2" class="ltx_td ltx_align_right ltx_border_bb"><math id="A1.T2.9.9.2.m1.1" class="ltx_Math" alttext="6000" display="inline"><semantics id="A1.T2.9.9.2.m1.1a"><mn id="A1.T2.9.9.2.m1.1.1" xref="A1.T2.9.9.2.m1.1.1.cmml">6000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.9.9.2.m1.1b"><cn type="integer" id="A1.T2.9.9.2.m1.1.1.cmml" xref="A1.T2.9.9.2.m1.1.1">6000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.9.9.2.m1.1c">6000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.9.9.2.m1.1d">6000</annotation></semantics></math></td>
<td id="A1.T2.10.10.3" class="ltx_td ltx_align_right ltx_border_bb"><math id="A1.T2.10.10.3.m1.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="A1.T2.10.10.3.m1.1a"><mn id="A1.T2.10.10.3.m1.1.1" xref="A1.T2.10.10.3.m1.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="A1.T2.10.10.3.m1.1b"><cn type="integer" id="A1.T2.10.10.3.m1.1.1.cmml" xref="A1.T2.10.10.3.m1.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.10.10.3.m1.1c">1000</annotation><annotation encoding="application/x-llamapun" id="A1.T2.10.10.3.m1.1d">1000</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Reward model</h3>

<div id="A1.SS4.p1" class="ltx_para">
<p id="A1.SS4.p1.2" class="ltx_p">We used learned reward models that assign a score to the whole translation. We considered two types of reward models for translation <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>: i) <span id="A1.SS4.p1.2.1" class="ltx_text ltx_font_italic">Reference-free</span> reward models estimate of how good a translation is based on the source and candidate sentences only, ii) <span id="A1.SS4.p1.2.2" class="ltx_text ltx_font_italic">Reference-based</span> reward models additionally use the reference human translation to decide how good a candidate translation is. The reference-free reward models are more flexible since they do not require reference translations. Moreover, by their design, reference-based models assign higher scores for sentences similar to the reference, and this could happen even when the reference is erroneous or incomplete. Finally, reference-free models open possibilities to evaluate and discover candidate translations that supersede the quality of references. Thus, in our experiments, we chose to work with reference-free reward models. On the other hand, since the reference-free reward models are not grounded in a human reference translation, it is more vulnerable to the distribution shifts in the candidates generated by the model and reward hacking. In practice, we pre-computed and stored <math id="A1.SS4.p1.1.m1.2" class="ltx_Math" alttext="R({\bm{x}},{\bm{y}})" display="inline"><semantics id="A1.SS4.p1.1.m1.2a"><mrow id="A1.SS4.p1.1.m1.2.3" xref="A1.SS4.p1.1.m1.2.3.cmml"><mi id="A1.SS4.p1.1.m1.2.3.2" xref="A1.SS4.p1.1.m1.2.3.2.cmml">R</mi><mo id="A1.SS4.p1.1.m1.2.3.1" xref="A1.SS4.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A1.SS4.p1.1.m1.2.3.3.2" xref="A1.SS4.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A1.SS4.p1.1.m1.2.3.3.2.1" xref="A1.SS4.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml">𝒙</mi><mo id="A1.SS4.p1.1.m1.2.3.3.2.2" xref="A1.SS4.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="A1.SS4.p1.1.m1.2.2" xref="A1.SS4.p1.1.m1.2.2.cmml">𝒚</mi><mo stretchy="false" id="A1.SS4.p1.1.m1.2.3.3.2.3" xref="A1.SS4.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.2b"><apply id="A1.SS4.p1.1.m1.2.3.cmml" xref="A1.SS4.p1.1.m1.2.3"><times id="A1.SS4.p1.1.m1.2.3.1.cmml" xref="A1.SS4.p1.1.m1.2.3.1"></times><ci id="A1.SS4.p1.1.m1.2.3.2.cmml" xref="A1.SS4.p1.1.m1.2.3.2">𝑅</ci><interval closure="open" id="A1.SS4.p1.1.m1.2.3.3.1.cmml" xref="A1.SS4.p1.1.m1.2.3.3.2"><ci id="A1.SS4.p1.1.m1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1">𝒙</ci><ci id="A1.SS4.p1.1.m1.2.2.cmml" xref="A1.SS4.p1.1.m1.2.2">𝒚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.2c">R({\bm{x}},{\bm{y}})</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.1.m1.2d">italic_R ( bold_italic_x , bold_italic_y )</annotation></semantics></math> for the generated <math id="A1.SS4.p1.2.m2.1" class="ltx_Math" alttext="{\cal D}_{g}" display="inline"><semantics id="A1.SS4.p1.2.m2.1a"><msub id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS4.p1.2.m2.1.1.2" xref="A1.SS4.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="A1.SS4.p1.2.m2.1.1.3" xref="A1.SS4.p1.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b"><apply id="A1.SS4.p1.2.m2.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.2.m2.1.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS4.p1.2.m2.1.1.2.cmml" xref="A1.SS4.p1.2.m2.1.1.2">𝒟</ci><ci id="A1.SS4.p1.2.m2.1.1.3.cmml" xref="A1.SS4.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">{\cal D}_{g}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="A1.SS4.p2" class="ltx_para">
<p id="A1.SS4.p2.1" class="ltx_p">During the development of the model, we relied on the methodology of “unit tests” for reward models where we tested them in various hand-crafted settings, such as on various permutations and repetitions of sentences. The unit-tests ensured the high quality of rewards generated for <span id="A1.SS4.p2.1.1" class="ltx_ERROR undefined">\rest</span>. Even though we used the most robust available reference-free reward model, we found that it was still not perfect, and sometimes showed signs of delusions. For example, the reward of a translation occasionally increased when we repeated the sentence, independent of the initial quality of the translation.</p>
</div>
</section>
<section id="A1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>Alignment between human evaluation scores and the reward model scores</h3>

<div id="A1.SS5.p1" class="ltx_para">
<p id="A1.SS5.p1.3" class="ltx_p">In Figure <a href="#A1.F9" title="Figure 9 ‣ A.5 Alignment between human evaluation scores and the reward model scores ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> and <a href="#A1.F10" title="Figure 10 ‣ A.5 Alignment between human evaluation scores and the reward model scores ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, we showed the distribution of human preferences and reward model scores for <span id="A1.SS5.p1.3.1" class="ltx_ERROR undefined">\rest</span> with <span id="A1.SS5.p1.3.2" class="ltx_text ltx_font_typewriter">BC</span> and <span id="A1.SS5.p1.3.3" class="ltx_text ltx_markedasmath ltx_font_typewriter">G=1 I=4</span>. Here, we found out that our reward model has a very high variance on samples with low human preference score from <span id="A1.SS5.p1.3.4" class="ltx_ERROR undefined">\rest</span> (<span id="A1.SS5.p1.3.5" class="ltx_text ltx_font_typewriter">BC</span>, <span id="A1.SS5.p1.3.6" class="ltx_text ltx_markedasmath ltx_font_typewriter">G=1 I=4</span>) and our supervised learning baseline (<span id="A1.SS5.p1.3.7" class="ltx_text ltx_font_typewriter">BC</span>, <span id="A1.SS5.p1.3.8" class="ltx_text ltx_markedasmath ltx_font_typewriter">G=0 I=0</span>). Our hypothesis for this is that the training dataset for the reward model was dominated by translations of high quality <span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>The data came from WMT 2021 metrics shared task dataset <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a href="#bib.bib16" title="" class="ltx_ref">2021</a>)</cite>, which reviews the human evaluation of good translation models</span></span></span>. Thus the model overfitted to the samples with high scores, and it has high variance in its prediction over the samples with lesser quality. This gap can be addressed with the incremental retraining of the reward model.</p>
</div>
<figure id="A1.F9" class="ltx_figure"><img src="assets/plots/iwslt_baseline_rest_twostep_violin_plots.png" id="A1.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="345" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span id="A1.F9.11.1" class="ltx_text ltx_font_bold">[IWSLT 2014 De-En]:</span> distribution of human preference and reward model scores for <span id="A1.F9.12.2" class="ltx_ERROR undefined">\rest</span> (BC, <span id="A1.F9.13.3" class="ltx_text ltx_markedasmath ltx_font_typewriter">I=4, G=1</span>) in side by side evaluation with supervised model. The human preference scores less than or equal to <math id="A1.F9.5.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.F9.5.m2.1b"><mn id="A1.F9.5.m2.1.1" xref="A1.F9.5.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.F9.5.m2.1c"><cn type="integer" id="A1.F9.5.m2.1.1.cmml" xref="A1.F9.5.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.5.m2.1d">3</annotation><annotation encoding="application/x-llamapun" id="A1.F9.5.m2.1e">3</annotation></semantics></math> have significantly higher variance in rewards compared to the human preference scores above <math id="A1.F9.6.m3.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.F9.6.m3.1b"><mn id="A1.F9.6.m3.1.1" xref="A1.F9.6.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.F9.6.m3.1c"><cn type="integer" id="A1.F9.6.m3.1.1.cmml" xref="A1.F9.6.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.6.m3.1d">3</annotation><annotation encoding="application/x-llamapun" id="A1.F9.6.m3.1e">3</annotation></semantics></math>. The plots on the left-hand side are for the samples generated from a supervised baseline and the right-hand side are for the samples generated with <span id="A1.F9.14.4" class="ltx_ERROR undefined">\rest</span>.</figcaption>
</figure>
<figure id="A1.F10" class="ltx_figure"><img src="assets/plots/wmt_human_Eval_violin_rest.png" id="A1.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="171" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="A1.F10.8.1" class="ltx_text ltx_font_bold">[WMT 2020 Zh-En]:</span> distribution of human preference and reward model scores for <span id="A1.F10.9.2" class="ltx_ERROR undefined">\rest</span> (BC, <span id="A1.F10.10.3" class="ltx_text ltx_markedasmath ltx_font_typewriter">I=4, G=1</span>) in side by side evaluation with supervised model. The human preference scores lower than or equal to <math id="A1.F10.4.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="A1.F10.4.m2.1b"><mn id="A1.F10.4.m2.1.1" xref="A1.F10.4.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="A1.F10.4.m2.1c"><cn type="integer" id="A1.F10.4.m2.1.1.cmml" xref="A1.F10.4.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.4.m2.1d">3</annotation><annotation encoding="application/x-llamapun" id="A1.F10.4.m2.1e">3</annotation></semantics></math> has a variance in terms of reward model scores. The reward model has less certainty on the scores of the candidates having lower scores.</figcaption>
</figure>
</section>
<section id="A1.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Results on test sets</h3>

<div id="A1.SS6.p1" class="ltx_para">
<p id="A1.SS6.p1.1" class="ltx_p">Figures <a href="#A1.F11" title="Figure 11 ‣ A.6 Results on test sets ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> and <a href="#A1.F12" title="Figure 12 ‣ A.6 Results on test sets ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> present the results on the test sets in IWSLT 2014 De-En and WMT 2020 Zh-En datasets. Similar to the validations set, <math id="A1.SS6.p1.1.m1.1" class="ltx_Math" alttext="\rest" display="inline"><semantics id="A1.SS6.p1.1.m1.1a"><merror class="ltx_ERROR undefined undefined" id="A1.SS6.p1.1.m1.1.1" xref="A1.SS6.p1.1.m1.1.1b.cmml"><mtext id="A1.SS6.p1.1.m1.1.1a" xref="A1.SS6.p1.1.m1.1.1b.cmml">\rest</mtext></merror><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.1.m1.1b"><ci id="A1.SS6.p1.1.m1.1.1b.cmml" xref="A1.SS6.p1.1.m1.1.1"><merror class="ltx_ERROR undefined undefined" id="A1.SS6.p1.1.m1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1"><mtext id="A1.SS6.p1.1.m1.1.1a.cmml" xref="A1.SS6.p1.1.m1.1.1">\rest</mtext></merror></ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.1.m1.1c">\rest</annotation></semantics></math> outperforms other value-based offline RL baselines. Also, increasing the number of both <span id="A1.SS6.p1.1.1" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="A1.SS6.p1.1.2" class="ltx_text ltx_font_typewriter">Improve</span> steps helps to further increase the rewards.</p>
</div>
<figure id="A1.F11" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_multiple_improve_test.png" id="A1.F11.g1" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_square" width="155" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_second_grow_step_test.png" id="A1.F11.g2" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" width="210" height="133" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span><span id="A1.F11.6.1" class="ltx_text ltx_font_bold">[IWSLT 2014 De-En]: ReST results on test set.</span> All variations of <span id="A1.F11.7.2" class="ltx_ERROR undefined">\rest</span> (purple) outperform supervised learning baseline (grey). As we increase the number of <span id="A1.F11.8.3" class="ltx_text ltx_font_typewriter">Grow</span> and <span id="A1.F11.9.4" class="ltx_text ltx_font_typewriter">Improve</span> steps, the reward of the model on the test set continues to increase.
</figcaption>
</figure>
<figure id="A1.F12" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/wmt_multiple_improve_test.png" id="A1.F12.g1" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_square" width="149" height="160" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/wmt_offline_algos_test.png" id="A1.F12.g2" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_square" width="181" height="160" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span><span id="A1.F12.6.1" class="ltx_text ltx_font_bold">[WMT 2020 Zh-En]: ReST results on test set.</span> We see that <math id="A1.F12.2.m1.1" class="ltx_Math" alttext="\rest" display="inline"><semantics id="A1.F12.2.m1.1b"><merror class="ltx_ERROR undefined undefined" id="A1.F12.2.m1.1.1" xref="A1.F12.2.m1.1.1b.cmml"><mtext id="A1.F12.2.m1.1.1b" xref="A1.F12.2.m1.1.1b.cmml">\rest</mtext></merror><annotation-xml encoding="MathML-Content" id="A1.F12.2.m1.1c"><ci id="A1.F12.2.m1.1.1b.cmml" xref="A1.F12.2.m1.1.1"><merror class="ltx_ERROR undefined undefined" id="A1.F12.2.m1.1.1.cmml" xref="A1.F12.2.m1.1.1"><mtext id="A1.F12.2.m1.1.1a.cmml" xref="A1.F12.2.m1.1.1">\rest</mtext></merror></ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F12.2.m1.1d">\rest</annotation></semantics></math> clearly outperforms the baselines (right) and the reward of the model on the test set increases with the number of <span id="A1.F12.7.2" class="ltx_text ltx_font_typewriter">Improve</span> steps.
</figcaption>
</figure>
</section>
<section id="A1.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Additional experiments</h3>

<div id="A1.SS7.p1" class="ltx_para">
<p id="A1.SS7.p1.1" class="ltx_p">This section reports the results of several ablations in <span id="A1.SS7.p1.1.1" class="ltx_ERROR undefined">\rest</span> which explain some of the design choices that we made.</p>
</div>
<section id="A1.SS7.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">GOLD loss compared to BC loss in <span id="A1.SS7.SSS0.Px1.1.1" class="ltx_text ltx_font_typewriter">Improve</span> step</h5>

<div id="A1.SS7.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS7.SSS0.Px1.p1.1" class="ltx_p">In Figure <a href="#A1.F14" title="Figure 14 ‣ GOLD loss compared to BC loss in Improve step ‣ A.7 Additional experiments ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>, we compare GOLD against BC losses with the increasing number of <span id="A1.SS7.SSS0.Px1.p1.1.1" class="ltx_ERROR undefined">\rest</span> <span id="A1.SS7.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_typewriter">Improve</span> steps on WMT 2020 Zh-En dataset. The performance of both BC and GOLD improves with the number of <span id="A1.SS7.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_typewriter">Improve</span> steps, but BC performs better than GOLD in every setting.</p>
</div>
<figure id="A1.F14" class="ltx_figure">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span id="A1.F14.5.1" class="ltx_text ltx_font_bold">[WMT 2020 Zh-En]:</span> GOLD loss vs BC loss in multi-step improvement. The performance of all methods improves with more steps, but BC loss always performs better than other offline RL losses that we tried.</figcaption><div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A1.F14.1" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_center ltx_align_middle" style="width:195.1pt;">
<span id="A1.F14.1.p1" class="ltx_para ltx_align_center"><img src="assets/plots/wmt_GOLD_vs_BC_rest_ablations.png" id="A1.F14.1.p1.g1" class="ltx_graphics ltx_img_landscape" width="574" height="175" alt="Refer to caption">
</span></span></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><span id="A1.F14.2" class="ltx_inline-para ltx_minipage ltx_flex_size_2 ltx_align_center ltx_align_middle" style="width:195.1pt;">
<span id="A1.F14.2.p1" class="ltx_para ltx_align_center"><img src="assets/plots/iwslt_baseline_comparisons.png" id="A1.F14.2.p1.g1" class="ltx_graphics ltx_img_landscape" width="574" height="189" alt="Refer to caption">
</span></span></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span id="A1.F14.5.1" class="ltx_text ltx_font_bold">[WMT 2020 Zh-En]:</span> GOLD loss vs BC loss in multi-step improvement. The performance of all methods improves with more steps, but BC loss always performs better than other offline RL losses that we tried.</figcaption>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span><span id="A1.F14.9.1" class="ltx_text ltx_font_bold">[IWSLT 2014 De-En]:</span> BVMPO, BC, GOLD losses used in <span id="A1.F14.10.2" class="ltx_ERROR undefined">\rest</span>. BC loss with three <span id="A1.F14.11.3" class="ltx_text ltx_font_typewriter">Improve</span> steps yields the best results.</figcaption>
</figure>
</section>
<section id="A1.SS7.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Loss comparison on IWSLT 2014 De-En</h5>

<div id="A1.SS7.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS7.SSS0.Px2.p1.1" class="ltx_p">In Figure <a href="#A1.F14" title="Figure 14 ‣ GOLD loss compared to BC loss in Improve step ‣ A.7 Additional experiments ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>, we compare BVMPO, BC and GOLD losses in <span id="A1.SS7.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">Improve</span> step on IWSLT 2014. The results are consistent with WMT dataset: in short, <span id="A1.SS7.SSS0.Px2.p1.1.2" class="ltx_ERROR undefined">\rest</span> with BC loss and multiple <span id="A1.SS7.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_typewriter">Improve</span> steps outperforms other approaches.</p>
</div>
</section>
<section id="A1.SS7.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Selecting threshold based on percentiles of reward model scores</h5>

<div id="A1.SS7.SSS0.Px3.p1" class="ltx_para">
<p id="A1.SS7.SSS0.Px3.p1.1" class="ltx_p">Using a single threshold for all the source-candidate pairs may lead to a scenario with no training data for certain (harder) source sentences or contexts. Alternatively, we can filter the candidate sentences based on the percentile of the scores given their source. This way of filtering based on percentiles effectively results in changing the thresholds for each source sentence. The results are presented in Figure <a href="#A1.F15" title="Figure 15 ‣ Selecting threshold based on percentiles of reward model scores ‣ A.7 Additional experiments ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>. As the filtering percentile increases, the performance increases, but it starts saturating, and the gains become smaller after <math id="A1.SS7.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="p=90" display="inline"><semantics id="A1.SS7.SSS0.Px3.p1.1.m1.1a"><mrow id="A1.SS7.SSS0.Px3.p1.1.m1.1.1" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.2" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.2.cmml">p</mi><mo id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.1" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.3" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.3.cmml">90</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px3.p1.1.m1.1b"><apply id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1"><eq id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.1"></eq><ci id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.2">𝑝</ci><cn type="integer" id="A1.SS7.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="A1.SS7.SSS0.Px3.p1.1.m1.1.1.3">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px3.p1.1.m1.1c">p=90</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px3.p1.1.m1.1d">italic_p = 90</annotation></semantics></math>. The results are generally similar to those with global threshold-based filtering.</p>
</div>
<figure id="A1.F15" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_percentile_comparisons.png" id="A1.F15.g1" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" width="240" height="182" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_rest_percentile_improvements_comparisons.png" id="A1.F15.g2" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" width="240" height="182" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span><span id="A1.F15.6.1" class="ltx_text ltx_font_bold">[IWSLT 2014 De-En] percentiles</span>: Filtering data based on percentiles of reward scores for each source candidate. <span id="A1.F15.7.2" class="ltx_ERROR undefined">\rest</span> performs better with increasing percentile and the performance saturates after <math id="A1.F15.2.m1.1" class="ltx_Math" alttext="p=90" display="inline"><semantics id="A1.F15.2.m1.1b"><mrow id="A1.F15.2.m1.1.1" xref="A1.F15.2.m1.1.1.cmml"><mi id="A1.F15.2.m1.1.1.2" xref="A1.F15.2.m1.1.1.2.cmml">p</mi><mo id="A1.F15.2.m1.1.1.1" xref="A1.F15.2.m1.1.1.1.cmml">=</mo><mn id="A1.F15.2.m1.1.1.3" xref="A1.F15.2.m1.1.1.3.cmml">90</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F15.2.m1.1c"><apply id="A1.F15.2.m1.1.1.cmml" xref="A1.F15.2.m1.1.1"><eq id="A1.F15.2.m1.1.1.1.cmml" xref="A1.F15.2.m1.1.1.1"></eq><ci id="A1.F15.2.m1.1.1.2.cmml" xref="A1.F15.2.m1.1.1.2">𝑝</ci><cn type="integer" id="A1.F15.2.m1.1.1.3.cmml" xref="A1.F15.2.m1.1.1.3">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F15.2.m1.1d">p=90</annotation><annotation encoding="application/x-llamapun" id="A1.F15.2.m1.1e">italic_p = 90</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="A1.SS7.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Selecting threshold based on linear interpolation between the mean and max scores of candidates</h5>

<div id="A1.SS7.SSS0.Px4.p1" class="ltx_para">
<p id="A1.SS7.SSS0.Px4.p1.5" class="ltx_p">An alternative way of specifying filters based on a source sentence is to compute the filter based on a max reward score (<math id="A1.SS7.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="V^{\max}(source)" display="inline"><semantics id="A1.SS7.SSS0.Px4.p1.1.m1.1a"><mrow id="A1.SS7.SSS0.Px4.p1.1.m1.1.1" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.cmml"><msup id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.cmml"><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.2" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.2.cmml">V</mi><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.3" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.3.cmml">max</mi></msup><mo id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.cmml"><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.cmml">s</mi><mo id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml">o</mi><mo id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1a" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.4" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.4.cmml">u</mi><mo id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1b" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.5" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.5.cmml">r</mi><mo id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1c" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.6" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.6.cmml">c</mi><mo id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1d" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.7" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px4.p1.1.m1.1b"><apply id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1"><times id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.2"></times><apply id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.1.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.2.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.2">𝑉</ci><max id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.3.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.3.3"></max></apply><apply id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1"><times id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.1"></times><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.3">𝑜</ci><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.4.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.4">𝑢</ci><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.5.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.5">𝑟</ci><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.6.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.6">𝑐</ci><ci id="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.7.cmml" xref="A1.SS7.SSS0.Px4.p1.1.m1.1.1.1.1.1.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px4.p1.1.m1.1c">V^{\max}(source)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px4.p1.1.m1.1d">italic_V start_POSTSUPERSCRIPT roman_max end_POSTSUPERSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e )</annotation></semantics></math>) and the mean candidate score (<math id="A1.SS7.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="V^{\text{mean}}(source)" display="inline"><semantics id="A1.SS7.SSS0.Px4.p1.2.m2.1a"><mrow id="A1.SS7.SSS0.Px4.p1.2.m2.1.1" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.cmml"><msup id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.cmml"><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.2" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.2.cmml">V</mi><mtext id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.3" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.3a.cmml">mean</mtext></msup><mo id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.2" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml">s</mi><mo id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml">o</mi><mo id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1a" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.4" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.4.cmml">u</mi><mo id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1b" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.5" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.5.cmml">r</mi><mo id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1c" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.6" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.6.cmml">c</mi><mo id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1d" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.7" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px4.p1.2.m2.1b"><apply id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1"><times id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.2"></times><apply id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.1.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.2.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.2">𝑉</ci><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.3a.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.3"><mtext mathsize="70%" id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.3.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.3.3">mean</mtext></ci></apply><apply id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1"><times id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.1"></times><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.2">𝑠</ci><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.3">𝑜</ci><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.4.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.4">𝑢</ci><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.5.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.5">𝑟</ci><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.6.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.6">𝑐</ci><ci id="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.7.cmml" xref="A1.SS7.SSS0.Px4.p1.2.m2.1.1.1.1.1.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px4.p1.2.m2.1c">V^{\text{mean}}(source)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px4.p1.2.m2.1d">italic_V start_POSTSUPERSCRIPT mean end_POSTSUPERSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e )</annotation></semantics></math>) for a give source sentence. Then, we select the threshold for each source sentence as <math id="A1.SS7.SSS0.Px4.p1.3.m3.4" class="ltx_Math" alttext="\tau_{\gamma}(source)=\gamma V^{\max}(source)+(1-\gamma)V^{\text{mean}}(source)" display="inline"><semantics id="A1.SS7.SSS0.Px4.p1.3.m3.4a"><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.4.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.cmml"><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.cmml"><msub id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.2.cmml">τ</mi><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.3.cmml">γ</mi></msub><mo id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.2.cmml">s</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.3.cmml">o</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1a" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.4.cmml">u</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1b" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.5" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.5.cmml">r</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1c" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.6" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.6.cmml">c</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1d" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.7" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.5" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.5.cmml">=</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.cmml"><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.3.cmml">γ</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.2.cmml">⁢</mo><msup id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.2.cmml">V</mi><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.3.cmml">max</mi></msup><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.2a" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.2.cmml">⁢</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.2.cmml">s</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.3.cmml">o</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1a" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.4.cmml">u</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1b" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.5" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.5.cmml">r</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1c" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.6" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.6.cmml">c</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1d" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.7" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.4.cmml">+</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.cmml"><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.cmml"><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.cmml"><mn id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.2.cmml">1</mn><mo id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.1.cmml">−</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.3.cmml">γ</mi></mrow><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.cmml">)</mo></mrow><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.3.cmml">⁢</mo><msup id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.2.cmml">V</mi><mtext id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.3a.cmml">mean</mtext></msup><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.3a" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.3.cmml">⁢</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.cmml"><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.cmml">(</mo><mrow id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.cmml"><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.2" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.2.cmml">s</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.3.cmml">o</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1a" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.4" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.4.cmml">u</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1b" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.5" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.5.cmml">r</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1c" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.6" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.6.cmml">c</mi><mo id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1d" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1.cmml">⁢</mo><mi id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.7" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.3" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px4.p1.3.m3.4b"><apply id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4"><eq id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.5.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.5"></eq><apply id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1"><times id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.2"></times><apply id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3">subscript</csymbol><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.2">𝜏</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.3.3">𝛾</ci></apply><apply id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1"><times id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.1"></times><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.2">𝑠</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.3">𝑜</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.4">𝑢</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.5.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.5">𝑟</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.6.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.6">𝑐</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.7.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.1.1.1.1.1.1.7">𝑒</ci></apply></apply><apply id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4"><plus id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.4"></plus><apply id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1"><times id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.2"></times><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.3">𝛾</ci><apply id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4">superscript</csymbol><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.2">𝑉</ci><max id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.4.3"></max></apply><apply id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1"><times id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.1"></times><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.2">𝑠</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.3">𝑜</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.4">𝑢</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.5.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.5">𝑟</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.6.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.6">𝑐</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.7.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.2.2.2.1.1.1.1.7">𝑒</ci></apply></apply><apply id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3"><times id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.3"></times><apply id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1"><minus id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.1"></minus><cn type="integer" id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.2">1</cn><ci id="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.3.3.3.2.1.1.1.3">𝛾</ci></apply><apply id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4"><csymbol cd="ambiguous" id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4">superscript</csymbol><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.2">𝑉</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.3a.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.3"><mtext mathsize="70%" id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.4.3">mean</mtext></ci></apply><apply id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1"><times id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.1"></times><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.2.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.2">𝑠</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.3.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.3">𝑜</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.4.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.4">𝑢</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.5.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.5">𝑟</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.6.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.6">𝑐</ci><ci id="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.7.cmml" xref="A1.SS7.SSS0.Px4.p1.3.m3.4.4.4.3.2.1.1.7">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px4.p1.3.m3.4c">\tau_{\gamma}(source)=\gamma V^{\max}(source)+(1-\gamma)V^{\text{mean}}(source)</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px4.p1.3.m3.4d">italic_τ start_POSTSUBSCRIPT italic_γ end_POSTSUBSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e ) = italic_γ italic_V start_POSTSUPERSCRIPT roman_max end_POSTSUPERSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e ) + ( 1 - italic_γ ) italic_V start_POSTSUPERSCRIPT mean end_POSTSUPERSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e )</annotation></semantics></math>. At each <span id="A1.SS7.SSS0.Px4.p1.5.1" class="ltx_text ltx_font_typewriter">Improve</span> step, we increase the parameter <math id="A1.SS7.SSS0.Px4.p1.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.SS7.SSS0.Px4.p1.4.m4.1a"><mi id="A1.SS7.SSS0.Px4.p1.4.m4.1.1" xref="A1.SS7.SSS0.Px4.p1.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px4.p1.4.m4.1b"><ci id="A1.SS7.SSS0.Px4.p1.4.m4.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px4.p1.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px4.p1.4.m4.1d">italic_γ</annotation></semantics></math>. We report the results with respect to different <math id="A1.SS7.SSS0.Px4.p1.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.SS7.SSS0.Px4.p1.5.m5.1a"><mi id="A1.SS7.SSS0.Px4.p1.5.m5.1.1" xref="A1.SS7.SSS0.Px4.p1.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS7.SSS0.Px4.p1.5.m5.1b"><ci id="A1.SS7.SSS0.Px4.p1.5.m5.1.1.cmml" xref="A1.SS7.SSS0.Px4.p1.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS7.SSS0.Px4.p1.5.m5.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.SS7.SSS0.Px4.p1.5.m5.1d">italic_γ</annotation></semantics></math> values in Figure <a href="#A1.F16" title="Figure 16 ‣ Selecting threshold based on linear interpolation between the mean and max scores of candidates ‣ A.7 Additional experiments ‣ Appendix A Appendix ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>. In a nutshell, computing the threshold by interpolating the max and mean scores for a given candidate gives results similar to the percentile-based way of computing the thresholds per source. Also we can see that the schedule of thresholds and the number of <span id="A1.SS7.SSS0.Px4.p1.5.2" class="ltx_text ltx_font_typewriter">Improve</span> steps have a large impact on the final performance of the model.</p>
</div>
<figure id="A1.F16" class="ltx_figure">
<div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_interpolation_comparisons.png" id="A1.F16.g1" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_square" width="210" height="199" alt="Refer to caption"></div>
<div class="ltx_flex_cell 
                  ltx_flex_size_2"><img src="assets/plots/iwslt_rest_interpolation_comparisons.png" id="A1.F16.g2" class="ltx_graphics ltx_centering ltx_flex_size_2 ltx_img_landscape" width="311" height="198" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span><span id="A1.F16.18.1" class="ltx_text ltx_font_bold">[IWSLT 2014 De-En] interpolation experiments:</span> Threshold in <span id="A1.F16.19.2" class="ltx_text ltx_font_typewriter">Improve</span> step is chosen for each candidate sentence as <math id="A1.F16.7.m1.3" class="ltx_Math" alttext="\gamma V^{\max}(source)+(1-\gamma)V^{\text{mean}}(source)" display="inline"><semantics id="A1.F16.7.m1.3b"><mrow id="A1.F16.7.m1.3.3" xref="A1.F16.7.m1.3.3.cmml"><mrow id="A1.F16.7.m1.1.1.1" xref="A1.F16.7.m1.1.1.1.cmml"><mi id="A1.F16.7.m1.1.1.1.3" xref="A1.F16.7.m1.1.1.1.3.cmml">γ</mi><mo id="A1.F16.7.m1.1.1.1.2" xref="A1.F16.7.m1.1.1.1.2.cmml">⁢</mo><msup id="A1.F16.7.m1.1.1.1.4" xref="A1.F16.7.m1.1.1.1.4.cmml"><mi id="A1.F16.7.m1.1.1.1.4.2" xref="A1.F16.7.m1.1.1.1.4.2.cmml">V</mi><mi id="A1.F16.7.m1.1.1.1.4.3" xref="A1.F16.7.m1.1.1.1.4.3.cmml">max</mi></msup><mo id="A1.F16.7.m1.1.1.1.2b" xref="A1.F16.7.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.F16.7.m1.1.1.1.1.1" xref="A1.F16.7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.F16.7.m1.1.1.1.1.1.2" xref="A1.F16.7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.F16.7.m1.1.1.1.1.1.1" xref="A1.F16.7.m1.1.1.1.1.1.1.cmml"><mi id="A1.F16.7.m1.1.1.1.1.1.1.2" xref="A1.F16.7.m1.1.1.1.1.1.1.2.cmml">s</mi><mo id="A1.F16.7.m1.1.1.1.1.1.1.1" xref="A1.F16.7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.1.1.1.1.1.1.3" xref="A1.F16.7.m1.1.1.1.1.1.1.3.cmml">o</mi><mo id="A1.F16.7.m1.1.1.1.1.1.1.1b" xref="A1.F16.7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.1.1.1.1.1.1.4" xref="A1.F16.7.m1.1.1.1.1.1.1.4.cmml">u</mi><mo id="A1.F16.7.m1.1.1.1.1.1.1.1c" xref="A1.F16.7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.1.1.1.1.1.1.5" xref="A1.F16.7.m1.1.1.1.1.1.1.5.cmml">r</mi><mo id="A1.F16.7.m1.1.1.1.1.1.1.1d" xref="A1.F16.7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.1.1.1.1.1.1.6" xref="A1.F16.7.m1.1.1.1.1.1.1.6.cmml">c</mi><mo id="A1.F16.7.m1.1.1.1.1.1.1.1e" xref="A1.F16.7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.1.1.1.1.1.1.7" xref="A1.F16.7.m1.1.1.1.1.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.F16.7.m1.1.1.1.1.1.3" xref="A1.F16.7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.F16.7.m1.3.3.4" xref="A1.F16.7.m1.3.3.4.cmml">+</mo><mrow id="A1.F16.7.m1.3.3.3" xref="A1.F16.7.m1.3.3.3.cmml"><mrow id="A1.F16.7.m1.2.2.2.1.1" xref="A1.F16.7.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A1.F16.7.m1.2.2.2.1.1.2" xref="A1.F16.7.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A1.F16.7.m1.2.2.2.1.1.1" xref="A1.F16.7.m1.2.2.2.1.1.1.cmml"><mn id="A1.F16.7.m1.2.2.2.1.1.1.2" xref="A1.F16.7.m1.2.2.2.1.1.1.2.cmml">1</mn><mo id="A1.F16.7.m1.2.2.2.1.1.1.1" xref="A1.F16.7.m1.2.2.2.1.1.1.1.cmml">−</mo><mi id="A1.F16.7.m1.2.2.2.1.1.1.3" xref="A1.F16.7.m1.2.2.2.1.1.1.3.cmml">γ</mi></mrow><mo stretchy="false" id="A1.F16.7.m1.2.2.2.1.1.3" xref="A1.F16.7.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="A1.F16.7.m1.3.3.3.3" xref="A1.F16.7.m1.3.3.3.3.cmml">⁢</mo><msup id="A1.F16.7.m1.3.3.3.4" xref="A1.F16.7.m1.3.3.3.4.cmml"><mi id="A1.F16.7.m1.3.3.3.4.2" xref="A1.F16.7.m1.3.3.3.4.2.cmml">V</mi><mtext id="A1.F16.7.m1.3.3.3.4.3" xref="A1.F16.7.m1.3.3.3.4.3a.cmml">mean</mtext></msup><mo id="A1.F16.7.m1.3.3.3.3b" xref="A1.F16.7.m1.3.3.3.3.cmml">⁢</mo><mrow id="A1.F16.7.m1.3.3.3.2.1" xref="A1.F16.7.m1.3.3.3.2.1.1.cmml"><mo stretchy="false" id="A1.F16.7.m1.3.3.3.2.1.2" xref="A1.F16.7.m1.3.3.3.2.1.1.cmml">(</mo><mrow id="A1.F16.7.m1.3.3.3.2.1.1" xref="A1.F16.7.m1.3.3.3.2.1.1.cmml"><mi id="A1.F16.7.m1.3.3.3.2.1.1.2" xref="A1.F16.7.m1.3.3.3.2.1.1.2.cmml">s</mi><mo id="A1.F16.7.m1.3.3.3.2.1.1.1" xref="A1.F16.7.m1.3.3.3.2.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.3.3.3.2.1.1.3" xref="A1.F16.7.m1.3.3.3.2.1.1.3.cmml">o</mi><mo id="A1.F16.7.m1.3.3.3.2.1.1.1b" xref="A1.F16.7.m1.3.3.3.2.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.3.3.3.2.1.1.4" xref="A1.F16.7.m1.3.3.3.2.1.1.4.cmml">u</mi><mo id="A1.F16.7.m1.3.3.3.2.1.1.1c" xref="A1.F16.7.m1.3.3.3.2.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.3.3.3.2.1.1.5" xref="A1.F16.7.m1.3.3.3.2.1.1.5.cmml">r</mi><mo id="A1.F16.7.m1.3.3.3.2.1.1.1d" xref="A1.F16.7.m1.3.3.3.2.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.3.3.3.2.1.1.6" xref="A1.F16.7.m1.3.3.3.2.1.1.6.cmml">c</mi><mo id="A1.F16.7.m1.3.3.3.2.1.1.1e" xref="A1.F16.7.m1.3.3.3.2.1.1.1.cmml">⁢</mo><mi id="A1.F16.7.m1.3.3.3.2.1.1.7" xref="A1.F16.7.m1.3.3.3.2.1.1.7.cmml">e</mi></mrow><mo stretchy="false" id="A1.F16.7.m1.3.3.3.2.1.3" xref="A1.F16.7.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.F16.7.m1.3c"><apply id="A1.F16.7.m1.3.3.cmml" xref="A1.F16.7.m1.3.3"><plus id="A1.F16.7.m1.3.3.4.cmml" xref="A1.F16.7.m1.3.3.4"></plus><apply id="A1.F16.7.m1.1.1.1.cmml" xref="A1.F16.7.m1.1.1.1"><times id="A1.F16.7.m1.1.1.1.2.cmml" xref="A1.F16.7.m1.1.1.1.2"></times><ci id="A1.F16.7.m1.1.1.1.3.cmml" xref="A1.F16.7.m1.1.1.1.3">𝛾</ci><apply id="A1.F16.7.m1.1.1.1.4.cmml" xref="A1.F16.7.m1.1.1.1.4"><csymbol cd="ambiguous" id="A1.F16.7.m1.1.1.1.4.1.cmml" xref="A1.F16.7.m1.1.1.1.4">superscript</csymbol><ci id="A1.F16.7.m1.1.1.1.4.2.cmml" xref="A1.F16.7.m1.1.1.1.4.2">𝑉</ci><max id="A1.F16.7.m1.1.1.1.4.3.cmml" xref="A1.F16.7.m1.1.1.1.4.3"></max></apply><apply id="A1.F16.7.m1.1.1.1.1.1.1.cmml" xref="A1.F16.7.m1.1.1.1.1.1"><times id="A1.F16.7.m1.1.1.1.1.1.1.1.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.1"></times><ci id="A1.F16.7.m1.1.1.1.1.1.1.2.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="A1.F16.7.m1.1.1.1.1.1.1.3.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.3">𝑜</ci><ci id="A1.F16.7.m1.1.1.1.1.1.1.4.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.4">𝑢</ci><ci id="A1.F16.7.m1.1.1.1.1.1.1.5.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.5">𝑟</ci><ci id="A1.F16.7.m1.1.1.1.1.1.1.6.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.6">𝑐</ci><ci id="A1.F16.7.m1.1.1.1.1.1.1.7.cmml" xref="A1.F16.7.m1.1.1.1.1.1.1.7">𝑒</ci></apply></apply><apply id="A1.F16.7.m1.3.3.3.cmml" xref="A1.F16.7.m1.3.3.3"><times id="A1.F16.7.m1.3.3.3.3.cmml" xref="A1.F16.7.m1.3.3.3.3"></times><apply id="A1.F16.7.m1.2.2.2.1.1.1.cmml" xref="A1.F16.7.m1.2.2.2.1.1"><minus id="A1.F16.7.m1.2.2.2.1.1.1.1.cmml" xref="A1.F16.7.m1.2.2.2.1.1.1.1"></minus><cn type="integer" id="A1.F16.7.m1.2.2.2.1.1.1.2.cmml" xref="A1.F16.7.m1.2.2.2.1.1.1.2">1</cn><ci id="A1.F16.7.m1.2.2.2.1.1.1.3.cmml" xref="A1.F16.7.m1.2.2.2.1.1.1.3">𝛾</ci></apply><apply id="A1.F16.7.m1.3.3.3.4.cmml" xref="A1.F16.7.m1.3.3.3.4"><csymbol cd="ambiguous" id="A1.F16.7.m1.3.3.3.4.1.cmml" xref="A1.F16.7.m1.3.3.3.4">superscript</csymbol><ci id="A1.F16.7.m1.3.3.3.4.2.cmml" xref="A1.F16.7.m1.3.3.3.4.2">𝑉</ci><ci id="A1.F16.7.m1.3.3.3.4.3a.cmml" xref="A1.F16.7.m1.3.3.3.4.3"><mtext mathsize="70%" id="A1.F16.7.m1.3.3.3.4.3.cmml" xref="A1.F16.7.m1.3.3.3.4.3">mean</mtext></ci></apply><apply id="A1.F16.7.m1.3.3.3.2.1.1.cmml" xref="A1.F16.7.m1.3.3.3.2.1"><times id="A1.F16.7.m1.3.3.3.2.1.1.1.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.1"></times><ci id="A1.F16.7.m1.3.3.3.2.1.1.2.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.2">𝑠</ci><ci id="A1.F16.7.m1.3.3.3.2.1.1.3.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.3">𝑜</ci><ci id="A1.F16.7.m1.3.3.3.2.1.1.4.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.4">𝑢</ci><ci id="A1.F16.7.m1.3.3.3.2.1.1.5.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.5">𝑟</ci><ci id="A1.F16.7.m1.3.3.3.2.1.1.6.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.6">𝑐</ci><ci id="A1.F16.7.m1.3.3.3.2.1.1.7.cmml" xref="A1.F16.7.m1.3.3.3.2.1.1.7">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F16.7.m1.3d">\gamma V^{\max}(source)+(1-\gamma)V^{\text{mean}}(source)</annotation><annotation encoding="application/x-llamapun" id="A1.F16.7.m1.3e">italic_γ italic_V start_POSTSUPERSCRIPT roman_max end_POSTSUPERSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e ) + ( 1 - italic_γ ) italic_V start_POSTSUPERSCRIPT mean end_POSTSUPERSCRIPT ( italic_s italic_o italic_u italic_r italic_c italic_e )</annotation></semantics></math>. On the left, experiments with <span id="A1.F16.20.3" class="ltx_text ltx_markedasmath ltx_font_typewriter">I=1</span> provide improvements and increasing <math id="A1.F16.9.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.F16.9.m3.1b"><mi id="A1.F16.9.m3.1.1" xref="A1.F16.9.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.F16.9.m3.1c"><ci id="A1.F16.9.m3.1.1.cmml" xref="A1.F16.9.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F16.9.m3.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.F16.9.m3.1e">italic_γ</annotation></semantics></math>, which also helps substantially. On the right, we present the results with <math id="A1.F16.10.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.F16.10.m4.1b"><mi id="A1.F16.10.m4.1.1" xref="A1.F16.10.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.F16.10.m4.1c"><ci id="A1.F16.10.m4.1.1.cmml" xref="A1.F16.10.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F16.10.m4.1d">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.F16.10.m4.1e">italic_γ</annotation></semantics></math> starting with <math id="A1.F16.11.m5.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="A1.F16.11.m5.1b"><mn id="A1.F16.11.m5.1.1" xref="A1.F16.11.m5.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A1.F16.11.m5.1c"><cn type="float" id="A1.F16.11.m5.1.1.cmml" xref="A1.F16.11.m5.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F16.11.m5.1d">0.5</annotation><annotation encoding="application/x-llamapun" id="A1.F16.11.m5.1e">0.5</annotation></semantics></math> instead of <math id="A1.F16.12.m6.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="A1.F16.12.m6.1b"><mn id="A1.F16.12.m6.1.1" xref="A1.F16.12.m6.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="A1.F16.12.m6.1c"><cn type="float" id="A1.F16.12.m6.1.1.cmml" xref="A1.F16.12.m6.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.F16.12.m6.1d">0.5</annotation><annotation encoding="application/x-llamapun" id="A1.F16.12.m6.1e">0.5</annotation></semantics></math>. As it can be seen from this figure, the number of <span id="A1.F16.21.4" class="ltx_text ltx_font_typewriter">Improve</span> steps and how the thresholds are selected greatly influence the final performance of the model. </figcaption>
</figure>
</section>
</section>
<section id="A1.SS8" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.8 </span>Baseline Algorithms</h3>

<div id="A1.SS8.p1" class="ltx_para">
<p id="A1.SS8.p1.1" class="ltx_p">This section provides details on the baseline losses used in Figure <a href="#S4.F5" title="Figure 5 ‣ Do multiple Improve steps in \rest increase the reward model scores? ‣ 4 Experiments and analysis ‣ Reinforced Self-Training (\rest) for Language Modeling" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<section id="A1.SS8.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.8.1 </span>BVMPO</h4>

<div id="A1.SS8.SSS1.p1" class="ltx_para">
<p id="A1.SS8.SSS1.p1.2" class="ltx_p">The BVMPO approach is similar to DIME proposed by <cite class="ltx_cite ltx_citemacro_cite">Abdolmaleki et al. (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite>. The main difference is that we use a state-value function instead of Q funtion with v-trace <cite class="ltx_cite ltx_citemacro_citep">(Espeholt et al., <a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite>, similarly to V-MPO <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a href="#bib.bib52" title="" class="ltx_ref">2020</a>)</cite>. We train separate neural networks for policy and value function. The policy is pre-trained with BC and the value network is pre-trained with BVE to estimate the behavior value <math id="A1.SS8.SSS1.p1.1.m1.1" class="ltx_Math" alttext="V^{\beta}" display="inline"><semantics id="A1.SS8.SSS1.p1.1.m1.1a"><msup id="A1.SS8.SSS1.p1.1.m1.1.1" xref="A1.SS8.SSS1.p1.1.m1.1.1.cmml"><mi id="A1.SS8.SSS1.p1.1.m1.1.1.2" xref="A1.SS8.SSS1.p1.1.m1.1.1.2.cmml">V</mi><mi id="A1.SS8.SSS1.p1.1.m1.1.1.3" xref="A1.SS8.SSS1.p1.1.m1.1.1.3.cmml">β</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS1.p1.1.m1.1b"><apply id="A1.SS8.SSS1.p1.1.m1.1.1.cmml" xref="A1.SS8.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS8.SSS1.p1.1.m1.1.1.1.cmml" xref="A1.SS8.SSS1.p1.1.m1.1.1">superscript</csymbol><ci id="A1.SS8.SSS1.p1.1.m1.1.1.2.cmml" xref="A1.SS8.SSS1.p1.1.m1.1.1.2">𝑉</ci><ci id="A1.SS8.SSS1.p1.1.m1.1.1.3.cmml" xref="A1.SS8.SSS1.p1.1.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS1.p1.1.m1.1c">V^{\beta}</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS1.p1.1.m1.1d">italic_V start_POSTSUPERSCRIPT italic_β end_POSTSUPERSCRIPT</annotation></semantics></math>. BVMPO uses the behavioral cloning policy <math id="A1.SS8.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\pi^{\beta}(a|s)" display="inline"><semantics id="A1.SS8.SSS1.p1.2.m2.1a"><mrow id="A1.SS8.SSS1.p1.2.m2.1.1" xref="A1.SS8.SSS1.p1.2.m2.1.1.cmml"><msup id="A1.SS8.SSS1.p1.2.m2.1.1.3" xref="A1.SS8.SSS1.p1.2.m2.1.1.3.cmml"><mi id="A1.SS8.SSS1.p1.2.m2.1.1.3.2" xref="A1.SS8.SSS1.p1.2.m2.1.1.3.2.cmml">π</mi><mi id="A1.SS8.SSS1.p1.2.m2.1.1.3.3" xref="A1.SS8.SSS1.p1.2.m2.1.1.3.3.cmml">β</mi></msup><mo id="A1.SS8.SSS1.p1.2.m2.1.1.2" xref="A1.SS8.SSS1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="A1.SS8.SSS1.p1.2.m2.1.1.1.1" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.2" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.2" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.1" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.3" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.3" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS1.p1.2.m2.1b"><apply id="A1.SS8.SSS1.p1.2.m2.1.1.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1"><times id="A1.SS8.SSS1.p1.2.m2.1.1.2.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.2"></times><apply id="A1.SS8.SSS1.p1.2.m2.1.1.3.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS8.SSS1.p1.2.m2.1.1.3.1.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS8.SSS1.p1.2.m2.1.1.3.2.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.3.2">𝜋</ci><ci id="A1.SS8.SSS1.p1.2.m2.1.1.3.3.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.3.3">𝛽</ci></apply><apply id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.2">𝑎</ci><ci id="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="A1.SS8.SSS1.p1.2.m2.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS1.p1.2.m2.1c">\pi^{\beta}(a|s)</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS1.p1.2.m2.1d">italic_π start_POSTSUPERSCRIPT italic_β end_POSTSUPERSCRIPT ( italic_a | italic_s )</annotation></semantics></math> as a behaviour prior:</p>
<table id="A1.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E4.m1.1" class="ltx_Math" alttext="{\mathcal{L}}_{BVMPO}={\mathcal{L}}_{VMPO}+\lambda\textup{KL}(\pi^{\beta}|\pi)." display="block"><semantics id="A1.E4.m1.1a"><mrow id="A1.E4.m1.1.1.1" xref="A1.E4.m1.1.1.1.1.cmml"><mrow id="A1.E4.m1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.cmml"><msub id="A1.E4.m1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E4.m1.1.1.1.1.3.2" xref="A1.E4.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="A1.E4.m1.1.1.1.1.3.3" xref="A1.E4.m1.1.1.1.1.3.3.cmml"><mi id="A1.E4.m1.1.1.1.1.3.3.2" xref="A1.E4.m1.1.1.1.1.3.3.2.cmml">B</mi><mo id="A1.E4.m1.1.1.1.1.3.3.1" xref="A1.E4.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.3.3.3" xref="A1.E4.m1.1.1.1.1.3.3.3.cmml">V</mi><mo id="A1.E4.m1.1.1.1.1.3.3.1a" xref="A1.E4.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.3.3.4" xref="A1.E4.m1.1.1.1.1.3.3.4.cmml">M</mi><mo id="A1.E4.m1.1.1.1.1.3.3.1b" xref="A1.E4.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.3.3.5" xref="A1.E4.m1.1.1.1.1.3.3.5.cmml">P</mi><mo id="A1.E4.m1.1.1.1.1.3.3.1c" xref="A1.E4.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.3.3.6" xref="A1.E4.m1.1.1.1.1.3.3.6.cmml">O</mi></mrow></msub><mo id="A1.E4.m1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="A1.E4.m1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.cmml"><msub id="A1.E4.m1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E4.m1.1.1.1.1.1.3.2" xref="A1.E4.m1.1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="A1.E4.m1.1.1.1.1.1.3.3" xref="A1.E4.m1.1.1.1.1.1.3.3.cmml"><mi id="A1.E4.m1.1.1.1.1.1.3.3.2" xref="A1.E4.m1.1.1.1.1.1.3.3.2.cmml">V</mi><mo id="A1.E4.m1.1.1.1.1.1.3.3.1" xref="A1.E4.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.1.3.3.3" xref="A1.E4.m1.1.1.1.1.1.3.3.3.cmml">M</mi><mo id="A1.E4.m1.1.1.1.1.1.3.3.1a" xref="A1.E4.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.1.3.3.4" xref="A1.E4.m1.1.1.1.1.1.3.3.4.cmml">P</mi><mo id="A1.E4.m1.1.1.1.1.1.3.3.1b" xref="A1.E4.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="A1.E4.m1.1.1.1.1.1.3.3.5" xref="A1.E4.m1.1.1.1.1.1.3.3.5.cmml">O</mi></mrow></msub><mo id="A1.E4.m1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="A1.E4.m1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.cmml"><mi id="A1.E4.m1.1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.1.3.cmml">λ</mi><mo id="A1.E4.m1.1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mtext id="A1.E4.m1.1.1.1.1.1.1.4" xref="A1.E4.m1.1.1.1.1.1.1.4a.cmml">KL</mtext><mo id="A1.E4.m1.1.1.1.1.1.1.2a" xref="A1.E4.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E4.m1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E4.m1.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E4.m1.1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">π</mi><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">β</mi></msup><mo fence="false" id="A1.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">π</mi></mrow><mo stretchy="false" id="A1.E4.m1.1.1.1.1.1.1.1.1.3" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A1.E4.m1.1.1.1.2" xref="A1.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E4.m1.1b"><apply id="A1.E4.m1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1"><eq id="A1.E4.m1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.2"></eq><apply id="A1.E4.m1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E4.m1.1.1.1.1.3.1.cmml" xref="A1.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="A1.E4.m1.1.1.1.1.3.2.cmml" xref="A1.E4.m1.1.1.1.1.3.2">ℒ</ci><apply id="A1.E4.m1.1.1.1.1.3.3.cmml" xref="A1.E4.m1.1.1.1.1.3.3"><times id="A1.E4.m1.1.1.1.1.3.3.1.cmml" xref="A1.E4.m1.1.1.1.1.3.3.1"></times><ci id="A1.E4.m1.1.1.1.1.3.3.2.cmml" xref="A1.E4.m1.1.1.1.1.3.3.2">𝐵</ci><ci id="A1.E4.m1.1.1.1.1.3.3.3.cmml" xref="A1.E4.m1.1.1.1.1.3.3.3">𝑉</ci><ci id="A1.E4.m1.1.1.1.1.3.3.4.cmml" xref="A1.E4.m1.1.1.1.1.3.3.4">𝑀</ci><ci id="A1.E4.m1.1.1.1.1.3.3.5.cmml" xref="A1.E4.m1.1.1.1.1.3.3.5">𝑃</ci><ci id="A1.E4.m1.1.1.1.1.3.3.6.cmml" xref="A1.E4.m1.1.1.1.1.3.3.6">𝑂</ci></apply></apply><apply id="A1.E4.m1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1"><plus id="A1.E4.m1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.2"></plus><apply id="A1.E4.m1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E4.m1.1.1.1.1.1.3.1.cmml" xref="A1.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E4.m1.1.1.1.1.1.3.2.cmml" xref="A1.E4.m1.1.1.1.1.1.3.2">ℒ</ci><apply id="A1.E4.m1.1.1.1.1.1.3.3.cmml" xref="A1.E4.m1.1.1.1.1.1.3.3"><times id="A1.E4.m1.1.1.1.1.1.3.3.1.cmml" xref="A1.E4.m1.1.1.1.1.1.3.3.1"></times><ci id="A1.E4.m1.1.1.1.1.1.3.3.2.cmml" xref="A1.E4.m1.1.1.1.1.1.3.3.2">𝑉</ci><ci id="A1.E4.m1.1.1.1.1.1.3.3.3.cmml" xref="A1.E4.m1.1.1.1.1.1.3.3.3">𝑀</ci><ci id="A1.E4.m1.1.1.1.1.1.3.3.4.cmml" xref="A1.E4.m1.1.1.1.1.1.3.3.4">𝑃</ci><ci id="A1.E4.m1.1.1.1.1.1.3.3.5.cmml" xref="A1.E4.m1.1.1.1.1.1.3.3.5">𝑂</ci></apply></apply><apply id="A1.E4.m1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1"><times id="A1.E4.m1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.2"></times><ci id="A1.E4.m1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.3">𝜆</ci><ci id="A1.E4.m1.1.1.1.1.1.1.4a.cmml" xref="A1.E4.m1.1.1.1.1.1.1.4"><mtext id="A1.E4.m1.1.1.1.1.1.1.4.cmml" xref="A1.E4.m1.1.1.1.1.1.1.4">KL</mtext></ci><apply id="A1.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.2">𝜋</ci><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.2.3">𝛽</ci></apply><ci id="A1.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E4.m1.1.1.1.1.1.1.1.1.1.3">𝜋</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E4.m1.1c">{\mathcal{L}}_{BVMPO}={\mathcal{L}}_{VMPO}+\lambda\textup{KL}(\pi^{\beta}|\pi).</annotation><annotation encoding="application/x-llamapun" id="A1.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_V italic_M italic_P italic_O end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_V italic_M italic_P italic_O end_POSTSUBSCRIPT + italic_λ KL ( italic_π start_POSTSUPERSCRIPT italic_β end_POSTSUPERSCRIPT | italic_π ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="A1.SS8.SSS1.p1.5" class="ltx_p">As opposed to DIME, BVMPO starts with a fixed coefficient <math id="A1.SS8.SSS1.p1.3.m1.1" class="ltx_Math" alttext="\lambda=1" display="inline"><semantics id="A1.SS8.SSS1.p1.3.m1.1a"><mrow id="A1.SS8.SSS1.p1.3.m1.1.1" xref="A1.SS8.SSS1.p1.3.m1.1.1.cmml"><mi id="A1.SS8.SSS1.p1.3.m1.1.1.2" xref="A1.SS8.SSS1.p1.3.m1.1.1.2.cmml">λ</mi><mo id="A1.SS8.SSS1.p1.3.m1.1.1.1" xref="A1.SS8.SSS1.p1.3.m1.1.1.1.cmml">=</mo><mn id="A1.SS8.SSS1.p1.3.m1.1.1.3" xref="A1.SS8.SSS1.p1.3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS1.p1.3.m1.1b"><apply id="A1.SS8.SSS1.p1.3.m1.1.1.cmml" xref="A1.SS8.SSS1.p1.3.m1.1.1"><eq id="A1.SS8.SSS1.p1.3.m1.1.1.1.cmml" xref="A1.SS8.SSS1.p1.3.m1.1.1.1"></eq><ci id="A1.SS8.SSS1.p1.3.m1.1.1.2.cmml" xref="A1.SS8.SSS1.p1.3.m1.1.1.2">𝜆</ci><cn type="integer" id="A1.SS8.SSS1.p1.3.m1.1.1.3.cmml" xref="A1.SS8.SSS1.p1.3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS1.p1.3.m1.1c">\lambda=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS1.p1.3.m1.1d">italic_λ = 1</annotation></semantics></math> and anneals it to <math id="A1.SS8.SSS1.p1.4.m2.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="A1.SS8.SSS1.p1.4.m2.1a"><mrow id="A1.SS8.SSS1.p1.4.m2.1.1" xref="A1.SS8.SSS1.p1.4.m2.1.1.cmml"><mrow id="A1.SS8.SSS1.p1.4.m2.1.1.2" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.cmml"><mn id="A1.SS8.SSS1.p1.4.m2.1.1.2.2" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.2.cmml">1</mn><mo id="A1.SS8.SSS1.p1.4.m2.1.1.2.1" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.1.cmml">⁢</mo><mi id="A1.SS8.SSS1.p1.4.m2.1.1.2.3" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.3.cmml">e</mi></mrow><mo id="A1.SS8.SSS1.p1.4.m2.1.1.1" xref="A1.SS8.SSS1.p1.4.m2.1.1.1.cmml">−</mo><mn id="A1.SS8.SSS1.p1.4.m2.1.1.3" xref="A1.SS8.SSS1.p1.4.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS1.p1.4.m2.1b"><apply id="A1.SS8.SSS1.p1.4.m2.1.1.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1"><minus id="A1.SS8.SSS1.p1.4.m2.1.1.1.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1.1"></minus><apply id="A1.SS8.SSS1.p1.4.m2.1.1.2.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1.2"><times id="A1.SS8.SSS1.p1.4.m2.1.1.2.1.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.1"></times><cn type="integer" id="A1.SS8.SSS1.p1.4.m2.1.1.2.2.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.2">1</cn><ci id="A1.SS8.SSS1.p1.4.m2.1.1.2.3.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.SS8.SSS1.p1.4.m2.1.1.3.cmml" xref="A1.SS8.SSS1.p1.4.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS1.p1.4.m2.1c">1e-5</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS1.p1.4.m2.1d">1 italic_e - 5</annotation></semantics></math> during the training. We found that starting with a large <math id="A1.SS8.SSS1.p1.5.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A1.SS8.SSS1.p1.5.m3.1a"><mi id="A1.SS8.SSS1.p1.5.m3.1.1" xref="A1.SS8.SSS1.p1.5.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS1.p1.5.m3.1b"><ci id="A1.SS8.SSS1.p1.5.m3.1.1.cmml" xref="A1.SS8.SSS1.p1.5.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS1.p1.5.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS1.p1.5.m3.1d">italic_λ</annotation></semantics></math> and annealing it stabilizes the training without any noticeable drop in performance. Similarly, annealing the behavior regularization co-efficient was also shown to be effective in offline Q-learning <cite class="ltx_cite ltx_citemacro_citep">(Agarwal et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
<section id="A1.SS8.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.8.2 </span>GOLD</h4>

<div id="A1.SS8.SSS2.p1" class="ltx_para">
<p id="A1.SS8.SSS2.p1.2" class="ltx_p">The GOLD loss was introduced by <cite class="ltx_cite ltx_citemacro_cite">Pang and He (<a href="#bib.bib41" title="" class="ltx_ref">2021</a>)</cite>. When using it in <span id="A1.SS8.SSS2.p1.2.1" class="ltx_text ltx_font_typewriter">Improve</span> step, we start with a BC policy. In all GOLD experiments, we used <math id="A1.SS8.SSS2.p1.1.m1.1" class="ltx_Math" alttext="k=5" display="inline"><semantics id="A1.SS8.SSS2.p1.1.m1.1a"><mrow id="A1.SS8.SSS2.p1.1.m1.1.1" xref="A1.SS8.SSS2.p1.1.m1.1.1.cmml"><mi id="A1.SS8.SSS2.p1.1.m1.1.1.2" xref="A1.SS8.SSS2.p1.1.m1.1.1.2.cmml">k</mi><mo id="A1.SS8.SSS2.p1.1.m1.1.1.1" xref="A1.SS8.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS8.SSS2.p1.1.m1.1.1.3" xref="A1.SS8.SSS2.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS2.p1.1.m1.1b"><apply id="A1.SS8.SSS2.p1.1.m1.1.1.cmml" xref="A1.SS8.SSS2.p1.1.m1.1.1"><eq id="A1.SS8.SSS2.p1.1.m1.1.1.1.cmml" xref="A1.SS8.SSS2.p1.1.m1.1.1.1"></eq><ci id="A1.SS8.SSS2.p1.1.m1.1.1.2.cmml" xref="A1.SS8.SSS2.p1.1.m1.1.1.2">𝑘</ci><cn type="integer" id="A1.SS8.SSS2.p1.1.m1.1.1.3.cmml" xref="A1.SS8.SSS2.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS2.p1.1.m1.1c">k=5</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS2.p1.1.m1.1d">italic_k = 5</annotation></semantics></math> steps to unroll the MLE model into the future for reward computations. Increasing <math id="A1.SS8.SSS2.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.SS8.SSS2.p1.2.m2.1a"><mi id="A1.SS8.SSS2.p1.2.m2.1.1" xref="A1.SS8.SSS2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS2.p1.2.m2.1b"><ci id="A1.SS8.SSS2.p1.2.m2.1.1.cmml" xref="A1.SS8.SSS2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS2.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS2.p1.2.m2.1d">italic_k</annotation></semantics></math> did not improve the performance.</p>
</div>
</section>
<section id="A1.SS8.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.8.3 </span>Offline Actor Critic (OAC)</h4>

<div id="A1.SS8.SSS3.p1" class="ltx_para">
<p id="A1.SS8.SSS3.p1.1" class="ltx_p">Offline actor critic is an actor critic approach proposed by <cite class="ltx_cite ltx_citemacro_cite">Mathieu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> where the state-value function is trained to estimate the behavior value in the dataset <cite class="ltx_cite ltx_citemacro_citep">(Gulcehre et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>. Unlike <cite class="ltx_cite ltx_citemacro_cite">Mathieu et al. (<a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> we did not use the V-trace as it did not improve over the vanilla advantage function in our initial experiments.</p>
</div>
</section>
<section id="A1.SS8.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.8.4 </span>Value Functions</h4>

<div id="A1.SS8.SSS4.p1" class="ltx_para">
<p id="A1.SS8.SSS4.p1.1" class="ltx_p">We trained state-value functions on IWSLT 2014 De-En and WMT 2020 Zh-En datasets after the initial grow step. The value functions estimate the behavior value of the policy on the training dataset. The value functions predict the sum of discounted rewards for each word until the end of the sentence. We used a transformer-based encoder-decoder architecture for the value functions. The encoder gets the source sentence as the input, and the decoder predicts Monte Carlo discounted returns conditioned on the source and history of generated sequences of tokens in the target.</p>
</div>
<div id="A1.SS8.SSS4.p2" class="ltx_para">
<p id="A1.SS8.SSS4.p2.2" class="ltx_p">On the training sets of IWSLT and WMT, our value functions achieved Kendall-tau correlation of <math id="A1.SS8.SSS4.p2.1.m1.1" class="ltx_Math" alttext="92.4\%" display="inline"><semantics id="A1.SS8.SSS4.p2.1.m1.1a"><mrow id="A1.SS8.SSS4.p2.1.m1.1.1" xref="A1.SS8.SSS4.p2.1.m1.1.1.cmml"><mn id="A1.SS8.SSS4.p2.1.m1.1.1.2" xref="A1.SS8.SSS4.p2.1.m1.1.1.2.cmml">92.4</mn><mo id="A1.SS8.SSS4.p2.1.m1.1.1.1" xref="A1.SS8.SSS4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS4.p2.1.m1.1b"><apply id="A1.SS8.SSS4.p2.1.m1.1.1.cmml" xref="A1.SS8.SSS4.p2.1.m1.1.1"><csymbol cd="latexml" id="A1.SS8.SSS4.p2.1.m1.1.1.1.cmml" xref="A1.SS8.SSS4.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="A1.SS8.SSS4.p2.1.m1.1.1.2.cmml" xref="A1.SS8.SSS4.p2.1.m1.1.1.2">92.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS4.p2.1.m1.1c">92.4\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS4.p2.1.m1.1d">92.4 %</annotation></semantics></math> and Spearman correlation above <math id="A1.SS8.SSS4.p2.2.m2.1" class="ltx_Math" alttext="99\%" display="inline"><semantics id="A1.SS8.SSS4.p2.2.m2.1a"><mrow id="A1.SS8.SSS4.p2.2.m2.1.1" xref="A1.SS8.SSS4.p2.2.m2.1.1.cmml"><mn id="A1.SS8.SSS4.p2.2.m2.1.1.2" xref="A1.SS8.SSS4.p2.2.m2.1.1.2.cmml">99</mn><mo id="A1.SS8.SSS4.p2.2.m2.1.1.1" xref="A1.SS8.SSS4.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS8.SSS4.p2.2.m2.1b"><apply id="A1.SS8.SSS4.p2.2.m2.1.1.cmml" xref="A1.SS8.SSS4.p2.2.m2.1.1"><csymbol cd="latexml" id="A1.SS8.SSS4.p2.2.m2.1.1.1.cmml" xref="A1.SS8.SSS4.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="A1.SS8.SSS4.p2.2.m2.1.1.2.cmml" xref="A1.SS8.SSS4.p2.2.m2.1.1.2">99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS8.SSS4.p2.2.m2.1c">99\%</annotation><annotation encoding="application/x-llamapun" id="A1.SS8.SSS4.p2.2.m2.1d">99 %</annotation></semantics></math> with respect to the reward model scores in the dataset. As we do RL only offline, the value functions do not need to generalize beyond the training dataset.</p>
</div>
</section>
</section>
<section id="A1.SS9" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.9 </span><span id="A1.SS9.1.1" class="ltx_ERROR undefined">\rest</span>: Population interpretation</h3>

<div id="A1.SS9.p1" class="ltx_para">
<p id="A1.SS9.p1.1" class="ltx_p">Here, we provide a population interpretation of the <span id="A1.SS9.p1.1.1" class="ltx_ERROR undefined">\rest</span> algorithm. In this setup, the initial BC training step can be thought of as identifying <math id="A1.SS9.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A1.SS9.p1.1.m1.1a"><mi id="A1.SS9.p1.1.m1.1.1" xref="A1.SS9.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS9.p1.1.m1.1b"><ci id="A1.SS9.p1.1.m1.1.1.cmml" xref="A1.SS9.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p1.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p1.1.m1.1d">italic_θ</annotation></semantics></math> by minimizing</p>
<table id="A1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.Ex5.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\textup{KL}(p({\bm{x}},{\bm{y}})||\pi_{\theta}({\bm{x}},{\bm{y}}))" display="inline"><semantics id="A1.Ex5.m1.4a"><mrow id="A1.Ex5.m1.4b"><mtext id="A1.Ex5.m1.4.5">KL</mtext><mrow id="A1.Ex5.m1.4.6"><mo stretchy="false" id="A1.Ex5.m1.4.6.1">(</mo><mi id="A1.Ex5.m1.4.6.2">p</mi><mrow id="A1.Ex5.m1.4.6.3"><mo stretchy="false" id="A1.Ex5.m1.4.6.3.1">(</mo><mi id="A1.Ex5.m1.1.1">𝒙</mi><mo id="A1.Ex5.m1.4.6.3.2">,</mo><mi id="A1.Ex5.m1.2.2">𝒚</mi><mo stretchy="false" id="A1.Ex5.m1.4.6.3.3">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex5.m1.4.6.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex5.m1.4.6.5">|</mo><msub id="A1.Ex5.m1.4.6.6"><mi id="A1.Ex5.m1.4.6.6.2">π</mi><mi id="A1.Ex5.m1.4.6.6.3">θ</mi></msub><mrow id="A1.Ex5.m1.4.6.7"><mo stretchy="false" id="A1.Ex5.m1.4.6.7.1">(</mo><mi id="A1.Ex5.m1.3.3">𝒙</mi><mo id="A1.Ex5.m1.4.6.7.2">,</mo><mi id="A1.Ex5.m1.4.4">𝒚</mi><mo stretchy="false" id="A1.Ex5.m1.4.6.7.3">)</mo></mrow><mo stretchy="false" id="A1.Ex5.m1.4.6.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex5.m1.4c">\displaystyle\textup{KL}(p({\bm{x}},{\bm{y}})||\pi_{\theta}({\bm{x}},{\bm{y}}))</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m1.4d">KL ( italic_p ( bold_italic_x , bold_italic_y ) | | italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex5.m2.8" class="ltx_Math" alttext="\displaystyle=\sum_{{\bm{x}},{\bm{y}}}p({\bm{x}},{\bm{y}})\log\frac{p({\bm{x}},{\bm{y}})}{\pi_{\theta}({\bm{x}},{\bm{y}})}" display="inline"><semantics id="A1.Ex5.m2.8a"><mrow id="A1.Ex5.m2.8.9" xref="A1.Ex5.m2.8.9.cmml"><mi id="A1.Ex5.m2.8.9.2" xref="A1.Ex5.m2.8.9.2.cmml"></mi><mo id="A1.Ex5.m2.8.9.1" xref="A1.Ex5.m2.8.9.1.cmml">=</mo><mrow id="A1.Ex5.m2.8.9.3" xref="A1.Ex5.m2.8.9.3.cmml"><mstyle displaystyle="true" id="A1.Ex5.m2.8.9.3.1" xref="A1.Ex5.m2.8.9.3.1.cmml"><munder id="A1.Ex5.m2.8.9.3.1a" xref="A1.Ex5.m2.8.9.3.1.cmml"><mo movablelimits="false" id="A1.Ex5.m2.8.9.3.1.2" xref="A1.Ex5.m2.8.9.3.1.2.cmml">∑</mo><mrow id="A1.Ex5.m2.2.2.2.4" xref="A1.Ex5.m2.2.2.2.3.cmml"><mi id="A1.Ex5.m2.1.1.1.1" xref="A1.Ex5.m2.1.1.1.1.cmml">𝒙</mi><mo id="A1.Ex5.m2.2.2.2.4.1" xref="A1.Ex5.m2.2.2.2.3.cmml">,</mo><mi id="A1.Ex5.m2.2.2.2.2" xref="A1.Ex5.m2.2.2.2.2.cmml">𝒚</mi></mrow></munder></mstyle><mrow id="A1.Ex5.m2.8.9.3.2" xref="A1.Ex5.m2.8.9.3.2.cmml"><mi id="A1.Ex5.m2.8.9.3.2.2" xref="A1.Ex5.m2.8.9.3.2.2.cmml">p</mi><mo id="A1.Ex5.m2.8.9.3.2.1" xref="A1.Ex5.m2.8.9.3.2.1.cmml">⁢</mo><mrow id="A1.Ex5.m2.8.9.3.2.3.2" xref="A1.Ex5.m2.8.9.3.2.3.1.cmml"><mo stretchy="false" id="A1.Ex5.m2.8.9.3.2.3.2.1" xref="A1.Ex5.m2.8.9.3.2.3.1.cmml">(</mo><mi id="A1.Ex5.m2.7.7" xref="A1.Ex5.m2.7.7.cmml">𝒙</mi><mo id="A1.Ex5.m2.8.9.3.2.3.2.2" xref="A1.Ex5.m2.8.9.3.2.3.1.cmml">,</mo><mi id="A1.Ex5.m2.8.8" xref="A1.Ex5.m2.8.8.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex5.m2.8.9.3.2.3.2.3" xref="A1.Ex5.m2.8.9.3.2.3.1.cmml">)</mo></mrow><mo lspace="0.167em" id="A1.Ex5.m2.8.9.3.2.1a" xref="A1.Ex5.m2.8.9.3.2.1.cmml">⁢</mo><mrow id="A1.Ex5.m2.8.9.3.2.4" xref="A1.Ex5.m2.8.9.3.2.4.cmml"><mi id="A1.Ex5.m2.8.9.3.2.4.1" xref="A1.Ex5.m2.8.9.3.2.4.1.cmml">log</mi><mo lspace="0.167em" id="A1.Ex5.m2.8.9.3.2.4a" xref="A1.Ex5.m2.8.9.3.2.4.cmml">⁡</mo><mstyle displaystyle="true" id="A1.Ex5.m2.6.6" xref="A1.Ex5.m2.6.6.cmml"><mfrac id="A1.Ex5.m2.6.6a" xref="A1.Ex5.m2.6.6.cmml"><mrow id="A1.Ex5.m2.4.4.2" xref="A1.Ex5.m2.4.4.2.cmml"><mi id="A1.Ex5.m2.4.4.2.4" xref="A1.Ex5.m2.4.4.2.4.cmml">p</mi><mo id="A1.Ex5.m2.4.4.2.3" xref="A1.Ex5.m2.4.4.2.3.cmml">⁢</mo><mrow id="A1.Ex5.m2.4.4.2.5.2" xref="A1.Ex5.m2.4.4.2.5.1.cmml"><mo stretchy="false" id="A1.Ex5.m2.4.4.2.5.2.1" xref="A1.Ex5.m2.4.4.2.5.1.cmml">(</mo><mi id="A1.Ex5.m2.3.3.1.1" xref="A1.Ex5.m2.3.3.1.1.cmml">𝒙</mi><mo id="A1.Ex5.m2.4.4.2.5.2.2" xref="A1.Ex5.m2.4.4.2.5.1.cmml">,</mo><mi id="A1.Ex5.m2.4.4.2.2" xref="A1.Ex5.m2.4.4.2.2.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex5.m2.4.4.2.5.2.3" xref="A1.Ex5.m2.4.4.2.5.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex5.m2.6.6.4" xref="A1.Ex5.m2.6.6.4.cmml"><msub id="A1.Ex5.m2.6.6.4.4" xref="A1.Ex5.m2.6.6.4.4.cmml"><mi id="A1.Ex5.m2.6.6.4.4.2" xref="A1.Ex5.m2.6.6.4.4.2.cmml">π</mi><mi id="A1.Ex5.m2.6.6.4.4.3" xref="A1.Ex5.m2.6.6.4.4.3.cmml">θ</mi></msub><mo id="A1.Ex5.m2.6.6.4.3" xref="A1.Ex5.m2.6.6.4.3.cmml">⁢</mo><mrow id="A1.Ex5.m2.6.6.4.5.2" xref="A1.Ex5.m2.6.6.4.5.1.cmml"><mo stretchy="false" id="A1.Ex5.m2.6.6.4.5.2.1" xref="A1.Ex5.m2.6.6.4.5.1.cmml">(</mo><mi id="A1.Ex5.m2.5.5.3.1" xref="A1.Ex5.m2.5.5.3.1.cmml">𝒙</mi><mo id="A1.Ex5.m2.6.6.4.5.2.2" xref="A1.Ex5.m2.6.6.4.5.1.cmml">,</mo><mi id="A1.Ex5.m2.6.6.4.2" xref="A1.Ex5.m2.6.6.4.2.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex5.m2.6.6.4.5.2.3" xref="A1.Ex5.m2.6.6.4.5.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m2.8b"><apply id="A1.Ex5.m2.8.9.cmml" xref="A1.Ex5.m2.8.9"><eq id="A1.Ex5.m2.8.9.1.cmml" xref="A1.Ex5.m2.8.9.1"></eq><csymbol cd="latexml" id="A1.Ex5.m2.8.9.2.cmml" xref="A1.Ex5.m2.8.9.2">absent</csymbol><apply id="A1.Ex5.m2.8.9.3.cmml" xref="A1.Ex5.m2.8.9.3"><apply id="A1.Ex5.m2.8.9.3.1.cmml" xref="A1.Ex5.m2.8.9.3.1"><csymbol cd="ambiguous" id="A1.Ex5.m2.8.9.3.1.1.cmml" xref="A1.Ex5.m2.8.9.3.1">subscript</csymbol><sum id="A1.Ex5.m2.8.9.3.1.2.cmml" xref="A1.Ex5.m2.8.9.3.1.2"></sum><list id="A1.Ex5.m2.2.2.2.3.cmml" xref="A1.Ex5.m2.2.2.2.4"><ci id="A1.Ex5.m2.1.1.1.1.cmml" xref="A1.Ex5.m2.1.1.1.1">𝒙</ci><ci id="A1.Ex5.m2.2.2.2.2.cmml" xref="A1.Ex5.m2.2.2.2.2">𝒚</ci></list></apply><apply id="A1.Ex5.m2.8.9.3.2.cmml" xref="A1.Ex5.m2.8.9.3.2"><times id="A1.Ex5.m2.8.9.3.2.1.cmml" xref="A1.Ex5.m2.8.9.3.2.1"></times><ci id="A1.Ex5.m2.8.9.3.2.2.cmml" xref="A1.Ex5.m2.8.9.3.2.2">𝑝</ci><interval closure="open" id="A1.Ex5.m2.8.9.3.2.3.1.cmml" xref="A1.Ex5.m2.8.9.3.2.3.2"><ci id="A1.Ex5.m2.7.7.cmml" xref="A1.Ex5.m2.7.7">𝒙</ci><ci id="A1.Ex5.m2.8.8.cmml" xref="A1.Ex5.m2.8.8">𝒚</ci></interval><apply id="A1.Ex5.m2.8.9.3.2.4.cmml" xref="A1.Ex5.m2.8.9.3.2.4"><log id="A1.Ex5.m2.8.9.3.2.4.1.cmml" xref="A1.Ex5.m2.8.9.3.2.4.1"></log><apply id="A1.Ex5.m2.6.6.cmml" xref="A1.Ex5.m2.6.6"><divide id="A1.Ex5.m2.6.6.5.cmml" xref="A1.Ex5.m2.6.6"></divide><apply id="A1.Ex5.m2.4.4.2.cmml" xref="A1.Ex5.m2.4.4.2"><times id="A1.Ex5.m2.4.4.2.3.cmml" xref="A1.Ex5.m2.4.4.2.3"></times><ci id="A1.Ex5.m2.4.4.2.4.cmml" xref="A1.Ex5.m2.4.4.2.4">𝑝</ci><interval closure="open" id="A1.Ex5.m2.4.4.2.5.1.cmml" xref="A1.Ex5.m2.4.4.2.5.2"><ci id="A1.Ex5.m2.3.3.1.1.cmml" xref="A1.Ex5.m2.3.3.1.1">𝒙</ci><ci id="A1.Ex5.m2.4.4.2.2.cmml" xref="A1.Ex5.m2.4.4.2.2">𝒚</ci></interval></apply><apply id="A1.Ex5.m2.6.6.4.cmml" xref="A1.Ex5.m2.6.6.4"><times id="A1.Ex5.m2.6.6.4.3.cmml" xref="A1.Ex5.m2.6.6.4.3"></times><apply id="A1.Ex5.m2.6.6.4.4.cmml" xref="A1.Ex5.m2.6.6.4.4"><csymbol cd="ambiguous" id="A1.Ex5.m2.6.6.4.4.1.cmml" xref="A1.Ex5.m2.6.6.4.4">subscript</csymbol><ci id="A1.Ex5.m2.6.6.4.4.2.cmml" xref="A1.Ex5.m2.6.6.4.4.2">𝜋</ci><ci id="A1.Ex5.m2.6.6.4.4.3.cmml" xref="A1.Ex5.m2.6.6.4.4.3">𝜃</ci></apply><interval closure="open" id="A1.Ex5.m2.6.6.4.5.1.cmml" xref="A1.Ex5.m2.6.6.4.5.2"><ci id="A1.Ex5.m2.5.5.3.1.cmml" xref="A1.Ex5.m2.5.5.3.1">𝒙</ci><ci id="A1.Ex5.m2.6.6.4.2.cmml" xref="A1.Ex5.m2.6.6.4.2">𝒚</ci></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m2.8c">\displaystyle=\sum_{{\bm{x}},{\bm{y}}}p({\bm{x}},{\bm{y}})\log\frac{p({\bm{x}},{\bm{y}})}{\pi_{\theta}({\bm{x}},{\bm{y}})}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex5.m2.8d">= ∑ start_POSTSUBSCRIPT bold_italic_x , bold_italic_y end_POSTSUBSCRIPT italic_p ( bold_italic_x , bold_italic_y ) roman_log divide start_ARG italic_p ( bold_italic_x , bold_italic_y ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex6.m1.6" class="ltx_Math" alttext="\displaystyle=\sum_{{\bm{x}},{\bm{y}}}p({\bm{x}},{\bm{y}})\log\frac{p({\bm{y}}|{\bm{x}})}{\pi_{\theta}({\bm{y}}|{\bm{x}})}" display="inline"><semantics id="A1.Ex6.m1.6a"><mrow id="A1.Ex6.m1.6.7" xref="A1.Ex6.m1.6.7.cmml"><mi id="A1.Ex6.m1.6.7.2" xref="A1.Ex6.m1.6.7.2.cmml"></mi><mo id="A1.Ex6.m1.6.7.1" xref="A1.Ex6.m1.6.7.1.cmml">=</mo><mrow id="A1.Ex6.m1.6.7.3" xref="A1.Ex6.m1.6.7.3.cmml"><mstyle displaystyle="true" id="A1.Ex6.m1.6.7.3.1" xref="A1.Ex6.m1.6.7.3.1.cmml"><munder id="A1.Ex6.m1.6.7.3.1a" xref="A1.Ex6.m1.6.7.3.1.cmml"><mo movablelimits="false" id="A1.Ex6.m1.6.7.3.1.2" xref="A1.Ex6.m1.6.7.3.1.2.cmml">∑</mo><mrow id="A1.Ex6.m1.2.2.2.4" xref="A1.Ex6.m1.2.2.2.3.cmml"><mi id="A1.Ex6.m1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.cmml">𝒙</mi><mo id="A1.Ex6.m1.2.2.2.4.1" xref="A1.Ex6.m1.2.2.2.3.cmml">,</mo><mi id="A1.Ex6.m1.2.2.2.2" xref="A1.Ex6.m1.2.2.2.2.cmml">𝒚</mi></mrow></munder></mstyle><mrow id="A1.Ex6.m1.6.7.3.2" xref="A1.Ex6.m1.6.7.3.2.cmml"><mi id="A1.Ex6.m1.6.7.3.2.2" xref="A1.Ex6.m1.6.7.3.2.2.cmml">p</mi><mo id="A1.Ex6.m1.6.7.3.2.1" xref="A1.Ex6.m1.6.7.3.2.1.cmml">⁢</mo><mrow id="A1.Ex6.m1.6.7.3.2.3.2" xref="A1.Ex6.m1.6.7.3.2.3.1.cmml"><mo stretchy="false" id="A1.Ex6.m1.6.7.3.2.3.2.1" xref="A1.Ex6.m1.6.7.3.2.3.1.cmml">(</mo><mi id="A1.Ex6.m1.5.5" xref="A1.Ex6.m1.5.5.cmml">𝒙</mi><mo id="A1.Ex6.m1.6.7.3.2.3.2.2" xref="A1.Ex6.m1.6.7.3.2.3.1.cmml">,</mo><mi id="A1.Ex6.m1.6.6" xref="A1.Ex6.m1.6.6.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex6.m1.6.7.3.2.3.2.3" xref="A1.Ex6.m1.6.7.3.2.3.1.cmml">)</mo></mrow><mo lspace="0.167em" id="A1.Ex6.m1.6.7.3.2.1a" xref="A1.Ex6.m1.6.7.3.2.1.cmml">⁢</mo><mrow id="A1.Ex6.m1.6.7.3.2.4" xref="A1.Ex6.m1.6.7.3.2.4.cmml"><mi id="A1.Ex6.m1.6.7.3.2.4.1" xref="A1.Ex6.m1.6.7.3.2.4.1.cmml">log</mi><mo lspace="0.167em" id="A1.Ex6.m1.6.7.3.2.4a" xref="A1.Ex6.m1.6.7.3.2.4.cmml">⁡</mo><mstyle displaystyle="true" id="A1.Ex6.m1.4.4" xref="A1.Ex6.m1.4.4.cmml"><mfrac id="A1.Ex6.m1.4.4a" xref="A1.Ex6.m1.4.4.cmml"><mrow id="A1.Ex6.m1.3.3.1" xref="A1.Ex6.m1.3.3.1.cmml"><mi id="A1.Ex6.m1.3.3.1.3" xref="A1.Ex6.m1.3.3.1.3.cmml">p</mi><mo id="A1.Ex6.m1.3.3.1.2" xref="A1.Ex6.m1.3.3.1.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.3.3.1.1.1" xref="A1.Ex6.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex6.m1.3.3.1.1.1.2" xref="A1.Ex6.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m1.3.3.1.1.1.1" xref="A1.Ex6.m1.3.3.1.1.1.1.cmml"><mi id="A1.Ex6.m1.3.3.1.1.1.1.2" xref="A1.Ex6.m1.3.3.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="A1.Ex6.m1.3.3.1.1.1.1.1" xref="A1.Ex6.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m1.3.3.1.1.1.1.3" xref="A1.Ex6.m1.3.3.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="A1.Ex6.m1.3.3.1.1.1.3" xref="A1.Ex6.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.Ex6.m1.4.4.2" xref="A1.Ex6.m1.4.4.2.cmml"><msub id="A1.Ex6.m1.4.4.2.3" xref="A1.Ex6.m1.4.4.2.3.cmml"><mi id="A1.Ex6.m1.4.4.2.3.2" xref="A1.Ex6.m1.4.4.2.3.2.cmml">π</mi><mi id="A1.Ex6.m1.4.4.2.3.3" xref="A1.Ex6.m1.4.4.2.3.3.cmml">θ</mi></msub><mo id="A1.Ex6.m1.4.4.2.2" xref="A1.Ex6.m1.4.4.2.2.cmml">⁢</mo><mrow id="A1.Ex6.m1.4.4.2.1.1" xref="A1.Ex6.m1.4.4.2.1.1.1.cmml"><mo stretchy="false" id="A1.Ex6.m1.4.4.2.1.1.2" xref="A1.Ex6.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="A1.Ex6.m1.4.4.2.1.1.1" xref="A1.Ex6.m1.4.4.2.1.1.1.cmml"><mi id="A1.Ex6.m1.4.4.2.1.1.1.2" xref="A1.Ex6.m1.4.4.2.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="A1.Ex6.m1.4.4.2.1.1.1.1" xref="A1.Ex6.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="A1.Ex6.m1.4.4.2.1.1.1.3" xref="A1.Ex6.m1.4.4.2.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="A1.Ex6.m1.4.4.2.1.1.3" xref="A1.Ex6.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.6b"><apply id="A1.Ex6.m1.6.7.cmml" xref="A1.Ex6.m1.6.7"><eq id="A1.Ex6.m1.6.7.1.cmml" xref="A1.Ex6.m1.6.7.1"></eq><csymbol cd="latexml" id="A1.Ex6.m1.6.7.2.cmml" xref="A1.Ex6.m1.6.7.2">absent</csymbol><apply id="A1.Ex6.m1.6.7.3.cmml" xref="A1.Ex6.m1.6.7.3"><apply id="A1.Ex6.m1.6.7.3.1.cmml" xref="A1.Ex6.m1.6.7.3.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.6.7.3.1.1.cmml" xref="A1.Ex6.m1.6.7.3.1">subscript</csymbol><sum id="A1.Ex6.m1.6.7.3.1.2.cmml" xref="A1.Ex6.m1.6.7.3.1.2"></sum><list id="A1.Ex6.m1.2.2.2.3.cmml" xref="A1.Ex6.m1.2.2.2.4"><ci id="A1.Ex6.m1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1">𝒙</ci><ci id="A1.Ex6.m1.2.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2.2">𝒚</ci></list></apply><apply id="A1.Ex6.m1.6.7.3.2.cmml" xref="A1.Ex6.m1.6.7.3.2"><times id="A1.Ex6.m1.6.7.3.2.1.cmml" xref="A1.Ex6.m1.6.7.3.2.1"></times><ci id="A1.Ex6.m1.6.7.3.2.2.cmml" xref="A1.Ex6.m1.6.7.3.2.2">𝑝</ci><interval closure="open" id="A1.Ex6.m1.6.7.3.2.3.1.cmml" xref="A1.Ex6.m1.6.7.3.2.3.2"><ci id="A1.Ex6.m1.5.5.cmml" xref="A1.Ex6.m1.5.5">𝒙</ci><ci id="A1.Ex6.m1.6.6.cmml" xref="A1.Ex6.m1.6.6">𝒚</ci></interval><apply id="A1.Ex6.m1.6.7.3.2.4.cmml" xref="A1.Ex6.m1.6.7.3.2.4"><log id="A1.Ex6.m1.6.7.3.2.4.1.cmml" xref="A1.Ex6.m1.6.7.3.2.4.1"></log><apply id="A1.Ex6.m1.4.4.cmml" xref="A1.Ex6.m1.4.4"><divide id="A1.Ex6.m1.4.4.3.cmml" xref="A1.Ex6.m1.4.4"></divide><apply id="A1.Ex6.m1.3.3.1.cmml" xref="A1.Ex6.m1.3.3.1"><times id="A1.Ex6.m1.3.3.1.2.cmml" xref="A1.Ex6.m1.3.3.1.2"></times><ci id="A1.Ex6.m1.3.3.1.3.cmml" xref="A1.Ex6.m1.3.3.1.3">𝑝</ci><apply id="A1.Ex6.m1.3.3.1.1.1.1.cmml" xref="A1.Ex6.m1.3.3.1.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.3.3.1.1.1.1.1.cmml" xref="A1.Ex6.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="A1.Ex6.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex6.m1.3.3.1.1.1.1.2">𝒚</ci><ci id="A1.Ex6.m1.3.3.1.1.1.1.3.cmml" xref="A1.Ex6.m1.3.3.1.1.1.1.3">𝒙</ci></apply></apply><apply id="A1.Ex6.m1.4.4.2.cmml" xref="A1.Ex6.m1.4.4.2"><times id="A1.Ex6.m1.4.4.2.2.cmml" xref="A1.Ex6.m1.4.4.2.2"></times><apply id="A1.Ex6.m1.4.4.2.3.cmml" xref="A1.Ex6.m1.4.4.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.2.3.1.cmml" xref="A1.Ex6.m1.4.4.2.3">subscript</csymbol><ci id="A1.Ex6.m1.4.4.2.3.2.cmml" xref="A1.Ex6.m1.4.4.2.3.2">𝜋</ci><ci id="A1.Ex6.m1.4.4.2.3.3.cmml" xref="A1.Ex6.m1.4.4.2.3.3">𝜃</ci></apply><apply id="A1.Ex6.m1.4.4.2.1.1.1.cmml" xref="A1.Ex6.m1.4.4.2.1.1"><csymbol cd="latexml" id="A1.Ex6.m1.4.4.2.1.1.1.1.cmml" xref="A1.Ex6.m1.4.4.2.1.1.1.1">conditional</csymbol><ci id="A1.Ex6.m1.4.4.2.1.1.1.2.cmml" xref="A1.Ex6.m1.4.4.2.1.1.1.2">𝒚</ci><ci id="A1.Ex6.m1.4.4.2.1.1.1.3.cmml" xref="A1.Ex6.m1.4.4.2.1.1.1.3">𝒙</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.6c">\displaystyle=\sum_{{\bm{x}},{\bm{y}}}p({\bm{x}},{\bm{y}})\log\frac{p({\bm{y}}|{\bm{x}})}{\pi_{\theta}({\bm{y}}|{\bm{x}})}</annotation><annotation encoding="application/x-llamapun" id="A1.Ex6.m1.6d">= ∑ start_POSTSUBSCRIPT bold_italic_x , bold_italic_y end_POSTSUBSCRIPT italic_p ( bold_italic_x , bold_italic_y ) roman_log divide start_ARG italic_p ( bold_italic_y | bold_italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A1.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A1.Ex7.m1.1" class="ltx_math_unparsed" alttext="\displaystyle=\mathbb{E}_{{\bm{x}}\sim p({\bm{x}})}[\textup{KL}(p({\bm{y}}|{\bm{x}})||\pi_{\theta}({\bm{y}}|{\bm{x}}))]," display="inline"><semantics id="A1.Ex7.m1.1a"><mrow id="A1.Ex7.m1.1b"><mo id="A1.Ex7.m1.1.2">=</mo><msub id="A1.Ex7.m1.1.3"><mi id="A1.Ex7.m1.1.3.2">𝔼</mi><mrow id="A1.Ex7.m1.1.1.1"><mi id="A1.Ex7.m1.1.1.1.3">𝒙</mi><mo id="A1.Ex7.m1.1.1.1.2">∼</mo><mrow id="A1.Ex7.m1.1.1.1.4"><mi id="A1.Ex7.m1.1.1.1.4.2">p</mi><mo id="A1.Ex7.m1.1.1.1.4.1">⁢</mo><mrow id="A1.Ex7.m1.1.1.1.4.3.2"><mo stretchy="false" id="A1.Ex7.m1.1.1.1.4.3.2.1">(</mo><mi id="A1.Ex7.m1.1.1.1.1">𝒙</mi><mo stretchy="false" id="A1.Ex7.m1.1.1.1.4.3.2.2">)</mo></mrow></mrow></mrow></msub><mrow id="A1.Ex7.m1.1.4"><mo stretchy="false" id="A1.Ex7.m1.1.4.1">[</mo><mtext id="A1.Ex7.m1.1.4.2">KL</mtext><mrow id="A1.Ex7.m1.1.4.3"><mo stretchy="false" id="A1.Ex7.m1.1.4.3.1">(</mo><mi id="A1.Ex7.m1.1.4.3.2">p</mi><mrow id="A1.Ex7.m1.1.4.3.3"><mo stretchy="false" id="A1.Ex7.m1.1.4.3.3.1">(</mo><mi id="A1.Ex7.m1.1.4.3.3.2">𝒚</mi><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex7.m1.1.4.3.3.3">|</mo><mi id="A1.Ex7.m1.1.4.3.3.4">𝒙</mi><mo stretchy="false" id="A1.Ex7.m1.1.4.3.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex7.m1.1.4.3.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex7.m1.1.4.3.5">|</mo><msub id="A1.Ex7.m1.1.4.3.6"><mi id="A1.Ex7.m1.1.4.3.6.2">π</mi><mi id="A1.Ex7.m1.1.4.3.6.3">θ</mi></msub><mrow id="A1.Ex7.m1.1.4.3.7"><mo stretchy="false" id="A1.Ex7.m1.1.4.3.7.1">(</mo><mi id="A1.Ex7.m1.1.4.3.7.2">𝒚</mi><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex7.m1.1.4.3.7.3">|</mo><mi id="A1.Ex7.m1.1.4.3.7.4">𝒙</mi><mo stretchy="false" id="A1.Ex7.m1.1.4.3.7.5">)</mo></mrow><mo stretchy="false" id="A1.Ex7.m1.1.4.3.8">)</mo></mrow><mo stretchy="false" id="A1.Ex7.m1.1.4.4">]</mo></mrow><mo id="A1.Ex7.m1.1.5">,</mo></mrow><annotation encoding="application/x-tex" id="A1.Ex7.m1.1c">\displaystyle=\mathbb{E}_{{\bm{x}}\sim p({\bm{x}})}[\textup{KL}(p({\bm{y}}|{\bm{x}})||\pi_{\theta}({\bm{y}}|{\bm{x}}))],</annotation><annotation encoding="application/x-llamapun" id="A1.Ex7.m1.1d">= blackboard_E start_POSTSUBSCRIPT bold_italic_x ∼ italic_p ( bold_italic_x ) end_POSTSUBSCRIPT [ KL ( italic_p ( bold_italic_y | bold_italic_x ) | | italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS9.p1.5" class="ltx_p">where <span id="A1.SS9.p1.5.1" class="ltx_text ltx_markedasmath">KL</span> is the Kullback–Leibler discrepancy, <math id="A1.SS9.p1.3.m2.4" class="ltx_Math" alttext="p({\bm{x}},{\bm{y}})=p({\bm{x}})p({\bm{y}}|{\bm{x}})" display="inline"><semantics id="A1.SS9.p1.3.m2.4a"><mrow id="A1.SS9.p1.3.m2.4.4" xref="A1.SS9.p1.3.m2.4.4.cmml"><mrow id="A1.SS9.p1.3.m2.4.4.3" xref="A1.SS9.p1.3.m2.4.4.3.cmml"><mi id="A1.SS9.p1.3.m2.4.4.3.2" xref="A1.SS9.p1.3.m2.4.4.3.2.cmml">p</mi><mo id="A1.SS9.p1.3.m2.4.4.3.1" xref="A1.SS9.p1.3.m2.4.4.3.1.cmml">⁢</mo><mrow id="A1.SS9.p1.3.m2.4.4.3.3.2" xref="A1.SS9.p1.3.m2.4.4.3.3.1.cmml"><mo stretchy="false" id="A1.SS9.p1.3.m2.4.4.3.3.2.1" xref="A1.SS9.p1.3.m2.4.4.3.3.1.cmml">(</mo><mi id="A1.SS9.p1.3.m2.1.1" xref="A1.SS9.p1.3.m2.1.1.cmml">𝒙</mi><mo id="A1.SS9.p1.3.m2.4.4.3.3.2.2" xref="A1.SS9.p1.3.m2.4.4.3.3.1.cmml">,</mo><mi id="A1.SS9.p1.3.m2.2.2" xref="A1.SS9.p1.3.m2.2.2.cmml">𝒚</mi><mo stretchy="false" id="A1.SS9.p1.3.m2.4.4.3.3.2.3" xref="A1.SS9.p1.3.m2.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS9.p1.3.m2.4.4.2" xref="A1.SS9.p1.3.m2.4.4.2.cmml">=</mo><mrow id="A1.SS9.p1.3.m2.4.4.1" xref="A1.SS9.p1.3.m2.4.4.1.cmml"><mi id="A1.SS9.p1.3.m2.4.4.1.3" xref="A1.SS9.p1.3.m2.4.4.1.3.cmml">p</mi><mo id="A1.SS9.p1.3.m2.4.4.1.2" xref="A1.SS9.p1.3.m2.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS9.p1.3.m2.4.4.1.4.2" xref="A1.SS9.p1.3.m2.4.4.1.cmml"><mo stretchy="false" id="A1.SS9.p1.3.m2.4.4.1.4.2.1" xref="A1.SS9.p1.3.m2.4.4.1.cmml">(</mo><mi id="A1.SS9.p1.3.m2.3.3" xref="A1.SS9.p1.3.m2.3.3.cmml">𝒙</mi><mo stretchy="false" id="A1.SS9.p1.3.m2.4.4.1.4.2.2" xref="A1.SS9.p1.3.m2.4.4.1.cmml">)</mo></mrow><mo id="A1.SS9.p1.3.m2.4.4.1.2a" xref="A1.SS9.p1.3.m2.4.4.1.2.cmml">⁢</mo><mi id="A1.SS9.p1.3.m2.4.4.1.5" xref="A1.SS9.p1.3.m2.4.4.1.5.cmml">p</mi><mo id="A1.SS9.p1.3.m2.4.4.1.2b" xref="A1.SS9.p1.3.m2.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS9.p1.3.m2.4.4.1.1.1" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS9.p1.3.m2.4.4.1.1.1.2" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.SS9.p1.3.m2.4.4.1.1.1.1" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.cmml"><mi id="A1.SS9.p1.3.m2.4.4.1.1.1.1.2" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="A1.SS9.p1.3.m2.4.4.1.1.1.1.1" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.1.cmml">|</mo><mi id="A1.SS9.p1.3.m2.4.4.1.1.1.1.3" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="A1.SS9.p1.3.m2.4.4.1.1.1.3" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS9.p1.3.m2.4b"><apply id="A1.SS9.p1.3.m2.4.4.cmml" xref="A1.SS9.p1.3.m2.4.4"><eq id="A1.SS9.p1.3.m2.4.4.2.cmml" xref="A1.SS9.p1.3.m2.4.4.2"></eq><apply id="A1.SS9.p1.3.m2.4.4.3.cmml" xref="A1.SS9.p1.3.m2.4.4.3"><times id="A1.SS9.p1.3.m2.4.4.3.1.cmml" xref="A1.SS9.p1.3.m2.4.4.3.1"></times><ci id="A1.SS9.p1.3.m2.4.4.3.2.cmml" xref="A1.SS9.p1.3.m2.4.4.3.2">𝑝</ci><interval closure="open" id="A1.SS9.p1.3.m2.4.4.3.3.1.cmml" xref="A1.SS9.p1.3.m2.4.4.3.3.2"><ci id="A1.SS9.p1.3.m2.1.1.cmml" xref="A1.SS9.p1.3.m2.1.1">𝒙</ci><ci id="A1.SS9.p1.3.m2.2.2.cmml" xref="A1.SS9.p1.3.m2.2.2">𝒚</ci></interval></apply><apply id="A1.SS9.p1.3.m2.4.4.1.cmml" xref="A1.SS9.p1.3.m2.4.4.1"><times id="A1.SS9.p1.3.m2.4.4.1.2.cmml" xref="A1.SS9.p1.3.m2.4.4.1.2"></times><ci id="A1.SS9.p1.3.m2.4.4.1.3.cmml" xref="A1.SS9.p1.3.m2.4.4.1.3">𝑝</ci><ci id="A1.SS9.p1.3.m2.3.3.cmml" xref="A1.SS9.p1.3.m2.3.3">𝒙</ci><ci id="A1.SS9.p1.3.m2.4.4.1.5.cmml" xref="A1.SS9.p1.3.m2.4.4.1.5">𝑝</ci><apply id="A1.SS9.p1.3.m2.4.4.1.1.1.1.cmml" xref="A1.SS9.p1.3.m2.4.4.1.1.1"><csymbol cd="latexml" id="A1.SS9.p1.3.m2.4.4.1.1.1.1.1.cmml" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.1">conditional</csymbol><ci id="A1.SS9.p1.3.m2.4.4.1.1.1.1.2.cmml" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.2">𝒚</ci><ci id="A1.SS9.p1.3.m2.4.4.1.1.1.1.3.cmml" xref="A1.SS9.p1.3.m2.4.4.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p1.3.m2.4c">p({\bm{x}},{\bm{y}})=p({\bm{x}})p({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p1.3.m2.4d">italic_p ( bold_italic_x , bold_italic_y ) = italic_p ( bold_italic_x ) italic_p ( bold_italic_y | bold_italic_x )</annotation></semantics></math> is the (training) data distribution and <math id="A1.SS9.p1.4.m3.4" class="ltx_Math" alttext="\pi_{\theta}({\bm{x}},{\bm{y}})=p({\bm{x}})\pi_{\theta}({\bm{y}}|{\bm{x}})" display="inline"><semantics id="A1.SS9.p1.4.m3.4a"><mrow id="A1.SS9.p1.4.m3.4.4" xref="A1.SS9.p1.4.m3.4.4.cmml"><mrow id="A1.SS9.p1.4.m3.4.4.3" xref="A1.SS9.p1.4.m3.4.4.3.cmml"><msub id="A1.SS9.p1.4.m3.4.4.3.2" xref="A1.SS9.p1.4.m3.4.4.3.2.cmml"><mi id="A1.SS9.p1.4.m3.4.4.3.2.2" xref="A1.SS9.p1.4.m3.4.4.3.2.2.cmml">π</mi><mi id="A1.SS9.p1.4.m3.4.4.3.2.3" xref="A1.SS9.p1.4.m3.4.4.3.2.3.cmml">θ</mi></msub><mo id="A1.SS9.p1.4.m3.4.4.3.1" xref="A1.SS9.p1.4.m3.4.4.3.1.cmml">⁢</mo><mrow id="A1.SS9.p1.4.m3.4.4.3.3.2" xref="A1.SS9.p1.4.m3.4.4.3.3.1.cmml"><mo stretchy="false" id="A1.SS9.p1.4.m3.4.4.3.3.2.1" xref="A1.SS9.p1.4.m3.4.4.3.3.1.cmml">(</mo><mi id="A1.SS9.p1.4.m3.1.1" xref="A1.SS9.p1.4.m3.1.1.cmml">𝒙</mi><mo id="A1.SS9.p1.4.m3.4.4.3.3.2.2" xref="A1.SS9.p1.4.m3.4.4.3.3.1.cmml">,</mo><mi id="A1.SS9.p1.4.m3.2.2" xref="A1.SS9.p1.4.m3.2.2.cmml">𝒚</mi><mo stretchy="false" id="A1.SS9.p1.4.m3.4.4.3.3.2.3" xref="A1.SS9.p1.4.m3.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="A1.SS9.p1.4.m3.4.4.2" xref="A1.SS9.p1.4.m3.4.4.2.cmml">=</mo><mrow id="A1.SS9.p1.4.m3.4.4.1" xref="A1.SS9.p1.4.m3.4.4.1.cmml"><mi id="A1.SS9.p1.4.m3.4.4.1.3" xref="A1.SS9.p1.4.m3.4.4.1.3.cmml">p</mi><mo id="A1.SS9.p1.4.m3.4.4.1.2" xref="A1.SS9.p1.4.m3.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS9.p1.4.m3.4.4.1.4.2" xref="A1.SS9.p1.4.m3.4.4.1.cmml"><mo stretchy="false" id="A1.SS9.p1.4.m3.4.4.1.4.2.1" xref="A1.SS9.p1.4.m3.4.4.1.cmml">(</mo><mi id="A1.SS9.p1.4.m3.3.3" xref="A1.SS9.p1.4.m3.3.3.cmml">𝒙</mi><mo stretchy="false" id="A1.SS9.p1.4.m3.4.4.1.4.2.2" xref="A1.SS9.p1.4.m3.4.4.1.cmml">)</mo></mrow><mo id="A1.SS9.p1.4.m3.4.4.1.2a" xref="A1.SS9.p1.4.m3.4.4.1.2.cmml">⁢</mo><msub id="A1.SS9.p1.4.m3.4.4.1.5" xref="A1.SS9.p1.4.m3.4.4.1.5.cmml"><mi id="A1.SS9.p1.4.m3.4.4.1.5.2" xref="A1.SS9.p1.4.m3.4.4.1.5.2.cmml">π</mi><mi id="A1.SS9.p1.4.m3.4.4.1.5.3" xref="A1.SS9.p1.4.m3.4.4.1.5.3.cmml">θ</mi></msub><mo id="A1.SS9.p1.4.m3.4.4.1.2b" xref="A1.SS9.p1.4.m3.4.4.1.2.cmml">⁢</mo><mrow id="A1.SS9.p1.4.m3.4.4.1.1.1" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS9.p1.4.m3.4.4.1.1.1.2" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.cmml">(</mo><mrow id="A1.SS9.p1.4.m3.4.4.1.1.1.1" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.cmml"><mi id="A1.SS9.p1.4.m3.4.4.1.1.1.1.2" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.2.cmml">𝒚</mi><mo fence="false" id="A1.SS9.p1.4.m3.4.4.1.1.1.1.1" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.1.cmml">|</mo><mi id="A1.SS9.p1.4.m3.4.4.1.1.1.1.3" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.3.cmml">𝒙</mi></mrow><mo stretchy="false" id="A1.SS9.p1.4.m3.4.4.1.1.1.3" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS9.p1.4.m3.4b"><apply id="A1.SS9.p1.4.m3.4.4.cmml" xref="A1.SS9.p1.4.m3.4.4"><eq id="A1.SS9.p1.4.m3.4.4.2.cmml" xref="A1.SS9.p1.4.m3.4.4.2"></eq><apply id="A1.SS9.p1.4.m3.4.4.3.cmml" xref="A1.SS9.p1.4.m3.4.4.3"><times id="A1.SS9.p1.4.m3.4.4.3.1.cmml" xref="A1.SS9.p1.4.m3.4.4.3.1"></times><apply id="A1.SS9.p1.4.m3.4.4.3.2.cmml" xref="A1.SS9.p1.4.m3.4.4.3.2"><csymbol cd="ambiguous" id="A1.SS9.p1.4.m3.4.4.3.2.1.cmml" xref="A1.SS9.p1.4.m3.4.4.3.2">subscript</csymbol><ci id="A1.SS9.p1.4.m3.4.4.3.2.2.cmml" xref="A1.SS9.p1.4.m3.4.4.3.2.2">𝜋</ci><ci id="A1.SS9.p1.4.m3.4.4.3.2.3.cmml" xref="A1.SS9.p1.4.m3.4.4.3.2.3">𝜃</ci></apply><interval closure="open" id="A1.SS9.p1.4.m3.4.4.3.3.1.cmml" xref="A1.SS9.p1.4.m3.4.4.3.3.2"><ci id="A1.SS9.p1.4.m3.1.1.cmml" xref="A1.SS9.p1.4.m3.1.1">𝒙</ci><ci id="A1.SS9.p1.4.m3.2.2.cmml" xref="A1.SS9.p1.4.m3.2.2">𝒚</ci></interval></apply><apply id="A1.SS9.p1.4.m3.4.4.1.cmml" xref="A1.SS9.p1.4.m3.4.4.1"><times id="A1.SS9.p1.4.m3.4.4.1.2.cmml" xref="A1.SS9.p1.4.m3.4.4.1.2"></times><ci id="A1.SS9.p1.4.m3.4.4.1.3.cmml" xref="A1.SS9.p1.4.m3.4.4.1.3">𝑝</ci><ci id="A1.SS9.p1.4.m3.3.3.cmml" xref="A1.SS9.p1.4.m3.3.3">𝒙</ci><apply id="A1.SS9.p1.4.m3.4.4.1.5.cmml" xref="A1.SS9.p1.4.m3.4.4.1.5"><csymbol cd="ambiguous" id="A1.SS9.p1.4.m3.4.4.1.5.1.cmml" xref="A1.SS9.p1.4.m3.4.4.1.5">subscript</csymbol><ci id="A1.SS9.p1.4.m3.4.4.1.5.2.cmml" xref="A1.SS9.p1.4.m3.4.4.1.5.2">𝜋</ci><ci id="A1.SS9.p1.4.m3.4.4.1.5.3.cmml" xref="A1.SS9.p1.4.m3.4.4.1.5.3">𝜃</ci></apply><apply id="A1.SS9.p1.4.m3.4.4.1.1.1.1.cmml" xref="A1.SS9.p1.4.m3.4.4.1.1.1"><csymbol cd="latexml" id="A1.SS9.p1.4.m3.4.4.1.1.1.1.1.cmml" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.1">conditional</csymbol><ci id="A1.SS9.p1.4.m3.4.4.1.1.1.1.2.cmml" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.2">𝒚</ci><ci id="A1.SS9.p1.4.m3.4.4.1.1.1.1.3.cmml" xref="A1.SS9.p1.4.m3.4.4.1.1.1.1.3">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p1.4.m3.4c">\pi_{\theta}({\bm{x}},{\bm{y}})=p({\bm{x}})\pi_{\theta}({\bm{y}}|{\bm{x}})</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p1.4.m3.4d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) = italic_p ( bold_italic_x ) italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_y | bold_italic_x )</annotation></semantics></math>. Let us call the minimizer <math id="A1.SS9.p1.5.m4.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="A1.SS9.p1.5.m4.1a"><msub id="A1.SS9.p1.5.m4.1.1" xref="A1.SS9.p1.5.m4.1.1.cmml"><mi id="A1.SS9.p1.5.m4.1.1.2" xref="A1.SS9.p1.5.m4.1.1.2.cmml">θ</mi><mn id="A1.SS9.p1.5.m4.1.1.3" xref="A1.SS9.p1.5.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS9.p1.5.m4.1b"><apply id="A1.SS9.p1.5.m4.1.1.cmml" xref="A1.SS9.p1.5.m4.1.1"><csymbol cd="ambiguous" id="A1.SS9.p1.5.m4.1.1.1.cmml" xref="A1.SS9.p1.5.m4.1.1">subscript</csymbol><ci id="A1.SS9.p1.5.m4.1.1.2.cmml" xref="A1.SS9.p1.5.m4.1.1.2">𝜃</ci><cn type="integer" id="A1.SS9.p1.5.m4.1.1.3.cmml" xref="A1.SS9.p1.5.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p1.5.m4.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p1.5.m4.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="A1.SS9.p2" class="ltx_para">
<p id="A1.SS9.p2.4" class="ltx_p">Assume now that one has the parameter <math id="A1.SS9.p2.1.m1.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="A1.SS9.p2.1.m1.1a"><msub id="A1.SS9.p2.1.m1.1.1" xref="A1.SS9.p2.1.m1.1.1.cmml"><mi id="A1.SS9.p2.1.m1.1.1.2" xref="A1.SS9.p2.1.m1.1.1.2.cmml">θ</mi><mi id="A1.SS9.p2.1.m1.1.1.3" xref="A1.SS9.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.1.m1.1b"><apply id="A1.SS9.p2.1.m1.1.1.cmml" xref="A1.SS9.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS9.p2.1.m1.1.1.1.cmml" xref="A1.SS9.p2.1.m1.1.1">subscript</csymbol><ci id="A1.SS9.p2.1.m1.1.1.2.cmml" xref="A1.SS9.p2.1.m1.1.1.2">𝜃</ci><ci id="A1.SS9.p2.1.m1.1.1.3.cmml" xref="A1.SS9.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.1.m1.1c">\theta_{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> at the end of <span id="A1.SS9.p2.4.1" class="ltx_text ltx_font_typewriter">Improve</span> steps of the <math id="A1.SS9.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.SS9.p2.2.m2.1a"><mi id="A1.SS9.p2.2.m2.1.1" xref="A1.SS9.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.2.m2.1b"><ci id="A1.SS9.p2.2.m2.1.1.cmml" xref="A1.SS9.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.2.m2.1d">italic_k</annotation></semantics></math>th <span id="A1.SS9.p2.4.2" class="ltx_text ltx_font_typewriter">Grow</span> step. Then at the next <math id="A1.SS9.p2.3.m3.1" class="ltx_Math" alttext="(k+1)" display="inline"><semantics id="A1.SS9.p2.3.m3.1a"><mrow id="A1.SS9.p2.3.m3.1.1.1" xref="A1.SS9.p2.3.m3.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS9.p2.3.m3.1.1.1.2" xref="A1.SS9.p2.3.m3.1.1.1.1.cmml">(</mo><mrow id="A1.SS9.p2.3.m3.1.1.1.1" xref="A1.SS9.p2.3.m3.1.1.1.1.cmml"><mi id="A1.SS9.p2.3.m3.1.1.1.1.2" xref="A1.SS9.p2.3.m3.1.1.1.1.2.cmml">k</mi><mo id="A1.SS9.p2.3.m3.1.1.1.1.1" xref="A1.SS9.p2.3.m3.1.1.1.1.1.cmml">+</mo><mn id="A1.SS9.p2.3.m3.1.1.1.1.3" xref="A1.SS9.p2.3.m3.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A1.SS9.p2.3.m3.1.1.1.3" xref="A1.SS9.p2.3.m3.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.3.m3.1b"><apply id="A1.SS9.p2.3.m3.1.1.1.1.cmml" xref="A1.SS9.p2.3.m3.1.1.1"><plus id="A1.SS9.p2.3.m3.1.1.1.1.1.cmml" xref="A1.SS9.p2.3.m3.1.1.1.1.1"></plus><ci id="A1.SS9.p2.3.m3.1.1.1.1.2.cmml" xref="A1.SS9.p2.3.m3.1.1.1.1.2">𝑘</ci><cn type="integer" id="A1.SS9.p2.3.m3.1.1.1.1.3.cmml" xref="A1.SS9.p2.3.m3.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.3.m3.1c">(k+1)</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.3.m3.1d">( italic_k + 1 )</annotation></semantics></math>th <span id="A1.SS9.p2.4.3" class="ltx_text ltx_font_typewriter">Grow</span> step, we consider <span id="A1.SS9.p2.4.4" class="ltx_text ltx_font_typewriter">Improve</span> steps using a sequence of increasing thresholds <math id="A1.SS9.p2.4.m4.1" class="ltx_Math" alttext="(\tau_{i})_{i=1}^{I}" display="inline"><semantics id="A1.SS9.p2.4.m4.1a"><msubsup id="A1.SS9.p2.4.m4.1.1" xref="A1.SS9.p2.4.m4.1.1.cmml"><mrow id="A1.SS9.p2.4.m4.1.1.1.1.1" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS9.p2.4.m4.1.1.1.1.1.2" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.cmml">(</mo><msub id="A1.SS9.p2.4.m4.1.1.1.1.1.1" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="A1.SS9.p2.4.m4.1.1.1.1.1.1.2" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.2.cmml">τ</mi><mi id="A1.SS9.p2.4.m4.1.1.1.1.1.1.3" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS9.p2.4.m4.1.1.1.1.1.3" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.SS9.p2.4.m4.1.1.1.3" xref="A1.SS9.p2.4.m4.1.1.1.3.cmml"><mi id="A1.SS9.p2.4.m4.1.1.1.3.2" xref="A1.SS9.p2.4.m4.1.1.1.3.2.cmml">i</mi><mo id="A1.SS9.p2.4.m4.1.1.1.3.1" xref="A1.SS9.p2.4.m4.1.1.1.3.1.cmml">=</mo><mn id="A1.SS9.p2.4.m4.1.1.1.3.3" xref="A1.SS9.p2.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.SS9.p2.4.m4.1.1.3" xref="A1.SS9.p2.4.m4.1.1.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.4.m4.1b"><apply id="A1.SS9.p2.4.m4.1.1.cmml" xref="A1.SS9.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS9.p2.4.m4.1.1.2.cmml" xref="A1.SS9.p2.4.m4.1.1">superscript</csymbol><apply id="A1.SS9.p2.4.m4.1.1.1.cmml" xref="A1.SS9.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS9.p2.4.m4.1.1.1.2.cmml" xref="A1.SS9.p2.4.m4.1.1">subscript</csymbol><apply id="A1.SS9.p2.4.m4.1.1.1.1.1.1.cmml" xref="A1.SS9.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS9.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="A1.SS9.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="A1.SS9.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.2">𝜏</ci><ci id="A1.SS9.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="A1.SS9.p2.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.SS9.p2.4.m4.1.1.1.3.cmml" xref="A1.SS9.p2.4.m4.1.1.1.3"><eq id="A1.SS9.p2.4.m4.1.1.1.3.1.cmml" xref="A1.SS9.p2.4.m4.1.1.1.3.1"></eq><ci id="A1.SS9.p2.4.m4.1.1.1.3.2.cmml" xref="A1.SS9.p2.4.m4.1.1.1.3.2">𝑖</ci><cn type="integer" id="A1.SS9.p2.4.m4.1.1.1.3.3.cmml" xref="A1.SS9.p2.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="A1.SS9.p2.4.m4.1.1.3.cmml" xref="A1.SS9.p2.4.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.4.m4.1c">(\tau_{i})_{i=1}^{I}</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.4.m4.1d">( italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math> which are used to filter the available data distribution (mixture of original data distribution and synthetic data distribution) to obtain a new distribution</p>
<table id="A1.Ex8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex8.m1.9" class="ltx_Math" alttext="\pi_{\theta_{k}}^{\tau_{i}}({\bm{x}},{\bm{y}})\propto\{(1-\lambda)p({\bm{x}},{\bm{y}})+\lambda\pi_{\theta_{k}}({\bm{x}},{\bm{y}})\}\mathbb{I}(R({\bm{x}},{\bm{y}})&gt;\tau_{i})." display="block"><semantics id="A1.Ex8.m1.9a"><mrow id="A1.Ex8.m1.9.9.1" xref="A1.Ex8.m1.9.9.1.1.cmml"><mrow id="A1.Ex8.m1.9.9.1.1" xref="A1.Ex8.m1.9.9.1.1.cmml"><mrow id="A1.Ex8.m1.9.9.1.1.4" xref="A1.Ex8.m1.9.9.1.1.4.cmml"><msubsup id="A1.Ex8.m1.9.9.1.1.4.2" xref="A1.Ex8.m1.9.9.1.1.4.2.cmml"><mi id="A1.Ex8.m1.9.9.1.1.4.2.2.2" xref="A1.Ex8.m1.9.9.1.1.4.2.2.2.cmml">π</mi><msub id="A1.Ex8.m1.9.9.1.1.4.2.2.3" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3.cmml"><mi id="A1.Ex8.m1.9.9.1.1.4.2.2.3.2" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3.2.cmml">θ</mi><mi id="A1.Ex8.m1.9.9.1.1.4.2.2.3.3" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3.3.cmml">k</mi></msub><msub id="A1.Ex8.m1.9.9.1.1.4.2.3" xref="A1.Ex8.m1.9.9.1.1.4.2.3.cmml"><mi id="A1.Ex8.m1.9.9.1.1.4.2.3.2" xref="A1.Ex8.m1.9.9.1.1.4.2.3.2.cmml">τ</mi><mi id="A1.Ex8.m1.9.9.1.1.4.2.3.3" xref="A1.Ex8.m1.9.9.1.1.4.2.3.3.cmml">i</mi></msub></msubsup><mo id="A1.Ex8.m1.9.9.1.1.4.1" xref="A1.Ex8.m1.9.9.1.1.4.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.9.9.1.1.4.3.2" xref="A1.Ex8.m1.9.9.1.1.4.3.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.4.3.2.1" xref="A1.Ex8.m1.9.9.1.1.4.3.1.cmml">(</mo><mi id="A1.Ex8.m1.1.1" xref="A1.Ex8.m1.1.1.cmml">𝒙</mi><mo id="A1.Ex8.m1.9.9.1.1.4.3.2.2" xref="A1.Ex8.m1.9.9.1.1.4.3.1.cmml">,</mo><mi id="A1.Ex8.m1.2.2" xref="A1.Ex8.m1.2.2.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.4.3.2.3" xref="A1.Ex8.m1.9.9.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex8.m1.9.9.1.1.3" xref="A1.Ex8.m1.9.9.1.1.3.cmml">∝</mo><mrow id="A1.Ex8.m1.9.9.1.1.2" xref="A1.Ex8.m1.9.9.1.1.2.cmml"><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1" xref="A1.Ex8.m1.9.9.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.2" xref="A1.Ex8.m1.9.9.1.1.1.1.2.cmml">{</mo><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml"><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.3.cmml">p</mi><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.2a" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.2.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.1.cmml">(</mo><mi id="A1.Ex8.m1.3.3" xref="A1.Ex8.m1.3.3.cmml">𝒙</mi><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.2.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.1.cmml">,</mo><mi id="A1.Ex8.m1.4.4" xref="A1.Ex8.m1.4.4.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.2.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.cmml"><mi id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.2.cmml">λ</mi><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.cmml"><mi id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.2.cmml">π</mi><msub id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.cmml"><mi id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mi id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.3.cmml">k</mi></msub></msub><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.1a" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.2.1" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.1.cmml">(</mo><mi id="A1.Ex8.m1.5.5" xref="A1.Ex8.m1.5.5.cmml">𝒙</mi><mo id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.2.2" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.1.cmml">,</mo><mi id="A1.Ex8.m1.6.6" xref="A1.Ex8.m1.6.6.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.2.3" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.1.1.1.3" xref="A1.Ex8.m1.9.9.1.1.1.1.2.cmml">}</mo></mrow><mo id="A1.Ex8.m1.9.9.1.1.2.3" xref="A1.Ex8.m1.9.9.1.1.2.3.cmml">⁢</mo><mi id="A1.Ex8.m1.9.9.1.1.2.4" xref="A1.Ex8.m1.9.9.1.1.2.4.cmml">𝕀</mi><mo id="A1.Ex8.m1.9.9.1.1.2.3a" xref="A1.Ex8.m1.9.9.1.1.2.3.cmml">⁢</mo><mrow id="A1.Ex8.m1.9.9.1.1.2.2.1" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.2.2.1.2" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.cmml">(</mo><mrow id="A1.Ex8.m1.9.9.1.1.2.2.1.1" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.cmml"><mrow id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.cmml"><mi id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.2" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.2.cmml">R</mi><mo id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.1" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.2" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.1.cmml"><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.2.1" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.1.cmml">(</mo><mi id="A1.Ex8.m1.7.7" xref="A1.Ex8.m1.7.7.cmml">𝒙</mi><mo id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.2.2" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.1.cmml">,</mo><mi id="A1.Ex8.m1.8.8" xref="A1.Ex8.m1.8.8.cmml">𝒚</mi><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.2.3" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex8.m1.9.9.1.1.2.2.1.1.1" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.1.cmml">&gt;</mo><msub id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.cmml"><mi id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.2" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.2.cmml">τ</mi><mi id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.3" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A1.Ex8.m1.9.9.1.1.2.2.1.3" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A1.Ex8.m1.9.9.1.2" xref="A1.Ex8.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex8.m1.9b"><apply id="A1.Ex8.m1.9.9.1.1.cmml" xref="A1.Ex8.m1.9.9.1"><csymbol cd="latexml" id="A1.Ex8.m1.9.9.1.1.3.cmml" xref="A1.Ex8.m1.9.9.1.1.3">proportional-to</csymbol><apply id="A1.Ex8.m1.9.9.1.1.4.cmml" xref="A1.Ex8.m1.9.9.1.1.4"><times id="A1.Ex8.m1.9.9.1.1.4.1.cmml" xref="A1.Ex8.m1.9.9.1.1.4.1"></times><apply id="A1.Ex8.m1.9.9.1.1.4.2.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.4.2.1.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2">superscript</csymbol><apply id="A1.Ex8.m1.9.9.1.1.4.2.2.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.4.2.2.1.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2">subscript</csymbol><ci id="A1.Ex8.m1.9.9.1.1.4.2.2.2.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.2.2">𝜋</ci><apply id="A1.Ex8.m1.9.9.1.1.4.2.2.3.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.4.2.2.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3">subscript</csymbol><ci id="A1.Ex8.m1.9.9.1.1.4.2.2.3.2.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3.2">𝜃</ci><ci id="A1.Ex8.m1.9.9.1.1.4.2.2.3.3.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.2.3.3">𝑘</ci></apply></apply><apply id="A1.Ex8.m1.9.9.1.1.4.2.3.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.4.2.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.3">subscript</csymbol><ci id="A1.Ex8.m1.9.9.1.1.4.2.3.2.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.3.2">𝜏</ci><ci id="A1.Ex8.m1.9.9.1.1.4.2.3.3.cmml" xref="A1.Ex8.m1.9.9.1.1.4.2.3.3">𝑖</ci></apply></apply><interval closure="open" id="A1.Ex8.m1.9.9.1.1.4.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.4.3.2"><ci id="A1.Ex8.m1.1.1.cmml" xref="A1.Ex8.m1.1.1">𝒙</ci><ci id="A1.Ex8.m1.2.2.cmml" xref="A1.Ex8.m1.2.2">𝒚</ci></interval></apply><apply id="A1.Ex8.m1.9.9.1.1.2.cmml" xref="A1.Ex8.m1.9.9.1.1.2"><times id="A1.Ex8.m1.9.9.1.1.2.3.cmml" xref="A1.Ex8.m1.9.9.1.1.2.3"></times><set id="A1.Ex8.m1.9.9.1.1.1.1.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1"><apply id="A1.Ex8.m1.9.9.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1"><plus id="A1.Ex8.m1.9.9.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.2"></plus><apply id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1"><times id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.2"></times><apply id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1"><minus id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><ci id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.3">𝑝</ci><interval closure="open" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.1.4.2"><ci id="A1.Ex8.m1.3.3.cmml" xref="A1.Ex8.m1.3.3">𝒙</ci><ci id="A1.Ex8.m1.4.4.cmml" xref="A1.Ex8.m1.4.4">𝒚</ci></interval></apply><apply id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3"><times id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.1"></times><ci id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.2">𝜆</ci><apply id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.2">𝜋</ci><apply id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.2.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.2">𝜃</ci><ci id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.3.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.3.3.3">𝑘</ci></apply></apply><interval closure="open" id="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.1.cmml" xref="A1.Ex8.m1.9.9.1.1.1.1.1.1.3.4.2"><ci id="A1.Ex8.m1.5.5.cmml" xref="A1.Ex8.m1.5.5">𝒙</ci><ci id="A1.Ex8.m1.6.6.cmml" xref="A1.Ex8.m1.6.6">𝒚</ci></interval></apply></apply></set><ci id="A1.Ex8.m1.9.9.1.1.2.4.cmml" xref="A1.Ex8.m1.9.9.1.1.2.4">𝕀</ci><apply id="A1.Ex8.m1.9.9.1.1.2.2.1.1.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1"><gt id="A1.Ex8.m1.9.9.1.1.2.2.1.1.1.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.1"></gt><apply id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2"><times id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.1.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.1"></times><ci id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.2.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.2">𝑅</ci><interval closure="open" id="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.2.3.2"><ci id="A1.Ex8.m1.7.7.cmml" xref="A1.Ex8.m1.7.7">𝒙</ci><ci id="A1.Ex8.m1.8.8.cmml" xref="A1.Ex8.m1.8.8">𝒚</ci></interval></apply><apply id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.1.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3">subscript</csymbol><ci id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.2.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.2">𝜏</ci><ci id="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.3.cmml" xref="A1.Ex8.m1.9.9.1.1.2.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex8.m1.9c">\pi_{\theta_{k}}^{\tau_{i}}({\bm{x}},{\bm{y}})\propto\{(1-\lambda)p({\bm{x}},{\bm{y}})+\lambda\pi_{\theta_{k}}({\bm{x}},{\bm{y}})\}\mathbb{I}(R({\bm{x}},{\bm{y}})&gt;\tau_{i}).</annotation><annotation encoding="application/x-llamapun" id="A1.Ex8.m1.9d">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( bold_italic_x , bold_italic_y ) ∝ { ( 1 - italic_λ ) italic_p ( bold_italic_x , bold_italic_y ) + italic_λ italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) } blackboard_I ( italic_R ( bold_italic_x , bold_italic_y ) &gt; italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS9.p2.5" class="ltx_p">We then obtain the next parameter <math id="A1.SS9.p2.5.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A1.SS9.p2.5.m1.1a"><mi id="A1.SS9.p2.5.m1.1.1" xref="A1.SS9.p2.5.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.5.m1.1b"><ci id="A1.SS9.p2.5.m1.1.1.cmml" xref="A1.SS9.p2.5.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.5.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.5.m1.1d">italic_θ</annotation></semantics></math> by minimizing the KL</p>
<table id="A1.Ex9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex9.m1.4" class="ltx_math_unparsed" alttext="\textup{KL}(\pi^{\tau_{i}}_{\theta_{k}}({\bm{x}},{\bm{y}})||\pi_{\theta}({\bm{x}},{\bm{y}}))" display="block"><semantics id="A1.Ex9.m1.4a"><mrow id="A1.Ex9.m1.4b"><mtext id="A1.Ex9.m1.4.5">KL</mtext><mrow id="A1.Ex9.m1.4.6"><mo stretchy="false" id="A1.Ex9.m1.4.6.1">(</mo><msubsup id="A1.Ex9.m1.4.6.2"><mi id="A1.Ex9.m1.4.6.2.2.2">π</mi><msub id="A1.Ex9.m1.4.6.2.3"><mi id="A1.Ex9.m1.4.6.2.3.2">θ</mi><mi id="A1.Ex9.m1.4.6.2.3.3">k</mi></msub><msub id="A1.Ex9.m1.4.6.2.2.3"><mi id="A1.Ex9.m1.4.6.2.2.3.2">τ</mi><mi id="A1.Ex9.m1.4.6.2.2.3.3">i</mi></msub></msubsup><mrow id="A1.Ex9.m1.4.6.3"><mo stretchy="false" id="A1.Ex9.m1.4.6.3.1">(</mo><mi id="A1.Ex9.m1.1.1">𝒙</mi><mo id="A1.Ex9.m1.4.6.3.2">,</mo><mi id="A1.Ex9.m1.2.2">𝒚</mi><mo stretchy="false" id="A1.Ex9.m1.4.6.3.3">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex9.m1.4.6.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A1.Ex9.m1.4.6.5">|</mo><msub id="A1.Ex9.m1.4.6.6"><mi id="A1.Ex9.m1.4.6.6.2">π</mi><mi id="A1.Ex9.m1.4.6.6.3">θ</mi></msub><mrow id="A1.Ex9.m1.4.6.7"><mo stretchy="false" id="A1.Ex9.m1.4.6.7.1">(</mo><mi id="A1.Ex9.m1.3.3">𝒙</mi><mo id="A1.Ex9.m1.4.6.7.2">,</mo><mi id="A1.Ex9.m1.4.4">𝒚</mi><mo stretchy="false" id="A1.Ex9.m1.4.6.7.3">)</mo></mrow><mo stretchy="false" id="A1.Ex9.m1.4.6.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.Ex9.m1.4c">\textup{KL}(\pi^{\tau_{i}}_{\theta_{k}}({\bm{x}},{\bm{y}})||\pi_{\theta}({\bm{x}},{\bm{y}}))</annotation><annotation encoding="application/x-llamapun" id="A1.Ex9.m1.4d">KL ( italic_π start_POSTSUPERSCRIPT italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) | | italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS9.p2.7" class="ltx_p">and keep increasing the threshold until the reward <math id="A1.SS9.p2.6.m1.5" class="ltx_Math" alttext="\mathbb{E}_{\pi_{\theta}({\bm{x}},{\bm{y}})}[R({\bm{x}},{\bm{y}})]" display="inline"><semantics id="A1.SS9.p2.6.m1.5a"><mrow id="A1.SS9.p2.6.m1.5.5" xref="A1.SS9.p2.6.m1.5.5.cmml"><msub id="A1.SS9.p2.6.m1.5.5.3" xref="A1.SS9.p2.6.m1.5.5.3.cmml"><mi id="A1.SS9.p2.6.m1.5.5.3.2" xref="A1.SS9.p2.6.m1.5.5.3.2.cmml">𝔼</mi><mrow id="A1.SS9.p2.6.m1.2.2.2" xref="A1.SS9.p2.6.m1.2.2.2.cmml"><msub id="A1.SS9.p2.6.m1.2.2.2.4" xref="A1.SS9.p2.6.m1.2.2.2.4.cmml"><mi id="A1.SS9.p2.6.m1.2.2.2.4.2" xref="A1.SS9.p2.6.m1.2.2.2.4.2.cmml">π</mi><mi id="A1.SS9.p2.6.m1.2.2.2.4.3" xref="A1.SS9.p2.6.m1.2.2.2.4.3.cmml">θ</mi></msub><mo id="A1.SS9.p2.6.m1.2.2.2.3" xref="A1.SS9.p2.6.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.SS9.p2.6.m1.2.2.2.5.2" xref="A1.SS9.p2.6.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="A1.SS9.p2.6.m1.2.2.2.5.2.1" xref="A1.SS9.p2.6.m1.2.2.2.5.1.cmml">(</mo><mi id="A1.SS9.p2.6.m1.1.1.1.1" xref="A1.SS9.p2.6.m1.1.1.1.1.cmml">𝒙</mi><mo id="A1.SS9.p2.6.m1.2.2.2.5.2.2" xref="A1.SS9.p2.6.m1.2.2.2.5.1.cmml">,</mo><mi id="A1.SS9.p2.6.m1.2.2.2.2" xref="A1.SS9.p2.6.m1.2.2.2.2.cmml">𝒚</mi><mo stretchy="false" id="A1.SS9.p2.6.m1.2.2.2.5.2.3" xref="A1.SS9.p2.6.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.SS9.p2.6.m1.5.5.2" xref="A1.SS9.p2.6.m1.5.5.2.cmml">⁢</mo><mrow id="A1.SS9.p2.6.m1.5.5.1.1" xref="A1.SS9.p2.6.m1.5.5.1.2.cmml"><mo stretchy="false" id="A1.SS9.p2.6.m1.5.5.1.1.2" xref="A1.SS9.p2.6.m1.5.5.1.2.1.cmml">[</mo><mrow id="A1.SS9.p2.6.m1.5.5.1.1.1" xref="A1.SS9.p2.6.m1.5.5.1.1.1.cmml"><mi id="A1.SS9.p2.6.m1.5.5.1.1.1.2" xref="A1.SS9.p2.6.m1.5.5.1.1.1.2.cmml">R</mi><mo id="A1.SS9.p2.6.m1.5.5.1.1.1.1" xref="A1.SS9.p2.6.m1.5.5.1.1.1.1.cmml">⁢</mo><mrow id="A1.SS9.p2.6.m1.5.5.1.1.1.3.2" xref="A1.SS9.p2.6.m1.5.5.1.1.1.3.1.cmml"><mo stretchy="false" id="A1.SS9.p2.6.m1.5.5.1.1.1.3.2.1" xref="A1.SS9.p2.6.m1.5.5.1.1.1.3.1.cmml">(</mo><mi id="A1.SS9.p2.6.m1.3.3" xref="A1.SS9.p2.6.m1.3.3.cmml">𝒙</mi><mo id="A1.SS9.p2.6.m1.5.5.1.1.1.3.2.2" xref="A1.SS9.p2.6.m1.5.5.1.1.1.3.1.cmml">,</mo><mi id="A1.SS9.p2.6.m1.4.4" xref="A1.SS9.p2.6.m1.4.4.cmml">𝒚</mi><mo stretchy="false" id="A1.SS9.p2.6.m1.5.5.1.1.1.3.2.3" xref="A1.SS9.p2.6.m1.5.5.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A1.SS9.p2.6.m1.5.5.1.1.3" xref="A1.SS9.p2.6.m1.5.5.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.6.m1.5b"><apply id="A1.SS9.p2.6.m1.5.5.cmml" xref="A1.SS9.p2.6.m1.5.5"><times id="A1.SS9.p2.6.m1.5.5.2.cmml" xref="A1.SS9.p2.6.m1.5.5.2"></times><apply id="A1.SS9.p2.6.m1.5.5.3.cmml" xref="A1.SS9.p2.6.m1.5.5.3"><csymbol cd="ambiguous" id="A1.SS9.p2.6.m1.5.5.3.1.cmml" xref="A1.SS9.p2.6.m1.5.5.3">subscript</csymbol><ci id="A1.SS9.p2.6.m1.5.5.3.2.cmml" xref="A1.SS9.p2.6.m1.5.5.3.2">𝔼</ci><apply id="A1.SS9.p2.6.m1.2.2.2.cmml" xref="A1.SS9.p2.6.m1.2.2.2"><times id="A1.SS9.p2.6.m1.2.2.2.3.cmml" xref="A1.SS9.p2.6.m1.2.2.2.3"></times><apply id="A1.SS9.p2.6.m1.2.2.2.4.cmml" xref="A1.SS9.p2.6.m1.2.2.2.4"><csymbol cd="ambiguous" id="A1.SS9.p2.6.m1.2.2.2.4.1.cmml" xref="A1.SS9.p2.6.m1.2.2.2.4">subscript</csymbol><ci id="A1.SS9.p2.6.m1.2.2.2.4.2.cmml" xref="A1.SS9.p2.6.m1.2.2.2.4.2">𝜋</ci><ci id="A1.SS9.p2.6.m1.2.2.2.4.3.cmml" xref="A1.SS9.p2.6.m1.2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="A1.SS9.p2.6.m1.2.2.2.5.1.cmml" xref="A1.SS9.p2.6.m1.2.2.2.5.2"><ci id="A1.SS9.p2.6.m1.1.1.1.1.cmml" xref="A1.SS9.p2.6.m1.1.1.1.1">𝒙</ci><ci id="A1.SS9.p2.6.m1.2.2.2.2.cmml" xref="A1.SS9.p2.6.m1.2.2.2.2">𝒚</ci></interval></apply></apply><apply id="A1.SS9.p2.6.m1.5.5.1.2.cmml" xref="A1.SS9.p2.6.m1.5.5.1.1"><csymbol cd="latexml" id="A1.SS9.p2.6.m1.5.5.1.2.1.cmml" xref="A1.SS9.p2.6.m1.5.5.1.1.2">delimited-[]</csymbol><apply id="A1.SS9.p2.6.m1.5.5.1.1.1.cmml" xref="A1.SS9.p2.6.m1.5.5.1.1.1"><times id="A1.SS9.p2.6.m1.5.5.1.1.1.1.cmml" xref="A1.SS9.p2.6.m1.5.5.1.1.1.1"></times><ci id="A1.SS9.p2.6.m1.5.5.1.1.1.2.cmml" xref="A1.SS9.p2.6.m1.5.5.1.1.1.2">𝑅</ci><interval closure="open" id="A1.SS9.p2.6.m1.5.5.1.1.1.3.1.cmml" xref="A1.SS9.p2.6.m1.5.5.1.1.1.3.2"><ci id="A1.SS9.p2.6.m1.3.3.cmml" xref="A1.SS9.p2.6.m1.3.3">𝒙</ci><ci id="A1.SS9.p2.6.m1.4.4.cmml" xref="A1.SS9.p2.6.m1.4.4">𝒚</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.6.m1.5c">\mathbb{E}_{\pi_{\theta}({\bm{x}},{\bm{y}})}[R({\bm{x}},{\bm{y}})]</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.6.m1.5d">blackboard_E start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_x , bold_italic_y ) end_POSTSUBSCRIPT [ italic_R ( bold_italic_x , bold_italic_y ) ]</annotation></semantics></math> stops increasing. This yields <math id="A1.SS9.p2.7.m2.1" class="ltx_Math" alttext="\theta_{k+1}" display="inline"><semantics id="A1.SS9.p2.7.m2.1a"><msub id="A1.SS9.p2.7.m2.1.1" xref="A1.SS9.p2.7.m2.1.1.cmml"><mi id="A1.SS9.p2.7.m2.1.1.2" xref="A1.SS9.p2.7.m2.1.1.2.cmml">θ</mi><mrow id="A1.SS9.p2.7.m2.1.1.3" xref="A1.SS9.p2.7.m2.1.1.3.cmml"><mi id="A1.SS9.p2.7.m2.1.1.3.2" xref="A1.SS9.p2.7.m2.1.1.3.2.cmml">k</mi><mo id="A1.SS9.p2.7.m2.1.1.3.1" xref="A1.SS9.p2.7.m2.1.1.3.1.cmml">+</mo><mn id="A1.SS9.p2.7.m2.1.1.3.3" xref="A1.SS9.p2.7.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS9.p2.7.m2.1b"><apply id="A1.SS9.p2.7.m2.1.1.cmml" xref="A1.SS9.p2.7.m2.1.1"><csymbol cd="ambiguous" id="A1.SS9.p2.7.m2.1.1.1.cmml" xref="A1.SS9.p2.7.m2.1.1">subscript</csymbol><ci id="A1.SS9.p2.7.m2.1.1.2.cmml" xref="A1.SS9.p2.7.m2.1.1.2">𝜃</ci><apply id="A1.SS9.p2.7.m2.1.1.3.cmml" xref="A1.SS9.p2.7.m2.1.1.3"><plus id="A1.SS9.p2.7.m2.1.1.3.1.cmml" xref="A1.SS9.p2.7.m2.1.1.3.1"></plus><ci id="A1.SS9.p2.7.m2.1.1.3.2.cmml" xref="A1.SS9.p2.7.m2.1.1.3.2">𝑘</ci><cn type="integer" id="A1.SS9.p2.7.m2.1.1.3.3.cmml" xref="A1.SS9.p2.7.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS9.p2.7.m2.1c">\theta_{k+1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS9.p2.7.m2.1d">italic_θ start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Aug 23 01:31:02 2023 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
