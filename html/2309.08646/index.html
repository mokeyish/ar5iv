<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Cure the headache of Transformers via Collinear Constrained Attention</title>
<!--Generated on Thu Sep 21 05:26:53 2023 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dginev/ar5iv-css@0.7.6/css/ar5iv.min.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Cure the headache of Transformers via Collinear Constrained Attention</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shiyi Zhu, Jing Ye, Wei Jiang, Qi Zhang, Yifan Wu, &amp; Jianguo Li

<br class="ltx_break">Ant Group 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">{zhushiyi.zsy,qianye.yj,shouzhi.jw,lijg.zero}@antgroup.com</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">As the rapid progression of practical applications based on Large Language Models continues, the importance of extrapolating performance has grown exponentially in the research domain. In our study, we identified an anomalous behavior in Transformer models that had been previously overlooked, leading to a chaos around closest tokens which carried the most important information. We’ve coined this discovery the ”headache of Transformers”. To address this at its core, we introduced a novel self-attention structure named Collinear Constrained Attention (CoCA). This structure can be seamlessly integrated with existing extrapolation, interpolation methods, and other optimization strategies designed for traditional Transformer models. We have achieved excellent extrapolating performance even for 16 times to 24 times of sequence lengths during inference without any fine-tuning on our model. We have also enhanced CoCA’s computational and spatial efficiency to ensure its practicality. We plan to open-source CoCA shortly. In the meantime, we’ve made our code available in the appendix for reappearing experiments.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">In the seminal work of Transformer models <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite>, “extrapolate to sequence lengths longer than the ones encountered during training” was a beautiful but ideal hypothesis that we want.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">There was a lot of works tried to realize it. From the perspective of implementation methods, it can be divided into two categories, pre-training and fine-tuning, pre-training ones such as ALiBi <cite class="ltx_cite ltx_citemacro_citep">(Press et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> and LeX <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite> by introducing a new position encoding method, while fine-tuning ones such as PI <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite> and NTK-aware Scaled RoPE <cite class="ltx_cite ltx_citemacro_citep">(bloc97, <a href="#bib.bib3" title="" class="ltx_ref">2023</a>)</cite> by improving the extrapolation or interpolation methods.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">These works made a lot of contributions in this research domain. However, they still haven’t solve this problem perfectly. Pre-training methods like ALiBi <cite class="ltx_cite ltx_citemacro_citep">(Press et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite> and LeX <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite> have weaken the aesthetics of the attention structure to some extent since the assumption in their models may be too strong. The structural changes of these models also make them not suitable for some useful optimization methods such as linear attention <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al., <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>. Additionally, they conflict with available fine-tuning methods either.
</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">For fine-tuning methods which is based on RoPE <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>, situation may be slightly better, since they introduce no destructive
features. However, they still put their eyes on position encoding like Pre-training methods did. Furthermore, we found that all these methods haven’t discover one technical deficiency in Transformer models itself, which may be the heart of the matter of extrapolating to longer sequence.
</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">In a nutshell, not only the tail of positional encoding will make attention scores oscillate as we all known, but the head either. The initial angle between queries and keys will destroy the monotonicity of RoPE significantly on those closest positions with the most important information in common cognition, which is incurable with whatever extrapolation or interpolation methods, but studying Transformer models itself.
</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">Can we get a Transformer model with ideal usage of input information? This question, not exactly the same but highly relevant, was studied by <cite class="ltx_cite ltx_citemacro_citep">(Del’etang et al., <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite> before. They found that Transformer models behave abnormally, left an open question.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text ltx_font_bold">This work</span> We drilled down on the anomalous behavior of Transformer models, especially the interactions between RoPE <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite> and attention matrices. Finally, we make it realized, by rescuing the headache of Transformer models with our Collinear Constrained Attention method, see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for understanding. “Extrapolate to sequence lengths longer than the ones encountered during training”, naturally, without additional fine-tuning, without destruction of an ideal attention structure. Even more, perfectly work with available extrapolation or interpolation methods and any other useful optimization methods proposed for traditional Transformer models.
</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="9.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="197" height="239" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Collinear Constrained Attention. <span id="S1.F1.7.1" class="ltx_text">Q</span>, <span id="S1.F1.8.2" class="ltx_text">T</span> and <span id="S1.F1.9.3" class="ltx_text">V</span> are generated by projection matrices the same as before, we generate <span id="S1.F1.10.4" class="ltx_text">K</span> with <span id="S1.F1.11.5" class="ltx_text">Q</span> and <span id="S1.F1.12.6" class="ltx_text">T</span> to applying collinear Constraint.</figcaption>
</figure>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">Since our model is non-destructive to the current attention structure and computational efficient, everyone could get a promoted vision of Transformer models with ideal characteristic of extrapolating by the method we named Collinear Constraint here, and use it just as before, with no difference.</p>
</div>
<div id="S1.p9" class="ltx_para ltx_noindent">
<p id="S1.p9.1" class="ltx_p">This is not only the historic moment for our work but for Transformer models, Large Language Models either. We believe that the characteristic of ideal usage of input information will make large language models such as GPTs <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite> and LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib19" title="" class="ltx_ref">2023a</a>)</cite> much more powerful than before.</p>
</div>
<div id="S1.p10" class="ltx_para ltx_noindent">
<p id="S1.p10.1" class="ltx_p">Our implementation will be open-source soon. Here we temporarily provide our code in Appendix <a href="#A2" title="Appendix B Code ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a> for reappearing experiments.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Method</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Background: Rotary Position Embedding (RoPE)</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.4" class="ltx_p">Positional encoding plays a important role in Transformer models since it represents the order of inputs. We consider Rotary Position Embedding(RoPE) <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite> here, which is a positional encoding method used by LLaMA model <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib19" title="" class="ltx_ref">2023a</a>)</cite>, GPT-NeoX <cite class="ltx_cite ltx_citemacro_citep">(Black et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite>, etc. Suppose the position index is an interger <math id="S2.SS1.p1.1.m1.2" class="ltx_Math" alttext="n\in[0,c)" display="inline"><semantics id="S2.SS1.p1.1.m1.2a"><mrow id="S2.SS1.p1.1.m1.2.3" xref="S2.SS1.p1.1.m1.2.3.cmml"><mi id="S2.SS1.p1.1.m1.2.3.2" xref="S2.SS1.p1.1.m1.2.3.2.cmml">n</mi><mo id="S2.SS1.p1.1.m1.2.3.1" xref="S2.SS1.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S2.SS1.p1.1.m1.2.3.3.2" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.2.3.3.2.1" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">0</mn><mo id="S2.SS1.p1.1.m1.2.3.3.2.2" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.1.m1.2.2" xref="S2.SS1.p1.1.m1.2.2.cmml">c</mi><mo stretchy="false" id="S2.SS1.p1.1.m1.2.3.3.2.3" xref="S2.SS1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.2b"><apply id="S2.SS1.p1.1.m1.2.3.cmml" xref="S2.SS1.p1.1.m1.2.3"><in id="S2.SS1.p1.1.m1.2.3.1.cmml" xref="S2.SS1.p1.1.m1.2.3.1"></in><ci id="S2.SS1.p1.1.m1.2.3.2.cmml" xref="S2.SS1.p1.1.m1.2.3.2">𝑛</ci><interval closure="closed-open" id="S2.SS1.p1.1.m1.2.3.3.1.cmml" xref="S2.SS1.p1.1.m1.2.3.3.2"><cn type="integer" id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">0</cn><ci id="S2.SS1.p1.1.m1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2">𝑐</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.2c">n\in[0,c)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.2d">italic_n ∈ [ 0 , italic_c )</annotation></semantics></math> and the corresponding input vector <math id="S2.SS1.p1.2.m2.4" class="ltx_Math" alttext="{\mathbf{x}}:=(x_{0},x_{1},...,x_{d-1})" display="inline"><semantics id="S2.SS1.p1.2.m2.4a"><mrow id="S2.SS1.p1.2.m2.4.4" xref="S2.SS1.p1.2.m2.4.4.cmml"><mi id="S2.SS1.p1.2.m2.4.4.5" xref="S2.SS1.p1.2.m2.4.4.5.cmml">𝐱</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p1.2.m2.4.4.4" xref="S2.SS1.p1.2.m2.4.4.4.cmml">:=</mo><mrow id="S2.SS1.p1.2.m2.4.4.3.3" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.4.4.3.3.4" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">(</mo><msub id="S2.SS1.p1.2.m2.2.2.1.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.2.2.1.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml">x</mi><mn id="S2.SS1.p1.2.m2.2.2.1.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.5" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.3.3.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.3.3.2.2.2.2" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml">x</mi><mn id="S2.SS1.p1.2.m2.3.3.2.2.2.3" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.2.m2.4.4.3.3.6" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS1.p1.2.m2.4.4.3.3.7" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.2.m2.4.4.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.2" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml">x</mi><mrow id="S2.SS1.p1.2.m2.4.4.3.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="S2.SS1.p1.2.m2.4.4.3.3.3.3.2" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml">d</mi><mo id="S2.SS1.p1.2.m2.4.4.3.3.3.3.1" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.1.cmml">−</mo><mn id="S2.SS1.p1.2.m2.4.4.3.3.3.3.3" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS1.p1.2.m2.4.4.3.3.8" xref="S2.SS1.p1.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.4b"><apply id="S2.SS1.p1.2.m2.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4"><csymbol cd="latexml" id="S2.SS1.p1.2.m2.4.4.4.cmml" xref="S2.SS1.p1.2.m2.4.4.4">assign</csymbol><ci id="S2.SS1.p1.2.m2.4.4.5.cmml" xref="S2.SS1.p1.2.m2.4.4.5">𝐱</ci><vector id="S2.SS1.p1.2.m2.4.4.3.4.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3"><apply id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S2.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.1.3">0</cn></apply><apply id="S2.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.2">𝑥</ci><cn type="integer" id="S2.SS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.3.3.2.2.2.3">1</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">…</ci><apply id="S2.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.2">𝑥</ci><apply id="S2.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3"><minus id="S2.SS1.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.1"></minus><ci id="S2.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.2">𝑑</ci><cn type="integer" id="S2.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml" xref="S2.SS1.p1.2.m2.4.4.3.3.3.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.4c">{\mathbf{x}}:=(x_{0},x_{1},...,x_{d-1})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.4d">bold_x := ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_d - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_d</annotation></semantics></math> represents the dimension of the attention head and always even. RoPE defines a vector-valued complex function <math id="S2.SS1.p1.4.m4.2" class="ltx_Math" alttext="f({\mathbf{x}},n)" display="inline"><semantics id="S2.SS1.p1.4.m4.2a"><mrow id="S2.SS1.p1.4.m4.2.3" xref="S2.SS1.p1.4.m4.2.3.cmml"><mi id="S2.SS1.p1.4.m4.2.3.2" xref="S2.SS1.p1.4.m4.2.3.2.cmml">f</mi><mo id="S2.SS1.p1.4.m4.2.3.1" xref="S2.SS1.p1.4.m4.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.4.m4.2.3.3.2" xref="S2.SS1.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.2.3.3.2.1" xref="S2.SS1.p1.4.m4.2.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">𝐱</mi><mo id="S2.SS1.p1.4.m4.2.3.3.2.2" xref="S2.SS1.p1.4.m4.2.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.4.m4.2.2" xref="S2.SS1.p1.4.m4.2.2.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.4.m4.2.3.3.2.3" xref="S2.SS1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.2b"><apply id="S2.SS1.p1.4.m4.2.3.cmml" xref="S2.SS1.p1.4.m4.2.3"><times id="S2.SS1.p1.4.m4.2.3.1.cmml" xref="S2.SS1.p1.4.m4.2.3.1"></times><ci id="S2.SS1.p1.4.m4.2.3.2.cmml" xref="S2.SS1.p1.4.m4.2.3.2">𝑓</ci><interval closure="open" id="S2.SS1.p1.4.m4.2.3.3.1.cmml" xref="S2.SS1.p1.4.m4.2.3.3.2"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝐱</ci><ci id="S2.SS1.p1.4.m4.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.2c">f({\mathbf{x}},n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.2d">italic_f ( bold_x , italic_n )</annotation></semantics></math> as follows:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.6" class="ltx_Math" alttext="f({\mathbf{x}},n)=((x_{0}+ix_{d/2})e^{im\theta_{0}},(x_{1}+ix_{1+d/2})e^{im\theta_{1}},...,(x_{d/2-1}+ix_{d-1})e^{im\theta_{d/2-1}})" display="block"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml"><mrow id="S2.E1.m1.6.6.5" xref="S2.E1.m1.6.6.5.cmml"><mi id="S2.E1.m1.6.6.5.2" xref="S2.E1.m1.6.6.5.2.cmml">f</mi><mo id="S2.E1.m1.6.6.5.1" xref="S2.E1.m1.6.6.5.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.5.3.2" xref="S2.E1.m1.6.6.5.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.5.3.2.1" xref="S2.E1.m1.6.6.5.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐱</mi><mo id="S2.E1.m1.6.6.5.3.2.2" xref="S2.E1.m1.6.6.5.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">n</mi><mo stretchy="false" id="S2.E1.m1.6.6.5.3.2.3" xref="S2.E1.m1.6.6.5.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.4" xref="S2.E1.m1.6.6.4.cmml">=</mo><mrow id="S2.E1.m1.6.6.3.3" xref="S2.E1.m1.6.6.3.4.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.3.3.4" xref="S2.E1.m1.6.6.3.4.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.cmml">x</mi><mn id="S2.E1.m1.4.4.1.1.1.1.1.1.2.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.2.cmml">x</mi><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.2.cmml">d</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.1.cmml">/</mo><mn id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.3.cmml">2</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml">⁢</mo><msup id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.3.2.cmml">e</mi><mrow id="S2.E1.m1.4.4.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.3.2" xref="S2.E1.m1.4.4.1.1.1.3.3.2.cmml">i</mi><mo id="S2.E1.m1.4.4.1.1.1.3.3.1" xref="S2.E1.m1.4.4.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.4.4.1.1.1.3.3.3" xref="S2.E1.m1.4.4.1.1.1.3.3.3.cmml">m</mi><mo id="S2.E1.m1.4.4.1.1.1.3.3.1a" xref="S2.E1.m1.4.4.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E1.m1.4.4.1.1.1.3.3.4" xref="S2.E1.m1.4.4.1.1.1.3.3.4.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3.3.4.2" xref="S2.E1.m1.4.4.1.1.1.3.3.4.2.cmml">θ</mi><mn id="S2.E1.m1.4.4.1.1.1.3.3.4.3" xref="S2.E1.m1.4.4.1.1.1.3.3.4.3.cmml">0</mn></msub></mrow></msup></mrow><mo id="S2.E1.m1.6.6.3.3.5" xref="S2.E1.m1.6.6.3.4.cmml">,</mo><mrow id="S2.E1.m1.5.5.2.2.2" xref="S2.E1.m1.5.5.2.2.2.cmml"><mrow id="S2.E1.m1.5.5.2.2.2.1.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.1.1.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.cmml"><msub id="S2.E1.m1.5.5.2.2.2.1.1.1.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2.cmml"><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.2.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2.2.cmml">x</mi><mn id="S2.E1.m1.5.5.2.2.2.1.1.1.2.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.E1.m1.5.5.2.2.2.1.1.1.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1.cmml">+</mo><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.cmml"><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.3.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.2.cmml">i</mi><mo id="S2.E1.m1.5.5.2.2.2.1.1.1.3.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.cmml"><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.2.cmml">x</mi><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.cmml"><mn id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.2.cmml">1</mn><mo id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.1.cmml">+</mo><mrow id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.cmml"><mi id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.2" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.2.cmml">d</mi><mo id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.1" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.1.cmml">/</mo><mn id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2.1.1.3" xref="S2.E1.m1.5.5.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.5.5.2.2.2.2" xref="S2.E1.m1.5.5.2.2.2.2.cmml">⁢</mo><msup id="S2.E1.m1.5.5.2.2.2.3" xref="S2.E1.m1.5.5.2.2.2.3.cmml"><mi id="S2.E1.m1.5.5.2.2.2.3.2" xref="S2.E1.m1.5.5.2.2.2.3.2.cmml">e</mi><mrow id="S2.E1.m1.5.5.2.2.2.3.3" xref="S2.E1.m1.5.5.2.2.2.3.3.cmml"><mi id="S2.E1.m1.5.5.2.2.2.3.3.2" xref="S2.E1.m1.5.5.2.2.2.3.3.2.cmml">i</mi><mo id="S2.E1.m1.5.5.2.2.2.3.3.1" xref="S2.E1.m1.5.5.2.2.2.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.5.5.2.2.2.3.3.3" xref="S2.E1.m1.5.5.2.2.2.3.3.3.cmml">m</mi><mo id="S2.E1.m1.5.5.2.2.2.3.3.1a" xref="S2.E1.m1.5.5.2.2.2.3.3.1.cmml">⁢</mo><msub id="S2.E1.m1.5.5.2.2.2.3.3.4" xref="S2.E1.m1.5.5.2.2.2.3.3.4.cmml"><mi id="S2.E1.m1.5.5.2.2.2.3.3.4.2" xref="S2.E1.m1.5.5.2.2.2.3.3.4.2.cmml">θ</mi><mn id="S2.E1.m1.5.5.2.2.2.3.3.4.3" xref="S2.E1.m1.5.5.2.2.2.3.3.4.3.cmml">1</mn></msub></mrow></msup></mrow><mo id="S2.E1.m1.6.6.3.3.6" xref="S2.E1.m1.6.6.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">…</mi><mo id="S2.E1.m1.6.6.3.3.7" xref="S2.E1.m1.6.6.3.4.cmml">,</mo><mrow id="S2.E1.m1.6.6.3.3.3" xref="S2.E1.m1.6.6.3.3.3.cmml"><mrow id="S2.E1.m1.6.6.3.3.3.1.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.6.6.3.3.3.1.1.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.6.6.3.3.3.1.1.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.cmml"><msub id="S2.E1.m1.6.6.3.3.3.1.1.1.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.cmml"><mi id="S2.E1.m1.6.6.3.3.3.1.1.1.2.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.2.cmml">x</mi><mrow id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.cmml"><mrow id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.cmml"><mi id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.2.cmml">d</mi><mo id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.1.cmml">/</mo><mn id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.3.cmml">2</mn></mrow><mo id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.1.cmml">−</mo><mn id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E1.m1.6.6.3.3.3.1.1.1.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.1.cmml">+</mo><mrow id="S2.E1.m1.6.6.3.3.3.1.1.1.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.cmml"><mi id="S2.E1.m1.6.6.3.3.3.1.1.1.3.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.2.cmml">i</mi><mo id="S2.E1.m1.6.6.3.3.3.1.1.1.3.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.cmml"><mi id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.2.cmml">x</mi><mrow id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.cmml"><mi id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.2" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.2.cmml">d</mi><mo id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.1" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.1.cmml">−</mo><mn id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E1.m1.6.6.3.3.3.1.1.3" xref="S2.E1.m1.6.6.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.6.6.3.3.3.2" xref="S2.E1.m1.6.6.3.3.3.2.cmml">⁢</mo><msup id="S2.E1.m1.6.6.3.3.3.3" xref="S2.E1.m1.6.6.3.3.3.3.cmml"><mi id="S2.E1.m1.6.6.3.3.3.3.2" xref="S2.E1.m1.6.6.3.3.3.3.2.cmml">e</mi><mrow id="S2.E1.m1.6.6.3.3.3.3.3" xref="S2.E1.m1.6.6.3.3.3.3.3.cmml"><mi id="S2.E1.m1.6.6.3.3.3.3.3.2" xref="S2.E1.m1.6.6.3.3.3.3.3.2.cmml">i</mi><mo id="S2.E1.m1.6.6.3.3.3.3.3.1" xref="S2.E1.m1.6.6.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.6.6.3.3.3.3.3.3" xref="S2.E1.m1.6.6.3.3.3.3.3.3.cmml">m</mi><mo id="S2.E1.m1.6.6.3.3.3.3.3.1a" xref="S2.E1.m1.6.6.3.3.3.3.3.1.cmml">⁢</mo><msub id="S2.E1.m1.6.6.3.3.3.3.3.4" xref="S2.E1.m1.6.6.3.3.3.3.3.4.cmml"><mi id="S2.E1.m1.6.6.3.3.3.3.3.4.2" xref="S2.E1.m1.6.6.3.3.3.3.3.4.2.cmml">θ</mi><mrow id="S2.E1.m1.6.6.3.3.3.3.3.4.3" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.cmml"><mrow id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.cmml"><mi id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.2" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.2.cmml">d</mi><mo id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.1" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.1.cmml">/</mo><mn id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.3" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.3.cmml">2</mn></mrow><mo id="S2.E1.m1.6.6.3.3.3.3.3.4.3.1" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.1.cmml">−</mo><mn id="S2.E1.m1.6.6.3.3.3.3.3.4.3.3" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.3.cmml">1</mn></mrow></msub></mrow></msup></mrow><mo stretchy="false" id="S2.E1.m1.6.6.3.3.8" xref="S2.E1.m1.6.6.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"><eq id="S2.E1.m1.6.6.4.cmml" xref="S2.E1.m1.6.6.4"></eq><apply id="S2.E1.m1.6.6.5.cmml" xref="S2.E1.m1.6.6.5"><times id="S2.E1.m1.6.6.5.1.cmml" xref="S2.E1.m1.6.6.5.1"></times><ci id="S2.E1.m1.6.6.5.2.cmml" xref="S2.E1.m1.6.6.5.2">𝑓</ci><interval closure="open" id="S2.E1.m1.6.6.5.3.1.cmml" xref="S2.E1.m1.6.6.5.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐱</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑛</ci></interval></apply><vector id="S2.E1.m1.6.6.3.4.cmml" xref="S2.E1.m1.6.6.3.3"><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2"></times><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><plus id="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1"></plus><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2">𝑥</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.2">𝑖</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.2">𝑥</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3"><divide id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.1"></divide><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.2">𝑑</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.2">𝑒</ci><apply id="S2.E1.m1.4.4.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3"><times id="S2.E1.m1.4.4.1.1.1.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.1"></times><ci id="S2.E1.m1.4.4.1.1.1.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.2">𝑖</ci><ci id="S2.E1.m1.4.4.1.1.1.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.3">𝑚</ci><apply id="S2.E1.m1.4.4.1.1.1.3.3.4.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.3.3.4.1.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.4">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.3.3.4.2.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.4.2">𝜃</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.3.3.4.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3.3.4.3">0</cn></apply></apply></apply></apply><apply id="S2.E1.m1.5.5.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2"><times id="S2.E1.m1.5.5.2.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2.2"></times><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1"><plus id="S2.E1.m1.5.5.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.1"></plus><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.2.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2.2">𝑥</ci><cn type="integer" id="S2.E1.m1.5.5.2.2.2.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.2.3">1</cn></apply><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3"><times id="S2.E1.m1.5.5.2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.1"></times><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.2">𝑖</ci><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.2">𝑥</ci><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3"><plus id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.1"></plus><cn type="integer" id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.2">1</cn><apply id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3"><divide id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.1"></divide><ci id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E1.m1.5.5.2.2.2.3.cmml" xref="S2.E1.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.2.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.3">superscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.3.2">𝑒</ci><apply id="S2.E1.m1.5.5.2.2.2.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3"><times id="S2.E1.m1.5.5.2.2.2.3.3.1.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.1"></times><ci id="S2.E1.m1.5.5.2.2.2.3.3.2.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.2">𝑖</ci><ci id="S2.E1.m1.5.5.2.2.2.3.3.3.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.3">𝑚</ci><apply id="S2.E1.m1.5.5.2.2.2.3.3.4.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.2.3.3.4.1.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.4">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.3.3.4.2.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.4.2">𝜃</ci><cn type="integer" id="S2.E1.m1.5.5.2.2.2.3.3.4.3.cmml" xref="S2.E1.m1.5.5.2.2.2.3.3.4.3">1</cn></apply></apply></apply></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">…</ci><apply id="S2.E1.m1.6.6.3.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3"><times id="S2.E1.m1.6.6.3.3.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.2"></times><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1"><plus id="S2.E1.m1.6.6.3.3.3.1.1.1.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.1"></plus><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.3.3.3.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.6.6.3.3.3.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.2">𝑥</ci><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3"><minus id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.1"></minus><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2"><divide id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.1"></divide><ci id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.2">𝑑</ci><cn type="integer" id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.2.3">2</cn></apply><cn type="integer" id="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3"><times id="S2.E1.m1.6.6.3.3.3.1.1.1.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.1"></times><ci id="S2.E1.m1.6.6.3.3.3.1.1.1.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.2">𝑖</ci><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.2">𝑥</ci><apply id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3"><minus id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.1"></minus><ci id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.2">𝑑</ci><cn type="integer" id="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E1.m1.6.6.3.3.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.3.3.3.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.3">superscript</csymbol><ci id="S2.E1.m1.6.6.3.3.3.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.3.2">𝑒</ci><apply id="S2.E1.m1.6.6.3.3.3.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3"><times id="S2.E1.m1.6.6.3.3.3.3.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.1"></times><ci id="S2.E1.m1.6.6.3.3.3.3.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.2">𝑖</ci><ci id="S2.E1.m1.6.6.3.3.3.3.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.3">𝑚</ci><apply id="S2.E1.m1.6.6.3.3.3.3.3.4.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.3.3.3.3.3.4.1.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4">subscript</csymbol><ci id="S2.E1.m1.6.6.3.3.3.3.3.4.2.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.2">𝜃</ci><apply id="S2.E1.m1.6.6.3.3.3.3.3.4.3.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3"><minus id="S2.E1.m1.6.6.3.3.3.3.3.4.3.1.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.1"></minus><apply id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2"><divide id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.1.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.1"></divide><ci id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.2.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.2">𝑑</ci><cn type="integer" id="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.3.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.2.3">2</cn></apply><cn type="integer" id="S2.E1.m1.6.6.3.3.3.3.3.4.3.3.cmml" xref="S2.E1.m1.6.6.3.3.3.3.3.4.3.3">1</cn></apply></apply></apply></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">f({\mathbf{x}},n)=((x_{0}+ix_{d/2})e^{im\theta_{0}},(x_{1}+ix_{1+d/2})e^{im\theta_{1}},...,(x_{d/2-1}+ix_{d-1})e^{im\theta_{d/2-1}})</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.6d">italic_f ( bold_x , italic_n ) = ( ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_i italic_x start_POSTSUBSCRIPT italic_d / 2 end_POSTSUBSCRIPT ) italic_e start_POSTSUPERSCRIPT italic_i italic_m italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_i italic_x start_POSTSUBSCRIPT 1 + italic_d / 2 end_POSTSUBSCRIPT ) italic_e start_POSTSUPERSCRIPT italic_i italic_m italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , … , ( italic_x start_POSTSUBSCRIPT italic_d / 2 - 1 end_POSTSUBSCRIPT + italic_i italic_x start_POSTSUBSCRIPT italic_d - 1 end_POSTSUBSCRIPT ) italic_e start_POSTSUPERSCRIPT italic_i italic_m italic_θ start_POSTSUBSCRIPT italic_d / 2 - 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.6" class="ltx_p">where <math id="S2.SS1.p1.5.m1.1" class="ltx_Math" alttext="i:=\sqrt{-1}" display="inline"><semantics id="S2.SS1.p1.5.m1.1a"><mrow id="S2.SS1.p1.5.m1.1.1" xref="S2.SS1.p1.5.m1.1.1.cmml"><mi id="S2.SS1.p1.5.m1.1.1.2" xref="S2.SS1.p1.5.m1.1.1.2.cmml">i</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p1.5.m1.1.1.1" xref="S2.SS1.p1.5.m1.1.1.1.cmml">:=</mo><msqrt id="S2.SS1.p1.5.m1.1.1.3" xref="S2.SS1.p1.5.m1.1.1.3.cmml"><mrow id="S2.SS1.p1.5.m1.1.1.3.2" xref="S2.SS1.p1.5.m1.1.1.3.2.cmml"><mo id="S2.SS1.p1.5.m1.1.1.3.2a" xref="S2.SS1.p1.5.m1.1.1.3.2.cmml">−</mo><mn id="S2.SS1.p1.5.m1.1.1.3.2.2" xref="S2.SS1.p1.5.m1.1.1.3.2.2.cmml">1</mn></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m1.1b"><apply id="S2.SS1.p1.5.m1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.5.m1.1.1.1.cmml" xref="S2.SS1.p1.5.m1.1.1.1">assign</csymbol><ci id="S2.SS1.p1.5.m1.1.1.2.cmml" xref="S2.SS1.p1.5.m1.1.1.2">𝑖</ci><apply id="S2.SS1.p1.5.m1.1.1.3.cmml" xref="S2.SS1.p1.5.m1.1.1.3"><root id="S2.SS1.p1.5.m1.1.1.3a.cmml" xref="S2.SS1.p1.5.m1.1.1.3"></root><apply id="S2.SS1.p1.5.m1.1.1.3.2.cmml" xref="S2.SS1.p1.5.m1.1.1.3.2"><minus id="S2.SS1.p1.5.m1.1.1.3.2.1.cmml" xref="S2.SS1.p1.5.m1.1.1.3.2"></minus><cn type="integer" id="S2.SS1.p1.5.m1.1.1.3.2.2.cmml" xref="S2.SS1.p1.5.m1.1.1.3.2.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m1.1c">i:=\sqrt{-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m1.1d">italic_i := square-root start_ARG - 1 end_ARG</annotation></semantics></math> is the imaginary unit and <math id="S2.SS1.p1.6.m2.1" class="ltx_Math" alttext="\theta_{j}=10000^{-2j/d}" display="inline"><semantics id="S2.SS1.p1.6.m2.1a"><mrow id="S2.SS1.p1.6.m2.1.1" xref="S2.SS1.p1.6.m2.1.1.cmml"><msub id="S2.SS1.p1.6.m2.1.1.2" xref="S2.SS1.p1.6.m2.1.1.2.cmml"><mi id="S2.SS1.p1.6.m2.1.1.2.2" xref="S2.SS1.p1.6.m2.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p1.6.m2.1.1.2.3" xref="S2.SS1.p1.6.m2.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS1.p1.6.m2.1.1.1" xref="S2.SS1.p1.6.m2.1.1.1.cmml">=</mo><msup id="S2.SS1.p1.6.m2.1.1.3" xref="S2.SS1.p1.6.m2.1.1.3.cmml"><mn id="S2.SS1.p1.6.m2.1.1.3.2" xref="S2.SS1.p1.6.m2.1.1.3.2.cmml">10000</mn><mrow id="S2.SS1.p1.6.m2.1.1.3.3" xref="S2.SS1.p1.6.m2.1.1.3.3.cmml"><mo id="S2.SS1.p1.6.m2.1.1.3.3a" xref="S2.SS1.p1.6.m2.1.1.3.3.cmml">−</mo><mrow id="S2.SS1.p1.6.m2.1.1.3.3.2" xref="S2.SS1.p1.6.m2.1.1.3.3.2.cmml"><mrow id="S2.SS1.p1.6.m2.1.1.3.3.2.2" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.cmml"><mn id="S2.SS1.p1.6.m2.1.1.3.3.2.2.2" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.2.cmml">2</mn><mo id="S2.SS1.p1.6.m2.1.1.3.3.2.2.1" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m2.1.1.3.3.2.2.3" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.3.cmml">j</mi></mrow><mo id="S2.SS1.p1.6.m2.1.1.3.3.2.1" xref="S2.SS1.p1.6.m2.1.1.3.3.2.1.cmml">/</mo><mi id="S2.SS1.p1.6.m2.1.1.3.3.2.3" xref="S2.SS1.p1.6.m2.1.1.3.3.2.3.cmml">d</mi></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m2.1b"><apply id="S2.SS1.p1.6.m2.1.1.cmml" xref="S2.SS1.p1.6.m2.1.1"><eq id="S2.SS1.p1.6.m2.1.1.1.cmml" xref="S2.SS1.p1.6.m2.1.1.1"></eq><apply id="S2.SS1.p1.6.m2.1.1.2.cmml" xref="S2.SS1.p1.6.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m2.1.1.2.1.cmml" xref="S2.SS1.p1.6.m2.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.6.m2.1.1.2.2.cmml" xref="S2.SS1.p1.6.m2.1.1.2.2">𝜃</ci><ci id="S2.SS1.p1.6.m2.1.1.2.3.cmml" xref="S2.SS1.p1.6.m2.1.1.2.3">𝑗</ci></apply><apply id="S2.SS1.p1.6.m2.1.1.3.cmml" xref="S2.SS1.p1.6.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m2.1.1.3.1.cmml" xref="S2.SS1.p1.6.m2.1.1.3">superscript</csymbol><cn type="integer" id="S2.SS1.p1.6.m2.1.1.3.2.cmml" xref="S2.SS1.p1.6.m2.1.1.3.2">10000</cn><apply id="S2.SS1.p1.6.m2.1.1.3.3.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3"><minus id="S2.SS1.p1.6.m2.1.1.3.3.1.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3"></minus><apply id="S2.SS1.p1.6.m2.1.1.3.3.2.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2"><divide id="S2.SS1.p1.6.m2.1.1.3.3.2.1.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2.1"></divide><apply id="S2.SS1.p1.6.m2.1.1.3.3.2.2.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2"><times id="S2.SS1.p1.6.m2.1.1.3.3.2.2.1.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.1"></times><cn type="integer" id="S2.SS1.p1.6.m2.1.1.3.3.2.2.2.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.2">2</cn><ci id="S2.SS1.p1.6.m2.1.1.3.3.2.2.3.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2.2.3">𝑗</ci></apply><ci id="S2.SS1.p1.6.m2.1.1.3.3.2.3.cmml" xref="S2.SS1.p1.6.m2.1.1.3.3.2.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m2.1c">\theta_{j}=10000^{-2j/d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m2.1d">italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 10000 start_POSTSUPERSCRIPT - 2 italic_j / italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Attention score after applying RoPE is:
</p>
<table id="S2.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle a(m,n)" display="inline"><semantics id="S2.E2X.2.1.1.m1.2a"><mrow id="S2.E2X.2.1.1.m1.2.3" xref="S2.E2X.2.1.1.m1.2.3.cmml"><mi id="S2.E2X.2.1.1.m1.2.3.2" xref="S2.E2X.2.1.1.m1.2.3.2.cmml">a</mi><mo id="S2.E2X.2.1.1.m1.2.3.1" xref="S2.E2X.2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.E2X.2.1.1.m1.2.3.3.2" xref="S2.E2X.2.1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.E2X.2.1.1.m1.2.3.3.2.1" xref="S2.E2X.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.E2X.2.1.1.m1.1.1" xref="S2.E2X.2.1.1.m1.1.1.cmml">m</mi><mo id="S2.E2X.2.1.1.m1.2.3.3.2.2" xref="S2.E2X.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.E2X.2.1.1.m1.2.2" xref="S2.E2X.2.1.1.m1.2.2.cmml">n</mi><mo stretchy="false" id="S2.E2X.2.1.1.m1.2.3.3.2.3" xref="S2.E2X.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.2b"><apply id="S2.E2X.2.1.1.m1.2.3.cmml" xref="S2.E2X.2.1.1.m1.2.3"><times id="S2.E2X.2.1.1.m1.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.2.3.1"></times><ci id="S2.E2X.2.1.1.m1.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.2.3.2">𝑎</ci><interval closure="open" id="S2.E2X.2.1.1.m1.2.3.3.1.cmml" xref="S2.E2X.2.1.1.m1.2.3.3.2"><ci id="S2.E2X.2.1.1.m1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1">𝑚</ci><ci id="S2.E2X.2.1.1.m1.2.2.cmml" xref="S2.E2X.2.1.1.m1.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.2c">\displaystyle a(m,n)</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.2.1.1.m1.2d">italic_a ( italic_m , italic_n )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=\text{Re}(\langle f({\mathbf{q}},m),f({\mathbf{k}},n)\rangle)" display="inline"><semantics id="S2.E2X.3.2.2.m1.5a"><mrow id="S2.E2X.3.2.2.m1.5.5" xref="S2.E2X.3.2.2.m1.5.5.cmml"><mi id="S2.E2X.3.2.2.m1.5.5.3" xref="S2.E2X.3.2.2.m1.5.5.3.cmml"></mi><mo id="S2.E2X.3.2.2.m1.5.5.2" xref="S2.E2X.3.2.2.m1.5.5.2.cmml">=</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1" xref="S2.E2X.3.2.2.m1.5.5.1.cmml"><mtext id="S2.E2X.3.2.2.m1.5.5.1.3" xref="S2.E2X.3.2.2.m1.5.5.1.3a.cmml">Re</mtext><mo id="S2.E2X.3.2.2.m1.5.5.1.2" xref="S2.E2X.3.2.2.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1.1.1" xref="S2.E2X.3.2.2.m1.5.5.1.cmml"><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.2" xref="S2.E2X.3.2.2.m1.5.5.1.cmml">(</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.3" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.3.cmml">⟨</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml">f</mi><mo id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.1" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E2X.3.2.2.m1.1.1" xref="S2.E2X.3.2.2.m1.1.1.cmml">𝐪</mi><mo id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.E2X.3.2.2.m1.2.2" xref="S2.E2X.3.2.2.m1.2.2.cmml">m</mi><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.4" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.3.cmml">,</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.cmml"><mi id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.2.cmml">f</mi><mo id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.1" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2.1" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml">(</mo><mi id="S2.E2X.3.2.2.m1.3.3" xref="S2.E2X.3.2.2.m1.3.3.cmml">𝐤</mi><mo id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2.2" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E2X.3.2.2.m1.4.4" xref="S2.E2X.3.2.2.m1.4.4.cmml">n</mi><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2.3" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.5" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.3.cmml">⟩</mo></mrow><mo stretchy="false" id="S2.E2X.3.2.2.m1.5.5.1.1.1.3" xref="S2.E2X.3.2.2.m1.5.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.3.2.2.m1.5b"><apply id="S2.E2X.3.2.2.m1.5.5.cmml" xref="S2.E2X.3.2.2.m1.5.5"><eq id="S2.E2X.3.2.2.m1.5.5.2.cmml" xref="S2.E2X.3.2.2.m1.5.5.2"></eq><csymbol cd="latexml" id="S2.E2X.3.2.2.m1.5.5.3.cmml" xref="S2.E2X.3.2.2.m1.5.5.3">absent</csymbol><apply id="S2.E2X.3.2.2.m1.5.5.1.cmml" xref="S2.E2X.3.2.2.m1.5.5.1"><times id="S2.E2X.3.2.2.m1.5.5.1.2.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.2"></times><ci id="S2.E2X.3.2.2.m1.5.5.1.3a.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.3"><mtext id="S2.E2X.3.2.2.m1.5.5.1.3.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.3">Re</mtext></ci><list id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2"><apply id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1"><times id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.1"></times><ci id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.2">𝑓</ci><interval closure="open" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2"><ci id="S2.E2X.3.2.2.m1.1.1.cmml" xref="S2.E2X.3.2.2.m1.1.1">𝐪</ci><ci id="S2.E2X.3.2.2.m1.2.2.cmml" xref="S2.E2X.3.2.2.m1.2.2">𝑚</ci></interval></apply><apply id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2"><times id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.1"></times><ci id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.2">𝑓</ci><interval closure="open" id="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2"><ci id="S2.E2X.3.2.2.m1.3.3.cmml" xref="S2.E2X.3.2.2.m1.3.3">𝐤</ci><ci id="S2.E2X.3.2.2.m1.4.4.cmml" xref="S2.E2X.3.2.2.m1.4.4">𝑛</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.3.2.2.m1.5c">\displaystyle=\text{Re}(\langle f({\mathbf{q}},m),f({\mathbf{k}},n)\rangle)</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.3.2.2.m1.5d">= Re ( ⟨ italic_f ( bold_q , italic_m ) , italic_f ( bold_k , italic_n ) ⟩ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="5" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S2.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle=\text{Re}\left[\sum_{j=0}^{d/2-1}(q_{j}+iq_{j+d/2})(k_{j}-ik_{j+d/2})e^{i(m-n)\theta_{j}}\right]" display="inline"><semantics id="S2.E2Xa.2.1.1.m1.2a"><mrow id="S2.E2Xa.2.1.1.m1.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.3" xref="S2.E2Xa.2.1.1.m1.2.2.3.cmml"></mi><mo id="S2.E2Xa.2.1.1.m1.2.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.2.cmml">=</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.cmml"><mtext id="S2.E2Xa.2.1.1.m1.2.2.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.3a.cmml">Re</mtext><mo id="S2.E2Xa.2.1.1.m1.2.2.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.2.cmml"><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml"><munderover id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3a" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml"><mo movablelimits="false" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.2.cmml">j</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.3.cmml">0</mn></mrow><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.cmml"><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.2.cmml">d</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.1.cmml">/</mo><mn id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.3.cmml">2</mn></mrow><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml"><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">q</mi><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2.cmml">j</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml">/</mo><mn id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.cmml"><msub id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.2.cmml">k</mi><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.1.cmml">−</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.2.cmml">i</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.1.cmml">⁢</mo><msub id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.2.cmml">k</mi><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.2.cmml">j</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.1.cmml">+</mo><mrow id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.2.cmml">d</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.1" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.1.cmml">/</mo><mn id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.cmml">)</mo></mrow><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.3a" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.3.cmml">⁢</mo><msup id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.cmml"><mi id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.2" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.2.cmml">e</mi><mrow id="S2.E2Xa.2.1.1.m1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.1.1.1.3.cmml">i</mi><mo id="S2.E2Xa.2.1.1.m1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2Xa.2.1.1.m1.1.1.1.2a" xref="S2.E2Xa.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msub id="S2.E2Xa.2.1.1.m1.1.1.1.4" xref="S2.E2Xa.2.1.1.m1.1.1.1.4.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.1.4.2" xref="S2.E2Xa.2.1.1.m1.1.1.1.4.2.cmml">θ</mi><mi id="S2.E2Xa.2.1.1.m1.1.1.1.4.3" xref="S2.E2Xa.2.1.1.m1.1.1.1.4.3.cmml">j</mi></msub></mrow></msup></mrow></mrow><mo id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xa.2.1.1.m1.2b"><apply id="S2.E2Xa.2.1.1.m1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2"><eq id="S2.E2Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.2"></eq><csymbol cd="latexml" id="S2.E2Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.3">absent</csymbol><apply id="S2.E2Xa.2.1.1.m1.2.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1"><times id="S2.E2Xa.2.1.1.m1.2.2.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.2"></times><ci id="S2.E2Xa.2.1.1.m1.2.2.1.3a.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.3"><mtext id="S2.E2Xa.2.1.1.m1.2.2.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.3">Re</mtext></ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E2Xa.2.1.1.m1.2.2.1.1.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1"><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3">superscript</csymbol><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3">subscript</csymbol><sum id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.2"></sum><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3"><eq id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.1"></eq><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.2">𝑗</ci><cn type="integer" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.2.3.3">0</cn></apply></apply><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3"><minus id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.1"></minus><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2"><divide id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.1"></divide><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.2">𝑑</ci><cn type="integer" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.2.3">2</cn></apply><cn type="integer" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2"><times id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.3"></times><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1"><plus id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3"><times id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">𝑞</ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3"><plus id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.2">𝑗</ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3"><divide id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.1"></divide><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1"><minus id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.1"></minus><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.2">𝑘</ci><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.2.3">𝑗</ci></apply><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3"><times id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.1"></times><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.2">𝑖</ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.2">𝑘</ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3"><plus id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.1"></plus><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.2">𝑗</ci><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3"><divide id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.1"></divide><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.2.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.1.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4">superscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.1.1.1.1.2.4.2">𝑒</ci><apply id="S2.E2Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1"><times id="S2.E2Xa.2.1.1.m1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.2"></times><ci id="S2.E2Xa.2.1.1.m1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.3">𝑖</ci><apply id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1"><minus id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.1"></minus><ci id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.E2Xa.2.1.1.m1.1.1.1.4.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.1.1.1.4.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.4">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.1.1.1.4.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.4.2">𝜃</ci><ci id="S2.E2Xa.2.1.1.m1.1.1.1.4.3.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.4.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.2.1.1.m1.2c">\displaystyle=\text{Re}\left[\sum_{j=0}^{d/2-1}(q_{j}+iq_{j+d/2})(k_{j}-ik_{j+d/2})e^{i(m-n)\theta_{j}}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xa.2.1.1.m1.2d">= Re [ ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_i italic_q start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT ) ( italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_i italic_k start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT ) italic_e start_POSTSUPERSCRIPT italic_i ( italic_m - italic_n ) italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S2.E2Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xb.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle=\sum_{j=0}^{d/2-1}((q_{j}k_{j}+q_{j+d/2}k_{j+d/2})\text{cos}((m-n)\theta_{j})" display="inline"><semantics id="S2.E2Xb.2.1.1.m1.1a"><mrow id="S2.E2Xb.2.1.1.m1.1b"><mo id="S2.E2Xb.2.1.1.m1.1.1">=</mo><mstyle displaystyle="true" id="S2.E2Xb.2.1.1.m1.1.2"><munderover id="S2.E2Xb.2.1.1.m1.1.2a"><mo movablelimits="false" id="S2.E2Xb.2.1.1.m1.1.2.2.2">∑</mo><mrow id="S2.E2Xb.2.1.1.m1.1.2.2.3"><mi id="S2.E2Xb.2.1.1.m1.1.2.2.3.2">j</mi><mo id="S2.E2Xb.2.1.1.m1.1.2.2.3.1">=</mo><mn id="S2.E2Xb.2.1.1.m1.1.2.2.3.3">0</mn></mrow><mrow id="S2.E2Xb.2.1.1.m1.1.2.3"><mrow id="S2.E2Xb.2.1.1.m1.1.2.3.2"><mi id="S2.E2Xb.2.1.1.m1.1.2.3.2.2">d</mi><mo id="S2.E2Xb.2.1.1.m1.1.2.3.2.1">/</mo><mn id="S2.E2Xb.2.1.1.m1.1.2.3.2.3">2</mn></mrow><mo id="S2.E2Xb.2.1.1.m1.1.2.3.1">−</mo><mn id="S2.E2Xb.2.1.1.m1.1.2.3.3">1</mn></mrow></munderover></mstyle><mrow id="S2.E2Xb.2.1.1.m1.1.3"><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.1">(</mo><mrow id="S2.E2Xb.2.1.1.m1.1.3.2"><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.2.1">(</mo><msub id="S2.E2Xb.2.1.1.m1.1.3.2.2"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.2.2">q</mi><mi id="S2.E2Xb.2.1.1.m1.1.3.2.2.3">j</mi></msub><msub id="S2.E2Xb.2.1.1.m1.1.3.2.3"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.3.2">k</mi><mi id="S2.E2Xb.2.1.1.m1.1.3.2.3.3">j</mi></msub><mo id="S2.E2Xb.2.1.1.m1.1.3.2.4">+</mo><msub id="S2.E2Xb.2.1.1.m1.1.3.2.5"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.5.2">q</mi><mrow id="S2.E2Xb.2.1.1.m1.1.3.2.5.3"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.5.3.2">j</mi><mo id="S2.E2Xb.2.1.1.m1.1.3.2.5.3.1">+</mo><mrow id="S2.E2Xb.2.1.1.m1.1.3.2.5.3.3"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.5.3.3.2">d</mi><mo id="S2.E2Xb.2.1.1.m1.1.3.2.5.3.3.1">/</mo><mn id="S2.E2Xb.2.1.1.m1.1.3.2.5.3.3.3">2</mn></mrow></mrow></msub><msub id="S2.E2Xb.2.1.1.m1.1.3.2.6"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.6.2">k</mi><mrow id="S2.E2Xb.2.1.1.m1.1.3.2.6.3"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.6.3.2">j</mi><mo id="S2.E2Xb.2.1.1.m1.1.3.2.6.3.1">+</mo><mrow id="S2.E2Xb.2.1.1.m1.1.3.2.6.3.3"><mi id="S2.E2Xb.2.1.1.m1.1.3.2.6.3.3.2">d</mi><mo id="S2.E2Xb.2.1.1.m1.1.3.2.6.3.3.1">/</mo><mn id="S2.E2Xb.2.1.1.m1.1.3.2.6.3.3.3">2</mn></mrow></mrow></msub><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.2.7">)</mo></mrow><mtext id="S2.E2Xb.2.1.1.m1.1.3.3">cos</mtext><mrow id="S2.E2Xb.2.1.1.m1.1.3.4"><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.4.1">(</mo><mrow id="S2.E2Xb.2.1.1.m1.1.3.4.2"><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.4.2.1">(</mo><mi id="S2.E2Xb.2.1.1.m1.1.3.4.2.2">m</mi><mo id="S2.E2Xb.2.1.1.m1.1.3.4.2.3">−</mo><mi id="S2.E2Xb.2.1.1.m1.1.3.4.2.4">n</mi><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.4.2.5">)</mo></mrow><msub id="S2.E2Xb.2.1.1.m1.1.3.4.3"><mi id="S2.E2Xb.2.1.1.m1.1.3.4.3.2">θ</mi><mi id="S2.E2Xb.2.1.1.m1.1.3.4.3.3">j</mi></msub><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.3.4.4">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S2.E2Xb.2.1.1.m1.1c">\displaystyle=\sum_{j=0}^{d/2-1}((q_{j}k_{j}+q_{j+d/2}k_{j+d/2})\text{cos}((m-n)\theta_{j})</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xb.2.1.1.m1.1d">= ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT ( ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_q start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT ) cos ( ( italic_m - italic_n ) italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S2.E2Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xc.2.1.1.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\ \ \ \ +(q_{j}k_{j+d/2}-q_{j+d/2}k_{j})\text{sin}((m-n)\theta_{j}))" display="inline"><semantics id="S2.E2Xc.2.1.1.m1.1a"><mrow id="S2.E2Xc.2.1.1.m1.1b"><mo id="S2.E2Xc.2.1.1.m1.1.1">+</mo><mrow id="S2.E2Xc.2.1.1.m1.1.2"><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.2.1">(</mo><msub id="S2.E2Xc.2.1.1.m1.1.2.2"><mi id="S2.E2Xc.2.1.1.m1.1.2.2.2">q</mi><mi id="S2.E2Xc.2.1.1.m1.1.2.2.3">j</mi></msub><msub id="S2.E2Xc.2.1.1.m1.1.2.3"><mi id="S2.E2Xc.2.1.1.m1.1.2.3.2">k</mi><mrow id="S2.E2Xc.2.1.1.m1.1.2.3.3"><mi id="S2.E2Xc.2.1.1.m1.1.2.3.3.2">j</mi><mo id="S2.E2Xc.2.1.1.m1.1.2.3.3.1">+</mo><mrow id="S2.E2Xc.2.1.1.m1.1.2.3.3.3"><mi id="S2.E2Xc.2.1.1.m1.1.2.3.3.3.2">d</mi><mo id="S2.E2Xc.2.1.1.m1.1.2.3.3.3.1">/</mo><mn id="S2.E2Xc.2.1.1.m1.1.2.3.3.3.3">2</mn></mrow></mrow></msub><mo id="S2.E2Xc.2.1.1.m1.1.2.4">−</mo><msub id="S2.E2Xc.2.1.1.m1.1.2.5"><mi id="S2.E2Xc.2.1.1.m1.1.2.5.2">q</mi><mrow id="S2.E2Xc.2.1.1.m1.1.2.5.3"><mi id="S2.E2Xc.2.1.1.m1.1.2.5.3.2">j</mi><mo id="S2.E2Xc.2.1.1.m1.1.2.5.3.1">+</mo><mrow id="S2.E2Xc.2.1.1.m1.1.2.5.3.3"><mi id="S2.E2Xc.2.1.1.m1.1.2.5.3.3.2">d</mi><mo id="S2.E2Xc.2.1.1.m1.1.2.5.3.3.1">/</mo><mn id="S2.E2Xc.2.1.1.m1.1.2.5.3.3.3">2</mn></mrow></mrow></msub><msub id="S2.E2Xc.2.1.1.m1.1.2.6"><mi id="S2.E2Xc.2.1.1.m1.1.2.6.2">k</mi><mi id="S2.E2Xc.2.1.1.m1.1.2.6.3">j</mi></msub><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.2.7">)</mo></mrow><mtext id="S2.E2Xc.2.1.1.m1.1.3">sin</mtext><mrow id="S2.E2Xc.2.1.1.m1.1.4"><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.4.1">(</mo><mrow id="S2.E2Xc.2.1.1.m1.1.4.2"><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.4.2.1">(</mo><mi id="S2.E2Xc.2.1.1.m1.1.4.2.2">m</mi><mo id="S2.E2Xc.2.1.1.m1.1.4.2.3">−</mo><mi id="S2.E2Xc.2.1.1.m1.1.4.2.4">n</mi><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.4.2.5">)</mo></mrow><msub id="S2.E2Xc.2.1.1.m1.1.4.3"><mi id="S2.E2Xc.2.1.1.m1.1.4.3.2">θ</mi><mi id="S2.E2Xc.2.1.1.m1.1.4.3.3">j</mi></msub><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.4.4">)</mo></mrow><mo stretchy="false" id="S2.E2Xc.2.1.1.m1.1.5">)</mo></mrow><annotation encoding="application/x-tex" id="S2.E2Xc.2.1.1.m1.1c">\displaystyle\ \ \ \ +(q_{j}k_{j+d/2}-q_{j+d/2}k_{j})\text{sin}((m-n)\theta_{j}))</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xc.2.1.1.m1.1d">+ ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT - italic_q start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) sin ( ( italic_m - italic_n ) italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S2.E2Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xd.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle:=a(m-n)" display="inline"><semantics id="S2.E2Xd.2.1.1.m1.1a"><mrow id="S2.E2Xd.2.1.1.m1.1.1" xref="S2.E2Xd.2.1.1.m1.1.1.cmml"><mi id="S2.E2Xd.2.1.1.m1.1.1.3" xref="S2.E2Xd.2.1.1.m1.1.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S2.E2Xd.2.1.1.m1.1.1.2" xref="S2.E2Xd.2.1.1.m1.1.1.2.cmml">:=</mo><mrow id="S2.E2Xd.2.1.1.m1.1.1.1" xref="S2.E2Xd.2.1.1.m1.1.1.1.cmml"><mi id="S2.E2Xd.2.1.1.m1.1.1.1.3" xref="S2.E2Xd.2.1.1.m1.1.1.1.3.cmml">a</mi><mo id="S2.E2Xd.2.1.1.m1.1.1.1.2" xref="S2.E2Xd.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2Xd.2.1.1.m1.1.1.1.1.1" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.2" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.2" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.1" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.3" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.3" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xd.2.1.1.m1.1b"><apply id="S2.E2Xd.2.1.1.m1.1.1.cmml" xref="S2.E2Xd.2.1.1.m1.1.1"><csymbol cd="latexml" id="S2.E2Xd.2.1.1.m1.1.1.2.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.2">assign</csymbol><csymbol cd="latexml" id="S2.E2Xd.2.1.1.m1.1.1.3.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.3">absent</csymbol><apply id="S2.E2Xd.2.1.1.m1.1.1.1.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1"><times id="S2.E2Xd.2.1.1.m1.1.1.1.2.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1.2"></times><ci id="S2.E2Xd.2.1.1.m1.1.1.1.3.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1.3">𝑎</ci><apply id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1"><minus id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.1"></minus><ci id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xd.2.1.1.m1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xd.2.1.1.m1.1c">\displaystyle:=a(m-n)</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xd.2.1.1.m1.1d">:= italic_a ( italic_m - italic_n )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS1.p1.10" class="ltx_p">Here, <math id="S2.SS1.p1.7.m1.1" class="ltx_Math" alttext="{\mathbf{q}}" display="inline"><semantics id="S2.SS1.p1.7.m1.1a"><mi id="S2.SS1.p1.7.m1.1.1" xref="S2.SS1.p1.7.m1.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m1.1b"><ci id="S2.SS1.p1.7.m1.1.1.cmml" xref="S2.SS1.p1.7.m1.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m1.1c">{\mathbf{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m1.1d">bold_q</annotation></semantics></math> and <math id="S2.SS1.p1.8.m2.1" class="ltx_Math" alttext="{\mathbf{k}}" display="inline"><semantics id="S2.SS1.p1.8.m2.1a"><mi id="S2.SS1.p1.8.m2.1.1" xref="S2.SS1.p1.8.m2.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m2.1b"><ci id="S2.SS1.p1.8.m2.1.1.cmml" xref="S2.SS1.p1.8.m2.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m2.1c">{\mathbf{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m2.1d">bold_k</annotation></semantics></math> denote the query and key vectors for a particular attention head. The attention score <math id="S2.SS1.p1.9.m3.1" class="ltx_Math" alttext="a(m-n)" display="inline"><semantics id="S2.SS1.p1.9.m3.1a"><mrow id="S2.SS1.p1.9.m3.1.1" xref="S2.SS1.p1.9.m3.1.1.cmml"><mi id="S2.SS1.p1.9.m3.1.1.3" xref="S2.SS1.p1.9.m3.1.1.3.cmml">a</mi><mo id="S2.SS1.p1.9.m3.1.1.2" xref="S2.SS1.p1.9.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.9.m3.1.1.1.1" xref="S2.SS1.p1.9.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.9.m3.1.1.1.1.2" xref="S2.SS1.p1.9.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.9.m3.1.1.1.1.1" xref="S2.SS1.p1.9.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.9.m3.1.1.1.1.1.2" xref="S2.SS1.p1.9.m3.1.1.1.1.1.2.cmml">m</mi><mo id="S2.SS1.p1.9.m3.1.1.1.1.1.1" xref="S2.SS1.p1.9.m3.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS1.p1.9.m3.1.1.1.1.1.3" xref="S2.SS1.p1.9.m3.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.SS1.p1.9.m3.1.1.1.1.3" xref="S2.SS1.p1.9.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m3.1b"><apply id="S2.SS1.p1.9.m3.1.1.cmml" xref="S2.SS1.p1.9.m3.1.1"><times id="S2.SS1.p1.9.m3.1.1.2.cmml" xref="S2.SS1.p1.9.m3.1.1.2"></times><ci id="S2.SS1.p1.9.m3.1.1.3.cmml" xref="S2.SS1.p1.9.m3.1.1.3">𝑎</ci><apply id="S2.SS1.p1.9.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.9.m3.1.1.1.1"><minus id="S2.SS1.p1.9.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.9.m3.1.1.1.1.1.1"></minus><ci id="S2.SS1.p1.9.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.9.m3.1.1.1.1.1.2">𝑚</ci><ci id="S2.SS1.p1.9.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.9.m3.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m3.1c">a(m-n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m3.1d">italic_a ( italic_m - italic_n )</annotation></semantics></math> is only dependent on relative position <math id="S2.SS1.p1.10.m4.1" class="ltx_Math" alttext="(m-n)" display="inline"><semantics id="S2.SS1.p1.10.m4.1a"><mrow id="S2.SS1.p1.10.m4.1.1.1" xref="S2.SS1.p1.10.m4.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.10.m4.1.1.1.2" xref="S2.SS1.p1.10.m4.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.10.m4.1.1.1.1" xref="S2.SS1.p1.10.m4.1.1.1.1.cmml"><mi id="S2.SS1.p1.10.m4.1.1.1.1.2" xref="S2.SS1.p1.10.m4.1.1.1.1.2.cmml">m</mi><mo id="S2.SS1.p1.10.m4.1.1.1.1.1" xref="S2.SS1.p1.10.m4.1.1.1.1.1.cmml">−</mo><mi id="S2.SS1.p1.10.m4.1.1.1.1.3" xref="S2.SS1.p1.10.m4.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.SS1.p1.10.m4.1.1.1.3" xref="S2.SS1.p1.10.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m4.1b"><apply id="S2.SS1.p1.10.m4.1.1.1.1.cmml" xref="S2.SS1.p1.10.m4.1.1.1"><minus id="S2.SS1.p1.10.m4.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m4.1.1.1.1.1"></minus><ci id="S2.SS1.p1.10.m4.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m4.1.1.1.1.2">𝑚</ci><ci id="S2.SS1.p1.10.m4.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m4.1.1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m4.1c">(m-n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m4.1d">( italic_m - italic_n )</annotation></semantics></math>. It is a beautiful design that works with the Attention mechanism to achieve absolute positional encoding in the way of relative positional encoding.This feature renders RoPE more efficient than other position encoding techniques and is inherently compatible with linear attentions.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Long-term decay of RoPE</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">As studied by <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite> before, RoPE has the characteristic of long-term decay:</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<table id="S2.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle|a(s)|" display="inline"><semantics id="S2.E3X.2.1.1.m1.2a"><mrow id="S2.E3X.2.1.1.m1.2.2.1" xref="S2.E3X.2.1.1.m1.2.2.2.cmml"><mo stretchy="false" id="S2.E3X.2.1.1.m1.2.2.1.2" xref="S2.E3X.2.1.1.m1.2.2.2.1.cmml">|</mo><mrow id="S2.E3X.2.1.1.m1.2.2.1.1" xref="S2.E3X.2.1.1.m1.2.2.1.1.cmml"><mi id="S2.E3X.2.1.1.m1.2.2.1.1.2" xref="S2.E3X.2.1.1.m1.2.2.1.1.2.cmml">a</mi><mo id="S2.E3X.2.1.1.m1.2.2.1.1.1" xref="S2.E3X.2.1.1.m1.2.2.1.1.1.cmml">⁢</mo><mrow id="S2.E3X.2.1.1.m1.2.2.1.1.3.2" xref="S2.E3X.2.1.1.m1.2.2.1.1.cmml"><mo stretchy="false" id="S2.E3X.2.1.1.m1.2.2.1.1.3.2.1" xref="S2.E3X.2.1.1.m1.2.2.1.1.cmml">(</mo><mi id="S2.E3X.2.1.1.m1.1.1" xref="S2.E3X.2.1.1.m1.1.1.cmml">s</mi><mo stretchy="false" id="S2.E3X.2.1.1.m1.2.2.1.1.3.2.2" xref="S2.E3X.2.1.1.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3X.2.1.1.m1.2.2.1.3" xref="S2.E3X.2.1.1.m1.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.2.1.1.m1.2b"><apply id="S2.E3X.2.1.1.m1.2.2.2.cmml" xref="S2.E3X.2.1.1.m1.2.2.1"><abs id="S2.E3X.2.1.1.m1.2.2.2.1.cmml" xref="S2.E3X.2.1.1.m1.2.2.1.2"></abs><apply id="S2.E3X.2.1.1.m1.2.2.1.1.cmml" xref="S2.E3X.2.1.1.m1.2.2.1.1"><times id="S2.E3X.2.1.1.m1.2.2.1.1.1.cmml" xref="S2.E3X.2.1.1.m1.2.2.1.1.1"></times><ci id="S2.E3X.2.1.1.m1.2.2.1.1.2.cmml" xref="S2.E3X.2.1.1.m1.2.2.1.1.2">𝑎</ci><ci id="S2.E3X.2.1.1.m1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.2c">\displaystyle|a(s)|</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.2.1.1.m1.2d">| italic_a ( italic_s ) |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\Bigg{|}\text{Re}\left[\sum_{j=0}^{d/2-1}h_{j}e^{is\theta_{j}}\right]\Bigg{|}" display="inline"><semantics id="S2.E3X.3.2.2.m1.1a"><mrow id="S2.E3X.3.2.2.m1.1.1" xref="S2.E3X.3.2.2.m1.1.1.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S2.E3X.3.2.2.m1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.2.cmml"><mo maxsize="260%" minsize="260%" id="S2.E3X.3.2.2.m1.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.cmml"><mtext id="S2.E3X.3.2.2.m1.1.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.3a.cmml">Re</mtext><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1a" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">0</mn></mrow><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">/</mo><mn id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></mrow><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">h</mi><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">e</mi><mrow id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">s</mi><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.1a" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><msub id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.2.cmml">θ</mi><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.3.cmml">j</mi></msub></mrow></msup></mrow></mrow><mo id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo maxsize="260%" minsize="260%" id="S2.E3X.3.2.2.m1.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.3.2.2.m1.1b"><apply id="S2.E3X.3.2.2.m1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1"><eq id="S2.E3X.3.2.2.m1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S2.E3X.3.2.2.m1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1"><abs id="S2.E3X.3.2.2.m1.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.2"></abs><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1"><times id="S2.E3X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.3a.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.3"><mtext id="S2.E3X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.3">Re</mtext></ci><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1"><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3">0</cn></apply></apply><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1"></minus><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2"><divide id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.1"></divide><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑑</ci><cn type="integer" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2"><times id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.2">ℎ</ci><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.2">𝑒</ci><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3"><times id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.1"></times><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.2">𝑖</ci><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.3">𝑠</ci><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.2">𝜃</ci><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.3.4.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.1c">\displaystyle=\Bigg{|}\text{Re}\left[\sum_{j=0}^{d/2-1}h_{j}e^{is\theta_{j}}\right]\Bigg{|}</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.3.2.2.m1.1d">= | Re [ ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_i italic_s italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ] |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S2.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\leq(\max_{i}|h_{i+1}-h_{i}|)\sum_{j=0}^{d/2-1}|S_{j+1}|" display="inline"><semantics id="S2.E3Xa.2.1.1.m1.2a"><mrow id="S2.E3Xa.2.1.1.m1.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.4" xref="S2.E3Xa.2.1.1.m1.2.2.4.cmml"></mi><mo id="S2.E3Xa.2.1.1.m1.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.3.cmml">≤</mo><mrow id="S2.E3Xa.2.1.1.m1.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.cmml"><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><munder id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">max</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi></munder><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1a" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3Xa.2.1.1.m1.2.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.cmml"><munderover id="S2.E3Xa.2.1.1.m1.2.2.2.2.2a" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.cmml"><mo movablelimits="false" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.2.cmml">j</mi><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.3.cmml">0</mn></mrow><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.cmml"><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.2.cmml">d</mi><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.1.cmml">/</mo><mn id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.3.cmml">2</mn></mrow><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.1.cmml">−</mo><mn id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.2.1.cmml">|</mo><msub id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">S</mi><mrow id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.cmml">j</mi><mo id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1.cmml">+</mo><mn id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.2b"><apply id="S2.E3Xa.2.1.1.m1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2"><leq id="S2.E3Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.3"></leq><csymbol cd="latexml" id="S2.E3Xa.2.1.1.m1.2.2.4.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.4">absent</csymbol><apply id="S2.E3Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2"><times id="S2.E3Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.3"></times><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1"><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><max id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2"></max><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><abs id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"><minus id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3"><plus id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2"><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2">subscript</csymbol><sum id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.2"></sum><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3"><eq id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.1"></eq><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.2.3.3">0</cn></apply></apply><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3"><minus id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.1"></minus><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2"><divide id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.1"></divide><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.2">𝑑</ci><cn type="integer" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.2.3">2</cn></apply><cn type="integer" id="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1"><abs id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.2.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.2"></abs><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.2">𝑆</ci><apply id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3"><plus id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1"></plus><ci id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2">𝑗</ci><cn type="integer" id="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.2c">\displaystyle\leq(\max_{i}|h_{i+1}-h_{i}|)\sum_{j=0}^{d/2-1}|S_{j+1}|</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.2.1.1.m1.2d">≤ ( roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ) ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT | italic_S start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.4" class="ltx_p">where <math id="S2.SS2.p3.1.m1.2" class="ltx_Math" alttext="h_{j}:=(q_{j}+iq_{j+d/2})(k_{j}-ik_{j+d/2})" display="inline"><semantics id="S2.SS2.p3.1.m1.2a"><mrow id="S2.SS2.p3.1.m1.2.2" xref="S2.SS2.p3.1.m1.2.2.cmml"><msub id="S2.SS2.p3.1.m1.2.2.4" xref="S2.SS2.p3.1.m1.2.2.4.cmml"><mi id="S2.SS2.p3.1.m1.2.2.4.2" xref="S2.SS2.p3.1.m1.2.2.4.2.cmml">h</mi><mi id="S2.SS2.p3.1.m1.2.2.4.3" xref="S2.SS2.p3.1.m1.2.2.4.3.cmml">j</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.p3.1.m1.2.2.3" xref="S2.SS2.p3.1.m1.2.2.3.cmml">:=</mo><mrow id="S2.SS2.p3.1.m1.2.2.2" xref="S2.SS2.p3.1.m1.2.2.2.cmml"><mrow id="S2.SS2.p3.1.m1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p3.1.m1.1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p3.1.m1.1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml"><msub id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS2.p3.1.m1.1.1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.2.cmml">q</mi><mrow id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.2.cmml">j</mi><mo id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mrow id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mo id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.1.cmml">/</mo><mn id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.SS2.p3.1.m1.1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS2.p3.1.m1.2.2.2.3" xref="S2.SS2.p3.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS2.p3.1.m1.2.2.2.2.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S2.SS2.p3.1.m1.2.2.2.2.1.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.SS2.p3.1.m1.2.2.2.2.1.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.cmml"><msub id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.2.cmml">k</mi><mi id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS2.p3.1.m1.2.2.2.2.1.1.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.1.cmml">−</mo><mrow id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><msub id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.2.cmml">k</mi><mrow id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.2.cmml">j</mi><mo id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.1.cmml">+</mo><mrow id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.cmml"><mi id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.2" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.2.cmml">d</mi><mo id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.1" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.1.cmml">/</mo><mn id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.SS2.p3.1.m1.2.2.2.2.1.3" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.2b"><apply id="S2.SS2.p3.1.m1.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2"><csymbol cd="latexml" id="S2.SS2.p3.1.m1.2.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.3">assign</csymbol><apply id="S2.SS2.p3.1.m1.2.2.4.cmml" xref="S2.SS2.p3.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.2.2.4.1.cmml" xref="S2.SS2.p3.1.m1.2.2.4">subscript</csymbol><ci id="S2.SS2.p3.1.m1.2.2.4.2.cmml" xref="S2.SS2.p3.1.m1.2.2.4.2">ℎ</ci><ci id="S2.SS2.p3.1.m1.2.2.4.3.cmml" xref="S2.SS2.p3.1.m1.2.2.4.3">𝑗</ci></apply><apply id="S2.SS2.p3.1.m1.2.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2"><times id="S2.SS2.p3.1.m1.2.2.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.3"></times><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1"><plus id="S2.SS2.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.1"></plus><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3"><times id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.2">𝑞</ci><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3"><plus id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.2">𝑗</ci><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3"><divide id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.1"></divide><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.SS2.p3.1.m1.2.2.2.2.1.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1"><minus id="S2.SS2.p3.1.m1.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.1"></minus><apply id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.2">𝑘</ci><ci id="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3"><times id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.1"></times><ci id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.2">𝑖</ci><apply id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.2">𝑘</ci><apply id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3"><plus id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.1"></plus><ci id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.2">𝑗</ci><apply id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3"><divide id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.1"></divide><ci id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.2c">h_{j}:=(q_{j}+iq_{j+d/2})(k_{j}-ik_{j+d/2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.2d">italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT := ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_i italic_q start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT ) ( italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_i italic_k start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT )</annotation></semantics></math> and <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="S_{j}:=\sum_{k=0}^{j-1}e^{is\theta_{k}}" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mrow id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><msub id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml"><mi id="S2.SS2.p3.2.m2.1.1.2.2" xref="S2.SS2.p3.2.m2.1.1.2.2.cmml">S</mi><mi id="S2.SS2.p3.2.m2.1.1.2.3" xref="S2.SS2.p3.2.m2.1.1.2.3.cmml">j</mi></msub><mo lspace="0.278em" rspace="0.111em" id="S2.SS2.p3.2.m2.1.1.1" xref="S2.SS2.p3.2.m2.1.1.1.cmml">:=</mo><mrow id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml"><msubsup id="S2.SS2.p3.2.m2.1.1.3.1" xref="S2.SS2.p3.2.m2.1.1.3.1.cmml"><mo id="S2.SS2.p3.2.m2.1.1.3.1.2.2" xref="S2.SS2.p3.2.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS2.p3.2.m2.1.1.3.1.2.3" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.cmml"><mi id="S2.SS2.p3.2.m2.1.1.3.1.2.3.2" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.2.cmml">k</mi><mo id="S2.SS2.p3.2.m2.1.1.3.1.2.3.1" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.SS2.p3.2.m2.1.1.3.1.2.3.3" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S2.SS2.p3.2.m2.1.1.3.1.3" xref="S2.SS2.p3.2.m2.1.1.3.1.3.cmml"><mi id="S2.SS2.p3.2.m2.1.1.3.1.3.2" xref="S2.SS2.p3.2.m2.1.1.3.1.3.2.cmml">j</mi><mo id="S2.SS2.p3.2.m2.1.1.3.1.3.1" xref="S2.SS2.p3.2.m2.1.1.3.1.3.1.cmml">−</mo><mn id="S2.SS2.p3.2.m2.1.1.3.1.3.3" xref="S2.SS2.p3.2.m2.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><msup id="S2.SS2.p3.2.m2.1.1.3.2" xref="S2.SS2.p3.2.m2.1.1.3.2.cmml"><mi id="S2.SS2.p3.2.m2.1.1.3.2.2" xref="S2.SS2.p3.2.m2.1.1.3.2.2.cmml">e</mi><mrow id="S2.SS2.p3.2.m2.1.1.3.2.3" xref="S2.SS2.p3.2.m2.1.1.3.2.3.cmml"><mi id="S2.SS2.p3.2.m2.1.1.3.2.3.2" xref="S2.SS2.p3.2.m2.1.1.3.2.3.2.cmml">i</mi><mo id="S2.SS2.p3.2.m2.1.1.3.2.3.1" xref="S2.SS2.p3.2.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.SS2.p3.2.m2.1.1.3.2.3.3" xref="S2.SS2.p3.2.m2.1.1.3.2.3.3.cmml">s</mi><mo id="S2.SS2.p3.2.m2.1.1.3.2.3.1a" xref="S2.SS2.p3.2.m2.1.1.3.2.3.1.cmml">⁢</mo><msub id="S2.SS2.p3.2.m2.1.1.3.2.3.4" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4.cmml"><mi id="S2.SS2.p3.2.m2.1.1.3.2.3.4.2" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4.2.cmml">θ</mi><mi id="S2.SS2.p3.2.m2.1.1.3.2.3.4.3" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4.3.cmml">k</mi></msub></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"><csymbol cd="latexml" id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1.1">assign</csymbol><apply id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2.2">𝑆</ci><ci id="S2.SS2.p3.2.m2.1.1.2.3.cmml" xref="S2.SS2.p3.2.m2.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p3.2.m2.1.1.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3"><apply id="S2.SS2.p3.2.m2.1.1.3.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.3.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1">superscript</csymbol><apply id="S2.SS2.p3.2.m2.1.1.3.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.3.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1">subscript</csymbol><sum id="S2.SS2.p3.2.m2.1.1.3.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.2.2"></sum><apply id="S2.SS2.p3.2.m2.1.1.3.1.2.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3"><eq id="S2.SS2.p3.2.m2.1.1.3.1.2.3.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.1"></eq><ci id="S2.SS2.p3.2.m2.1.1.3.1.2.3.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.SS2.p3.2.m2.1.1.3.1.2.3.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S2.SS2.p3.2.m2.1.1.3.1.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.3"><minus id="S2.SS2.p3.2.m2.1.1.3.1.3.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.3.1"></minus><ci id="S2.SS2.p3.2.m2.1.1.3.1.3.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.3.2">𝑗</ci><cn type="integer" id="S2.SS2.p3.2.m2.1.1.3.1.3.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.1.3.3">1</cn></apply></apply><apply id="S2.SS2.p3.2.m2.1.1.3.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.3.2.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2">superscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.3.2.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.2">𝑒</ci><apply id="S2.SS2.p3.2.m2.1.1.3.2.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3"><times id="S2.SS2.p3.2.m2.1.1.3.2.3.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.1"></times><ci id="S2.SS2.p3.2.m2.1.1.3.2.3.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.2">𝑖</ci><ci id="S2.SS2.p3.2.m2.1.1.3.2.3.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.3">𝑠</ci><apply id="S2.SS2.p3.2.m2.1.1.3.2.3.4.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.3.2.3.4.1.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.3.2.3.4.2.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4.2">𝜃</ci><ci id="S2.SS2.p3.2.m2.1.1.3.2.3.4.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3.2.3.4.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">S_{j}:=\sum_{k=0}^{j-1}e^{is\theta_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT := ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j - 1 end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_i italic_s italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, Since the value of <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="\sum_{j=0}^{d/2-1}|S_{j+1}|" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mrow id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><msubsup id="S2.SS2.p3.3.m3.1.1.2" xref="S2.SS2.p3.3.m3.1.1.2.cmml"><mo id="S2.SS2.p3.3.m3.1.1.2.2.2" xref="S2.SS2.p3.3.m3.1.1.2.2.2.cmml">∑</mo><mrow id="S2.SS2.p3.3.m3.1.1.2.2.3" xref="S2.SS2.p3.3.m3.1.1.2.2.3.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2.2.3.2" xref="S2.SS2.p3.3.m3.1.1.2.2.3.2.cmml">j</mi><mo id="S2.SS2.p3.3.m3.1.1.2.2.3.1" xref="S2.SS2.p3.3.m3.1.1.2.2.3.1.cmml">=</mo><mn id="S2.SS2.p3.3.m3.1.1.2.2.3.3" xref="S2.SS2.p3.3.m3.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S2.SS2.p3.3.m3.1.1.2.3" xref="S2.SS2.p3.3.m3.1.1.2.3.cmml"><mrow id="S2.SS2.p3.3.m3.1.1.2.3.2" xref="S2.SS2.p3.3.m3.1.1.2.3.2.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2.3.2.2" xref="S2.SS2.p3.3.m3.1.1.2.3.2.2.cmml">d</mi><mo id="S2.SS2.p3.3.m3.1.1.2.3.2.1" xref="S2.SS2.p3.3.m3.1.1.2.3.2.1.cmml">/</mo><mn id="S2.SS2.p3.3.m3.1.1.2.3.2.3" xref="S2.SS2.p3.3.m3.1.1.2.3.2.3.cmml">2</mn></mrow><mo id="S2.SS2.p3.3.m3.1.1.2.3.1" xref="S2.SS2.p3.3.m3.1.1.2.3.1.cmml">−</mo><mn id="S2.SS2.p3.3.m3.1.1.2.3.3" xref="S2.SS2.p3.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S2.SS2.p3.3.m3.1.1.1.1" xref="S2.SS2.p3.3.m3.1.1.1.2.cmml"><mo lspace="0em" stretchy="false" id="S2.SS2.p3.3.m3.1.1.1.1.2" xref="S2.SS2.p3.3.m3.1.1.1.2.1.cmml">|</mo><msub id="S2.SS2.p3.3.m3.1.1.1.1.1" xref="S2.SS2.p3.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.1.1.1.2" xref="S2.SS2.p3.3.m3.1.1.1.1.1.2.cmml">S</mi><mrow id="S2.SS2.p3.3.m3.1.1.1.1.1.3" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p3.3.m3.1.1.1.1.1.3.2" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.2.cmml">j</mi><mo id="S2.SS2.p3.3.m3.1.1.1.1.1.3.1" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.1.cmml">+</mo><mn id="S2.SS2.p3.3.m3.1.1.1.1.1.3.3" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS2.p3.3.m3.1.1.1.1.3" xref="S2.SS2.p3.3.m3.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><apply id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.2.1.cmml" xref="S2.SS2.p3.3.m3.1.1.2">superscript</csymbol><apply id="S2.SS2.p3.3.m3.1.1.2.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.2.2.1.cmml" xref="S2.SS2.p3.3.m3.1.1.2">subscript</csymbol><sum id="S2.SS2.p3.3.m3.1.1.2.2.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2.2.2"></sum><apply id="S2.SS2.p3.3.m3.1.1.2.2.3.cmml" xref="S2.SS2.p3.3.m3.1.1.2.2.3"><eq id="S2.SS2.p3.3.m3.1.1.2.2.3.1.cmml" xref="S2.SS2.p3.3.m3.1.1.2.2.3.1"></eq><ci id="S2.SS2.p3.3.m3.1.1.2.2.3.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.SS2.p3.3.m3.1.1.2.2.3.3.cmml" xref="S2.SS2.p3.3.m3.1.1.2.2.3.3">0</cn></apply></apply><apply id="S2.SS2.p3.3.m3.1.1.2.3.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3"><minus id="S2.SS2.p3.3.m3.1.1.2.3.1.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3.1"></minus><apply id="S2.SS2.p3.3.m3.1.1.2.3.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3.2"><divide id="S2.SS2.p3.3.m3.1.1.2.3.2.1.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3.2.1"></divide><ci id="S2.SS2.p3.3.m3.1.1.2.3.2.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3.2.2">𝑑</ci><cn type="integer" id="S2.SS2.p3.3.m3.1.1.2.3.2.3.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3.2.3">2</cn></apply><cn type="integer" id="S2.SS2.p3.3.m3.1.1.2.3.3.cmml" xref="S2.SS2.p3.3.m3.1.1.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p3.3.m3.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1"><abs id="S2.SS2.p3.3.m3.1.1.1.2.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.2"></abs><apply id="S2.SS2.p3.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1.2">𝑆</ci><apply id="S2.SS2.p3.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3"><plus id="S2.SS2.p3.3.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.1"></plus><ci id="S2.SS2.p3.3.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S2.SS2.p3.3.m3.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p3.3.m3.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\sum_{j=0}^{d/2-1}|S_{j+1}|</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT | italic_S start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT |</annotation></semantics></math> decays with the relative distance <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><mi id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.4.m4.1d">italic_s</annotation></semantics></math>, the attention score decays either.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p">This is consistent with human understanding of language modeling.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS2.p5.1" class="ltx_p">We claim that we could get a much more stronger one with collinear constraint later.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Anomalous behavior between RoPE and attention matrices</h3>

<div id="S2.SS3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS3.p1.2" class="ltx_p">In Equation <a href="#S2.E2" title="2 ‣ 2.1 Background: Rotary Position Embedding (RoPE) ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we show the attention score after applying RoPE as <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="a(m-n)" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">a</mi><mo id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.p1.1.m1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.1.m1.1.1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.1.m1.1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.SS3.p1.1.m1.1.1.1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS3.p1.1.m1.1.1.1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.SS3.p1.1.m1.1.1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><times id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2"></times><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝑎</ci><apply id="S2.SS3.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1"><minus id="S2.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1.1"></minus><ci id="S2.SS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1.2">𝑚</ci><ci id="S2.SS3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">a(m-n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_a ( italic_m - italic_n )</annotation></semantics></math>, mathematically, it can be visualized as the inner-product of two complex number after a rotation for any individual <math id="S2.SS3.p1.2.m2.2" class="ltx_Math" alttext="j\in[0,d/2]" display="inline"><semantics id="S2.SS3.p1.2.m2.2a"><mrow id="S2.SS3.p1.2.m2.2.2" xref="S2.SS3.p1.2.m2.2.2.cmml"><mi id="S2.SS3.p1.2.m2.2.2.3" xref="S2.SS3.p1.2.m2.2.2.3.cmml">j</mi><mo id="S2.SS3.p1.2.m2.2.2.2" xref="S2.SS3.p1.2.m2.2.2.2.cmml">∈</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.2.m2.2.2.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">[</mo><mn id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">0</mn><mo id="S2.SS3.p1.2.m2.2.2.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">,</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml">d</mi><mo id="S2.SS3.p1.2.m2.2.2.1.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml">/</mo><mn id="S2.SS3.p1.2.m2.2.2.1.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S2.SS3.p1.2.m2.2.2.1.1.4" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.2b"><apply id="S2.SS3.p1.2.m2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2"><in id="S2.SS3.p1.2.m2.2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2.2"></in><ci id="S2.SS3.p1.2.m2.2.2.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3">𝑗</ci><interval closure="closed" id="S2.SS3.p1.2.m2.2.2.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1"><cn type="integer" id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">0</cn><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1"><divide id="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.1"></divide><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2">𝑑</ci><cn type="integer" id="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.2c">j\in[0,d/2]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.2d">italic_j ∈ [ 0 , italic_d / 2 ]</annotation></semantics></math>, just like Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para ltx_noindent">
<p id="S2.SS3.p2.1" class="ltx_p">It intuitively make sense, since position distance can be modeling as one kind of order and the inner-product of two complex number changes with the rotation angle <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="(m-n)\theta" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><mrow id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mrow id="S2.SS3.p2.1.m1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.1.m1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.SS3.p2.1.m1.1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS3.p2.1.m1.1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">⁢</mo><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><times id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2"></times><apply id="S2.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1"><minus id="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1"></minus><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.2">𝑚</ci><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.3">𝑛</ci></apply><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">(m-n)\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">( italic_m - italic_n ) italic_θ</annotation></semantics></math>.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para ltx_noindent">
<p id="S2.SS3.p3.1" class="ltx_p">However, we will show that it is not a qualified order with a technical deficiency.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para ltx_noindent">
<p id="S2.SS3.p4.7" class="ltx_p">For simplicity, we consider bidirectional models first, such as Bert <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite> and GLM <cite class="ltx_cite ltx_citemacro_citep">(Du et al., <a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, etc. As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, for any pair of <math id="S2.SS3.p4.1.m1.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.SS3.p4.1.m1.1a"><msub id="S2.SS3.p4.1.m1.1.1" xref="S2.SS3.p4.1.m1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.2.cmml">𝐪</mi><mi id="S2.SS3.p4.1.m1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><apply id="S2.SS3.p4.1.m1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.2">𝐪</ci><ci id="S2.SS3.p4.1.m1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.1.m1.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS3.p4.2.m2.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.SS3.p4.2.m2.1a"><msub id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml"><mi id="S2.SS3.p4.2.m2.1.1.2" xref="S2.SS3.p4.2.m2.1.1.2.cmml">𝐤</mi><mi id="S2.SS3.p4.2.m2.1.1.3" xref="S2.SS3.p4.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><apply id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.2.m2.1.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p4.2.m2.1.1.2.cmml" xref="S2.SS3.p4.2.m2.1.1.2">𝐤</ci><ci id="S2.SS3.p4.2.m2.1.1.3.cmml" xref="S2.SS3.p4.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.2.m2.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, without loss of generality, we suppose that there is an angle <math id="S2.SS3.p4.3.m3.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S2.SS3.p4.3.m3.1a"><msub id="S2.SS3.p4.3.m3.1.1" xref="S2.SS3.p4.3.m3.1.1.cmml"><mi id="S2.SS3.p4.3.m3.1.1.2" xref="S2.SS3.p4.3.m3.1.1.2.cmml">θ</mi><mn id="S2.SS3.p4.3.m3.1.1.3" xref="S2.SS3.p4.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.3.m3.1b"><apply id="S2.SS3.p4.3.m3.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.3.m3.1.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p4.3.m3.1.1.2.cmml" xref="S2.SS3.p4.3.m3.1.1.2">𝜃</ci><cn type="integer" id="S2.SS3.p4.3.m3.1.1.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.3.m3.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.3.m3.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> which is smaller than <math id="S2.SS3.p4.4.m4.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.SS3.p4.4.m4.1a"><mi id="S2.SS3.p4.4.m4.1.1" xref="S2.SS3.p4.4.m4.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.4.m4.1b"><ci id="S2.SS3.p4.4.m4.1.1.cmml" xref="S2.SS3.p4.4.m4.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.4.m4.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.4.m4.1d">italic_π</annotation></semantics></math> to rotate counterclockwise from <math id="S2.SS3.p4.5.m5.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.SS3.p4.5.m5.1a"><msub id="S2.SS3.p4.5.m5.1.1" xref="S2.SS3.p4.5.m5.1.1.cmml"><mi id="S2.SS3.p4.5.m5.1.1.2" xref="S2.SS3.p4.5.m5.1.1.2.cmml">𝐤</mi><mi id="S2.SS3.p4.5.m5.1.1.3" xref="S2.SS3.p4.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.5.m5.1b"><apply id="S2.SS3.p4.5.m5.1.1.cmml" xref="S2.SS3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.5.m5.1.1.1.cmml" xref="S2.SS3.p4.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p4.5.m5.1.1.2.cmml" xref="S2.SS3.p4.5.m5.1.1.2">𝐤</ci><ci id="S2.SS3.p4.5.m5.1.1.3.cmml" xref="S2.SS3.p4.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.5.m5.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.5.m5.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="S2.SS3.p4.6.m6.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.SS3.p4.6.m6.1a"><msub id="S2.SS3.p4.6.m6.1.1" xref="S2.SS3.p4.6.m6.1.1.cmml"><mi id="S2.SS3.p4.6.m6.1.1.2" xref="S2.SS3.p4.6.m6.1.1.2.cmml">𝐪</mi><mi id="S2.SS3.p4.6.m6.1.1.3" xref="S2.SS3.p4.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.6.m6.1b"><apply id="S2.SS3.p4.6.m6.1.1.cmml" xref="S2.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.6.m6.1.1.1.cmml" xref="S2.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p4.6.m6.1.1.2.cmml" xref="S2.SS3.p4.6.m6.1.1.2">𝐪</ci><ci id="S2.SS3.p4.6.m6.1.1.3.cmml" xref="S2.SS3.p4.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.6.m6.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.6.m6.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in the complex plane, then we have two possible conditions of their position indices(while <math id="S2.SS3.p4.7.m7.1" class="ltx_Math" alttext="=" display="inline"><semantics id="S2.SS3.p4.7.m7.1a"><mo id="S2.SS3.p4.7.m7.1.1" xref="S2.SS3.p4.7.m7.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.7.m7.1b"><eq id="S2.SS3.p4.7.m7.1.1.cmml" xref="S2.SS3.p4.7.m7.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.7.m7.1c">=</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.7.m7.1d">=</annotation></semantics></math> is ordinary).</p>
</div>
<div id="S2.SS3.p5" class="ltx_para ltx_noindent">
<p id="S2.SS3.p5.3" class="ltx_p"><math id="S2.SS3.p5.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S2.SS3.p5.1.m1.1a"><mo id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><ci id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.1.m1.1d">∙</annotation></semantics></math> When <math id="S2.SS3.p5.2.m2.1" class="ltx_Math" alttext="m&gt;n" display="inline"><semantics id="S2.SS3.p5.2.m2.1a"><mrow id="S2.SS3.p5.2.m2.1.1" xref="S2.SS3.p5.2.m2.1.1.cmml"><mi id="S2.SS3.p5.2.m2.1.1.2" xref="S2.SS3.p5.2.m2.1.1.2.cmml">m</mi><mo id="S2.SS3.p5.2.m2.1.1.1" xref="S2.SS3.p5.2.m2.1.1.1.cmml">&gt;</mo><mi id="S2.SS3.p5.2.m2.1.1.3" xref="S2.SS3.p5.2.m2.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.2.m2.1b"><apply id="S2.SS3.p5.2.m2.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1"><gt id="S2.SS3.p5.2.m2.1.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1.1"></gt><ci id="S2.SS3.p5.2.m2.1.1.2.cmml" xref="S2.SS3.p5.2.m2.1.1.2">𝑚</ci><ci id="S2.SS3.p5.2.m2.1.1.3.cmml" xref="S2.SS3.p5.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.2.m2.1c">m&gt;n</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.2.m2.1d">italic_m &gt; italic_n</annotation></semantics></math>, shown as the right part of Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, it’s the order preserving one what we want. Since the attention score decreases when the position distance increase(until they rotate out of <math id="S2.SS3.p5.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.SS3.p5.3.m3.1a"><mi id="S2.SS3.p5.3.m3.1.1" xref="S2.SS3.p5.3.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.3.m3.1b"><ci id="S2.SS3.p5.3.m3.1.1.cmml" xref="S2.SS3.p5.3.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.3.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.3.m3.1d">italic_π</annotation></semantics></math>, we will discuss this part in Appendix <a href="#A1" title="Appendix A Rotary borders ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>).</p>
</div>
<div id="S2.SS3.p6" class="ltx_para ltx_noindent">
<p id="S2.SS3.p6.3" class="ltx_p"><math id="S2.SS3.p6.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S2.SS3.p6.1.m1.1a"><mo id="S2.SS3.p6.1.m1.1.1" xref="S2.SS3.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.1.m1.1b"><ci id="S2.SS3.p6.1.m1.1.1.cmml" xref="S2.SS3.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.1.m1.1d">∙</annotation></semantics></math> However, when <math id="S2.SS3.p6.2.m2.1" class="ltx_Math" alttext="m&lt;n" display="inline"><semantics id="S2.SS3.p6.2.m2.1a"><mrow id="S2.SS3.p6.2.m2.1.1" xref="S2.SS3.p6.2.m2.1.1.cmml"><mi id="S2.SS3.p6.2.m2.1.1.2" xref="S2.SS3.p6.2.m2.1.1.2.cmml">m</mi><mo id="S2.SS3.p6.2.m2.1.1.1" xref="S2.SS3.p6.2.m2.1.1.1.cmml">&lt;</mo><mi id="S2.SS3.p6.2.m2.1.1.3" xref="S2.SS3.p6.2.m2.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.2.m2.1b"><apply id="S2.SS3.p6.2.m2.1.1.cmml" xref="S2.SS3.p6.2.m2.1.1"><lt id="S2.SS3.p6.2.m2.1.1.1.cmml" xref="S2.SS3.p6.2.m2.1.1.1"></lt><ci id="S2.SS3.p6.2.m2.1.1.2.cmml" xref="S2.SS3.p6.2.m2.1.1.2">𝑚</ci><ci id="S2.SS3.p6.2.m2.1.1.3.cmml" xref="S2.SS3.p6.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.2.m2.1c">m&lt;n</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.2.m2.1d">italic_m &lt; italic_n</annotation></semantics></math>, shown as the left part of Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the anomalous behavior which breaks the order at closest tokens with the number of <math id="S2.SS3.p6.3.m3.1" class="ltx_Math" alttext="\theta_{0}/\theta_{j}" display="inline"><semantics id="S2.SS3.p6.3.m3.1a"><mrow id="S2.SS3.p6.3.m3.1.1" xref="S2.SS3.p6.3.m3.1.1.cmml"><msub id="S2.SS3.p6.3.m3.1.1.2" xref="S2.SS3.p6.3.m3.1.1.2.cmml"><mi id="S2.SS3.p6.3.m3.1.1.2.2" xref="S2.SS3.p6.3.m3.1.1.2.2.cmml">θ</mi><mn id="S2.SS3.p6.3.m3.1.1.2.3" xref="S2.SS3.p6.3.m3.1.1.2.3.cmml">0</mn></msub><mo id="S2.SS3.p6.3.m3.1.1.1" xref="S2.SS3.p6.3.m3.1.1.1.cmml">/</mo><msub id="S2.SS3.p6.3.m3.1.1.3" xref="S2.SS3.p6.3.m3.1.1.3.cmml"><mi id="S2.SS3.p6.3.m3.1.1.3.2" xref="S2.SS3.p6.3.m3.1.1.3.2.cmml">θ</mi><mi id="S2.SS3.p6.3.m3.1.1.3.3" xref="S2.SS3.p6.3.m3.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.3.m3.1b"><apply id="S2.SS3.p6.3.m3.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1"><divide id="S2.SS3.p6.3.m3.1.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1.1"></divide><apply id="S2.SS3.p6.3.m3.1.1.2.cmml" xref="S2.SS3.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p6.3.m3.1.1.2.1.cmml" xref="S2.SS3.p6.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS3.p6.3.m3.1.1.2.2.cmml" xref="S2.SS3.p6.3.m3.1.1.2.2">𝜃</ci><cn type="integer" id="S2.SS3.p6.3.m3.1.1.2.3.cmml" xref="S2.SS3.p6.3.m3.1.1.2.3">0</cn></apply><apply id="S2.SS3.p6.3.m3.1.1.3.cmml" xref="S2.SS3.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p6.3.m3.1.1.3.1.cmml" xref="S2.SS3.p6.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS3.p6.3.m3.1.1.3.2.cmml" xref="S2.SS3.p6.3.m3.1.1.3.2">𝜃</ci><ci id="S2.SS3.p6.3.m3.1.1.3.3.cmml" xref="S2.SS3.p6.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.3.m3.1c">\theta_{0}/\theta_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.3.m3.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT / italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. More terribly, it always accompanies the model whether applying PI <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite> or NTK-aware Scaled RoPE <cite class="ltx_cite ltx_citemacro_citep">(bloc97, <a href="#bib.bib3" title="" class="ltx_ref">2023</a>)</cite>. Since we could only survive by cutting tail but not head.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="1.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="471" height="165" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Broken of order in bidirectional models. The inner-product of <math id="S2.F2.8.m1.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.F2.8.m1.1b"><msub id="S2.F2.8.m1.1.1" xref="S2.F2.8.m1.1.1.cmml"><mi id="S2.F2.8.m1.1.1.2" xref="S2.F2.8.m1.1.1.2.cmml">𝐪</mi><mi id="S2.F2.8.m1.1.1.3" xref="S2.F2.8.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.8.m1.1c"><apply id="S2.F2.8.m1.1.1.cmml" xref="S2.F2.8.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.8.m1.1.1.1.cmml" xref="S2.F2.8.m1.1.1">subscript</csymbol><ci id="S2.F2.8.m1.1.1.2.cmml" xref="S2.F2.8.m1.1.1.2">𝐪</ci><ci id="S2.F2.8.m1.1.1.3.cmml" xref="S2.F2.8.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m1.1d">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.8.m1.1e">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.F2.9.m2.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.F2.9.m2.1b"><msub id="S2.F2.9.m2.1.1" xref="S2.F2.9.m2.1.1.cmml"><mi id="S2.F2.9.m2.1.1.2" xref="S2.F2.9.m2.1.1.2.cmml">𝐤</mi><mi id="S2.F2.9.m2.1.1.3" xref="S2.F2.9.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.9.m2.1c"><apply id="S2.F2.9.m2.1.1.cmml" xref="S2.F2.9.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.9.m2.1.1.1.cmml" xref="S2.F2.9.m2.1.1">subscript</csymbol><ci id="S2.F2.9.m2.1.1.2.cmml" xref="S2.F2.9.m2.1.1.2">𝐤</ci><ci id="S2.F2.9.m2.1.1.3.cmml" xref="S2.F2.9.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.m2.1d">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.9.m2.1e">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is based on the relative angle between them. <span id="S2.F2.17.1" class="ltx_text ltx_font_bold">Left:</span> when <math id="S2.F2.10.m3.1" class="ltx_Math" alttext="|m-n|\theta_{j}&lt;\theta_{0}" display="inline"><semantics id="S2.F2.10.m3.1b"><mrow id="S2.F2.10.m3.1.1" xref="S2.F2.10.m3.1.1.cmml"><mrow id="S2.F2.10.m3.1.1.1" xref="S2.F2.10.m3.1.1.1.cmml"><mrow id="S2.F2.10.m3.1.1.1.1.1" xref="S2.F2.10.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.F2.10.m3.1.1.1.1.1.2" xref="S2.F2.10.m3.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.F2.10.m3.1.1.1.1.1.1" xref="S2.F2.10.m3.1.1.1.1.1.1.cmml"><mi id="S2.F2.10.m3.1.1.1.1.1.1.2" xref="S2.F2.10.m3.1.1.1.1.1.1.2.cmml">m</mi><mo id="S2.F2.10.m3.1.1.1.1.1.1.1" xref="S2.F2.10.m3.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.F2.10.m3.1.1.1.1.1.1.3" xref="S2.F2.10.m3.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.F2.10.m3.1.1.1.1.1.3" xref="S2.F2.10.m3.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.F2.10.m3.1.1.1.2" xref="S2.F2.10.m3.1.1.1.2.cmml">⁢</mo><msub id="S2.F2.10.m3.1.1.1.3" xref="S2.F2.10.m3.1.1.1.3.cmml"><mi id="S2.F2.10.m3.1.1.1.3.2" xref="S2.F2.10.m3.1.1.1.3.2.cmml">θ</mi><mi id="S2.F2.10.m3.1.1.1.3.3" xref="S2.F2.10.m3.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="S2.F2.10.m3.1.1.2" xref="S2.F2.10.m3.1.1.2.cmml">&lt;</mo><msub id="S2.F2.10.m3.1.1.3" xref="S2.F2.10.m3.1.1.3.cmml"><mi id="S2.F2.10.m3.1.1.3.2" xref="S2.F2.10.m3.1.1.3.2.cmml">θ</mi><mn id="S2.F2.10.m3.1.1.3.3" xref="S2.F2.10.m3.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.10.m3.1c"><apply id="S2.F2.10.m3.1.1.cmml" xref="S2.F2.10.m3.1.1"><lt id="S2.F2.10.m3.1.1.2.cmml" xref="S2.F2.10.m3.1.1.2"></lt><apply id="S2.F2.10.m3.1.1.1.cmml" xref="S2.F2.10.m3.1.1.1"><times id="S2.F2.10.m3.1.1.1.2.cmml" xref="S2.F2.10.m3.1.1.1.2"></times><apply id="S2.F2.10.m3.1.1.1.1.2.cmml" xref="S2.F2.10.m3.1.1.1.1.1"><abs id="S2.F2.10.m3.1.1.1.1.2.1.cmml" xref="S2.F2.10.m3.1.1.1.1.1.2"></abs><apply id="S2.F2.10.m3.1.1.1.1.1.1.cmml" xref="S2.F2.10.m3.1.1.1.1.1.1"><minus id="S2.F2.10.m3.1.1.1.1.1.1.1.cmml" xref="S2.F2.10.m3.1.1.1.1.1.1.1"></minus><ci id="S2.F2.10.m3.1.1.1.1.1.1.2.cmml" xref="S2.F2.10.m3.1.1.1.1.1.1.2">𝑚</ci><ci id="S2.F2.10.m3.1.1.1.1.1.1.3.cmml" xref="S2.F2.10.m3.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S2.F2.10.m3.1.1.1.3.cmml" xref="S2.F2.10.m3.1.1.1.3"><csymbol cd="ambiguous" id="S2.F2.10.m3.1.1.1.3.1.cmml" xref="S2.F2.10.m3.1.1.1.3">subscript</csymbol><ci id="S2.F2.10.m3.1.1.1.3.2.cmml" xref="S2.F2.10.m3.1.1.1.3.2">𝜃</ci><ci id="S2.F2.10.m3.1.1.1.3.3.cmml" xref="S2.F2.10.m3.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.F2.10.m3.1.1.3.cmml" xref="S2.F2.10.m3.1.1.3"><csymbol cd="ambiguous" id="S2.F2.10.m3.1.1.3.1.cmml" xref="S2.F2.10.m3.1.1.3">subscript</csymbol><ci id="S2.F2.10.m3.1.1.3.2.cmml" xref="S2.F2.10.m3.1.1.3.2">𝜃</ci><cn type="integer" id="S2.F2.10.m3.1.1.3.3.cmml" xref="S2.F2.10.m3.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.m3.1d">|m-n|\theta_{j}&lt;\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.10.m3.1e">| italic_m - italic_n | italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT &lt; italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the relative angle between <math id="S2.F2.11.m4.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.F2.11.m4.1b"><msub id="S2.F2.11.m4.1.1" xref="S2.F2.11.m4.1.1.cmml"><mi id="S2.F2.11.m4.1.1.2" xref="S2.F2.11.m4.1.1.2.cmml">𝐪</mi><mi id="S2.F2.11.m4.1.1.3" xref="S2.F2.11.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.11.m4.1c"><apply id="S2.F2.11.m4.1.1.cmml" xref="S2.F2.11.m4.1.1"><csymbol cd="ambiguous" id="S2.F2.11.m4.1.1.1.cmml" xref="S2.F2.11.m4.1.1">subscript</csymbol><ci id="S2.F2.11.m4.1.1.2.cmml" xref="S2.F2.11.m4.1.1.2">𝐪</ci><ci id="S2.F2.11.m4.1.1.3.cmml" xref="S2.F2.11.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.m4.1d">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.11.m4.1e">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.F2.12.m5.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.F2.12.m5.1b"><msub id="S2.F2.12.m5.1.1" xref="S2.F2.12.m5.1.1.cmml"><mi id="S2.F2.12.m5.1.1.2" xref="S2.F2.12.m5.1.1.2.cmml">𝐤</mi><mi id="S2.F2.12.m5.1.1.3" xref="S2.F2.12.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.12.m5.1c"><apply id="S2.F2.12.m5.1.1.cmml" xref="S2.F2.12.m5.1.1"><csymbol cd="ambiguous" id="S2.F2.12.m5.1.1.1.cmml" xref="S2.F2.12.m5.1.1">subscript</csymbol><ci id="S2.F2.12.m5.1.1.2.cmml" xref="S2.F2.12.m5.1.1.2">𝐤</ci><ci id="S2.F2.12.m5.1.1.3.cmml" xref="S2.F2.12.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.12.m5.1d">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.12.m5.1e">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> will decrease with <math id="S2.F2.13.m6.1" class="ltx_Math" alttext="|m-n|" display="inline"><semantics id="S2.F2.13.m6.1b"><mrow id="S2.F2.13.m6.1.1.1" xref="S2.F2.13.m6.1.1.2.cmml"><mo stretchy="false" id="S2.F2.13.m6.1.1.1.2" xref="S2.F2.13.m6.1.1.2.1.cmml">|</mo><mrow id="S2.F2.13.m6.1.1.1.1" xref="S2.F2.13.m6.1.1.1.1.cmml"><mi id="S2.F2.13.m6.1.1.1.1.2" xref="S2.F2.13.m6.1.1.1.1.2.cmml">m</mi><mo id="S2.F2.13.m6.1.1.1.1.1" xref="S2.F2.13.m6.1.1.1.1.1.cmml">−</mo><mi id="S2.F2.13.m6.1.1.1.1.3" xref="S2.F2.13.m6.1.1.1.1.3.cmml">n</mi></mrow><mo stretchy="false" id="S2.F2.13.m6.1.1.1.3" xref="S2.F2.13.m6.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.13.m6.1c"><apply id="S2.F2.13.m6.1.1.2.cmml" xref="S2.F2.13.m6.1.1.1"><abs id="S2.F2.13.m6.1.1.2.1.cmml" xref="S2.F2.13.m6.1.1.1.2"></abs><apply id="S2.F2.13.m6.1.1.1.1.cmml" xref="S2.F2.13.m6.1.1.1.1"><minus id="S2.F2.13.m6.1.1.1.1.1.cmml" xref="S2.F2.13.m6.1.1.1.1.1"></minus><ci id="S2.F2.13.m6.1.1.1.1.2.cmml" xref="S2.F2.13.m6.1.1.1.1.2">𝑚</ci><ci id="S2.F2.13.m6.1.1.1.1.3.cmml" xref="S2.F2.13.m6.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.13.m6.1d">|m-n|</annotation><annotation encoding="application/x-llamapun" id="S2.F2.13.m6.1e">| italic_m - italic_n |</annotation></semantics></math>, which means closest tokens may get smaller attention scores. (We use ’may’ here since the attention score is the sum of <math id="S2.F2.14.m7.1" class="ltx_Math" alttext="d/2" display="inline"><semantics id="S2.F2.14.m7.1b"><mrow id="S2.F2.14.m7.1.1" xref="S2.F2.14.m7.1.1.cmml"><mi id="S2.F2.14.m7.1.1.2" xref="S2.F2.14.m7.1.1.2.cmml">d</mi><mo id="S2.F2.14.m7.1.1.1" xref="S2.F2.14.m7.1.1.1.cmml">/</mo><mn id="S2.F2.14.m7.1.1.3" xref="S2.F2.14.m7.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.14.m7.1c"><apply id="S2.F2.14.m7.1.1.cmml" xref="S2.F2.14.m7.1.1"><divide id="S2.F2.14.m7.1.1.1.cmml" xref="S2.F2.14.m7.1.1.1"></divide><ci id="S2.F2.14.m7.1.1.2.cmml" xref="S2.F2.14.m7.1.1.2">𝑑</ci><cn type="integer" id="S2.F2.14.m7.1.1.3.cmml" xref="S2.F2.14.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.14.m7.1d">d/2</annotation><annotation encoding="application/x-llamapun" id="S2.F2.14.m7.1e">italic_d / 2</annotation></semantics></math> inner-products, maybe one of them is insignificant. However, experiments confirmed this significance.). <span id="S2.F2.18.2" class="ltx_text ltx_font_bold">Right:</span> no anomalous behavior.</figcaption>
</figure>
<div id="S2.SS3.p7" class="ltx_para ltx_noindent">
<p id="S2.SS3.p7.9" class="ltx_p">For causal models, it also doomed although <math id="S2.SS3.p7.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.p7.1.m1.1a"><mi id="S2.SS3.p7.1.m1.1.1" xref="S2.SS3.p7.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.1.m1.1b"><ci id="S2.SS3.p7.1.m1.1.1.cmml" xref="S2.SS3.p7.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.1.m1.1d">italic_m</annotation></semantics></math> is always larger than <math id="S2.SS3.p7.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS3.p7.2.m2.1a"><mi id="S2.SS3.p7.2.m2.1.1" xref="S2.SS3.p7.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.2.m2.1b"><ci id="S2.SS3.p7.2.m2.1.1.cmml" xref="S2.SS3.p7.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.2.m2.1d">italic_n</annotation></semantics></math>. As shown in Figure <a href="#S2.F3" title="Figure 3 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, just for some <math id="S2.SS3.p7.3.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.p7.3.m3.1a"><mi id="S2.SS3.p7.3.m3.1.1" xref="S2.SS3.p7.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.3.m3.1b"><ci id="S2.SS3.p7.3.m3.1.1.cmml" xref="S2.SS3.p7.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.3.m3.1d">italic_j</annotation></semantics></math> when there is an angle <math id="S2.SS3.p7.4.m4.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S2.SS3.p7.4.m4.1a"><msub id="S2.SS3.p7.4.m4.1.1" xref="S2.SS3.p7.4.m4.1.1.cmml"><mi id="S2.SS3.p7.4.m4.1.1.2" xref="S2.SS3.p7.4.m4.1.1.2.cmml">θ</mi><mn id="S2.SS3.p7.4.m4.1.1.3" xref="S2.SS3.p7.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.4.m4.1b"><apply id="S2.SS3.p7.4.m4.1.1.cmml" xref="S2.SS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.4.m4.1.1.1.cmml" xref="S2.SS3.p7.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p7.4.m4.1.1.2.cmml" xref="S2.SS3.p7.4.m4.1.1.2">𝜃</ci><cn type="integer" id="S2.SS3.p7.4.m4.1.1.3.cmml" xref="S2.SS3.p7.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.4.m4.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.4.m4.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> which is smaller than <math id="S2.SS3.p7.5.m5.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.SS3.p7.5.m5.1a"><mi id="S2.SS3.p7.5.m5.1.1" xref="S2.SS3.p7.5.m5.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.5.m5.1b"><ci id="S2.SS3.p7.5.m5.1.1.cmml" xref="S2.SS3.p7.5.m5.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.5.m5.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.5.m5.1d">italic_π</annotation></semantics></math> to rotate counterclockwise from <math id="S2.SS3.p7.6.m6.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.SS3.p7.6.m6.1a"><msub id="S2.SS3.p7.6.m6.1.1" xref="S2.SS3.p7.6.m6.1.1.cmml"><mi id="S2.SS3.p7.6.m6.1.1.2" xref="S2.SS3.p7.6.m6.1.1.2.cmml">𝐪</mi><mi id="S2.SS3.p7.6.m6.1.1.3" xref="S2.SS3.p7.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.6.m6.1b"><apply id="S2.SS3.p7.6.m6.1.1.cmml" xref="S2.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.6.m6.1.1.1.cmml" xref="S2.SS3.p7.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p7.6.m6.1.1.2.cmml" xref="S2.SS3.p7.6.m6.1.1.2">𝐪</ci><ci id="S2.SS3.p7.6.m6.1.1.3.cmml" xref="S2.SS3.p7.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.6.m6.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.6.m6.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="S2.SS3.p7.7.m7.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.SS3.p7.7.m7.1a"><msub id="S2.SS3.p7.7.m7.1.1" xref="S2.SS3.p7.7.m7.1.1.cmml"><mi id="S2.SS3.p7.7.m7.1.1.2" xref="S2.SS3.p7.7.m7.1.1.2.cmml">𝐤</mi><mi id="S2.SS3.p7.7.m7.1.1.3" xref="S2.SS3.p7.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.7.m7.1b"><apply id="S2.SS3.p7.7.m7.1.1.cmml" xref="S2.SS3.p7.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.7.m7.1.1.1.cmml" xref="S2.SS3.p7.7.m7.1.1">subscript</csymbol><ci id="S2.SS3.p7.7.m7.1.1.2.cmml" xref="S2.SS3.p7.7.m7.1.1.2">𝐤</ci><ci id="S2.SS3.p7.7.m7.1.1.3.cmml" xref="S2.SS3.p7.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.7.m7.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.7.m7.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, instead of <math id="S2.SS3.p7.8.m8.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.SS3.p7.8.m8.1a"><msub id="S2.SS3.p7.8.m8.1.1" xref="S2.SS3.p7.8.m8.1.1.cmml"><mi id="S2.SS3.p7.8.m8.1.1.2" xref="S2.SS3.p7.8.m8.1.1.2.cmml">𝐤</mi><mi id="S2.SS3.p7.8.m8.1.1.3" xref="S2.SS3.p7.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.8.m8.1b"><apply id="S2.SS3.p7.8.m8.1.1.cmml" xref="S2.SS3.p7.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.8.m8.1.1.1.cmml" xref="S2.SS3.p7.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.p7.8.m8.1.1.2.cmml" xref="S2.SS3.p7.8.m8.1.1.2">𝐤</ci><ci id="S2.SS3.p7.8.m8.1.1.3.cmml" xref="S2.SS3.p7.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.8.m8.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.8.m8.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="S2.SS3.p7.9.m9.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.SS3.p7.9.m9.1a"><msub id="S2.SS3.p7.9.m9.1.1" xref="S2.SS3.p7.9.m9.1.1.cmml"><mi id="S2.SS3.p7.9.m9.1.1.2" xref="S2.SS3.p7.9.m9.1.1.2.cmml">𝐪</mi><mi id="S2.SS3.p7.9.m9.1.1.3" xref="S2.SS3.p7.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.9.m9.1b"><apply id="S2.SS3.p7.9.m9.1.1.cmml" xref="S2.SS3.p7.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.9.m9.1.1.1.cmml" xref="S2.SS3.p7.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.p7.9.m9.1.1.2.cmml" xref="S2.SS3.p7.9.m9.1.1.2">𝐪</ci><ci id="S2.SS3.p7.9.m9.1.1.3.cmml" xref="S2.SS3.p7.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.9.m9.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.9.m9.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="2.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="224" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Broken of order in causal models. Definition of notations are the same as Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, notice that <math id="S2.F3.4.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S2.F3.4.m1.1b"><msub id="S2.F3.4.m1.1.1" xref="S2.F3.4.m1.1.1.cmml"><mi id="S2.F3.4.m1.1.1.2" xref="S2.F3.4.m1.1.1.2.cmml">θ</mi><mn id="S2.F3.4.m1.1.1.3" xref="S2.F3.4.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F3.4.m1.1c"><apply id="S2.F3.4.m1.1.1.cmml" xref="S2.F3.4.m1.1.1"><csymbol cd="ambiguous" id="S2.F3.4.m1.1.1.1.cmml" xref="S2.F3.4.m1.1.1">subscript</csymbol><ci id="S2.F3.4.m1.1.1.2.cmml" xref="S2.F3.4.m1.1.1.2">𝜃</ci><cn type="integer" id="S2.F3.4.m1.1.1.3.cmml" xref="S2.F3.4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.4.m1.1d">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.4.m1.1e">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> here is a little different from Figure <a href="#S2.F2" title="Figure 2 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, since it’s counterclockwise from <math id="S2.F3.5.m2.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.F3.5.m2.1b"><msub id="S2.F3.5.m2.1.1" xref="S2.F3.5.m2.1.1.cmml"><mi id="S2.F3.5.m2.1.1.2" xref="S2.F3.5.m2.1.1.2.cmml">𝐪</mi><mi id="S2.F3.5.m2.1.1.3" xref="S2.F3.5.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F3.5.m2.1c"><apply id="S2.F3.5.m2.1.1.cmml" xref="S2.F3.5.m2.1.1"><csymbol cd="ambiguous" id="S2.F3.5.m2.1.1.1.cmml" xref="S2.F3.5.m2.1.1">subscript</csymbol><ci id="S2.F3.5.m2.1.1.2.cmml" xref="S2.F3.5.m2.1.1.2">𝐪</ci><ci id="S2.F3.5.m2.1.1.3.cmml" xref="S2.F3.5.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.5.m2.1d">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.5.m2.1e">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to <math id="S2.F3.6.m3.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.F3.6.m3.1b"><msub id="S2.F3.6.m3.1.1" xref="S2.F3.6.m3.1.1.cmml"><mi id="S2.F3.6.m3.1.1.2" xref="S2.F3.6.m3.1.1.2.cmml">𝐤</mi><mi id="S2.F3.6.m3.1.1.3" xref="S2.F3.6.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F3.6.m3.1c"><apply id="S2.F3.6.m3.1.1.cmml" xref="S2.F3.6.m3.1.1"><csymbol cd="ambiguous" id="S2.F3.6.m3.1.1.1.cmml" xref="S2.F3.6.m3.1.1">subscript</csymbol><ci id="S2.F3.6.m3.1.1.2.cmml" xref="S2.F3.6.m3.1.1.2">𝐤</ci><ci id="S2.F3.6.m3.1.1.3.cmml" xref="S2.F3.6.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.6.m3.1d">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.6.m3.1e">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> here.</figcaption>
</figure>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Collinear Constrained Attention(CoCA)</h3>

<div id="S2.SS4.p1" class="ltx_para ltx_noindent">
<p id="S2.SS4.p1.2" class="ltx_p">Follow the analysis in Section <a href="#S2.SS3" title="2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>, we can naturally deduce the following method: applying a collinear constraint on any pair of <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><msub id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.1.1.2" xref="S2.SS4.p1.1.m1.1.1.2.cmml">𝐪</mi><mi id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2">𝐪</ci><ci id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS4.p1.2.m2.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="S2.SS4.p1.2.m2.1a"><msub id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">𝐤</mi><mi id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝐤</ci><ci id="S2.SS4.p1.2.m2.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="S2.SS4.p2" class="ltx_para ltx_noindent">
<p id="S2.SS4.p2.4" class="ltx_p">Formally, let <math id="S2.SS4.p2.1.m1.1" class="ltx_Math" alttext="{\mathbb{S}}_{N}=\{w_{i}\}_{i=1}^{N}" display="inline"><semantics id="S2.SS4.p2.1.m1.1a"><mrow id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><msub id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml"><mi id="S2.SS4.p2.1.m1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.3.2.cmml">𝕊</mi><mi id="S2.SS4.p2.1.m1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.3.3.cmml">N</mi></msub><mo id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">=</mo><msubsup id="S2.SS4.p2.1.m1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.cmml"><mrow id="S2.SS4.p2.1.m1.1.1.1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS4.p2.1.m1.1.1.1.1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS4.p2.1.m1.1.1.1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS4.p2.1.m1.1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.1.3.cmml"><mi id="S2.SS4.p2.1.m1.1.1.1.1.3.2" xref="S2.SS4.p2.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS4.p2.1.m1.1.1.1.1.3.1" xref="S2.SS4.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS4.p2.1.m1.1.1.1.1.3.3" xref="S2.SS4.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS4.p2.1.m1.1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><eq id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2"></eq><apply id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.3.2">𝕊</ci><ci id="S2.SS4.p2.1.m1.1.1.3.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3.3">𝑁</ci></apply><apply id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1">superscript</csymbol><apply id="S2.SS4.p2.1.m1.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1">subscript</csymbol><set id="S2.SS4.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1"><apply id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS4.p2.1.m1.1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3"><eq id="S2.SS4.p2.1.m1.1.1.1.1.3.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S2.SS4.p2.1.m1.1.1.1.1.3.2.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS4.p2.1.m1.1.1.1.1.3.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS4.p2.1.m1.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">{\mathbb{S}}_{N}=\{w_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">blackboard_S start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = { italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> be a sequence of <math id="S2.SS4.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS4.p2.2.m2.1a"><mi id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><ci id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">italic_N</annotation></semantics></math> input tokens. The corresponding word embedding of <math id="S2.SS4.p2.3.m3.1" class="ltx_Math" alttext="{\mathbb{S}}_{N}" display="inline"><semantics id="S2.SS4.p2.3.m3.1a"><msub id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml"><mi id="S2.SS4.p2.3.m3.1.1.2" xref="S2.SS4.p2.3.m3.1.1.2.cmml">𝕊</mi><mi id="S2.SS4.p2.3.m3.1.1.3" xref="S2.SS4.p2.3.m3.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><apply id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.3.m3.1.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.p2.3.m3.1.1.2.cmml" xref="S2.SS4.p2.3.m3.1.1.2">𝕊</ci><ci id="S2.SS4.p2.3.m3.1.1.3.cmml" xref="S2.SS4.p2.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">{\mathbb{S}}_{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.3.m3.1d">blackboard_S start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math> is denoted as <math id="S2.SS4.p2.4.m4.1" class="ltx_Math" alttext="\mathbb{E}_{N}=\{{\mathbf{x}}_{i}\}_{i=1}^{N}" display="inline"><semantics id="S2.SS4.p2.4.m4.1a"><mrow id="S2.SS4.p2.4.m4.1.1" xref="S2.SS4.p2.4.m4.1.1.cmml"><msub id="S2.SS4.p2.4.m4.1.1.3" xref="S2.SS4.p2.4.m4.1.1.3.cmml"><mi id="S2.SS4.p2.4.m4.1.1.3.2" xref="S2.SS4.p2.4.m4.1.1.3.2.cmml">𝔼</mi><mi id="S2.SS4.p2.4.m4.1.1.3.3" xref="S2.SS4.p2.4.m4.1.1.3.3.cmml">N</mi></msub><mo id="S2.SS4.p2.4.m4.1.1.2" xref="S2.SS4.p2.4.m4.1.1.2.cmml">=</mo><msubsup id="S2.SS4.p2.4.m4.1.1.1" xref="S2.SS4.p2.4.m4.1.1.1.cmml"><mrow id="S2.SS4.p2.4.m4.1.1.1.1.1.1" xref="S2.SS4.p2.4.m4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS4.p2.4.m4.1.1.1.1.1.1.2" xref="S2.SS4.p2.4.m4.1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.2" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.3" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS4.p2.4.m4.1.1.1.1.1.1.3" xref="S2.SS4.p2.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS4.p2.4.m4.1.1.1.1.3" xref="S2.SS4.p2.4.m4.1.1.1.1.3.cmml"><mi id="S2.SS4.p2.4.m4.1.1.1.1.3.2" xref="S2.SS4.p2.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS4.p2.4.m4.1.1.1.1.3.1" xref="S2.SS4.p2.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS4.p2.4.m4.1.1.1.1.3.3" xref="S2.SS4.p2.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS4.p2.4.m4.1.1.1.3" xref="S2.SS4.p2.4.m4.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m4.1b"><apply id="S2.SS4.p2.4.m4.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1"><eq id="S2.SS4.p2.4.m4.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.2"></eq><apply id="S2.SS4.p2.4.m4.1.1.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.3">subscript</csymbol><ci id="S2.SS4.p2.4.m4.1.1.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.3.2">𝔼</ci><ci id="S2.SS4.p2.4.m4.1.1.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.3.3">𝑁</ci></apply><apply id="S2.SS4.p2.4.m4.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1">superscript</csymbol><apply id="S2.SS4.p2.4.m4.1.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1">subscript</csymbol><set id="S2.SS4.p2.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1"><apply id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS4.p2.4.m4.1.1.1.1.3.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.3"><eq id="S2.SS4.p2.4.m4.1.1.1.1.3.1.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.3.1"></eq><ci id="S2.SS4.p2.4.m4.1.1.1.1.3.2.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS4.p2.4.m4.1.1.1.1.3.3.cmml" xref="S2.SS4.p2.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS4.p2.4.m4.1.1.1.3.cmml" xref="S2.SS4.p2.4.m4.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m4.1c">\mathbb{E}_{N}=\{{\mathbf{x}}_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.4.m4.1d">blackboard_E start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = { bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, we first get the queries as same as before:</p>
<table id="S2.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle{\mathbf{q}}_{m}={\bm{W}}_{q}{\mathbf{x}}_{m},\forall m\in[1,N]" display="inline"><semantics id="S2.E4X.2.1.1.m1.4a"><mrow id="S2.E4X.2.1.1.m1.4.4.2" xref="S2.E4X.2.1.1.m1.4.4.3.cmml"><mrow id="S2.E4X.2.1.1.m1.3.3.1.1" xref="S2.E4X.2.1.1.m1.3.3.1.1.cmml"><msub id="S2.E4X.2.1.1.m1.3.3.1.1.2" xref="S2.E4X.2.1.1.m1.3.3.1.1.2.cmml"><mi id="S2.E4X.2.1.1.m1.3.3.1.1.2.2" xref="S2.E4X.2.1.1.m1.3.3.1.1.2.2.cmml">𝐪</mi><mi id="S2.E4X.2.1.1.m1.3.3.1.1.2.3" xref="S2.E4X.2.1.1.m1.3.3.1.1.2.3.cmml">m</mi></msub><mo id="S2.E4X.2.1.1.m1.3.3.1.1.1" xref="S2.E4X.2.1.1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E4X.2.1.1.m1.3.3.1.1.3" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.cmml"><msub id="S2.E4X.2.1.1.m1.3.3.1.1.3.2" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2.cmml"><mi id="S2.E4X.2.1.1.m1.3.3.1.1.3.2.2" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.E4X.2.1.1.m1.3.3.1.1.3.2.3" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2.3.cmml">q</mi></msub><mo id="S2.E4X.2.1.1.m1.3.3.1.1.3.1" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.1.cmml">⁢</mo><msub id="S2.E4X.2.1.1.m1.3.3.1.1.3.3" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3.cmml"><mi id="S2.E4X.2.1.1.m1.3.3.1.1.3.3.2" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3.2.cmml">𝐱</mi><mi id="S2.E4X.2.1.1.m1.3.3.1.1.3.3.3" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3.3.cmml">m</mi></msub></mrow></mrow><mo id="S2.E4X.2.1.1.m1.4.4.2.3" xref="S2.E4X.2.1.1.m1.4.4.3a.cmml">,</mo><mrow id="S2.E4X.2.1.1.m1.4.4.2.2" xref="S2.E4X.2.1.1.m1.4.4.2.2.cmml"><mrow id="S2.E4X.2.1.1.m1.4.4.2.2.2" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.cmml"><mo rspace="0.167em" id="S2.E4X.2.1.1.m1.4.4.2.2.2.1" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.1.cmml">∀</mo><mi id="S2.E4X.2.1.1.m1.4.4.2.2.2.2" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.2.cmml">m</mi></mrow><mo id="S2.E4X.2.1.1.m1.4.4.2.2.1" xref="S2.E4X.2.1.1.m1.4.4.2.2.1.cmml">∈</mo><mrow id="S2.E4X.2.1.1.m1.4.4.2.2.3.2" xref="S2.E4X.2.1.1.m1.4.4.2.2.3.1.cmml"><mo stretchy="false" id="S2.E4X.2.1.1.m1.4.4.2.2.3.2.1" xref="S2.E4X.2.1.1.m1.4.4.2.2.3.1.cmml">[</mo><mn id="S2.E4X.2.1.1.m1.1.1" xref="S2.E4X.2.1.1.m1.1.1.cmml">1</mn><mo id="S2.E4X.2.1.1.m1.4.4.2.2.3.2.2" xref="S2.E4X.2.1.1.m1.4.4.2.2.3.1.cmml">,</mo><mi id="S2.E4X.2.1.1.m1.2.2" xref="S2.E4X.2.1.1.m1.2.2.cmml">N</mi><mo stretchy="false" id="S2.E4X.2.1.1.m1.4.4.2.2.3.2.3" xref="S2.E4X.2.1.1.m1.4.4.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4X.2.1.1.m1.4b"><apply id="S2.E4X.2.1.1.m1.4.4.3.cmml" xref="S2.E4X.2.1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.4.4.3a.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S2.E4X.2.1.1.m1.3.3.1.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1"><eq id="S2.E4X.2.1.1.m1.3.3.1.1.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.1"></eq><apply id="S2.E4X.2.1.1.m1.3.3.1.1.2.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E4X.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.2.2">𝐪</ci><ci id="S2.E4X.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.2.3">𝑚</ci></apply><apply id="S2.E4X.2.1.1.m1.3.3.1.1.3.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3"><times id="S2.E4X.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.1"></times><apply id="S2.E4X.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S2.E4X.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2.2">𝑾</ci><ci id="S2.E4X.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.2.3">𝑞</ci></apply><apply id="S2.E4X.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4X.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S2.E4X.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3.2">𝐱</ci><ci id="S2.E4X.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S2.E4X.2.1.1.m1.3.3.1.1.3.3.3">𝑚</ci></apply></apply></apply><apply id="S2.E4X.2.1.1.m1.4.4.2.2.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2"><in id="S2.E4X.2.1.1.m1.4.4.2.2.1.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.1"></in><apply id="S2.E4X.2.1.1.m1.4.4.2.2.2.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.2"><csymbol cd="latexml" id="S2.E4X.2.1.1.m1.4.4.2.2.2.1.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.1">for-all</csymbol><ci id="S2.E4X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.2.2">𝑚</ci></apply><interval closure="closed" id="S2.E4X.2.1.1.m1.4.4.2.2.3.1.cmml" xref="S2.E4X.2.1.1.m1.4.4.2.2.3.2"><cn type="integer" id="S2.E4X.2.1.1.m1.1.1.cmml" xref="S2.E4X.2.1.1.m1.1.1">1</cn><ci id="S2.E4X.2.1.1.m1.2.2.cmml" xref="S2.E4X.2.1.1.m1.2.2">𝑁</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4X.2.1.1.m1.4c">\displaystyle{\mathbf{q}}_{m}={\bm{W}}_{q}{\mathbf{x}}_{m},\forall m\in[1,N]</annotation><annotation encoding="application/x-llamapun" id="S2.E4X.2.1.1.m1.4d">bold_q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , ∀ italic_m ∈ [ 1 , italic_N ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p2.8" class="ltx_p">Notice that the subscript <math id="S2.SS4.p2.5.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS4.p2.5.m1.1a"><mi id="S2.SS4.p2.5.m1.1.1" xref="S2.SS4.p2.5.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.5.m1.1b"><ci id="S2.SS4.p2.5.m1.1.1.cmml" xref="S2.SS4.p2.5.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.5.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.5.m1.1d">italic_m</annotation></semantics></math> here is quite different with <math id="S2.SS4.p2.6.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS4.p2.6.m2.1a"><mi id="S2.SS4.p2.6.m2.1.1" xref="S2.SS4.p2.6.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.6.m2.1b"><ci id="S2.SS4.p2.6.m2.1.1.cmml" xref="S2.SS4.p2.6.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.6.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.6.m2.1d">italic_j</annotation></semantics></math> we used in last section, while <math id="S2.SS4.p2.7.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS4.p2.7.m3.1a"><mi id="S2.SS4.p2.7.m3.1.1" xref="S2.SS4.p2.7.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.7.m3.1b"><ci id="S2.SS4.p2.7.m3.1.1.cmml" xref="S2.SS4.p2.7.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.7.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.7.m3.1d">italic_m</annotation></semantics></math> here represents the dimension of sequence length and <math id="S2.SS4.p2.8.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS4.p2.8.m4.1a"><mi id="S2.SS4.p2.8.m4.1.1" xref="S2.SS4.p2.8.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.8.m4.1b"><ci id="S2.SS4.p2.8.m4.1.1.cmml" xref="S2.SS4.p2.8.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.8.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.8.m4.1d">italic_j</annotation></semantics></math> represents the dimension of hidden size. We abbreviate it here by omitting the dimension of hidden size.</p>
</div>
<div id="S2.SS4.p3" class="ltx_para ltx_noindent">
<p id="S2.SS4.p3.2" class="ltx_p">Next, we get the keys in a different way since we have to apply the collinear constraint on it, we get the constraint coefficient first:</p>
<table id="S2.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle{\mathbf{t}}_{n}={\bm{W}}_{t}{\mathbf{x}}_{n},\forall n\in[1,N]" display="inline"><semantics id="S2.E5X.2.1.1.m1.4a"><mrow id="S2.E5X.2.1.1.m1.4.4.2" xref="S2.E5X.2.1.1.m1.4.4.3.cmml"><mrow id="S2.E5X.2.1.1.m1.3.3.1.1" xref="S2.E5X.2.1.1.m1.3.3.1.1.cmml"><msub id="S2.E5X.2.1.1.m1.3.3.1.1.2" xref="S2.E5X.2.1.1.m1.3.3.1.1.2.cmml"><mi id="S2.E5X.2.1.1.m1.3.3.1.1.2.2" xref="S2.E5X.2.1.1.m1.3.3.1.1.2.2.cmml">𝐭</mi><mi id="S2.E5X.2.1.1.m1.3.3.1.1.2.3" xref="S2.E5X.2.1.1.m1.3.3.1.1.2.3.cmml">n</mi></msub><mo id="S2.E5X.2.1.1.m1.3.3.1.1.1" xref="S2.E5X.2.1.1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E5X.2.1.1.m1.3.3.1.1.3" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.cmml"><msub id="S2.E5X.2.1.1.m1.3.3.1.1.3.2" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2.cmml"><mi id="S2.E5X.2.1.1.m1.3.3.1.1.3.2.2" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.E5X.2.1.1.m1.3.3.1.1.3.2.3" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2.3.cmml">t</mi></msub><mo id="S2.E5X.2.1.1.m1.3.3.1.1.3.1" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.1.cmml">⁢</mo><msub id="S2.E5X.2.1.1.m1.3.3.1.1.3.3" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3.cmml"><mi id="S2.E5X.2.1.1.m1.3.3.1.1.3.3.2" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3.2.cmml">𝐱</mi><mi id="S2.E5X.2.1.1.m1.3.3.1.1.3.3.3" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><mo id="S2.E5X.2.1.1.m1.4.4.2.3" xref="S2.E5X.2.1.1.m1.4.4.3a.cmml">,</mo><mrow id="S2.E5X.2.1.1.m1.4.4.2.2" xref="S2.E5X.2.1.1.m1.4.4.2.2.cmml"><mrow id="S2.E5X.2.1.1.m1.4.4.2.2.2" xref="S2.E5X.2.1.1.m1.4.4.2.2.2.cmml"><mo rspace="0.167em" id="S2.E5X.2.1.1.m1.4.4.2.2.2.1" xref="S2.E5X.2.1.1.m1.4.4.2.2.2.1.cmml">∀</mo><mi id="S2.E5X.2.1.1.m1.4.4.2.2.2.2" xref="S2.E5X.2.1.1.m1.4.4.2.2.2.2.cmml">n</mi></mrow><mo id="S2.E5X.2.1.1.m1.4.4.2.2.1" xref="S2.E5X.2.1.1.m1.4.4.2.2.1.cmml">∈</mo><mrow id="S2.E5X.2.1.1.m1.4.4.2.2.3.2" xref="S2.E5X.2.1.1.m1.4.4.2.2.3.1.cmml"><mo stretchy="false" id="S2.E5X.2.1.1.m1.4.4.2.2.3.2.1" xref="S2.E5X.2.1.1.m1.4.4.2.2.3.1.cmml">[</mo><mn id="S2.E5X.2.1.1.m1.1.1" xref="S2.E5X.2.1.1.m1.1.1.cmml">1</mn><mo id="S2.E5X.2.1.1.m1.4.4.2.2.3.2.2" xref="S2.E5X.2.1.1.m1.4.4.2.2.3.1.cmml">,</mo><mi id="S2.E5X.2.1.1.m1.2.2" xref="S2.E5X.2.1.1.m1.2.2.cmml">N</mi><mo stretchy="false" id="S2.E5X.2.1.1.m1.4.4.2.2.3.2.3" xref="S2.E5X.2.1.1.m1.4.4.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.2.1.1.m1.4b"><apply id="S2.E5X.2.1.1.m1.4.4.3.cmml" xref="S2.E5X.2.1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.4.4.3a.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S2.E5X.2.1.1.m1.3.3.1.1.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1"><eq id="S2.E5X.2.1.1.m1.3.3.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.1"></eq><apply id="S2.E5X.2.1.1.m1.3.3.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.2.2">𝐭</ci><ci id="S2.E5X.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.2.3">𝑛</ci></apply><apply id="S2.E5X.2.1.1.m1.3.3.1.1.3.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3"><times id="S2.E5X.2.1.1.m1.3.3.1.1.3.1.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.1"></times><apply id="S2.E5X.2.1.1.m1.3.3.1.1.3.2.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2.2">𝑾</ci><ci id="S2.E5X.2.1.1.m1.3.3.1.1.3.2.3.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E5X.2.1.1.m1.3.3.1.1.3.3.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.3.3.1.1.3.3.1.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.3.3.1.1.3.3.2.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3.2">𝐱</ci><ci id="S2.E5X.2.1.1.m1.3.3.1.1.3.3.3.cmml" xref="S2.E5X.2.1.1.m1.3.3.1.1.3.3.3">𝑛</ci></apply></apply></apply><apply id="S2.E5X.2.1.1.m1.4.4.2.2.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.2"><in id="S2.E5X.2.1.1.m1.4.4.2.2.1.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.2.1"></in><apply id="S2.E5X.2.1.1.m1.4.4.2.2.2.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.2.2"><csymbol cd="latexml" id="S2.E5X.2.1.1.m1.4.4.2.2.2.1.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.2.2.1">for-all</csymbol><ci id="S2.E5X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.2.2.2">𝑛</ci></apply><interval closure="closed" id="S2.E5X.2.1.1.m1.4.4.2.2.3.1.cmml" xref="S2.E5X.2.1.1.m1.4.4.2.2.3.2"><cn type="integer" id="S2.E5X.2.1.1.m1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1">1</cn><ci id="S2.E5X.2.1.1.m1.2.2.cmml" xref="S2.E5X.2.1.1.m1.2.2">𝑁</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.2.1.1.m1.4c">\displaystyle{\mathbf{t}}_{n}={\bm{W}}_{t}{\mathbf{x}}_{n},\forall n\in[1,N]</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.2.1.1.m1.4d">bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = bold_italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , ∀ italic_n ∈ [ 1 , italic_N ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S2.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5Xa.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle({\mathbf{t}}_{n;[0:d/2-1]},{\mathbf{t}}_{n;[d/2-1:d-1]})={\mathbf{t}}_{n}" display="inline"><semantics id="S2.E5Xa.2.1.1.m1.6a"><mrow id="S2.E5Xa.2.1.1.m1.6.6" xref="S2.E5Xa.2.1.1.m1.6.6.cmml"><mrow id="S2.E5Xa.2.1.1.m1.6.6.2.2" xref="S2.E5Xa.2.1.1.m1.6.6.2.3.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.6.6.2.2.3" xref="S2.E5Xa.2.1.1.m1.6.6.2.3.cmml">(</mo><msub id="S2.E5Xa.2.1.1.m1.5.5.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.2.cmml">𝐭</mi><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.cmml">n</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml">;</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml"><mn id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.1.cmml">:</mo><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml"><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2.cmml">d</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.1.cmml">/</mo><mn id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3.cmml">2</mn></mrow><mo id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S2.E5Xa.2.1.1.m1.6.6.2.2.4" xref="S2.E5Xa.2.1.1.m1.6.6.2.3.cmml">,</mo><msub id="S2.E5Xa.2.1.1.m1.6.6.2.2.2" xref="S2.E5Xa.2.1.1.m1.6.6.2.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.6.6.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.6.6.2.2.2.2.cmml">𝐭</mi><mrow id="S2.E5Xa.2.1.1.m1.4.4.2.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.3.3.1.1" xref="S2.E5Xa.2.1.1.m1.3.3.1.1.cmml">n</mi><mo id="S2.E5Xa.2.1.1.m1.4.4.2.2.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.3.cmml">;</mo><mrow id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.2.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.2.1.cmml">[</mo><mrow id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.cmml"><mrow id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.2.cmml">d</mi><mo id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.1" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.1.cmml">/</mo><mn id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.3" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.3.cmml">2</mn></mrow><mo id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.1" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.1.cmml">−</mo><mn id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.3" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.1.cmml">:</mo><mrow id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.2" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.1" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.3" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.3" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.2.1.cmml">]</mo></mrow></mrow></msub><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.6.6.2.2.5" xref="S2.E5Xa.2.1.1.m1.6.6.2.3.cmml">)</mo></mrow><mo id="S2.E5Xa.2.1.1.m1.6.6.3" xref="S2.E5Xa.2.1.1.m1.6.6.3.cmml">=</mo><msub id="S2.E5Xa.2.1.1.m1.6.6.4" xref="S2.E5Xa.2.1.1.m1.6.6.4.cmml"><mi id="S2.E5Xa.2.1.1.m1.6.6.4.2" xref="S2.E5Xa.2.1.1.m1.6.6.4.2.cmml">𝐭</mi><mi id="S2.E5Xa.2.1.1.m1.6.6.4.3" xref="S2.E5Xa.2.1.1.m1.6.6.4.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.2.1.1.m1.6b"><apply id="S2.E5Xa.2.1.1.m1.6.6.cmml" xref="S2.E5Xa.2.1.1.m1.6.6"><eq id="S2.E5Xa.2.1.1.m1.6.6.3.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.3"></eq><interval closure="open" id="S2.E5Xa.2.1.1.m1.6.6.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.2.2"><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.2">𝐭</ci><list id="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2"><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1">𝑛</ci><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1"><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.1">:</ci><cn type="integer" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.2">0</cn><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3"><minus id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.1"></minus><apply id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2"><divide id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.1"></divide><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.2">𝑑</ci><cn type="integer" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list></apply><apply id="S2.E5Xa.2.1.1.m1.6.6.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.6.6.2.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.2.2.2">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.6.6.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.2.2.2.2">𝐭</ci><list id="S2.E5Xa.2.1.1.m1.4.4.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2"><ci id="S2.E5Xa.2.1.1.m1.3.3.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.3.3.1.1">𝑛</ci><apply id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1"><ci id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.1">:</ci><apply id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2"><minus id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.1"></minus><apply id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2"><divide id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.1.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.1"></divide><ci id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.2">𝑑</ci><cn type="integer" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.2.3">2</cn></apply><cn type="integer" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.2.3">1</cn></apply><apply id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3"><minus id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.1"></minus><ci id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.2">𝑑</ci><cn type="integer" id="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.4.4.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list></apply></interval><apply id="S2.E5Xa.2.1.1.m1.6.6.4.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.4"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.6.6.4.1.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.4">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.6.6.4.2.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.4.2">𝐭</ci><ci id="S2.E5Xa.2.1.1.m1.6.6.4.3.cmml" xref="S2.E5Xa.2.1.1.m1.6.6.4.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.2.1.1.m1.6c">\displaystyle({\mathbf{t}}_{n;[0:d/2-1]},{\mathbf{t}}_{n;[d/2-1:d-1]})={\mathbf{t}}_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.2.1.1.m1.6d">( bold_t start_POSTSUBSCRIPT italic_n ; [ 0 : italic_d / 2 - 1 ] end_POSTSUBSCRIPT , bold_t start_POSTSUBSCRIPT italic_n ; [ italic_d / 2 - 1 : italic_d - 1 ] end_POSTSUBSCRIPT ) = bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S2.E5Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5Xb.2.1.1.m1.8" class="ltx_Math" alttext="\displaystyle{\mathbf{t}}_{n}=(\frac{{\mathbf{t}}_{n;[0:d/2-1]}+{\mathbf{t}}_{n;[d/2-1:d-1]}}{2},\frac{{\mathbf{t}}_{n;[0:d/2-1]}+{\mathbf{t}}_{n;[d/2-1:d-1]}}{2})" display="inline"><semantics id="S2.E5Xb.2.1.1.m1.8a"><mrow id="S2.E5Xb.2.1.1.m1.8.9" xref="S2.E5Xb.2.1.1.m1.8.9.cmml"><msub id="S2.E5Xb.2.1.1.m1.8.9.2" xref="S2.E5Xb.2.1.1.m1.8.9.2.cmml"><mi id="S2.E5Xb.2.1.1.m1.8.9.2.2" xref="S2.E5Xb.2.1.1.m1.8.9.2.2.cmml">𝐭</mi><mi id="S2.E5Xb.2.1.1.m1.8.9.2.3" xref="S2.E5Xb.2.1.1.m1.8.9.2.3.cmml">n</mi></msub><mo id="S2.E5Xb.2.1.1.m1.8.9.1" xref="S2.E5Xb.2.1.1.m1.8.9.1.cmml">=</mo><mrow id="S2.E5Xb.2.1.1.m1.8.9.3.2" xref="S2.E5Xb.2.1.1.m1.8.9.3.1.cmml"><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.8.9.3.2.1" xref="S2.E5Xb.2.1.1.m1.8.9.3.1.cmml">(</mo><mstyle displaystyle="true" id="S2.E5Xb.2.1.1.m1.4.4" xref="S2.E5Xb.2.1.1.m1.4.4.cmml"><mfrac id="S2.E5Xb.2.1.1.m1.4.4a" xref="S2.E5Xb.2.1.1.m1.4.4.cmml"><mrow id="S2.E5Xb.2.1.1.m1.4.4.4" xref="S2.E5Xb.2.1.1.m1.4.4.4.cmml"><msub id="S2.E5Xb.2.1.1.m1.4.4.4.6" xref="S2.E5Xb.2.1.1.m1.4.4.4.6.cmml"><mi id="S2.E5Xb.2.1.1.m1.4.4.4.6.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.6.2.cmml">𝐭</mi><mrow id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.3.cmml"><mi id="S2.E5Xb.2.1.1.m1.1.1.1.1.1.1" xref="S2.E5Xb.2.1.1.m1.1.1.1.1.1.1.cmml">n</mi><mo id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.2" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.3.cmml">;</mo><mrow id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.2" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.cmml"><mn id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.2" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.1" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.1.cmml">:</mo><mrow id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mrow id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.cmml"><mi id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.2" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml">d</mi><mo id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.1" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml">/</mo><mn id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.3" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.3.cmml">2</mn></mrow><mo id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.1" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.3" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.3" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S2.E5Xb.2.1.1.m1.4.4.4.5" xref="S2.E5Xb.2.1.1.m1.4.4.4.5.cmml">+</mo><msub id="S2.E5Xb.2.1.1.m1.4.4.4.7" xref="S2.E5Xb.2.1.1.m1.4.4.4.7.cmml"><mi id="S2.E5Xb.2.1.1.m1.4.4.4.7.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.7.2.cmml">𝐭</mi><mrow id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.3.cmml"><mi id="S2.E5Xb.2.1.1.m1.3.3.3.3.1.1" xref="S2.E5Xb.2.1.1.m1.3.3.3.3.1.1.cmml">n</mi><mo id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.3.cmml">;</mo><mrow id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.2.cmml"><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.2.1.cmml">[</mo><mrow id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.cmml"><mrow id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.cmml"><mrow id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.cmml"><mi id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.2.cmml">d</mi><mo id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.1" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.1.cmml">/</mo><mn id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.3" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.3.cmml">2</mn></mrow><mo id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.1" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.1.cmml">−</mo><mn id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.3" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.1" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.1.cmml">:</mo><mrow id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.cmml"><mi id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.2" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.1" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.3" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.3" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.2.1.cmml">]</mo></mrow></mrow></msub></mrow><mn id="S2.E5Xb.2.1.1.m1.4.4.6" xref="S2.E5Xb.2.1.1.m1.4.4.6.cmml">2</mn></mfrac></mstyle><mo id="S2.E5Xb.2.1.1.m1.8.9.3.2.2" xref="S2.E5Xb.2.1.1.m1.8.9.3.1.cmml">,</mo><mstyle displaystyle="true" id="S2.E5Xb.2.1.1.m1.8.8" xref="S2.E5Xb.2.1.1.m1.8.8.cmml"><mfrac id="S2.E5Xb.2.1.1.m1.8.8a" xref="S2.E5Xb.2.1.1.m1.8.8.cmml"><mrow id="S2.E5Xb.2.1.1.m1.8.8.4" xref="S2.E5Xb.2.1.1.m1.8.8.4.cmml"><msub id="S2.E5Xb.2.1.1.m1.8.8.4.6" xref="S2.E5Xb.2.1.1.m1.8.8.4.6.cmml"><mi id="S2.E5Xb.2.1.1.m1.8.8.4.6.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.6.2.cmml">𝐭</mi><mrow id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.3.cmml"><mi id="S2.E5Xb.2.1.1.m1.5.5.1.1.1.1" xref="S2.E5Xb.2.1.1.m1.5.5.1.1.1.1.cmml">n</mi><mo id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.2" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.3.cmml">;</mo><mrow id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.2" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.cmml"><mn id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.2" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.2.cmml">0</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.1" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.1.cmml">:</mo><mrow id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.cmml"><mrow id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.cmml"><mi id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.2" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.2.cmml">d</mi><mo id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.1" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.1.cmml">/</mo><mn id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.3" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.3.cmml">2</mn></mrow><mo id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.1" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.3" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.3" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></msub><mo id="S2.E5Xb.2.1.1.m1.8.8.4.5" xref="S2.E5Xb.2.1.1.m1.8.8.4.5.cmml">+</mo><msub id="S2.E5Xb.2.1.1.m1.8.8.4.7" xref="S2.E5Xb.2.1.1.m1.8.8.4.7.cmml"><mi id="S2.E5Xb.2.1.1.m1.8.8.4.7.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.7.2.cmml">𝐭</mi><mrow id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.3.cmml"><mi id="S2.E5Xb.2.1.1.m1.7.7.3.3.1.1" xref="S2.E5Xb.2.1.1.m1.7.7.3.3.1.1.cmml">n</mi><mo id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.3.cmml">;</mo><mrow id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.2.cmml"><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.2.1.cmml">[</mo><mrow id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.cmml"><mrow id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.cmml"><mrow id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.cmml"><mi id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.2.cmml">d</mi><mo id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.1" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.1.cmml">/</mo><mn id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.3" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.3.cmml">2</mn></mrow><mo id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.1" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.1.cmml">−</mo><mn id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.3" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.1" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.1.cmml">:</mo><mrow id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.cmml"><mi id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.2" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.2.cmml">d</mi><mo id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.1" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.3" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.3.cmml">1</mn></mrow></mrow><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.3" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.2.1.cmml">]</mo></mrow></mrow></msub></mrow><mn id="S2.E5Xb.2.1.1.m1.8.8.6" xref="S2.E5Xb.2.1.1.m1.8.8.6.cmml">2</mn></mfrac></mstyle><mo stretchy="false" id="S2.E5Xb.2.1.1.m1.8.9.3.2.3" xref="S2.E5Xb.2.1.1.m1.8.9.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xb.2.1.1.m1.8b"><apply id="S2.E5Xb.2.1.1.m1.8.9.cmml" xref="S2.E5Xb.2.1.1.m1.8.9"><eq id="S2.E5Xb.2.1.1.m1.8.9.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.9.1"></eq><apply id="S2.E5Xb.2.1.1.m1.8.9.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.9.2"><csymbol cd="ambiguous" id="S2.E5Xb.2.1.1.m1.8.9.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.9.2">subscript</csymbol><ci id="S2.E5Xb.2.1.1.m1.8.9.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.9.2.2">𝐭</ci><ci id="S2.E5Xb.2.1.1.m1.8.9.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.8.9.2.3">𝑛</ci></apply><interval closure="open" id="S2.E5Xb.2.1.1.m1.8.9.3.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.9.3.2"><apply id="S2.E5Xb.2.1.1.m1.4.4.cmml" xref="S2.E5Xb.2.1.1.m1.4.4"><divide id="S2.E5Xb.2.1.1.m1.4.4.5.cmml" xref="S2.E5Xb.2.1.1.m1.4.4"></divide><apply id="S2.E5Xb.2.1.1.m1.4.4.4.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4"><plus id="S2.E5Xb.2.1.1.m1.4.4.4.5.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.5"></plus><apply id="S2.E5Xb.2.1.1.m1.4.4.4.6.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.6"><csymbol cd="ambiguous" id="S2.E5Xb.2.1.1.m1.4.4.4.6.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.6">subscript</csymbol><ci id="S2.E5Xb.2.1.1.m1.4.4.4.6.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.6.2">𝐭</ci><list id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2"><ci id="S2.E5Xb.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.1.1.1.1.1.1">𝑛</ci><apply id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1"><ci id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.1">:</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.2">0</cn><apply id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3"><minus id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.1"></minus><apply id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2"><divide id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.1"></divide><ci id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.2">𝑑</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E5Xb.2.1.1.m1.2.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list></apply><apply id="S2.E5Xb.2.1.1.m1.4.4.4.7.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.7"><csymbol cd="ambiguous" id="S2.E5Xb.2.1.1.m1.4.4.4.7.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.7">subscript</csymbol><ci id="S2.E5Xb.2.1.1.m1.4.4.4.7.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.7.2">𝐭</ci><list id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2"><ci id="S2.E5Xb.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.3.3.3.3.1.1">𝑛</ci><apply id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1"><csymbol cd="latexml" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1"><ci id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.1">:</ci><apply id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2"><minus id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.1"></minus><apply id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2"><divide id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.1"></divide><ci id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.2">𝑑</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.2.3">2</cn></apply><cn type="integer" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.2.3">1</cn></apply><apply id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3"><minus id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.1.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.1"></minus><ci id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.2.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.2">𝑑</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.3.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.4.4.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list></apply></apply><cn type="integer" id="S2.E5Xb.2.1.1.m1.4.4.6.cmml" xref="S2.E5Xb.2.1.1.m1.4.4.6">2</cn></apply><apply id="S2.E5Xb.2.1.1.m1.8.8.cmml" xref="S2.E5Xb.2.1.1.m1.8.8"><divide id="S2.E5Xb.2.1.1.m1.8.8.5.cmml" xref="S2.E5Xb.2.1.1.m1.8.8"></divide><apply id="S2.E5Xb.2.1.1.m1.8.8.4.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4"><plus id="S2.E5Xb.2.1.1.m1.8.8.4.5.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.5"></plus><apply id="S2.E5Xb.2.1.1.m1.8.8.4.6.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.6"><csymbol cd="ambiguous" id="S2.E5Xb.2.1.1.m1.8.8.4.6.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.6">subscript</csymbol><ci id="S2.E5Xb.2.1.1.m1.8.8.4.6.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.6.2">𝐭</ci><list id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2"><ci id="S2.E5Xb.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.5.5.1.1.1.1">𝑛</ci><apply id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1"><ci id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.1">:</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.2">0</cn><apply id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3"><minus id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.1"></minus><apply id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2"><divide id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.1"></divide><ci id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.2">𝑑</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E5Xb.2.1.1.m1.6.6.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list></apply><apply id="S2.E5Xb.2.1.1.m1.8.8.4.7.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.7"><csymbol cd="ambiguous" id="S2.E5Xb.2.1.1.m1.8.8.4.7.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.7">subscript</csymbol><ci id="S2.E5Xb.2.1.1.m1.8.8.4.7.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.7.2">𝐭</ci><list id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2"><ci id="S2.E5Xb.2.1.1.m1.7.7.3.3.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.7.7.3.3.1.1">𝑛</ci><apply id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1"><csymbol cd="latexml" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1"><ci id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.1">:</ci><apply id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2"><minus id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.1"></minus><apply id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2"><divide id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.1"></divide><ci id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.2">𝑑</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.2.3">2</cn></apply><cn type="integer" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.3.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.2.3">1</cn></apply><apply id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3"><minus id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.1.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.1"></minus><ci id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.2.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.2">𝑑</ci><cn type="integer" id="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.3.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.4.4.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list></apply></apply><cn type="integer" id="S2.E5Xb.2.1.1.m1.8.8.6.cmml" xref="S2.E5Xb.2.1.1.m1.8.8.6">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xb.2.1.1.m1.8c">\displaystyle{\mathbf{t}}_{n}=(\frac{{\mathbf{t}}_{n;[0:d/2-1]}+{\mathbf{t}}_{n;[d/2-1:d-1]}}{2},\frac{{\mathbf{t}}_{n;[0:d/2-1]}+{\mathbf{t}}_{n;[d/2-1:d-1]}}{2})</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xb.2.1.1.m1.8d">bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = ( divide start_ARG bold_t start_POSTSUBSCRIPT italic_n ; [ 0 : italic_d / 2 - 1 ] end_POSTSUBSCRIPT + bold_t start_POSTSUBSCRIPT italic_n ; [ italic_d / 2 - 1 : italic_d - 1 ] end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG , divide start_ARG bold_t start_POSTSUBSCRIPT italic_n ; [ 0 : italic_d / 2 - 1 ] end_POSTSUBSCRIPT + bold_t start_POSTSUBSCRIPT italic_n ; [ italic_d / 2 - 1 : italic_d - 1 ] end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S2.E5Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle{\mathbf{t}}_{n}=\text{Relu}({\mathbf{t}}_{n})" display="inline"><semantics id="S2.E5Xc.2.1.1.m1.1a"><mrow id="S2.E5Xc.2.1.1.m1.1.1" xref="S2.E5Xc.2.1.1.m1.1.1.cmml"><msub id="S2.E5Xc.2.1.1.m1.1.1.3" xref="S2.E5Xc.2.1.1.m1.1.1.3.cmml"><mi id="S2.E5Xc.2.1.1.m1.1.1.3.2" xref="S2.E5Xc.2.1.1.m1.1.1.3.2.cmml">𝐭</mi><mi id="S2.E5Xc.2.1.1.m1.1.1.3.3" xref="S2.E5Xc.2.1.1.m1.1.1.3.3.cmml">n</mi></msub><mo id="S2.E5Xc.2.1.1.m1.1.1.2" xref="S2.E5Xc.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S2.E5Xc.2.1.1.m1.1.1.1" xref="S2.E5Xc.2.1.1.m1.1.1.1.cmml"><mtext id="S2.E5Xc.2.1.1.m1.1.1.1.3" xref="S2.E5Xc.2.1.1.m1.1.1.1.3a.cmml">Relu</mtext><mo id="S2.E5Xc.2.1.1.m1.1.1.1.2" xref="S2.E5Xc.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xc.2.1.1.m1.1.1.1.1.1" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.2" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.2" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.2.cmml">𝐭</mi><mi id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.3" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.3" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xc.2.1.1.m1.1b"><apply id="S2.E5Xc.2.1.1.m1.1.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1"><eq id="S2.E5Xc.2.1.1.m1.1.1.2.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.2"></eq><apply id="S2.E5Xc.2.1.1.m1.1.1.3.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xc.2.1.1.m1.1.1.3.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S2.E5Xc.2.1.1.m1.1.1.3.2.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3.2">𝐭</ci><ci id="S2.E5Xc.2.1.1.m1.1.1.3.3.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.3.3">𝑛</ci></apply><apply id="S2.E5Xc.2.1.1.m1.1.1.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1"><times id="S2.E5Xc.2.1.1.m1.1.1.1.2.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.2"></times><ci id="S2.E5Xc.2.1.1.m1.1.1.1.3a.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.3"><mtext id="S2.E5Xc.2.1.1.m1.1.1.1.3.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.3">Relu</mtext></ci><apply id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.2">𝐭</ci><ci id="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xc.2.1.1.m1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xc.2.1.1.m1.1c">\displaystyle{\mathbf{t}}_{n}=\text{Relu}({\mathbf{t}}_{n})</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xc.2.1.1.m1.1d">bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = Relu ( bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p3.1" class="ltx_p">it could be regard as folding <math id="S2.SS4.p3.1.m1.1" class="ltx_Math" alttext="{\mathbf{t}}_{n}" display="inline"><semantics id="S2.SS4.p3.1.m1.1a"><msub id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml"><mi id="S2.SS4.p3.1.m1.1.1.2" xref="S2.SS4.p3.1.m1.1.1.2.cmml">𝐭</mi><mi id="S2.SS4.p3.1.m1.1.1.3" xref="S2.SS4.p3.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p3.1.m1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2">𝐭</ci><ci id="S2.SS4.p3.1.m1.1.1.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">{\mathbf{t}}_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> in half along the dimension of hidden size and making a copy.</p>
</div>
<div id="S2.SS4.p4" class="ltx_para ltx_noindent">
<p id="S2.SS4.p4.5" class="ltx_p">Secondly, we get the keys as follows:</p>
<table id="S2.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle{\mathbf{k}}_{n}={\mathbf{Q}}\circ{\mathbf{t}}_{n}=({\mathbf{q}}_{1}\circ{\mathbf{t}}_{n},...,{\mathbf{q}}_{N}\circ{\mathbf{t}}_{n})" display="inline"><semantics id="S2.E6X.2.1.1.m1.3a"><mrow id="S2.E6X.2.1.1.m1.3.3" xref="S2.E6X.2.1.1.m1.3.3.cmml"><msub id="S2.E6X.2.1.1.m1.3.3.4" xref="S2.E6X.2.1.1.m1.3.3.4.cmml"><mi id="S2.E6X.2.1.1.m1.3.3.4.2" xref="S2.E6X.2.1.1.m1.3.3.4.2.cmml">𝐤</mi><mi id="S2.E6X.2.1.1.m1.3.3.4.3" xref="S2.E6X.2.1.1.m1.3.3.4.3.cmml">n</mi></msub><mo id="S2.E6X.2.1.1.m1.3.3.5" xref="S2.E6X.2.1.1.m1.3.3.5.cmml">=</mo><mrow id="S2.E6X.2.1.1.m1.3.3.6" xref="S2.E6X.2.1.1.m1.3.3.6.cmml"><mi id="S2.E6X.2.1.1.m1.3.3.6.2" xref="S2.E6X.2.1.1.m1.3.3.6.2.cmml">𝐐</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E6X.2.1.1.m1.3.3.6.1" xref="S2.E6X.2.1.1.m1.3.3.6.1.cmml">∘</mo><msub id="S2.E6X.2.1.1.m1.3.3.6.3" xref="S2.E6X.2.1.1.m1.3.3.6.3.cmml"><mi id="S2.E6X.2.1.1.m1.3.3.6.3.2" xref="S2.E6X.2.1.1.m1.3.3.6.3.2.cmml">𝐭</mi><mi id="S2.E6X.2.1.1.m1.3.3.6.3.3" xref="S2.E6X.2.1.1.m1.3.3.6.3.3.cmml">n</mi></msub></mrow><mo id="S2.E6X.2.1.1.m1.3.3.7" xref="S2.E6X.2.1.1.m1.3.3.7.cmml">=</mo><mrow id="S2.E6X.2.1.1.m1.3.3.2.2" xref="S2.E6X.2.1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.E6X.2.1.1.m1.3.3.2.2.3" xref="S2.E6X.2.1.1.m1.3.3.2.3.cmml">(</mo><mrow id="S2.E6X.2.1.1.m1.2.2.1.1.1" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.cmml"><msub id="S2.E6X.2.1.1.m1.2.2.1.1.1.2" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2.cmml"><mi id="S2.E6X.2.1.1.m1.2.2.1.1.1.2.2" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2.2.cmml">𝐪</mi><mn id="S2.E6X.2.1.1.m1.2.2.1.1.1.2.3" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E6X.2.1.1.m1.2.2.1.1.1.1" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.1.cmml">∘</mo><msub id="S2.E6X.2.1.1.m1.2.2.1.1.1.3" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.E6X.2.1.1.m1.2.2.1.1.1.3.2" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3.2.cmml">𝐭</mi><mi id="S2.E6X.2.1.1.m1.2.2.1.1.1.3.3" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3.3.cmml">n</mi></msub></mrow><mo id="S2.E6X.2.1.1.m1.3.3.2.2.4" xref="S2.E6X.2.1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.E6X.2.1.1.m1.1.1" xref="S2.E6X.2.1.1.m1.1.1.cmml">…</mi><mo id="S2.E6X.2.1.1.m1.3.3.2.2.5" xref="S2.E6X.2.1.1.m1.3.3.2.3.cmml">,</mo><mrow id="S2.E6X.2.1.1.m1.3.3.2.2.2" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.cmml"><msub id="S2.E6X.2.1.1.m1.3.3.2.2.2.2" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2.cmml"><mi id="S2.E6X.2.1.1.m1.3.3.2.2.2.2.2" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2.2.cmml">𝐪</mi><mi id="S2.E6X.2.1.1.m1.3.3.2.2.2.2.3" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2.3.cmml">N</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E6X.2.1.1.m1.3.3.2.2.2.1" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.1.cmml">∘</mo><msub id="S2.E6X.2.1.1.m1.3.3.2.2.2.3" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3.cmml"><mi id="S2.E6X.2.1.1.m1.3.3.2.2.2.3.2" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3.2.cmml">𝐭</mi><mi id="S2.E6X.2.1.1.m1.3.3.2.2.2.3.3" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S2.E6X.2.1.1.m1.3.3.2.2.6" xref="S2.E6X.2.1.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6X.2.1.1.m1.3b"><apply id="S2.E6X.2.1.1.m1.3.3.cmml" xref="S2.E6X.2.1.1.m1.3.3"><and id="S2.E6X.2.1.1.m1.3.3a.cmml" xref="S2.E6X.2.1.1.m1.3.3"></and><apply id="S2.E6X.2.1.1.m1.3.3b.cmml" xref="S2.E6X.2.1.1.m1.3.3"><eq id="S2.E6X.2.1.1.m1.3.3.5.cmml" xref="S2.E6X.2.1.1.m1.3.3.5"></eq><apply id="S2.E6X.2.1.1.m1.3.3.4.cmml" xref="S2.E6X.2.1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.3.3.4.1.cmml" xref="S2.E6X.2.1.1.m1.3.3.4">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.3.3.4.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.4.2">𝐤</ci><ci id="S2.E6X.2.1.1.m1.3.3.4.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.4.3">𝑛</ci></apply><apply id="S2.E6X.2.1.1.m1.3.3.6.cmml" xref="S2.E6X.2.1.1.m1.3.3.6"><compose id="S2.E6X.2.1.1.m1.3.3.6.1.cmml" xref="S2.E6X.2.1.1.m1.3.3.6.1"></compose><ci id="S2.E6X.2.1.1.m1.3.3.6.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.6.2">𝐐</ci><apply id="S2.E6X.2.1.1.m1.3.3.6.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.6.3"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.3.3.6.3.1.cmml" xref="S2.E6X.2.1.1.m1.3.3.6.3">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.3.3.6.3.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.6.3.2">𝐭</ci><ci id="S2.E6X.2.1.1.m1.3.3.6.3.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.6.3.3">𝑛</ci></apply></apply></apply><apply id="S2.E6X.2.1.1.m1.3.3c.cmml" xref="S2.E6X.2.1.1.m1.3.3"><eq id="S2.E6X.2.1.1.m1.3.3.7.cmml" xref="S2.E6X.2.1.1.m1.3.3.7"></eq><share href="#S2.E6X.2.1.1.m1.3.3.6.cmml" id="S2.E6X.2.1.1.m1.3.3d.cmml" xref="S2.E6X.2.1.1.m1.3.3"></share><vector id="S2.E6X.2.1.1.m1.3.3.2.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2"><apply id="S2.E6X.2.1.1.m1.2.2.1.1.1.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1"><compose id="S2.E6X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.1"></compose><apply id="S2.E6X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2.2">𝐪</ci><cn type="integer" id="S2.E6X.2.1.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.2.3">1</cn></apply><apply id="S2.E6X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.2.2.1.1.1.3.1.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.2.2.1.1.1.3.2.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3.2">𝐭</ci><ci id="S2.E6X.2.1.1.m1.2.2.1.1.1.3.3.cmml" xref="S2.E6X.2.1.1.m1.2.2.1.1.1.3.3">𝑛</ci></apply></apply><ci id="S2.E6X.2.1.1.m1.1.1.cmml" xref="S2.E6X.2.1.1.m1.1.1">…</ci><apply id="S2.E6X.2.1.1.m1.3.3.2.2.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2"><compose id="S2.E6X.2.1.1.m1.3.3.2.2.2.1.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.1"></compose><apply id="S2.E6X.2.1.1.m1.3.3.2.2.2.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2.2">𝐪</ci><ci id="S2.E6X.2.1.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.2.3">𝑁</ci></apply><apply id="S2.E6X.2.1.1.m1.3.3.2.2.2.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.E6X.2.1.1.m1.3.3.2.2.2.3.1.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3">subscript</csymbol><ci id="S2.E6X.2.1.1.m1.3.3.2.2.2.3.2.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3.2">𝐭</ci><ci id="S2.E6X.2.1.1.m1.3.3.2.2.2.3.3.cmml" xref="S2.E6X.2.1.1.m1.3.3.2.2.2.3.3">𝑛</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6X.2.1.1.m1.3c">\displaystyle{\mathbf{k}}_{n}={\mathbf{Q}}\circ{\mathbf{t}}_{n}=({\mathbf{q}}_{1}\circ{\mathbf{t}}_{n},...,{\mathbf{q}}_{N}\circ{\mathbf{t}}_{n})</annotation><annotation encoding="application/x-llamapun" id="S2.E6X.2.1.1.m1.3d">bold_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = bold_Q ∘ bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = ( bold_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∘ bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , … , bold_q start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ∘ bold_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p4.4" class="ltx_p">where <math id="S2.SS4.p4.1.m1.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S2.SS4.p4.1.m1.1a"><mo id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><compose id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">\circ</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">∘</annotation></semantics></math> represents Hadamard product. We have to claim that <math id="S2.SS4.p4.2.m2.1" class="ltx_Math" alttext="{\mathbf{k}}_{n}" display="inline"><semantics id="S2.SS4.p4.2.m2.1a"><msub id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml"><mi id="S2.SS4.p4.2.m2.1.1.2" xref="S2.SS4.p4.2.m2.1.1.2.cmml">𝐤</mi><mi id="S2.SS4.p4.2.m2.1.1.3" xref="S2.SS4.p4.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.1b"><apply id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.1.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p4.2.m2.1.1.2.cmml" xref="S2.SS4.p4.2.m2.1.1.2">𝐤</ci><ci id="S2.SS4.p4.2.m2.1.1.3.cmml" xref="S2.SS4.p4.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.1c">{\mathbf{k}}_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m2.1d">bold_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> here has one
more additional dimension than before, since it might bring unimaginable memory pressure(exactly <math id="S2.SS4.p4.3.m3.1" class="ltx_Math" alttext="d/h" display="inline"><semantics id="S2.SS4.p4.3.m3.1a"><mrow id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml"><mi id="S2.SS4.p4.3.m3.1.1.2" xref="S2.SS4.p4.3.m3.1.1.2.cmml">d</mi><mo id="S2.SS4.p4.3.m3.1.1.1" xref="S2.SS4.p4.3.m3.1.1.1.cmml">/</mo><mi id="S2.SS4.p4.3.m3.1.1.3" xref="S2.SS4.p4.3.m3.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.1b"><apply id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1"><divide id="S2.SS4.p4.3.m3.1.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1.1"></divide><ci id="S2.SS4.p4.3.m3.1.1.2.cmml" xref="S2.SS4.p4.3.m3.1.1.2">𝑑</ci><ci id="S2.SS4.p4.3.m3.1.1.3.cmml" xref="S2.SS4.p4.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.1c">d/h</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.3.m3.1d">italic_d / italic_h</annotation></semantics></math> times large, where <math id="S2.SS4.p4.4.m4.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS4.p4.4.m4.1a"><mi id="S2.SS4.p4.4.m4.1.1" xref="S2.SS4.p4.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m4.1b"><ci id="S2.SS4.p4.4.m4.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m4.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.4.m4.1d">italic_h</annotation></semantics></math> represents the number of heads).</p>
</div>
<div id="S2.SS4.p5" class="ltx_para ltx_noindent">
<p id="S2.SS4.p5.1" class="ltx_p">Fortunately, we can perfectly handle this with tensor contraction, leading to zero increase in memory consumption(see computational and spatial complexity in Section <a href="#S3.SS2" title="3.2 Computational and spatial complexity ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</p>
</div>
<div id="S2.SS4.p6" class="ltx_para ltx_noindent">
<p id="S2.SS4.p6.2" class="ltx_p">After this, we can apply RoPE almostly the same as before:</p>
<table id="S2.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E7X.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle f({\mathbf{q}}_{m})=f({\mathbf{q}},m)" display="inline"><semantics id="S2.E7X.2.1.1.m1.3a"><mrow id="S2.E7X.2.1.1.m1.3.3" xref="S2.E7X.2.1.1.m1.3.3.cmml"><mrow id="S2.E7X.2.1.1.m1.3.3.1" xref="S2.E7X.2.1.1.m1.3.3.1.cmml"><mi id="S2.E7X.2.1.1.m1.3.3.1.3" xref="S2.E7X.2.1.1.m1.3.3.1.3.cmml">f</mi><mo id="S2.E7X.2.1.1.m1.3.3.1.2" xref="S2.E7X.2.1.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E7X.2.1.1.m1.3.3.1.1.1" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7X.2.1.1.m1.3.3.1.1.1.2" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.cmml">(</mo><msub id="S2.E7X.2.1.1.m1.3.3.1.1.1.1" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.cmml"><mi id="S2.E7X.2.1.1.m1.3.3.1.1.1.1.2" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.2.cmml">𝐪</mi><mi id="S2.E7X.2.1.1.m1.3.3.1.1.1.1.3" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S2.E7X.2.1.1.m1.3.3.1.1.1.3" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7X.2.1.1.m1.3.3.2" xref="S2.E7X.2.1.1.m1.3.3.2.cmml">=</mo><mrow id="S2.E7X.2.1.1.m1.3.3.3" xref="S2.E7X.2.1.1.m1.3.3.3.cmml"><mi id="S2.E7X.2.1.1.m1.3.3.3.2" xref="S2.E7X.2.1.1.m1.3.3.3.2.cmml">f</mi><mo id="S2.E7X.2.1.1.m1.3.3.3.1" xref="S2.E7X.2.1.1.m1.3.3.3.1.cmml">⁢</mo><mrow id="S2.E7X.2.1.1.m1.3.3.3.3.2" xref="S2.E7X.2.1.1.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="S2.E7X.2.1.1.m1.3.3.3.3.2.1" xref="S2.E7X.2.1.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S2.E7X.2.1.1.m1.1.1" xref="S2.E7X.2.1.1.m1.1.1.cmml">𝐪</mi><mo id="S2.E7X.2.1.1.m1.3.3.3.3.2.2" xref="S2.E7X.2.1.1.m1.3.3.3.3.1.cmml">,</mo><mi id="S2.E7X.2.1.1.m1.2.2" xref="S2.E7X.2.1.1.m1.2.2.cmml">m</mi><mo stretchy="false" id="S2.E7X.2.1.1.m1.3.3.3.3.2.3" xref="S2.E7X.2.1.1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7X.2.1.1.m1.3b"><apply id="S2.E7X.2.1.1.m1.3.3.cmml" xref="S2.E7X.2.1.1.m1.3.3"><eq id="S2.E7X.2.1.1.m1.3.3.2.cmml" xref="S2.E7X.2.1.1.m1.3.3.2"></eq><apply id="S2.E7X.2.1.1.m1.3.3.1.cmml" xref="S2.E7X.2.1.1.m1.3.3.1"><times id="S2.E7X.2.1.1.m1.3.3.1.2.cmml" xref="S2.E7X.2.1.1.m1.3.3.1.2"></times><ci id="S2.E7X.2.1.1.m1.3.3.1.3.cmml" xref="S2.E7X.2.1.1.m1.3.3.1.3">𝑓</ci><apply id="S2.E7X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S2.E7X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E7X.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E7X.2.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.E7X.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.2">𝐪</ci><ci id="S2.E7X.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E7X.2.1.1.m1.3.3.1.1.1.1.3">𝑚</ci></apply></apply><apply id="S2.E7X.2.1.1.m1.3.3.3.cmml" xref="S2.E7X.2.1.1.m1.3.3.3"><times id="S2.E7X.2.1.1.m1.3.3.3.1.cmml" xref="S2.E7X.2.1.1.m1.3.3.3.1"></times><ci id="S2.E7X.2.1.1.m1.3.3.3.2.cmml" xref="S2.E7X.2.1.1.m1.3.3.3.2">𝑓</ci><interval closure="open" id="S2.E7X.2.1.1.m1.3.3.3.3.1.cmml" xref="S2.E7X.2.1.1.m1.3.3.3.3.2"><ci id="S2.E7X.2.1.1.m1.1.1.cmml" xref="S2.E7X.2.1.1.m1.1.1">𝐪</ci><ci id="S2.E7X.2.1.1.m1.2.2.cmml" xref="S2.E7X.2.1.1.m1.2.2">𝑚</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7X.2.1.1.m1.3c">\displaystyle f({\mathbf{q}}_{m})=f({\mathbf{q}},m)</annotation><annotation encoding="application/x-llamapun" id="S2.E7X.2.1.1.m1.3d">italic_f ( bold_q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) = italic_f ( bold_q , italic_m )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S2.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E7Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle f({\mathbf{k}}_{n})={\mathbf{Q}}\circ f({\mathbf{t}},n)" display="inline"><semantics id="S2.E7Xa.2.1.1.m1.3a"><mrow id="S2.E7Xa.2.1.1.m1.3.3" xref="S2.E7Xa.2.1.1.m1.3.3.cmml"><mrow id="S2.E7Xa.2.1.1.m1.3.3.1" xref="S2.E7Xa.2.1.1.m1.3.3.1.cmml"><mi id="S2.E7Xa.2.1.1.m1.3.3.1.3" xref="S2.E7Xa.2.1.1.m1.3.3.1.3.cmml">f</mi><mo id="S2.E7Xa.2.1.1.m1.3.3.1.2" xref="S2.E7Xa.2.1.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E7Xa.2.1.1.m1.3.3.1.1.1" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.2" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.cmml">(</mo><msub id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mi id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">𝐤</mi><mi id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.3" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.3" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7Xa.2.1.1.m1.3.3.2" xref="S2.E7Xa.2.1.1.m1.3.3.2.cmml">=</mo><mrow id="S2.E7Xa.2.1.1.m1.3.3.3" xref="S2.E7Xa.2.1.1.m1.3.3.3.cmml"><mrow id="S2.E7Xa.2.1.1.m1.3.3.3.2" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.cmml"><mi id="S2.E7Xa.2.1.1.m1.3.3.3.2.2" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.2.cmml">𝐐</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E7Xa.2.1.1.m1.3.3.3.2.1" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.1.cmml">∘</mo><mi id="S2.E7Xa.2.1.1.m1.3.3.3.2.3" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.3.cmml">f</mi></mrow><mo id="S2.E7Xa.2.1.1.m1.3.3.3.1" xref="S2.E7Xa.2.1.1.m1.3.3.3.1.cmml">⁢</mo><mrow id="S2.E7Xa.2.1.1.m1.3.3.3.3.2" xref="S2.E7Xa.2.1.1.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="S2.E7Xa.2.1.1.m1.3.3.3.3.2.1" xref="S2.E7Xa.2.1.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S2.E7Xa.2.1.1.m1.1.1" xref="S2.E7Xa.2.1.1.m1.1.1.cmml">𝐭</mi><mo id="S2.E7Xa.2.1.1.m1.3.3.3.3.2.2" xref="S2.E7Xa.2.1.1.m1.3.3.3.3.1.cmml">,</mo><mi id="S2.E7Xa.2.1.1.m1.2.2" xref="S2.E7Xa.2.1.1.m1.2.2.cmml">n</mi><mo stretchy="false" id="S2.E7Xa.2.1.1.m1.3.3.3.3.2.3" xref="S2.E7Xa.2.1.1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7Xa.2.1.1.m1.3b"><apply id="S2.E7Xa.2.1.1.m1.3.3.cmml" xref="S2.E7Xa.2.1.1.m1.3.3"><eq id="S2.E7Xa.2.1.1.m1.3.3.2.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.2"></eq><apply id="S2.E7Xa.2.1.1.m1.3.3.1.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1"><times id="S2.E7Xa.2.1.1.m1.3.3.1.2.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1.2"></times><ci id="S2.E7Xa.2.1.1.m1.3.3.1.3.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1.3">𝑓</ci><apply id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.2">𝐤</ci><ci id="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S2.E7Xa.2.1.1.m1.3.3.3.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3"><times id="S2.E7Xa.2.1.1.m1.3.3.3.1.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3.1"></times><apply id="S2.E7Xa.2.1.1.m1.3.3.3.2.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3.2"><compose id="S2.E7Xa.2.1.1.m1.3.3.3.2.1.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.1"></compose><ci id="S2.E7Xa.2.1.1.m1.3.3.3.2.2.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.2">𝐐</ci><ci id="S2.E7Xa.2.1.1.m1.3.3.3.2.3.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3.2.3">𝑓</ci></apply><interval closure="open" id="S2.E7Xa.2.1.1.m1.3.3.3.3.1.cmml" xref="S2.E7Xa.2.1.1.m1.3.3.3.3.2"><ci id="S2.E7Xa.2.1.1.m1.1.1.cmml" xref="S2.E7Xa.2.1.1.m1.1.1">𝐭</ci><ci id="S2.E7Xa.2.1.1.m1.2.2.cmml" xref="S2.E7Xa.2.1.1.m1.2.2">𝑛</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xa.2.1.1.m1.3c">\displaystyle f({\mathbf{k}}_{n})={\mathbf{Q}}\circ f({\mathbf{t}},n)</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xa.2.1.1.m1.3d">italic_f ( bold_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = bold_Q ∘ italic_f ( bold_t , italic_n )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS4.p6.1" class="ltx_p">where <math id="S2.SS4.p6.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S2.SS4.p6.1.m1.1a"><mi id="S2.SS4.p6.1.m1.1.1" xref="S2.SS4.p6.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p6.1.m1.1b"><ci id="S2.SS4.p6.1.m1.1.1.cmml" xref="S2.SS4.p6.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p6.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p6.1.m1.1d">italic_f</annotation></semantics></math> is defined as Equation <a href="#S2.E1" title="1 ‣ 2.1 Background: Rotary Position Embedding (RoPE) ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S2.SS4.p7" class="ltx_para ltx_noindent">
<p id="S2.SS4.p7.1" class="ltx_p">Finally, we get the attention score as follows:</p>
<table id="S2.E8" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E8X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E8X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle a(m,n)" display="inline"><semantics id="S2.E8X.2.1.1.m1.2a"><mrow id="S2.E8X.2.1.1.m1.2.3" xref="S2.E8X.2.1.1.m1.2.3.cmml"><mi id="S2.E8X.2.1.1.m1.2.3.2" xref="S2.E8X.2.1.1.m1.2.3.2.cmml">a</mi><mo id="S2.E8X.2.1.1.m1.2.3.1" xref="S2.E8X.2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.E8X.2.1.1.m1.2.3.3.2" xref="S2.E8X.2.1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.E8X.2.1.1.m1.2.3.3.2.1" xref="S2.E8X.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.E8X.2.1.1.m1.1.1" xref="S2.E8X.2.1.1.m1.1.1.cmml">m</mi><mo id="S2.E8X.2.1.1.m1.2.3.3.2.2" xref="S2.E8X.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.E8X.2.1.1.m1.2.2" xref="S2.E8X.2.1.1.m1.2.2.cmml">n</mi><mo stretchy="false" id="S2.E8X.2.1.1.m1.2.3.3.2.3" xref="S2.E8X.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8X.2.1.1.m1.2b"><apply id="S2.E8X.2.1.1.m1.2.3.cmml" xref="S2.E8X.2.1.1.m1.2.3"><times id="S2.E8X.2.1.1.m1.2.3.1.cmml" xref="S2.E8X.2.1.1.m1.2.3.1"></times><ci id="S2.E8X.2.1.1.m1.2.3.2.cmml" xref="S2.E8X.2.1.1.m1.2.3.2">𝑎</ci><interval closure="open" id="S2.E8X.2.1.1.m1.2.3.3.1.cmml" xref="S2.E8X.2.1.1.m1.2.3.3.2"><ci id="S2.E8X.2.1.1.m1.1.1.cmml" xref="S2.E8X.2.1.1.m1.1.1">𝑚</ci><ci id="S2.E8X.2.1.1.m1.2.2.cmml" xref="S2.E8X.2.1.1.m1.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8X.2.1.1.m1.2c">\displaystyle a(m,n)</annotation><annotation encoding="application/x-llamapun" id="S2.E8X.2.1.1.m1.2d">italic_a ( italic_m , italic_n )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E8X.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=\text{Re}(\langle f({\mathbf{q}},m),{\mathbf{q}}_{m}\circ f({\mathbf{t}},n)\rangle)" display="inline"><semantics id="S2.E8X.3.2.2.m1.5a"><mrow id="S2.E8X.3.2.2.m1.5.5" xref="S2.E8X.3.2.2.m1.5.5.cmml"><mi id="S2.E8X.3.2.2.m1.5.5.3" xref="S2.E8X.3.2.2.m1.5.5.3.cmml"></mi><mo id="S2.E8X.3.2.2.m1.5.5.2" xref="S2.E8X.3.2.2.m1.5.5.2.cmml">=</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1" xref="S2.E8X.3.2.2.m1.5.5.1.cmml"><mtext id="S2.E8X.3.2.2.m1.5.5.1.3" xref="S2.E8X.3.2.2.m1.5.5.1.3a.cmml">Re</mtext><mo id="S2.E8X.3.2.2.m1.5.5.1.2" xref="S2.E8X.3.2.2.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1" xref="S2.E8X.3.2.2.m1.5.5.1.cmml"><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.2" xref="S2.E8X.3.2.2.m1.5.5.1.cmml">(</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.3" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.3.cmml">⟨</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml">f</mi><mo id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.1" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E8X.3.2.2.m1.1.1" xref="S2.E8X.3.2.2.m1.1.1.cmml">𝐪</mi><mo id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.E8X.3.2.2.m1.2.2" xref="S2.E8X.3.2.2.m1.2.2.cmml">m</mi><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.4" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.3.cmml">,</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.cmml"><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.cmml"><msub id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.2.cmml">𝐪</mi><mi id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.3" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.3.cmml">m</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.1" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.1.cmml">∘</mo><mi id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.3" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.3.cmml">f</mi></mrow><mo id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.1" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2.1" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml">(</mo><mi id="S2.E8X.3.2.2.m1.3.3" xref="S2.E8X.3.2.2.m1.3.3.cmml">𝐭</mi><mo id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2.2" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E8X.3.2.2.m1.4.4" xref="S2.E8X.3.2.2.m1.4.4.cmml">n</mi><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2.3" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.5" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.3.cmml">⟩</mo></mrow><mo stretchy="false" id="S2.E8X.3.2.2.m1.5.5.1.1.1.3" xref="S2.E8X.3.2.2.m1.5.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8X.3.2.2.m1.5b"><apply id="S2.E8X.3.2.2.m1.5.5.cmml" xref="S2.E8X.3.2.2.m1.5.5"><eq id="S2.E8X.3.2.2.m1.5.5.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.2"></eq><csymbol cd="latexml" id="S2.E8X.3.2.2.m1.5.5.3.cmml" xref="S2.E8X.3.2.2.m1.5.5.3">absent</csymbol><apply id="S2.E8X.3.2.2.m1.5.5.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1"><times id="S2.E8X.3.2.2.m1.5.5.1.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.2"></times><ci id="S2.E8X.3.2.2.m1.5.5.1.3a.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.3"><mtext id="S2.E8X.3.2.2.m1.5.5.1.3.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.3">Re</mtext></ci><list id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2"><apply id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1"><times id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.1"></times><ci id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.2">𝑓</ci><interval closure="open" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2"><ci id="S2.E8X.3.2.2.m1.1.1.cmml" xref="S2.E8X.3.2.2.m1.1.1">𝐪</ci><ci id="S2.E8X.3.2.2.m1.2.2.cmml" xref="S2.E8X.3.2.2.m1.2.2">𝑚</ci></interval></apply><apply id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2"><times id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.1"></times><apply id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2"><compose id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.1"></compose><apply id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.2">𝐪</ci><ci id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.2.3">𝑚</ci></apply><ci id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.2.3">𝑓</ci></apply><interval closure="open" id="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.E8X.3.2.2.m1.5.5.1.1.1.1.2.2.3.2"><ci id="S2.E8X.3.2.2.m1.3.3.cmml" xref="S2.E8X.3.2.2.m1.3.3">𝐭</ci><ci id="S2.E8X.3.2.2.m1.4.4.cmml" xref="S2.E8X.3.2.2.m1.4.4">𝑛</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8X.3.2.2.m1.5c">\displaystyle=\text{Re}(\langle f({\mathbf{q}},m),{\mathbf{q}}_{m}\circ f({\mathbf{t}},n)\rangle)</annotation><annotation encoding="application/x-llamapun" id="S2.E8X.3.2.2.m1.5d">= Re ( ⟨ italic_f ( bold_q , italic_m ) , bold_q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∘ italic_f ( bold_t , italic_n ) ⟩ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S2.SS4.p8" class="ltx_para ltx_noindent">
<p id="S2.SS4.p8.3" class="ltx_p">Thus we have built the collinear constrained attention(CoCA) here. Review that the initial angle <math id="S2.SS4.p8.1.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S2.SS4.p8.1.m1.1a"><msub id="S2.SS4.p8.1.m1.1.1" xref="S2.SS4.p8.1.m1.1.1.cmml"><mi id="S2.SS4.p8.1.m1.1.1.2" xref="S2.SS4.p8.1.m1.1.1.2.cmml">θ</mi><mn id="S2.SS4.p8.1.m1.1.1.3" xref="S2.SS4.p8.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p8.1.m1.1b"><apply id="S2.SS4.p8.1.m1.1.1.cmml" xref="S2.SS4.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p8.1.m1.1.1.1.cmml" xref="S2.SS4.p8.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p8.1.m1.1.1.2.cmml" xref="S2.SS4.p8.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S2.SS4.p8.1.m1.1.1.3.cmml" xref="S2.SS4.p8.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p8.1.m1.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p8.1.m1.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> between <math id="S2.SS4.p8.2.m2.1" class="ltx_Math" alttext="{\mathbf{q}}" display="inline"><semantics id="S2.SS4.p8.2.m2.1a"><mi id="S2.SS4.p8.2.m2.1.1" xref="S2.SS4.p8.2.m2.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p8.2.m2.1b"><ci id="S2.SS4.p8.2.m2.1.1.cmml" xref="S2.SS4.p8.2.m2.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p8.2.m2.1c">{\mathbf{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p8.2.m2.1d">bold_q</annotation></semantics></math> and <math id="S2.SS4.p8.3.m3.1" class="ltx_Math" alttext="{\mathbf{k}}" display="inline"><semantics id="S2.SS4.p8.3.m3.1a"><mi id="S2.SS4.p8.3.m3.1.1" xref="S2.SS4.p8.3.m3.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p8.3.m3.1b"><ci id="S2.SS4.p8.3.m3.1.1.cmml" xref="S2.SS4.p8.3.m3.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p8.3.m3.1c">{\mathbf{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p8.3.m3.1d">bold_k</annotation></semantics></math> we defined in Section <a href="#S2.SS3" title="2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>, it always zero now. No more headaches.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Theoretical explanation</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Strong form of Long-term decay</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">As shown in Section <a href="#S2.SS2" title="2.2 Long-term decay of RoPE ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2</span></a>, RoPE has the characteristic of long-term decay:</p>
<table id="S3.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle|a(s)|" display="inline"><semantics id="S3.E9X.2.1.1.m1.2a"><mrow id="S3.E9X.2.1.1.m1.2.2.1" xref="S3.E9X.2.1.1.m1.2.2.2.cmml"><mo stretchy="false" id="S3.E9X.2.1.1.m1.2.2.1.2" xref="S3.E9X.2.1.1.m1.2.2.2.1.cmml">|</mo><mrow id="S3.E9X.2.1.1.m1.2.2.1.1" xref="S3.E9X.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E9X.2.1.1.m1.2.2.1.1.2" xref="S3.E9X.2.1.1.m1.2.2.1.1.2.cmml">a</mi><mo id="S3.E9X.2.1.1.m1.2.2.1.1.1" xref="S3.E9X.2.1.1.m1.2.2.1.1.1.cmml">⁢</mo><mrow id="S3.E9X.2.1.1.m1.2.2.1.1.3.2" xref="S3.E9X.2.1.1.m1.2.2.1.1.cmml"><mo stretchy="false" id="S3.E9X.2.1.1.m1.2.2.1.1.3.2.1" xref="S3.E9X.2.1.1.m1.2.2.1.1.cmml">(</mo><mi id="S3.E9X.2.1.1.m1.1.1" xref="S3.E9X.2.1.1.m1.1.1.cmml">s</mi><mo stretchy="false" id="S3.E9X.2.1.1.m1.2.2.1.1.3.2.2" xref="S3.E9X.2.1.1.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E9X.2.1.1.m1.2.2.1.3" xref="S3.E9X.2.1.1.m1.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.2.1.1.m1.2b"><apply id="S3.E9X.2.1.1.m1.2.2.2.cmml" xref="S3.E9X.2.1.1.m1.2.2.1"><abs id="S3.E9X.2.1.1.m1.2.2.2.1.cmml" xref="S3.E9X.2.1.1.m1.2.2.1.2"></abs><apply id="S3.E9X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E9X.2.1.1.m1.2.2.1.1"><times id="S3.E9X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E9X.2.1.1.m1.2.2.1.1.1"></times><ci id="S3.E9X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E9X.2.1.1.m1.2.2.1.1.2">𝑎</ci><ci id="S3.E9X.2.1.1.m1.1.1.cmml" xref="S3.E9X.2.1.1.m1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.2c">\displaystyle|a(s)|</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.2.1.1.m1.2d">| italic_a ( italic_s ) |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E9X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle\leq(\max_{i}|h_{i+1}-h_{i}|)\sum_{j=0}^{d/2-1}|S_{j+1}|" display="inline"><semantics id="S3.E9X.3.2.2.m1.2a"><mrow id="S3.E9X.3.2.2.m1.2.2" xref="S3.E9X.3.2.2.m1.2.2.cmml"><mi id="S3.E9X.3.2.2.m1.2.2.4" xref="S3.E9X.3.2.2.m1.2.2.4.cmml"></mi><mo id="S3.E9X.3.2.2.m1.2.2.3" xref="S3.E9X.3.2.2.m1.2.2.3.cmml">≤</mo><mrow id="S3.E9X.3.2.2.m1.2.2.2" xref="S3.E9X.3.2.2.m1.2.2.2.cmml"><mrow id="S3.E9X.3.2.2.m1.1.1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.cmml"><munder id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml">max</mi><mi id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">i</mi></munder><mo id="S3.E9X.3.2.2.m1.1.1.1.1.1.1a" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E9X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9X.3.2.2.m1.2.2.2.3" xref="S3.E9X.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E9X.3.2.2.m1.2.2.2.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E9X.3.2.2.m1.2.2.2.2.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.cmml"><munderover id="S3.E9X.3.2.2.m1.2.2.2.2.2a" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.cmml"><mo movablelimits="false" id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.2.cmml">j</mi><mo id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.1" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.E9X.3.2.2.m1.2.2.2.2.2.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.cmml"><mrow id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.cmml"><mi id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.2.cmml">d</mi><mo id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.1" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.1.cmml">/</mo><mn id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.3.cmml">2</mn></mrow><mo id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.1" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E9X.3.2.2.m1.2.2.2.2.1.1" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.2.1.cmml">|</mo><msub id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">S</mi><mrow id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.2" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml">j</mi><mo id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.1" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.1.cmml">+</mo><mn id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9X.3.2.2.m1.2b"><apply id="S3.E9X.3.2.2.m1.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2"><leq id="S3.E9X.3.2.2.m1.2.2.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.3"></leq><csymbol cd="latexml" id="S3.E9X.3.2.2.m1.2.2.4.cmml" xref="S3.E9X.3.2.2.m1.2.2.4">absent</csymbol><apply id="S3.E9X.3.2.2.m1.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2"><times id="S3.E9X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.3"></times><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1"><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2">subscript</csymbol><max id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.2"></max><ci id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1"><abs id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3"><plus id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E9X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2"><apply id="S3.E9X.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.2.2.2.2.2.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2">subscript</csymbol><sum id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.2"></sum><apply id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3"><eq id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.1"></eq><ci id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.2.3.3">0</cn></apply></apply><apply id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3"><minus id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.1"></minus><apply id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2"><divide id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.1"></divide><ci id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.2">𝑑</ci><cn type="integer" id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.2.3">2</cn></apply><cn type="integer" id="S3.E9X.3.2.2.m1.2.2.2.2.2.3.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E9X.3.2.2.m1.2.2.2.2.1.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1"><abs id="S3.E9X.3.2.2.m1.2.2.2.2.1.2.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.2"></abs><apply id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.2">𝑆</ci><apply id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3"><plus id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.1"></plus><ci id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E9X.3.2.2.m1.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9X.3.2.2.m1.2c">\displaystyle\leq(\max_{i}|h_{i+1}-h_{i}|)\sum_{j=0}^{d/2-1}|S_{j+1}|</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.3.2.2.m1.2d">≤ ( roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ) ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT | italic_S start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.3" class="ltx_p">For CoCA, we could deduce a much more stronger one as follows:</p>
<table id="S3.E10" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E10X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle|a(s)|" display="inline"><semantics id="S3.E10X.2.1.1.m1.2a"><mrow id="S3.E10X.2.1.1.m1.2.2.1" xref="S3.E10X.2.1.1.m1.2.2.2.cmml"><mo stretchy="false" id="S3.E10X.2.1.1.m1.2.2.1.2" xref="S3.E10X.2.1.1.m1.2.2.2.1.cmml">|</mo><mrow id="S3.E10X.2.1.1.m1.2.2.1.1" xref="S3.E10X.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E10X.2.1.1.m1.2.2.1.1.2" xref="S3.E10X.2.1.1.m1.2.2.1.1.2.cmml">a</mi><mo id="S3.E10X.2.1.1.m1.2.2.1.1.1" xref="S3.E10X.2.1.1.m1.2.2.1.1.1.cmml">⁢</mo><mrow id="S3.E10X.2.1.1.m1.2.2.1.1.3.2" xref="S3.E10X.2.1.1.m1.2.2.1.1.cmml"><mo stretchy="false" id="S3.E10X.2.1.1.m1.2.2.1.1.3.2.1" xref="S3.E10X.2.1.1.m1.2.2.1.1.cmml">(</mo><mi id="S3.E10X.2.1.1.m1.1.1" xref="S3.E10X.2.1.1.m1.1.1.cmml">s</mi><mo stretchy="false" id="S3.E10X.2.1.1.m1.2.2.1.1.3.2.2" xref="S3.E10X.2.1.1.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E10X.2.1.1.m1.2.2.1.3" xref="S3.E10X.2.1.1.m1.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.2.1.1.m1.2b"><apply id="S3.E10X.2.1.1.m1.2.2.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.1"><abs id="S3.E10X.2.1.1.m1.2.2.2.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.1.2"></abs><apply id="S3.E10X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.1.1"><times id="S3.E10X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E10X.2.1.1.m1.2.2.1.1.1"></times><ci id="S3.E10X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E10X.2.1.1.m1.2.2.1.1.2">𝑎</ci><ci id="S3.E10X.2.1.1.m1.1.1.cmml" xref="S3.E10X.2.1.1.m1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.2.1.1.m1.2c">\displaystyle|a(s)|</annotation><annotation encoding="application/x-llamapun" id="S3.E10X.2.1.1.m1.2d">| italic_a ( italic_s ) |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E10X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle\leq(\max_{i}|l_{i+1}-l_{i}|)\sum_{j=0}^{d/2-1}|C_{j+1}|" display="inline"><semantics id="S3.E10X.3.2.2.m1.2a"><mrow id="S3.E10X.3.2.2.m1.2.2" xref="S3.E10X.3.2.2.m1.2.2.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.4" xref="S3.E10X.3.2.2.m1.2.2.4.cmml"></mi><mo id="S3.E10X.3.2.2.m1.2.2.3" xref="S3.E10X.3.2.2.m1.2.2.3.cmml">≤</mo><mrow id="S3.E10X.3.2.2.m1.2.2.2" xref="S3.E10X.3.2.2.m1.2.2.2.cmml"><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml"><munder id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml">max</mi><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">i</mi></munder><mo id="S3.E10X.3.2.2.m1.1.1.1.1.1.1a" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">l</mi><mrow id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E10X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10X.3.2.2.m1.2.2.2.3" xref="S3.E10X.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E10X.3.2.2.m1.2.2.2.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E10X.3.2.2.m1.2.2.2.2.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.cmml"><munderover id="S3.E10X.3.2.2.m1.2.2.2.2.2a" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.cmml"><mo movablelimits="false" id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.2.cmml">j</mi><mo id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.2.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.cmml"><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.2.cmml">d</mi><mo id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.1.cmml">/</mo><mn id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.3.cmml">2</mn></mrow><mo id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.1.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.2.1.cmml">|</mo><msub id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml">C</mi><mrow id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml">j</mi><mo id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.1" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.1.cmml">+</mo><mn id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.3" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10X.3.2.2.m1.2b"><apply id="S3.E10X.3.2.2.m1.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2"><leq id="S3.E10X.3.2.2.m1.2.2.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.3"></leq><csymbol cd="latexml" id="S3.E10X.3.2.2.m1.2.2.4.cmml" xref="S3.E10X.3.2.2.m1.2.2.4">absent</csymbol><apply id="S3.E10X.3.2.2.m1.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2"><times id="S3.E10X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.3"></times><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1"><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2">subscript</csymbol><max id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.2"></max><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1"><abs id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2">𝑙</ci><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3"><plus id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E10X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2"><apply id="S3.E10X.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.2.2.2.2.2.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2">subscript</csymbol><sum id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.2"></sum><apply id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3"><eq id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.1"></eq><ci id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.2.3.3">0</cn></apply></apply><apply id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3"><minus id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.1"></minus><apply id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2"><divide id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.1"></divide><ci id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.2">𝑑</ci><cn type="integer" id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.2.3">2</cn></apply><cn type="integer" id="S3.E10X.3.2.2.m1.2.2.2.2.2.3.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1"><abs id="S3.E10X.3.2.2.m1.2.2.2.2.1.2.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.2"></abs><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.2">𝐶</ci><apply id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3"><plus id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.1"></plus><ci id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E10X.3.2.2.m1.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10X.3.2.2.m1.2c">\displaystyle\leq(\max_{i}|l_{i+1}-l_{i}|)\sum_{j=0}^{d/2-1}|C_{j+1}|</annotation><annotation encoding="application/x-llamapun" id="S3.E10X.3.2.2.m1.2d">≤ ( roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_l start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ) ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT | italic_C start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p2.2" class="ltx_p">where <math id="S3.SS1.p2.1.m1.2" class="ltx_Math" alttext="l_{j}:=|q_{j}+iq_{j+d/2}||k_{j}+ik_{j+d/2}|" display="inline"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml"><msub id="S3.SS1.p2.1.m1.2.2.4" xref="S3.SS1.p2.1.m1.2.2.4.cmml"><mi id="S3.SS1.p2.1.m1.2.2.4.2" xref="S3.SS1.p2.1.m1.2.2.4.2.cmml">l</mi><mi id="S3.SS1.p2.1.m1.2.2.4.3" xref="S3.SS1.p2.1.m1.2.2.4.3.cmml">j</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.1.m1.2.2.3" xref="S3.SS1.p2.1.m1.2.2.3.cmml">:=</mo><mrow id="S3.SS1.p2.1.m1.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.2.cmml">q</mi><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.2.cmml">j</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.1.cmml">/</mo><mn id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1" xref="S3.SS1.p2.1.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.2.2.1.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.1.cmml">|</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml"><msub id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2.cmml">k</mi><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p2.1.m1.2.2.2.2.1.1.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml">+</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.2.cmml">k</mi><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.2.cmml">j</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.1.cmml">+</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.2" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.2.cmml">d</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.1.cmml">/</mo><mn id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.3" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.2.2.2.2.1.3" xref="S3.SS1.p2.1.m1.2.2.2.2.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.3">assign</csymbol><apply id="S3.SS1.p2.1.m1.2.2.4.cmml" xref="S3.SS1.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.4.1.cmml" xref="S3.SS1.p2.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.4.2.cmml" xref="S3.SS1.p2.1.m1.2.2.4.2">𝑙</ci><ci id="S3.SS1.p2.1.m1.2.2.4.3.cmml" xref="S3.SS1.p2.1.m1.2.2.4.3">𝑗</ci></apply><apply id="S3.SS1.p2.1.m1.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2"><times id="S3.SS1.p2.1.m1.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.3"></times><apply id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1"><abs id="S3.SS1.p2.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2"></abs><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1"><plus id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.2">𝑞</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3"><plus id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.2">𝑗</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3"><divide id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.1"></divide><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1"><abs id="S3.SS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.2"></abs><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1"><plus id="S3.SS1.p2.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.1"></plus><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.2">𝑘</ci><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3"><times id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.2">𝑖</ci><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.2">𝑘</ci><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3"><plus id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.1"></plus><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.2">𝑗</ci><apply id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3"><divide id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.1"></divide><ci id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">l_{j}:=|q_{j}+iq_{j+d/2}||k_{j}+ik_{j+d/2}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.2d">italic_l start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT := | italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_i italic_q start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT | | italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_i italic_k start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT |</annotation></semantics></math>, and <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="C_{j}:=\sum_{k=0}^{j-1}\text{cos}(s\theta_{j})" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">C</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">j</mi></msub><mo lspace="0.278em" rspace="0.111em" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">:=</mo><mrow id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml"><msubsup id="S3.SS1.p2.2.m2.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.2.2.2" xref="S3.SS1.p2.2.m2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.2.2.3" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.2.2.3.2" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.SS1.p2.2.m2.1.1.1.2.2.3.1" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.1.1.1.2.2.3.3" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.SS1.p2.2.m2.1.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.1.2.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.2.3.2" xref="S3.SS1.p2.2.m2.1.1.1.2.3.2.cmml">j</mi><mo id="S3.SS1.p2.2.m2.1.1.1.2.3.1" xref="S3.SS1.p2.2.m2.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS1.p2.2.m2.1.1.1.2.3.3" xref="S3.SS1.p2.2.m2.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml"><mtext id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.3a.cmml">cos</mtext><mo id="S3.SS1.p2.2.m2.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">assign</csymbol><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝐶</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑗</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"><apply id="S3.SS1.p2.2.m2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2">superscript</csymbol><apply id="S3.SS1.p2.2.m2.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2">subscript</csymbol><sum id="S3.SS1.p2.2.m2.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.2.2"></sum><apply id="S3.SS1.p2.2.m2.1.1.1.2.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3"><eq id="S3.SS1.p2.2.m2.1.1.1.2.2.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.1"></eq><ci id="S3.SS1.p2.2.m2.1.1.1.2.2.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.1.2.2.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S3.SS1.p2.2.m2.1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.3"><minus id="S3.SS1.p2.2.m2.1.1.1.2.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.3.1"></minus><ci id="S3.SS1.p2.2.m2.1.1.1.2.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.1.2.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><times id="S3.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2"></times><ci id="S3.SS1.p2.2.m2.1.1.1.1.3a.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.3"><mtext id="S3.SS1.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.3">cos</mtext></ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1"><times id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.1"></times><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">C_{j}:=\sum_{k=0}^{j-1}\text{cos}(s\theta_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT := ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j - 1 end_POSTSUPERSCRIPT cos ( italic_s italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>. And we always have:</p>
<table id="S3.E11" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle|l_{i+1}-l_{i}|" display="inline"><semantics id="S3.E11X.2.1.1.m1.1a"><mrow id="S3.E11X.2.1.1.m1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.E11X.2.1.1.m1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.2.1.cmml">|</mo><mrow id="S3.E11X.2.1.1.m1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E11X.2.1.1.m1.1.1.1.1.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2.cmml">l</mi><mrow id="S3.E11X.2.1.1.m1.1.1.1.1.2.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E11X.2.1.1.m1.1.1.1.1.1" xref="S3.E11X.2.1.1.m1.1.1.1.1.1.cmml">−</mo><msub id="S3.E11X.2.1.1.m1.1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E11X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E11X.2.1.1.m1.1.1.1.3" xref="S3.E11X.2.1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.2.1.1.m1.1b"><apply id="S3.E11X.2.1.1.m1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1"><abs id="S3.E11X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.2"></abs><apply id="S3.E11X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1"><minus id="S3.E11X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.1"></minus><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.2">𝑙</ci><apply id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3"><plus id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.1"></plus><ci id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E11X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E11X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E11X.2.1.1.m1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.2.1.1.m1.1c">\displaystyle|l_{i+1}-l_{i}|</annotation><annotation encoding="application/x-llamapun" id="S3.E11X.2.1.1.m1.1d">| italic_l start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E11X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\leq|h_{i+1}-h_{i}|" display="inline"><semantics id="S3.E11X.3.2.2.m1.1a"><mrow id="S3.E11X.3.2.2.m1.1.1" xref="S3.E11X.3.2.2.m1.1.1.cmml"><mi id="S3.E11X.3.2.2.m1.1.1.3" xref="S3.E11X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E11X.3.2.2.m1.1.1.2" xref="S3.E11X.3.2.2.m1.1.1.2.cmml">≤</mo><mrow id="S3.E11X.3.2.2.m1.1.1.1.1" xref="S3.E11X.3.2.2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11X.3.2.2.m1.1.1.1.1.2" xref="S3.E11X.3.2.2.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E11X.3.2.2.m1.1.1.1.1.1" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.cmml"><msub id="S3.E11X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.cmml"><mi id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.2" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.1" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.3" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E11X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E11X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E11X.3.2.2.m1.1.1.1.1.1.3.2" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E11X.3.2.2.m1.1.1.1.1.1.3.3" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E11X.3.2.2.m1.1.1.1.1.3" xref="S3.E11X.3.2.2.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11X.3.2.2.m1.1b"><apply id="S3.E11X.3.2.2.m1.1.1.cmml" xref="S3.E11X.3.2.2.m1.1.1"><leq id="S3.E11X.3.2.2.m1.1.1.2.cmml" xref="S3.E11X.3.2.2.m1.1.1.2"></leq><csymbol cd="latexml" id="S3.E11X.3.2.2.m1.1.1.3.cmml" xref="S3.E11X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E11X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1"><abs id="S3.E11X.3.2.2.m1.1.1.1.2.1.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.2"></abs><apply id="S3.E11X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1"><minus id="S3.E11X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.1"></minus><apply id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3"><plus id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E11X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11X.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E11X.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E11X.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E11X.3.2.2.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11X.3.2.2.m1.1c">\displaystyle\leq|h_{i+1}-h_{i}|</annotation><annotation encoding="application/x-llamapun" id="S3.E11X.3.2.2.m1.1d">≤ | italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.4" class="ltx_p"><span id="S3.SS1.p3.4.1" class="ltx_text ltx_font_bold">Proof</span> Just notice that, when the initial angle <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">θ</mi><mn id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\theta_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> between <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="{\mathbf{q}}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">𝐪</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝐪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">{\mathbf{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">bold_q</annotation></semantics></math> and <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="{\mathbf{k}}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">{\mathbf{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">bold_k</annotation></semantics></math> is <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mn id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><cn type="integer" id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">0</cn></annotation-xml></semantics></math>, the attention score can be simplified as:</p>
<table id="S3.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E12X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle a(s)" display="inline"><semantics id="S3.E12X.2.1.1.m1.1a"><mrow id="S3.E12X.2.1.1.m1.1.2" xref="S3.E12X.2.1.1.m1.1.2.cmml"><mi id="S3.E12X.2.1.1.m1.1.2.2" xref="S3.E12X.2.1.1.m1.1.2.2.cmml">a</mi><mo id="S3.E12X.2.1.1.m1.1.2.1" xref="S3.E12X.2.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.E12X.2.1.1.m1.1.2.3.2" xref="S3.E12X.2.1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.E12X.2.1.1.m1.1.2.3.2.1" xref="S3.E12X.2.1.1.m1.1.2.cmml">(</mo><mi id="S3.E12X.2.1.1.m1.1.1" xref="S3.E12X.2.1.1.m1.1.1.cmml">s</mi><mo stretchy="false" id="S3.E12X.2.1.1.m1.1.2.3.2.2" xref="S3.E12X.2.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.2.1.1.m1.1b"><apply id="S3.E12X.2.1.1.m1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.2"><times id="S3.E12X.2.1.1.m1.1.2.1.cmml" xref="S3.E12X.2.1.1.m1.1.2.1"></times><ci id="S3.E12X.2.1.1.m1.1.2.2.cmml" xref="S3.E12X.2.1.1.m1.1.2.2">𝑎</ci><ci id="S3.E12X.2.1.1.m1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.2.1.1.m1.1c">\displaystyle a(s)</annotation><annotation encoding="application/x-llamapun" id="S3.E12X.2.1.1.m1.1d">italic_a ( italic_s )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\text{Re}\left[\sum_{j=0}^{d/2-1}h_{j}e^{is\theta_{j}}\right]" display="inline"><semantics id="S3.E12X.3.2.2.m1.1a"><mrow id="S3.E12X.3.2.2.m1.1.1" xref="S3.E12X.3.2.2.m1.1.1.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.3" xref="S3.E12X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E12X.3.2.2.m1.1.1.2" xref="S3.E12X.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E12X.3.2.2.m1.1.1.1" xref="S3.E12X.3.2.2.m1.1.1.1.cmml"><mtext id="S3.E12X.3.2.2.m1.1.1.1.3" xref="S3.E12X.3.2.2.m1.1.1.1.3a.cmml">Re</mtext><mo id="S3.E12X.3.2.2.m1.1.1.1.2" xref="S3.E12X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.2.cmml"><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1a" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3.cmml">0</mn></mrow><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.1.cmml">/</mo><mn id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></mrow><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.cmml"><msub id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml">h</mi><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.2.cmml">e</mi><mrow id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.1" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.3.cmml">s</mi><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.1a" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><msub id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.cmml"><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.2" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.2.cmml">θ</mi><mi id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.3.cmml">j</mi></msub></mrow></msup></mrow></mrow><mo id="S3.E12X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E12X.3.2.2.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.3.2.2.m1.1b"><apply id="S3.E12X.3.2.2.m1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1"><eq id="S3.E12X.3.2.2.m1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E12X.3.2.2.m1.1.1.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E12X.3.2.2.m1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1"><times id="S3.E12X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.2"></times><ci id="S3.E12X.3.2.2.m1.1.1.1.3a.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.3"><mtext id="S3.E12X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.3">Re</mtext></ci><apply id="S3.E12X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12X.3.2.2.m1.1.1.1.1.2.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1"><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3"><eq id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.2.3.3">0</cn></apply></apply><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3"><minus id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.1"></minus><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2"><divide id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.1"></divide><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.2">𝑑</ci><cn type="integer" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2"><times id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.1"></times><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.2">ℎ</ci><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.2">𝑒</ci><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3"><times id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.1"></times><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.2">𝑖</ci><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.3">𝑠</ci><apply id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.1.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4">subscript</csymbol><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.2.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.2">𝜃</ci><ci id="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.3.cmml" xref="S3.E12X.3.2.2.m1.1.1.1.1.1.1.2.3.3.4.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.3.2.2.m1.1c">\displaystyle=\text{Re}\left[\sum_{j=0}^{d/2-1}h_{j}e^{is\theta_{j}}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E12X.3.2.2.m1.1d">= Re [ ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_i italic_s italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
<tr id="S3.E12Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E12Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=\sum_{j=0}^{d/2-1}l_{j}\text{cos}(s\theta_{j})" display="inline"><semantics id="S3.E12Xa.2.1.1.m1.1a"><mrow id="S3.E12Xa.2.1.1.m1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.3" xref="S3.E12Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E12Xa.2.1.1.m1.1.1.2" xref="S3.E12Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E12Xa.2.1.1.m1.1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E12Xa.2.1.1.m1.1.1.1.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.cmml"><munderover id="S3.E12Xa.2.1.1.m1.1.1.1.2a" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.E12Xa.2.1.1.m1.1.1.1.2.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.cmml"><mrow id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.2.cmml">d</mi><mo id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.1.cmml">/</mo><mn id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.3.cmml">2</mn></mrow><mo id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E12Xa.2.1.1.m1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E12Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E12Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E12Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mtext id="S3.E12Xa.2.1.1.m1.1.1.1.1.4" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.4a.cmml">cos</mtext><mo id="S3.E12Xa.2.1.1.m1.1.1.1.1.2a" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12Xa.2.1.1.m1.1b"><apply id="S3.E12Xa.2.1.1.m1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1"><eq id="S3.E12Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E12Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E12Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1"><apply id="S3.E12Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2">superscript</csymbol><apply id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2">subscript</csymbol><sum id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.2"></sum><apply id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3"><eq id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.1"></eq><ci id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3"><minus id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.1"></minus><apply id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2"><divide id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.1"></divide><ci id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.2">𝑑</ci><cn type="integer" id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.2.3">2</cn></apply><cn type="integer" id="S3.E12Xa.2.1.1.m1.1.1.1.2.3.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E12Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1"><times id="S3.E12Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.2"></times><apply id="S3.E12Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E12Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.3.3">𝑗</ci></apply><ci id="S3.E12Xa.2.1.1.m1.1.1.1.1.4a.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.4"><mtext id="S3.E12Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.4">cos</mtext></ci><apply id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1"><times id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12Xa.2.1.1.m1.1c">\displaystyle=\sum_{j=0}^{d/2-1}l_{j}\text{cos}(s\theta_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.E12Xa.2.1.1.m1.1d">= ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d / 2 - 1 end_POSTSUPERSCRIPT italic_l start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT cos ( italic_s italic_θ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p3.5" class="ltx_p">Then follow the study of <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>, will easily get the estimation in <a href="#S3.E10" title="10 ‣ 3.1 Strong form of Long-term decay ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.2" class="ltx_p">For Inequality <a href="#S3.E11" title="11 ‣ 3.1 Strong form of Long-term decay ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, with triangle inequality, we have:</p>
<table id="S3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle|h_{i+1}-h_{i}|\geq||h_{i+1}|-|h_{i}||" display="inline"><semantics id="S3.E13X.2.1.1.m1.2a"><mrow id="S3.E13X.2.1.1.m1.2.2" xref="S3.E13X.2.1.1.m1.2.2.cmml"><mrow id="S3.E13X.2.1.1.m1.1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E13X.2.1.1.m1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.cmml"><msub id="S3.E13X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.2" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.1" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E13X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E13X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.2" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E13X.2.1.1.m1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E13X.2.1.1.m1.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.3.cmml">≥</mo><mrow id="S3.E13X.2.1.1.m1.2.2.2.1" xref="S3.E13X.2.1.1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.2.2.2.1.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.cmml">|</mo><mrow id="S3.E13X.2.1.1.m1.2.2.2.1.1" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.cmml"><mrow id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.2.1.cmml">|</mo><msub id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.2" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.2" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.1" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.3" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E13X.2.1.1.m1.2.2.2.1.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.3.cmml">−</mo><mrow id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.2.cmml"><mo stretchy="false" id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.2" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.2.1.cmml">|</mo><msub id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.2" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.2.cmml">h</mi><mi id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E13X.2.1.1.m1.2.2.2.1.3" xref="S3.E13X.2.1.1.m1.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.2.1.1.m1.2b"><apply id="S3.E13X.2.1.1.m1.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2"><geq id="S3.E13X.2.1.1.m1.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.3"></geq><apply id="S3.E13X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1"><abs id="S3.E13X.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.2"></abs><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1"><minus id="S3.E13X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.1"></minus><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3"><plus id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E13X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1"><abs id="S3.E13X.2.1.1.m1.2.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.2"></abs><apply id="S3.E13X.2.1.1.m1.2.2.2.1.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1"><minus id="S3.E13X.2.1.1.m1.2.2.2.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.3"></minus><apply id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1"><abs id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.2"></abs><apply id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.2">ℎ</ci><apply id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3"><plus id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.1"></plus><ci id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1"><abs id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.2"></abs><apply id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.2">ℎ</ci><ci id="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.2.1.1.m1.2c">\displaystyle|h_{i+1}-h_{i}|\geq||h_{i+1}|-|h_{i}||</annotation><annotation encoding="application/x-llamapun" id="S3.E13X.2.1.1.m1.2d">| italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | ≥ | | italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT | - | italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p4.1" class="ltx_p">review the definition of <math id="S3.SS1.p4.1.m1.2" class="ltx_Math" alttext="h_{i}=(q_{j}+iq_{j+d/2})(k_{j}-ik_{j+d/2})" display="inline"><semantics id="S3.SS1.p4.1.m1.2a"><mrow id="S3.SS1.p4.1.m1.2.2" xref="S3.SS1.p4.1.m1.2.2.cmml"><msub id="S3.SS1.p4.1.m1.2.2.4" xref="S3.SS1.p4.1.m1.2.2.4.cmml"><mi id="S3.SS1.p4.1.m1.2.2.4.2" xref="S3.SS1.p4.1.m1.2.2.4.2.cmml">h</mi><mi id="S3.SS1.p4.1.m1.2.2.4.3" xref="S3.SS1.p4.1.m1.2.2.4.3.cmml">i</mi></msub><mo id="S3.SS1.p4.1.m1.2.2.3" xref="S3.SS1.p4.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.p4.1.m1.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.cmml"><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.2.cmml">q</mi><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.2.cmml">j</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.1.cmml">+</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.2.cmml">d</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.1.cmml">/</mo><mn id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p4.1.m1.2.2.2.3" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS1.p4.1.m1.2.2.2.2.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.2.2.2.2.1.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.p4.1.m1.2.2.2.2.1.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml"><msub id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.2.cmml">k</mi><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p4.1.m1.2.2.2.2.1.1.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.1.cmml">−</mo><mrow id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><msub id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.2.cmml">k</mi><mrow id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.2.cmml">j</mi><mo id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.1.cmml">+</mo><mrow id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.2.cmml">d</mi><mo id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.1.cmml">/</mo><mn id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.3.cmml">2</mn></mrow></mrow></msub></mrow></mrow><mo stretchy="false" id="S3.SS1.p4.1.m1.2.2.2.2.1.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.2b"><apply id="S3.SS1.p4.1.m1.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2"><eq id="S3.SS1.p4.1.m1.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.3"></eq><apply id="S3.SS1.p4.1.m1.2.2.4.cmml" xref="S3.SS1.p4.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.4.1.cmml" xref="S3.SS1.p4.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.4.2.cmml" xref="S3.SS1.p4.1.m1.2.2.4.2">ℎ</ci><ci id="S3.SS1.p4.1.m1.2.2.4.3.cmml" xref="S3.SS1.p4.1.m1.2.2.4.3">𝑖</ci></apply><apply id="S3.SS1.p4.1.m1.2.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2"><times id="S3.SS1.p4.1.m1.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.3"></times><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1"><plus id="S3.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3"><times id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.2">𝑖</ci><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.2">𝑞</ci><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3"><plus id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.1"></plus><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.2">𝑗</ci><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3"><divide id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.1"></divide><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1"><minus id="S3.SS1.p4.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.1"></minus><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.2">𝑘</ci><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3"><times id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.1"></times><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.2">𝑖</ci><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.2">𝑘</ci><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3"><plus id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.1"></plus><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.2">𝑗</ci><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3"><divide id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.1"></divide><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.2">𝑑</ci><cn type="integer" id="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.3.3.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.2c">h_{i}=(q_{j}+iq_{j+d/2})(k_{j}-ik_{j+d/2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.2d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_i italic_q start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT ) ( italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_i italic_k start_POSTSUBSCRIPT italic_j + italic_d / 2 end_POSTSUBSCRIPT )</annotation></semantics></math>, we have:</p>
<table id="S3.E14" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E14X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle|h_{i+1}-h_{i}|" display="inline"><semantics id="S3.E14X.2.1.1.m1.1a"><mrow id="S3.E14X.2.1.1.m1.1.1.1" xref="S3.E14X.2.1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.E14X.2.1.1.m1.1.1.1.2" xref="S3.E14X.2.1.1.m1.1.1.2.1.cmml">|</mo><mrow id="S3.E14X.2.1.1.m1.1.1.1.1" xref="S3.E14X.2.1.1.m1.1.1.1.1.cmml"><msub id="S3.E14X.2.1.1.m1.1.1.1.1.2" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.cmml"><mi id="S3.E14X.2.1.1.m1.1.1.1.1.2.2" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E14X.2.1.1.m1.1.1.1.1.2.3" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.cmml"><mi id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.2" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.1" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.3" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E14X.2.1.1.m1.1.1.1.1.1" xref="S3.E14X.2.1.1.m1.1.1.1.1.1.cmml">−</mo><msub id="S3.E14X.2.1.1.m1.1.1.1.1.3" xref="S3.E14X.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E14X.2.1.1.m1.1.1.1.1.3.2" xref="S3.E14X.2.1.1.m1.1.1.1.1.3.2.cmml">h</mi><mi id="S3.E14X.2.1.1.m1.1.1.1.1.3.3" xref="S3.E14X.2.1.1.m1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E14X.2.1.1.m1.1.1.1.3" xref="S3.E14X.2.1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14X.2.1.1.m1.1b"><apply id="S3.E14X.2.1.1.m1.1.1.2.cmml" xref="S3.E14X.2.1.1.m1.1.1.1"><abs id="S3.E14X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.2"></abs><apply id="S3.E14X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1"><minus id="S3.E14X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.1"></minus><apply id="S3.E14X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14X.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3"><plus id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.1"></plus><ci id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E14X.2.1.1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E14X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14X.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14X.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.3.2">ℎ</ci><ci id="S3.E14X.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E14X.2.1.1.m1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14X.2.1.1.m1.1c">\displaystyle|h_{i+1}-h_{i}|</annotation><annotation encoding="application/x-llamapun" id="S3.E14X.2.1.1.m1.1d">| italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\geq||h_{i+1}|-|h_{i}||" display="inline"><semantics id="S3.E14X.3.2.2.m1.1a"><mrow id="S3.E14X.3.2.2.m1.1.1" xref="S3.E14X.3.2.2.m1.1.1.cmml"><mi id="S3.E14X.3.2.2.m1.1.1.3" xref="S3.E14X.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E14X.3.2.2.m1.1.1.2" xref="S3.E14X.3.2.2.m1.1.1.2.cmml">≥</mo><mrow id="S3.E14X.3.2.2.m1.1.1.1.1" xref="S3.E14X.3.2.2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14X.3.2.2.m1.1.1.1.1.2" xref="S3.E14X.3.2.2.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E14X.3.2.2.m1.1.1.1.1.1" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E14X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.2" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.2.1.cmml">|</mo><msub id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.cmml"><mi id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.2" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.2.cmml">h</mi><mi id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.3" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.3" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E14X.3.2.2.m1.1.1.1.1.3" xref="S3.E14X.3.2.2.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14X.3.2.2.m1.1b"><apply id="S3.E14X.3.2.2.m1.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1"><geq id="S3.E14X.3.2.2.m1.1.1.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.2"></geq><csymbol cd="latexml" id="S3.E14X.3.2.2.m1.1.1.3.cmml" xref="S3.E14X.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E14X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1"><abs id="S3.E14X.3.2.2.m1.1.1.1.2.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.2"></abs><apply id="S3.E14X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1"><minus id="S3.E14X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.3"></minus><apply id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1"><abs id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3"><plus id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1"><abs id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.2"></abs><apply id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.2">ℎ</ci><ci id="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E14X.3.2.2.m1.1.1.1.1.1.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14X.3.2.2.m1.1c">\displaystyle\geq||h_{i+1}|-|h_{i}||</annotation><annotation encoding="application/x-llamapun" id="S3.E14X.3.2.2.m1.1d">≥ | | italic_h start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT | - | italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(14)</span></td>
</tr>
<tr id="S3.E14Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=||{\mathbf{q}}_{i+1}{\mathbf{k}}^{*}_{i+1}|-|{\mathbf{q}}_{i}{\mathbf{k}}^{*}_{i}||" display="inline"><semantics id="S3.E14Xa.2.1.1.m1.1a"><mrow id="S3.E14Xa.2.1.1.m1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E14Xa.2.1.1.m1.1.1.2" xref="S3.E14Xa.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.cmml"><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐪</mi><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐤</mi><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">*</mo></msubsup></mrow><mo stretchy="false" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.2.1.cmml">|</mo><mrow id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.cmml"><msub id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.2.cmml">𝐪</mi><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.1" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.1.cmml">⁢</mo><msubsup id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.cmml"><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.2" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.2.cmml">𝐤</mi><mi id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.3.cmml">i</mi><mo id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.3.cmml">*</mo></msubsup></mrow><mo stretchy="false" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E14Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E14Xa.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14Xa.2.1.1.m1.1b"><apply id="S3.E14Xa.2.1.1.m1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1"><eq id="S3.E14Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E14Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E14Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1"><abs id="S3.E14Xa.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.2"></abs><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1"><minus id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.3"></minus><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1"><abs id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1"><times id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">𝐪</ci><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><plus id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝐤</ci><times id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.3"></times></apply><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><plus id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1"><abs id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.2"></abs><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1"><times id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.1"></times><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2">subscript</csymbol><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.2">𝐪</ci><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3">subscript</csymbol><apply id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.1.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3">superscript</csymbol><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.2.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.2">𝐤</ci><times id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.3"></times></apply><ci id="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.3.cmml" xref="S3.E14Xa.2.1.1.m1.1.1.1.1.1.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14Xa.2.1.1.m1.1c">\displaystyle=||{\mathbf{q}}_{i+1}{\mathbf{k}}^{*}_{i+1}|-|{\mathbf{q}}_{i}{\mathbf{k}}^{*}_{i}||</annotation><annotation encoding="application/x-llamapun" id="S3.E14Xa.2.1.1.m1.1d">= | | bold_q start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT bold_k start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT | - | bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_k start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E14Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=||{\mathbf{q}}_{i+1}{\mathbf{k}}_{i+1}|-|{\mathbf{q}}_{i}{\mathbf{k}}_{i}||" display="inline"><semantics id="S3.E14Xb.2.1.1.m1.1a"><mrow id="S3.E14Xb.2.1.1.m1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E14Xb.2.1.1.m1.1.1.2" xref="S3.E14Xb.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14Xb.2.1.1.m1.1.1.1.1.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.cmml"><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐪</mi><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐤</mi><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.2.1.cmml">|</mo><mrow id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.cmml"><msub id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.2.cmml">𝐪</mi><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.1" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.1.cmml">⁢</mo><msub id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.cmml"><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.2" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.cmml">𝐤</mi><mi id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.E14Xb.2.1.1.m1.1.1.1.1.3" xref="S3.E14Xb.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14Xb.2.1.1.m1.1b"><apply id="S3.E14Xb.2.1.1.m1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1"><eq id="S3.E14Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E14Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E14Xb.2.1.1.m1.1.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1"><abs id="S3.E14Xb.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.2"></abs><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1"><minus id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.3"></minus><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1"><abs id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1"><times id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.2">𝐪</ci><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3"><plus id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝐤</ci><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3"><plus id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.1"></plus><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1"><abs id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.2"></abs><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1"><times id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.1"></times><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.2">𝐪</ci><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.2">𝐤</ci><ci id="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.3.cmml" xref="S3.E14Xb.2.1.1.m1.1.1.1.1.1.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14Xb.2.1.1.m1.1c">\displaystyle=||{\mathbf{q}}_{i+1}{\mathbf{k}}_{i+1}|-|{\mathbf{q}}_{i}{\mathbf{k}}_{i}||</annotation><annotation encoding="application/x-llamapun" id="S3.E14Xb.2.1.1.m1.1d">= | | bold_q start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT bold_k start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT | - | bold_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E14Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=|l_{i+1}-l_{i}|" display="inline"><semantics id="S3.E14Xc.2.1.1.m1.1a"><mrow id="S3.E14Xc.2.1.1.m1.1.1" xref="S3.E14Xc.2.1.1.m1.1.1.cmml"><mi id="S3.E14Xc.2.1.1.m1.1.1.3" xref="S3.E14Xc.2.1.1.m1.1.1.3.cmml"></mi><mo id="S3.E14Xc.2.1.1.m1.1.1.2" xref="S3.E14Xc.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E14Xc.2.1.1.m1.1.1.1.1" xref="S3.E14Xc.2.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E14Xc.2.1.1.m1.1.1.1.1.2" xref="S3.E14Xc.2.1.1.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E14Xc.2.1.1.m1.1.1.1.1.1" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.cmml"><msub id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.2" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.2.cmml">l</mi><mrow id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.2" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.1" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.3" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.1" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.2" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.3" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E14Xc.2.1.1.m1.1.1.1.1.3" xref="S3.E14Xc.2.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14Xc.2.1.1.m1.1b"><apply id="S3.E14Xc.2.1.1.m1.1.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1"><eq id="S3.E14Xc.2.1.1.m1.1.1.2.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E14Xc.2.1.1.m1.1.1.3.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.3">absent</csymbol><apply id="S3.E14Xc.2.1.1.m1.1.1.1.2.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1"><abs id="S3.E14Xc.2.1.1.m1.1.1.1.2.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.2"></abs><apply id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1"><minus id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.1"></minus><apply id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.2">𝑙</ci><apply id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3"><plus id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E14Xc.2.1.1.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14Xc.2.1.1.m1.1c">\displaystyle=|l_{i+1}-l_{i}|</annotation><annotation encoding="application/x-llamapun" id="S3.E14Xc.2.1.1.m1.1d">= | italic_l start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT - italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Computational and spatial complexity</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We assign some notations before analysing, see Table <a href="#S3.T1" title="Table 1 ‣ 3.2 Computational and spatial complexity ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Some Notations</figcaption>
<table id="S3.T1.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.5.6.1" class="ltx_tr">
<th id="S3.T1.5.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.5.6.1.1.1" class="ltx_text ltx_font_bold">Variable</span></th>
<th id="S3.T1.5.6.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T1.5.6.1.2.1" class="ltx_text ltx_font_bold">Notation</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_left ltx_border_t">embedding-size</td>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">italic_V</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_left">sequence length</td>
<td id="S3.T1.2.2.1" class="ltx_td ltx_align_left"><math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.T1.2.2.1.m1.1a"><mi id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.1.m1.1d">italic_n</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.3.3" class="ltx_tr">
<td id="S3.T1.3.3.2" class="ltx_td ltx_align_left">number of layers</td>
<td id="S3.T1.3.3.1" class="ltx_td ltx_align_left"><math id="S3.T1.3.3.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.T1.3.3.1.m1.1a"><mi id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><ci id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.1.m1.1d">italic_L</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<td id="S3.T1.4.4.2" class="ltx_td ltx_align_left">number of heads per layer</td>
<td id="S3.T1.4.4.1" class="ltx_td ltx_align_left"><math id="S3.T1.4.4.1.m1.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.T1.4.4.1.m1.1a"><mi id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><ci id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.1.m1.1d">italic_h</annotation></semantics></math></td>
</tr>
<tr id="S3.T1.5.5" class="ltx_tr">
<td id="S3.T1.5.5.2" class="ltx_td ltx_align_left">hidden dimension</td>
<td id="S3.T1.5.5.1" class="ltx_td ltx_align_left"><math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><mi id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><ci id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.1.m1.1d">italic_d</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Computational complexity</figcaption>
<table id="S3.T2.15" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.15.16.1" class="ltx_tr">
<th id="S3.T2.15.16.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T2.15.16.1.1.1" class="ltx_text ltx_font_bold">COMPONENT</span></th>
<th id="S3.T2.15.16.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T2.15.16.1.2.1" class="ltx_text ltx_font_bold">Complexity Of Origin Model</span></th>
<th id="S3.T2.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S3.T2.15.16.1.3.1" class="ltx_text ltx_font_bold">Complexity Of CoCA</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.2.2" class="ltx_tr">
<td id="S3.T2.2.2.3" class="ltx_td ltx_align_left ltx_border_t">QK(T)V projection</td>
<td id="S3.T2.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><math id="S3.T2.1.1.1.m1.1" class="ltx_Math" alttext="3Vnd+3(L-1)nd^{2}" display="inline"><semantics id="S3.T2.1.1.1.m1.1a"><mrow id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml"><mrow id="S3.T2.1.1.1.m1.1.1.3" xref="S3.T2.1.1.1.m1.1.1.3.cmml"><mn id="S3.T2.1.1.1.m1.1.1.3.2" xref="S3.T2.1.1.1.m1.1.1.3.2.cmml">3</mn><mo id="S3.T2.1.1.1.m1.1.1.3.1" xref="S3.T2.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T2.1.1.1.m1.1.1.3.3" xref="S3.T2.1.1.1.m1.1.1.3.3.cmml">V</mi><mo id="S3.T2.1.1.1.m1.1.1.3.1a" xref="S3.T2.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T2.1.1.1.m1.1.1.3.4" xref="S3.T2.1.1.1.m1.1.1.3.4.cmml">n</mi><mo id="S3.T2.1.1.1.m1.1.1.3.1b" xref="S3.T2.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T2.1.1.1.m1.1.1.3.5" xref="S3.T2.1.1.1.m1.1.1.3.5.cmml">d</mi></mrow><mo id="S3.T2.1.1.1.m1.1.1.2" xref="S3.T2.1.1.1.m1.1.1.2.cmml">+</mo><mrow id="S3.T2.1.1.1.m1.1.1.1" xref="S3.T2.1.1.1.m1.1.1.1.cmml"><mn id="S3.T2.1.1.1.m1.1.1.1.3" xref="S3.T2.1.1.1.m1.1.1.1.3.cmml">3</mn><mo id="S3.T2.1.1.1.m1.1.1.1.2" xref="S3.T2.1.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.T2.1.1.1.m1.1.1.1.1.1" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.T2.1.1.1.m1.1.1.1.1.1.2" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T2.1.1.1.m1.1.1.1.1.1.1" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.T2.1.1.1.m1.1.1.1.1.1.1.2" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.T2.1.1.1.m1.1.1.1.1.1.1.1" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.T2.1.1.1.m1.1.1.1.1.1.1.3" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.T2.1.1.1.m1.1.1.1.1.1.3" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.T2.1.1.1.m1.1.1.1.2a" xref="S3.T2.1.1.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.T2.1.1.1.m1.1.1.1.4" xref="S3.T2.1.1.1.m1.1.1.1.4.cmml">n</mi><mo id="S3.T2.1.1.1.m1.1.1.1.2b" xref="S3.T2.1.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.T2.1.1.1.m1.1.1.1.5" xref="S3.T2.1.1.1.m1.1.1.1.5.cmml"><mi id="S3.T2.1.1.1.m1.1.1.1.5.2" xref="S3.T2.1.1.1.m1.1.1.1.5.2.cmml">d</mi><mn id="S3.T2.1.1.1.m1.1.1.1.5.3" xref="S3.T2.1.1.1.m1.1.1.1.5.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.1b"><apply id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1"><plus id="S3.T2.1.1.1.m1.1.1.2.cmml" xref="S3.T2.1.1.1.m1.1.1.2"></plus><apply id="S3.T2.1.1.1.m1.1.1.3.cmml" xref="S3.T2.1.1.1.m1.1.1.3"><times id="S3.T2.1.1.1.m1.1.1.3.1.cmml" xref="S3.T2.1.1.1.m1.1.1.3.1"></times><cn type="integer" id="S3.T2.1.1.1.m1.1.1.3.2.cmml" xref="S3.T2.1.1.1.m1.1.1.3.2">3</cn><ci id="S3.T2.1.1.1.m1.1.1.3.3.cmml" xref="S3.T2.1.1.1.m1.1.1.3.3">𝑉</ci><ci id="S3.T2.1.1.1.m1.1.1.3.4.cmml" xref="S3.T2.1.1.1.m1.1.1.3.4">𝑛</ci><ci id="S3.T2.1.1.1.m1.1.1.3.5.cmml" xref="S3.T2.1.1.1.m1.1.1.3.5">𝑑</ci></apply><apply id="S3.T2.1.1.1.m1.1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1.1"><times id="S3.T2.1.1.1.m1.1.1.1.2.cmml" xref="S3.T2.1.1.1.m1.1.1.1.2"></times><cn type="integer" id="S3.T2.1.1.1.m1.1.1.1.3.cmml" xref="S3.T2.1.1.1.m1.1.1.1.3">3</cn><apply id="S3.T2.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1.1.1.1"><minus id="S3.T2.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.1"></minus><ci id="S3.T2.1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.T2.1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.T2.1.1.1.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.T2.1.1.1.m1.1.1.1.4.cmml" xref="S3.T2.1.1.1.m1.1.1.1.4">𝑛</ci><apply id="S3.T2.1.1.1.m1.1.1.1.5.cmml" xref="S3.T2.1.1.1.m1.1.1.1.5"><csymbol cd="ambiguous" id="S3.T2.1.1.1.m1.1.1.1.5.1.cmml" xref="S3.T2.1.1.1.m1.1.1.1.5">superscript</csymbol><ci id="S3.T2.1.1.1.m1.1.1.1.5.2.cmml" xref="S3.T2.1.1.1.m1.1.1.1.5.2">𝑑</ci><cn type="integer" id="S3.T2.1.1.1.m1.1.1.1.5.3.cmml" xref="S3.T2.1.1.1.m1.1.1.1.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.1c">3Vnd+3(L-1)nd^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.m1.1d">3 italic_V italic_n italic_d + 3 ( italic_L - 1 ) italic_n italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T2.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><math id="S3.T2.2.2.2.m1.1" class="ltx_Math" alttext="3Vnd+3(L-1)nd^{2}" display="inline"><semantics id="S3.T2.2.2.2.m1.1a"><mrow id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml"><mrow id="S3.T2.2.2.2.m1.1.1.3" xref="S3.T2.2.2.2.m1.1.1.3.cmml"><mn id="S3.T2.2.2.2.m1.1.1.3.2" xref="S3.T2.2.2.2.m1.1.1.3.2.cmml">3</mn><mo id="S3.T2.2.2.2.m1.1.1.3.1" xref="S3.T2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T2.2.2.2.m1.1.1.3.3" xref="S3.T2.2.2.2.m1.1.1.3.3.cmml">V</mi><mo id="S3.T2.2.2.2.m1.1.1.3.1a" xref="S3.T2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T2.2.2.2.m1.1.1.3.4" xref="S3.T2.2.2.2.m1.1.1.3.4.cmml">n</mi><mo id="S3.T2.2.2.2.m1.1.1.3.1b" xref="S3.T2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T2.2.2.2.m1.1.1.3.5" xref="S3.T2.2.2.2.m1.1.1.3.5.cmml">d</mi></mrow><mo id="S3.T2.2.2.2.m1.1.1.2" xref="S3.T2.2.2.2.m1.1.1.2.cmml">+</mo><mrow id="S3.T2.2.2.2.m1.1.1.1" xref="S3.T2.2.2.2.m1.1.1.1.cmml"><mn id="S3.T2.2.2.2.m1.1.1.1.3" xref="S3.T2.2.2.2.m1.1.1.1.3.cmml">3</mn><mo id="S3.T2.2.2.2.m1.1.1.1.2" xref="S3.T2.2.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.T2.2.2.2.m1.1.1.1.1.1" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.T2.2.2.2.m1.1.1.1.1.1.2" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.T2.2.2.2.m1.1.1.1.1.1.1" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.T2.2.2.2.m1.1.1.1.1.1.1.2" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.2.cmml">L</mi><mo id="S3.T2.2.2.2.m1.1.1.1.1.1.1.1" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.T2.2.2.2.m1.1.1.1.1.1.1.3" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.T2.2.2.2.m1.1.1.1.1.1.3" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.T2.2.2.2.m1.1.1.1.2a" xref="S3.T2.2.2.2.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.T2.2.2.2.m1.1.1.1.4" xref="S3.T2.2.2.2.m1.1.1.1.4.cmml">n</mi><mo id="S3.T2.2.2.2.m1.1.1.1.2b" xref="S3.T2.2.2.2.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.T2.2.2.2.m1.1.1.1.5" xref="S3.T2.2.2.2.m1.1.1.1.5.cmml"><mi id="S3.T2.2.2.2.m1.1.1.1.5.2" xref="S3.T2.2.2.2.m1.1.1.1.5.2.cmml">d</mi><mn id="S3.T2.2.2.2.m1.1.1.1.5.3" xref="S3.T2.2.2.2.m1.1.1.1.5.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.1b"><apply id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1"><plus id="S3.T2.2.2.2.m1.1.1.2.cmml" xref="S3.T2.2.2.2.m1.1.1.2"></plus><apply id="S3.T2.2.2.2.m1.1.1.3.cmml" xref="S3.T2.2.2.2.m1.1.1.3"><times id="S3.T2.2.2.2.m1.1.1.3.1.cmml" xref="S3.T2.2.2.2.m1.1.1.3.1"></times><cn type="integer" id="S3.T2.2.2.2.m1.1.1.3.2.cmml" xref="S3.T2.2.2.2.m1.1.1.3.2">3</cn><ci id="S3.T2.2.2.2.m1.1.1.3.3.cmml" xref="S3.T2.2.2.2.m1.1.1.3.3">𝑉</ci><ci id="S3.T2.2.2.2.m1.1.1.3.4.cmml" xref="S3.T2.2.2.2.m1.1.1.3.4">𝑛</ci><ci id="S3.T2.2.2.2.m1.1.1.3.5.cmml" xref="S3.T2.2.2.2.m1.1.1.3.5">𝑑</ci></apply><apply id="S3.T2.2.2.2.m1.1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1.1"><times id="S3.T2.2.2.2.m1.1.1.1.2.cmml" xref="S3.T2.2.2.2.m1.1.1.1.2"></times><cn type="integer" id="S3.T2.2.2.2.m1.1.1.1.3.cmml" xref="S3.T2.2.2.2.m1.1.1.1.3">3</cn><apply id="S3.T2.2.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1.1.1.1"><minus id="S3.T2.2.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.1"></minus><ci id="S3.T2.2.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.2">𝐿</ci><cn type="integer" id="S3.T2.2.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.T2.2.2.2.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.T2.2.2.2.m1.1.1.1.4.cmml" xref="S3.T2.2.2.2.m1.1.1.1.4">𝑛</ci><apply id="S3.T2.2.2.2.m1.1.1.1.5.cmml" xref="S3.T2.2.2.2.m1.1.1.1.5"><csymbol cd="ambiguous" id="S3.T2.2.2.2.m1.1.1.1.5.1.cmml" xref="S3.T2.2.2.2.m1.1.1.1.5">superscript</csymbol><ci id="S3.T2.2.2.2.m1.1.1.1.5.2.cmml" xref="S3.T2.2.2.2.m1.1.1.1.5.2">𝑑</ci><cn type="integer" id="S3.T2.2.2.2.m1.1.1.1.5.3.cmml" xref="S3.T2.2.2.2.m1.1.1.1.5.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.1c">3Vnd+3(L-1)nd^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.m1.1d">3 italic_V italic_n italic_d + 3 ( italic_L - 1 ) italic_n italic_d start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.3.3" class="ltx_tr">
<td id="S3.T2.3.3.2" class="ltx_td ltx_align_left">T half</td>
<td id="S3.T2.3.3.3" class="ltx_td ltx_align_left">-</td>
<td id="S3.T2.3.3.1" class="ltx_td ltx_align_left"><math id="S3.T2.3.3.1.m1.1" class="ltx_Math" alttext="Lnd" display="inline"><semantics id="S3.T2.3.3.1.m1.1a"><mrow id="S3.T2.3.3.1.m1.1.1" xref="S3.T2.3.3.1.m1.1.1.cmml"><mi id="S3.T2.3.3.1.m1.1.1.2" xref="S3.T2.3.3.1.m1.1.1.2.cmml">L</mi><mo id="S3.T2.3.3.1.m1.1.1.1" xref="S3.T2.3.3.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.3.3.1.m1.1.1.3" xref="S3.T2.3.3.1.m1.1.1.3.cmml">n</mi><mo id="S3.T2.3.3.1.m1.1.1.1a" xref="S3.T2.3.3.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.3.3.1.m1.1.1.4" xref="S3.T2.3.3.1.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.1.m1.1b"><apply id="S3.T2.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.1.m1.1.1"><times id="S3.T2.3.3.1.m1.1.1.1.cmml" xref="S3.T2.3.3.1.m1.1.1.1"></times><ci id="S3.T2.3.3.1.m1.1.1.2.cmml" xref="S3.T2.3.3.1.m1.1.1.2">𝐿</ci><ci id="S3.T2.3.3.1.m1.1.1.3.cmml" xref="S3.T2.3.3.1.m1.1.1.3">𝑛</ci><ci id="S3.T2.3.3.1.m1.1.1.4.cmml" xref="S3.T2.3.3.1.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.1.m1.1c">Lnd</annotation><annotation encoding="application/x-llamapun" id="S3.T2.3.3.1.m1.1d">italic_L italic_n italic_d</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.4.4" class="ltx_tr">
<td id="S3.T2.4.4.2" class="ltx_td ltx_align_left">T Relu</td>
<td id="S3.T2.4.4.3" class="ltx_td ltx_align_left">-</td>
<td id="S3.T2.4.4.1" class="ltx_td ltx_align_left"><math id="S3.T2.4.4.1.m1.1" class="ltx_Math" alttext="Lnd" display="inline"><semantics id="S3.T2.4.4.1.m1.1a"><mrow id="S3.T2.4.4.1.m1.1.1" xref="S3.T2.4.4.1.m1.1.1.cmml"><mi id="S3.T2.4.4.1.m1.1.1.2" xref="S3.T2.4.4.1.m1.1.1.2.cmml">L</mi><mo id="S3.T2.4.4.1.m1.1.1.1" xref="S3.T2.4.4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.4.4.1.m1.1.1.3" xref="S3.T2.4.4.1.m1.1.1.3.cmml">n</mi><mo id="S3.T2.4.4.1.m1.1.1.1a" xref="S3.T2.4.4.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.4.4.1.m1.1.1.4" xref="S3.T2.4.4.1.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.1.m1.1b"><apply id="S3.T2.4.4.1.m1.1.1.cmml" xref="S3.T2.4.4.1.m1.1.1"><times id="S3.T2.4.4.1.m1.1.1.1.cmml" xref="S3.T2.4.4.1.m1.1.1.1"></times><ci id="S3.T2.4.4.1.m1.1.1.2.cmml" xref="S3.T2.4.4.1.m1.1.1.2">𝐿</ci><ci id="S3.T2.4.4.1.m1.1.1.3.cmml" xref="S3.T2.4.4.1.m1.1.1.3">𝑛</ci><ci id="S3.T2.4.4.1.m1.1.1.4.cmml" xref="S3.T2.4.4.1.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.1.m1.1c">Lnd</annotation><annotation encoding="application/x-llamapun" id="S3.T2.4.4.1.m1.1d">italic_L italic_n italic_d</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.6.6" class="ltx_tr">
<td id="S3.T2.6.6.3" class="ltx_td ltx_align_left">QK(T) rotary</td>
<td id="S3.T2.5.5.1" class="ltx_td ltx_align_left"><math id="S3.T2.5.5.1.m1.1" class="ltx_Math" alttext="2Lnd" display="inline"><semantics id="S3.T2.5.5.1.m1.1a"><mrow id="S3.T2.5.5.1.m1.1.1" xref="S3.T2.5.5.1.m1.1.1.cmml"><mn id="S3.T2.5.5.1.m1.1.1.2" xref="S3.T2.5.5.1.m1.1.1.2.cmml">2</mn><mo id="S3.T2.5.5.1.m1.1.1.1" xref="S3.T2.5.5.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.5.5.1.m1.1.1.3" xref="S3.T2.5.5.1.m1.1.1.3.cmml">L</mi><mo id="S3.T2.5.5.1.m1.1.1.1a" xref="S3.T2.5.5.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.5.5.1.m1.1.1.4" xref="S3.T2.5.5.1.m1.1.1.4.cmml">n</mi><mo id="S3.T2.5.5.1.m1.1.1.1b" xref="S3.T2.5.5.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.5.5.1.m1.1.1.5" xref="S3.T2.5.5.1.m1.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.1.m1.1b"><apply id="S3.T2.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.1.m1.1.1"><times id="S3.T2.5.5.1.m1.1.1.1.cmml" xref="S3.T2.5.5.1.m1.1.1.1"></times><cn type="integer" id="S3.T2.5.5.1.m1.1.1.2.cmml" xref="S3.T2.5.5.1.m1.1.1.2">2</cn><ci id="S3.T2.5.5.1.m1.1.1.3.cmml" xref="S3.T2.5.5.1.m1.1.1.3">𝐿</ci><ci id="S3.T2.5.5.1.m1.1.1.4.cmml" xref="S3.T2.5.5.1.m1.1.1.4">𝑛</ci><ci id="S3.T2.5.5.1.m1.1.1.5.cmml" xref="S3.T2.5.5.1.m1.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.1.m1.1c">2Lnd</annotation><annotation encoding="application/x-llamapun" id="S3.T2.5.5.1.m1.1d">2 italic_L italic_n italic_d</annotation></semantics></math></td>
<td id="S3.T2.6.6.2" class="ltx_td ltx_align_left"><math id="S3.T2.6.6.2.m1.1" class="ltx_Math" alttext="2Lnd" display="inline"><semantics id="S3.T2.6.6.2.m1.1a"><mrow id="S3.T2.6.6.2.m1.1.1" xref="S3.T2.6.6.2.m1.1.1.cmml"><mn id="S3.T2.6.6.2.m1.1.1.2" xref="S3.T2.6.6.2.m1.1.1.2.cmml">2</mn><mo id="S3.T2.6.6.2.m1.1.1.1" xref="S3.T2.6.6.2.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.6.6.2.m1.1.1.3" xref="S3.T2.6.6.2.m1.1.1.3.cmml">L</mi><mo id="S3.T2.6.6.2.m1.1.1.1a" xref="S3.T2.6.6.2.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.6.6.2.m1.1.1.4" xref="S3.T2.6.6.2.m1.1.1.4.cmml">n</mi><mo id="S3.T2.6.6.2.m1.1.1.1b" xref="S3.T2.6.6.2.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.6.6.2.m1.1.1.5" xref="S3.T2.6.6.2.m1.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.2.m1.1b"><apply id="S3.T2.6.6.2.m1.1.1.cmml" xref="S3.T2.6.6.2.m1.1.1"><times id="S3.T2.6.6.2.m1.1.1.1.cmml" xref="S3.T2.6.6.2.m1.1.1.1"></times><cn type="integer" id="S3.T2.6.6.2.m1.1.1.2.cmml" xref="S3.T2.6.6.2.m1.1.1.2">2</cn><ci id="S3.T2.6.6.2.m1.1.1.3.cmml" xref="S3.T2.6.6.2.m1.1.1.3">𝐿</ci><ci id="S3.T2.6.6.2.m1.1.1.4.cmml" xref="S3.T2.6.6.2.m1.1.1.4">𝑛</ci><ci id="S3.T2.6.6.2.m1.1.1.5.cmml" xref="S3.T2.6.6.2.m1.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.2.m1.1c">2Lnd</annotation><annotation encoding="application/x-llamapun" id="S3.T2.6.6.2.m1.1d">2 italic_L italic_n italic_d</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.8.8" class="ltx_tr">
<td id="S3.T2.7.7.1" class="ltx_td ltx_align_left"><math id="S3.T2.7.7.1.m1.1" class="ltx_Math" alttext="\text{K}=\text{Q}\circ\text{T}" display="inline"><semantics id="S3.T2.7.7.1.m1.1a"><mrow id="S3.T2.7.7.1.m1.1.1" xref="S3.T2.7.7.1.m1.1.1.cmml"><mtext id="S3.T2.7.7.1.m1.1.1.2" xref="S3.T2.7.7.1.m1.1.1.2a.cmml">K</mtext><mo id="S3.T2.7.7.1.m1.1.1.1" xref="S3.T2.7.7.1.m1.1.1.1.cmml">=</mo><mrow id="S3.T2.7.7.1.m1.1.1.3" xref="S3.T2.7.7.1.m1.1.1.3.cmml"><mtext id="S3.T2.7.7.1.m1.1.1.3.2" xref="S3.T2.7.7.1.m1.1.1.3.2a.cmml">Q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.T2.7.7.1.m1.1.1.3.1" xref="S3.T2.7.7.1.m1.1.1.3.1.cmml">∘</mo><mtext id="S3.T2.7.7.1.m1.1.1.3.3" xref="S3.T2.7.7.1.m1.1.1.3.3a.cmml">T</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.1.m1.1b"><apply id="S3.T2.7.7.1.m1.1.1.cmml" xref="S3.T2.7.7.1.m1.1.1"><eq id="S3.T2.7.7.1.m1.1.1.1.cmml" xref="S3.T2.7.7.1.m1.1.1.1"></eq><ci id="S3.T2.7.7.1.m1.1.1.2a.cmml" xref="S3.T2.7.7.1.m1.1.1.2"><mtext id="S3.T2.7.7.1.m1.1.1.2.cmml" xref="S3.T2.7.7.1.m1.1.1.2">K</mtext></ci><apply id="S3.T2.7.7.1.m1.1.1.3.cmml" xref="S3.T2.7.7.1.m1.1.1.3"><compose id="S3.T2.7.7.1.m1.1.1.3.1.cmml" xref="S3.T2.7.7.1.m1.1.1.3.1"></compose><ci id="S3.T2.7.7.1.m1.1.1.3.2a.cmml" xref="S3.T2.7.7.1.m1.1.1.3.2"><mtext id="S3.T2.7.7.1.m1.1.1.3.2.cmml" xref="S3.T2.7.7.1.m1.1.1.3.2">Q</mtext></ci><ci id="S3.T2.7.7.1.m1.1.1.3.3a.cmml" xref="S3.T2.7.7.1.m1.1.1.3.3"><mtext id="S3.T2.7.7.1.m1.1.1.3.3.cmml" xref="S3.T2.7.7.1.m1.1.1.3.3">T</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.1.m1.1c">\text{K}=\text{Q}\circ\text{T}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.7.7.1.m1.1d">K = Q ∘ T</annotation></semantics></math></td>
<td id="S3.T2.8.8.3" class="ltx_td ltx_align_left">-</td>
<td id="S3.T2.8.8.2" class="ltx_td ltx_align_left"><math id="S3.T2.8.8.2.m1.1" class="ltx_Math" alttext="Ln^{2}d" display="inline"><semantics id="S3.T2.8.8.2.m1.1a"><mrow id="S3.T2.8.8.2.m1.1.1" xref="S3.T2.8.8.2.m1.1.1.cmml"><mi id="S3.T2.8.8.2.m1.1.1.2" xref="S3.T2.8.8.2.m1.1.1.2.cmml">L</mi><mo id="S3.T2.8.8.2.m1.1.1.1" xref="S3.T2.8.8.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.8.8.2.m1.1.1.3" xref="S3.T2.8.8.2.m1.1.1.3.cmml"><mi id="S3.T2.8.8.2.m1.1.1.3.2" xref="S3.T2.8.8.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.8.8.2.m1.1.1.3.3" xref="S3.T2.8.8.2.m1.1.1.3.3.cmml">2</mn></msup><mo id="S3.T2.8.8.2.m1.1.1.1a" xref="S3.T2.8.8.2.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.8.8.2.m1.1.1.4" xref="S3.T2.8.8.2.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.2.m1.1b"><apply id="S3.T2.8.8.2.m1.1.1.cmml" xref="S3.T2.8.8.2.m1.1.1"><times id="S3.T2.8.8.2.m1.1.1.1.cmml" xref="S3.T2.8.8.2.m1.1.1.1"></times><ci id="S3.T2.8.8.2.m1.1.1.2.cmml" xref="S3.T2.8.8.2.m1.1.1.2">𝐿</ci><apply id="S3.T2.8.8.2.m1.1.1.3.cmml" xref="S3.T2.8.8.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.8.8.2.m1.1.1.3.1.cmml" xref="S3.T2.8.8.2.m1.1.1.3">superscript</csymbol><ci id="S3.T2.8.8.2.m1.1.1.3.2.cmml" xref="S3.T2.8.8.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.8.8.2.m1.1.1.3.3.cmml" xref="S3.T2.8.8.2.m1.1.1.3.3">2</cn></apply><ci id="S3.T2.8.8.2.m1.1.1.4.cmml" xref="S3.T2.8.8.2.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.2.m1.1c">Ln^{2}d</annotation><annotation encoding="application/x-llamapun" id="S3.T2.8.8.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.11.11" class="ltx_tr">
<td id="S3.T2.9.9.1" class="ltx_td ltx_align_left"><math id="S3.T2.9.9.1.m1.1" class="ltx_Math" alttext="\text{QK}^{\text{T}}" display="inline"><semantics id="S3.T2.9.9.1.m1.1a"><msup id="S3.T2.9.9.1.m1.1.1" xref="S3.T2.9.9.1.m1.1.1.cmml"><mtext id="S3.T2.9.9.1.m1.1.1.2" xref="S3.T2.9.9.1.m1.1.1.2a.cmml">QK</mtext><mtext id="S3.T2.9.9.1.m1.1.1.3" xref="S3.T2.9.9.1.m1.1.1.3a.cmml">T</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.1.m1.1b"><apply id="S3.T2.9.9.1.m1.1.1.cmml" xref="S3.T2.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T2.9.9.1.m1.1.1.1.cmml" xref="S3.T2.9.9.1.m1.1.1">superscript</csymbol><ci id="S3.T2.9.9.1.m1.1.1.2a.cmml" xref="S3.T2.9.9.1.m1.1.1.2"><mtext id="S3.T2.9.9.1.m1.1.1.2.cmml" xref="S3.T2.9.9.1.m1.1.1.2">QK</mtext></ci><ci id="S3.T2.9.9.1.m1.1.1.3a.cmml" xref="S3.T2.9.9.1.m1.1.1.3"><mtext mathsize="70%" id="S3.T2.9.9.1.m1.1.1.3.cmml" xref="S3.T2.9.9.1.m1.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.1.m1.1c">\text{QK}^{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.9.9.1.m1.1d">QK start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T2.10.10.2" class="ltx_td ltx_align_left"><math id="S3.T2.10.10.2.m1.1" class="ltx_Math" alttext="Ln^{2}d" display="inline"><semantics id="S3.T2.10.10.2.m1.1a"><mrow id="S3.T2.10.10.2.m1.1.1" xref="S3.T2.10.10.2.m1.1.1.cmml"><mi id="S3.T2.10.10.2.m1.1.1.2" xref="S3.T2.10.10.2.m1.1.1.2.cmml">L</mi><mo id="S3.T2.10.10.2.m1.1.1.1" xref="S3.T2.10.10.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.10.10.2.m1.1.1.3" xref="S3.T2.10.10.2.m1.1.1.3.cmml"><mi id="S3.T2.10.10.2.m1.1.1.3.2" xref="S3.T2.10.10.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.10.10.2.m1.1.1.3.3" xref="S3.T2.10.10.2.m1.1.1.3.3.cmml">2</mn></msup><mo id="S3.T2.10.10.2.m1.1.1.1a" xref="S3.T2.10.10.2.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.10.10.2.m1.1.1.4" xref="S3.T2.10.10.2.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.2.m1.1b"><apply id="S3.T2.10.10.2.m1.1.1.cmml" xref="S3.T2.10.10.2.m1.1.1"><times id="S3.T2.10.10.2.m1.1.1.1.cmml" xref="S3.T2.10.10.2.m1.1.1.1"></times><ci id="S3.T2.10.10.2.m1.1.1.2.cmml" xref="S3.T2.10.10.2.m1.1.1.2">𝐿</ci><apply id="S3.T2.10.10.2.m1.1.1.3.cmml" xref="S3.T2.10.10.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.10.10.2.m1.1.1.3.1.cmml" xref="S3.T2.10.10.2.m1.1.1.3">superscript</csymbol><ci id="S3.T2.10.10.2.m1.1.1.3.2.cmml" xref="S3.T2.10.10.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.10.10.2.m1.1.1.3.3.cmml" xref="S3.T2.10.10.2.m1.1.1.3.3">2</cn></apply><ci id="S3.T2.10.10.2.m1.1.1.4.cmml" xref="S3.T2.10.10.2.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.2.m1.1c">Ln^{2}d</annotation><annotation encoding="application/x-llamapun" id="S3.T2.10.10.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d</annotation></semantics></math></td>
<td id="S3.T2.11.11.3" class="ltx_td ltx_align_left"><math id="S3.T2.11.11.3.m1.1" class="ltx_Math" alttext="Ln^{2}d" display="inline"><semantics id="S3.T2.11.11.3.m1.1a"><mrow id="S3.T2.11.11.3.m1.1.1" xref="S3.T2.11.11.3.m1.1.1.cmml"><mi id="S3.T2.11.11.3.m1.1.1.2" xref="S3.T2.11.11.3.m1.1.1.2.cmml">L</mi><mo id="S3.T2.11.11.3.m1.1.1.1" xref="S3.T2.11.11.3.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.11.11.3.m1.1.1.3" xref="S3.T2.11.11.3.m1.1.1.3.cmml"><mi id="S3.T2.11.11.3.m1.1.1.3.2" xref="S3.T2.11.11.3.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.11.11.3.m1.1.1.3.3" xref="S3.T2.11.11.3.m1.1.1.3.3.cmml">2</mn></msup><mo id="S3.T2.11.11.3.m1.1.1.1a" xref="S3.T2.11.11.3.m1.1.1.1.cmml">⁢</mo><mi id="S3.T2.11.11.3.m1.1.1.4" xref="S3.T2.11.11.3.m1.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.3.m1.1b"><apply id="S3.T2.11.11.3.m1.1.1.cmml" xref="S3.T2.11.11.3.m1.1.1"><times id="S3.T2.11.11.3.m1.1.1.1.cmml" xref="S3.T2.11.11.3.m1.1.1.1"></times><ci id="S3.T2.11.11.3.m1.1.1.2.cmml" xref="S3.T2.11.11.3.m1.1.1.2">𝐿</ci><apply id="S3.T2.11.11.3.m1.1.1.3.cmml" xref="S3.T2.11.11.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.11.11.3.m1.1.1.3.1.cmml" xref="S3.T2.11.11.3.m1.1.1.3">superscript</csymbol><ci id="S3.T2.11.11.3.m1.1.1.3.2.cmml" xref="S3.T2.11.11.3.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.11.11.3.m1.1.1.3.3.cmml" xref="S3.T2.11.11.3.m1.1.1.3.3">2</cn></apply><ci id="S3.T2.11.11.3.m1.1.1.4.cmml" xref="S3.T2.11.11.3.m1.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.3.m1.1c">Ln^{2}d</annotation><annotation encoding="application/x-llamapun" id="S3.T2.11.11.3.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.13.13" class="ltx_tr">
<td id="S3.T2.13.13.3" class="ltx_td ltx_align_left">Mask</td>
<td id="S3.T2.12.12.1" class="ltx_td ltx_align_left"><math id="S3.T2.12.12.1.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T2.12.12.1.m1.1a"><mrow id="S3.T2.12.12.1.m1.1.1" xref="S3.T2.12.12.1.m1.1.1.cmml"><mi id="S3.T2.12.12.1.m1.1.1.2" xref="S3.T2.12.12.1.m1.1.1.2.cmml">L</mi><mo id="S3.T2.12.12.1.m1.1.1.1" xref="S3.T2.12.12.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.12.12.1.m1.1.1.3" xref="S3.T2.12.12.1.m1.1.1.3.cmml"><mi id="S3.T2.12.12.1.m1.1.1.3.2" xref="S3.T2.12.12.1.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.12.12.1.m1.1.1.3.3" xref="S3.T2.12.12.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.1.m1.1b"><apply id="S3.T2.12.12.1.m1.1.1.cmml" xref="S3.T2.12.12.1.m1.1.1"><times id="S3.T2.12.12.1.m1.1.1.1.cmml" xref="S3.T2.12.12.1.m1.1.1.1"></times><ci id="S3.T2.12.12.1.m1.1.1.2.cmml" xref="S3.T2.12.12.1.m1.1.1.2">𝐿</ci><apply id="S3.T2.12.12.1.m1.1.1.3.cmml" xref="S3.T2.12.12.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.12.12.1.m1.1.1.3.1.cmml" xref="S3.T2.12.12.1.m1.1.1.3">superscript</csymbol><ci id="S3.T2.12.12.1.m1.1.1.3.2.cmml" xref="S3.T2.12.12.1.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.12.12.1.m1.1.1.3.3.cmml" xref="S3.T2.12.12.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.1.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.12.12.1.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T2.13.13.2" class="ltx_td ltx_align_left"><math id="S3.T2.13.13.2.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T2.13.13.2.m1.1a"><mrow id="S3.T2.13.13.2.m1.1.1" xref="S3.T2.13.13.2.m1.1.1.cmml"><mi id="S3.T2.13.13.2.m1.1.1.2" xref="S3.T2.13.13.2.m1.1.1.2.cmml">L</mi><mo id="S3.T2.13.13.2.m1.1.1.1" xref="S3.T2.13.13.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.13.13.2.m1.1.1.3" xref="S3.T2.13.13.2.m1.1.1.3.cmml"><mi id="S3.T2.13.13.2.m1.1.1.3.2" xref="S3.T2.13.13.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.13.13.2.m1.1.1.3.3" xref="S3.T2.13.13.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.2.m1.1b"><apply id="S3.T2.13.13.2.m1.1.1.cmml" xref="S3.T2.13.13.2.m1.1.1"><times id="S3.T2.13.13.2.m1.1.1.1.cmml" xref="S3.T2.13.13.2.m1.1.1.1"></times><ci id="S3.T2.13.13.2.m1.1.1.2.cmml" xref="S3.T2.13.13.2.m1.1.1.2">𝐿</ci><apply id="S3.T2.13.13.2.m1.1.1.3.cmml" xref="S3.T2.13.13.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.13.13.2.m1.1.1.3.1.cmml" xref="S3.T2.13.13.2.m1.1.1.3">superscript</csymbol><ci id="S3.T2.13.13.2.m1.1.1.3.2.cmml" xref="S3.T2.13.13.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.13.13.2.m1.1.1.3.3.cmml" xref="S3.T2.13.13.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.2.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.13.13.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.15.15" class="ltx_tr">
<td id="S3.T2.15.15.3" class="ltx_td ltx_align_left">Softmax</td>
<td id="S3.T2.14.14.1" class="ltx_td ltx_align_left"><math id="S3.T2.14.14.1.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T2.14.14.1.m1.1a"><mrow id="S3.T2.14.14.1.m1.1.1" xref="S3.T2.14.14.1.m1.1.1.cmml"><mi id="S3.T2.14.14.1.m1.1.1.2" xref="S3.T2.14.14.1.m1.1.1.2.cmml">L</mi><mo id="S3.T2.14.14.1.m1.1.1.1" xref="S3.T2.14.14.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.14.14.1.m1.1.1.3" xref="S3.T2.14.14.1.m1.1.1.3.cmml"><mi id="S3.T2.14.14.1.m1.1.1.3.2" xref="S3.T2.14.14.1.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.14.14.1.m1.1.1.3.3" xref="S3.T2.14.14.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.14.14.1.m1.1b"><apply id="S3.T2.14.14.1.m1.1.1.cmml" xref="S3.T2.14.14.1.m1.1.1"><times id="S3.T2.14.14.1.m1.1.1.1.cmml" xref="S3.T2.14.14.1.m1.1.1.1"></times><ci id="S3.T2.14.14.1.m1.1.1.2.cmml" xref="S3.T2.14.14.1.m1.1.1.2">𝐿</ci><apply id="S3.T2.14.14.1.m1.1.1.3.cmml" xref="S3.T2.14.14.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.14.14.1.m1.1.1.3.1.cmml" xref="S3.T2.14.14.1.m1.1.1.3">superscript</csymbol><ci id="S3.T2.14.14.1.m1.1.1.3.2.cmml" xref="S3.T2.14.14.1.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.14.14.1.m1.1.1.3.3.cmml" xref="S3.T2.14.14.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.14.1.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.14.14.1.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T2.15.15.2" class="ltx_td ltx_align_left"><math id="S3.T2.15.15.2.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T2.15.15.2.m1.1a"><mrow id="S3.T2.15.15.2.m1.1.1" xref="S3.T2.15.15.2.m1.1.1.cmml"><mi id="S3.T2.15.15.2.m1.1.1.2" xref="S3.T2.15.15.2.m1.1.1.2.cmml">L</mi><mo id="S3.T2.15.15.2.m1.1.1.1" xref="S3.T2.15.15.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T2.15.15.2.m1.1.1.3" xref="S3.T2.15.15.2.m1.1.1.3.cmml"><mi id="S3.T2.15.15.2.m1.1.1.3.2" xref="S3.T2.15.15.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T2.15.15.2.m1.1.1.3.3" xref="S3.T2.15.15.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.15.15.2.m1.1b"><apply id="S3.T2.15.15.2.m1.1.1.cmml" xref="S3.T2.15.15.2.m1.1.1"><times id="S3.T2.15.15.2.m1.1.1.1.cmml" xref="S3.T2.15.15.2.m1.1.1.1"></times><ci id="S3.T2.15.15.2.m1.1.1.2.cmml" xref="S3.T2.15.15.2.m1.1.1.2">𝐿</ci><apply id="S3.T2.15.15.2.m1.1.1.3.cmml" xref="S3.T2.15.15.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T2.15.15.2.m1.1.1.3.1.cmml" xref="S3.T2.15.15.2.m1.1.1.3">superscript</csymbol><ci id="S3.T2.15.15.2.m1.1.1.3.2.cmml" xref="S3.T2.15.15.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T2.15.15.2.m1.1.1.3.3.cmml" xref="S3.T2.15.15.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.15.2.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T2.15.15.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.2" class="ltx_p">Since <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="n\gg d" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">n</mi><mo id="S3.SS2.p2.1.m1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.cmml">≫</mo><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1">much-greater-than</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑛</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">n\gg d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_n ≫ italic_d</annotation></semantics></math> in commonly used large language models, we can assert that computational complexity of CoCA is nearly 2 times of origin models with component <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\text{K}=\text{Q}\circ\text{T}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mtext id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2a.cmml">K</mtext><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mtext id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2a.cmml">Q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.2.m2.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">∘</mo><mtext id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3a.cmml">T</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><eq id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></eq><ci id="S3.SS2.p2.2.m2.1.1.2a.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><mtext id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">K</mtext></ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><compose id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.1"></compose><ci id="S3.SS2.p2.2.m2.1.1.3.2a.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2"><mtext id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">Q</mtext></ci><ci id="S3.SS2.p2.2.m2.1.1.3.3a.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3"><mtext id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">T</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\text{K}=\text{Q}\circ\text{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">K = Q ∘ T</annotation></semantics></math> from Table <a href="#S3.T2" title="Table 2 ‣ 3.2 Computational and spatial complexity ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, which is worthy by comparing such small cost with its excellent performance.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">Apart from computational complexity, another important factor which affects the practicality of one model is spatial complexity. As we pointed out after Equation <a href="#S2.E6" title="6 ‣ 2.4 Collinear Constrained Attention(CoCA) ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, there will be an unimaginable memory pressure without optimization, see Table <a href="#S3.T3" title="Table 3 ‣ 3.2 Computational and spatial complexity ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.3" class="ltx_p">The spatial complexity of component <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\text{K}=\text{Q}\circ\text{T}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mtext id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2a.cmml">K</mtext><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mtext id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2a.cmml">Q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p4.1.m1.1.1.3.1" xref="S3.SS2.p4.1.m1.1.1.3.1.cmml">∘</mo><mtext id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3a.cmml">T</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><eq id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></eq><ci id="S3.SS2.p4.1.m1.1.1.2a.cmml" xref="S3.SS2.p4.1.m1.1.1.2"><mtext id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">K</mtext></ci><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><compose id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.1"></compose><ci id="S3.SS2.p4.1.m1.1.1.3.2a.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2"><mtext id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">Q</mtext></ci><ci id="S3.SS2.p4.1.m1.1.1.3.3a.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3"><mtext id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">T</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\text{K}=\text{Q}\circ\text{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">K = Q ∘ T</annotation></semantics></math> will become <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="d/h" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">d</mi><mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">/</mo><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><divide id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1"></divide><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑑</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">d/h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_d / italic_h</annotation></semantics></math> times larger than origin model if fully expanded. It’s about <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="64\sim 256" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mrow id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mn id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">64</mn><mo id="S3.SS2.p4.3.m3.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.cmml">∼</mo><mn id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="latexml" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1">similar-to</csymbol><cn type="integer" id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">64</cn><cn type="integer" id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">64\sim 256</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">64 ∼ 256</annotation></semantics></math> times for commonly used models which is unacceptable for practical use.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Spatial complexity</figcaption>
<table id="S3.T3.15" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T3.15.16.1" class="ltx_tr">
<td id="S3.T3.15.16.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S3.T3.15.16.1.1.1" class="ltx_text ltx_font_bold">COMPONENT</span></td>
<td id="S3.T3.15.16.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="S3.T3.15.16.1.2.1" class="ltx_text ltx_font_bold">Complexity Of Origin Model</span></td>
<td id="S3.T3.15.16.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="S3.T3.15.16.1.3.1" class="ltx_text ltx_font_bold">Complexity Of CoCA</span></td>
</tr>
<tr id="S3.T3.2.2" class="ltx_tr">
<td id="S3.T3.2.2.3" class="ltx_td ltx_align_left ltx_border_t">QK(T)V projection</td>
<td id="S3.T3.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><math id="S3.T3.1.1.1.m1.1" class="ltx_Math" alttext="Lnd/h" display="inline"><semantics id="S3.T3.1.1.1.m1.1a"><mrow id="S3.T3.1.1.1.m1.1.1" xref="S3.T3.1.1.1.m1.1.1.cmml"><mrow id="S3.T3.1.1.1.m1.1.1.2" xref="S3.T3.1.1.1.m1.1.1.2.cmml"><mi id="S3.T3.1.1.1.m1.1.1.2.2" xref="S3.T3.1.1.1.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.1.1.1.m1.1.1.2.1" xref="S3.T3.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.1.1.1.m1.1.1.2.3" xref="S3.T3.1.1.1.m1.1.1.2.3.cmml">n</mi><mo id="S3.T3.1.1.1.m1.1.1.2.1a" xref="S3.T3.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.1.1.1.m1.1.1.2.4" xref="S3.T3.1.1.1.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.1.1.1.m1.1.1.1" xref="S3.T3.1.1.1.m1.1.1.1.cmml">/</mo><mi id="S3.T3.1.1.1.m1.1.1.3" xref="S3.T3.1.1.1.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.m1.1b"><apply id="S3.T3.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1"><divide id="S3.T3.1.1.1.m1.1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1.1"></divide><apply id="S3.T3.1.1.1.m1.1.1.2.cmml" xref="S3.T3.1.1.1.m1.1.1.2"><times id="S3.T3.1.1.1.m1.1.1.2.1.cmml" xref="S3.T3.1.1.1.m1.1.1.2.1"></times><ci id="S3.T3.1.1.1.m1.1.1.2.2.cmml" xref="S3.T3.1.1.1.m1.1.1.2.2">𝐿</ci><ci id="S3.T3.1.1.1.m1.1.1.2.3.cmml" xref="S3.T3.1.1.1.m1.1.1.2.3">𝑛</ci><ci id="S3.T3.1.1.1.m1.1.1.2.4.cmml" xref="S3.T3.1.1.1.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.1.1.1.m1.1.1.3.cmml" xref="S3.T3.1.1.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.m1.1c">Lnd/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.m1.1d">italic_L italic_n italic_d / italic_h</annotation></semantics></math></td>
<td id="S3.T3.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><math id="S3.T3.2.2.2.m1.1" class="ltx_Math" alttext="Lnd/h" display="inline"><semantics id="S3.T3.2.2.2.m1.1a"><mrow id="S3.T3.2.2.2.m1.1.1" xref="S3.T3.2.2.2.m1.1.1.cmml"><mrow id="S3.T3.2.2.2.m1.1.1.2" xref="S3.T3.2.2.2.m1.1.1.2.cmml"><mi id="S3.T3.2.2.2.m1.1.1.2.2" xref="S3.T3.2.2.2.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.2.2.2.m1.1.1.2.1" xref="S3.T3.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.2.2.2.m1.1.1.2.3" xref="S3.T3.2.2.2.m1.1.1.2.3.cmml">n</mi><mo id="S3.T3.2.2.2.m1.1.1.2.1a" xref="S3.T3.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.2.2.2.m1.1.1.2.4" xref="S3.T3.2.2.2.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.2.2.2.m1.1.1.1" xref="S3.T3.2.2.2.m1.1.1.1.cmml">/</mo><mi id="S3.T3.2.2.2.m1.1.1.3" xref="S3.T3.2.2.2.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.m1.1b"><apply id="S3.T3.2.2.2.m1.1.1.cmml" xref="S3.T3.2.2.2.m1.1.1"><divide id="S3.T3.2.2.2.m1.1.1.1.cmml" xref="S3.T3.2.2.2.m1.1.1.1"></divide><apply id="S3.T3.2.2.2.m1.1.1.2.cmml" xref="S3.T3.2.2.2.m1.1.1.2"><times id="S3.T3.2.2.2.m1.1.1.2.1.cmml" xref="S3.T3.2.2.2.m1.1.1.2.1"></times><ci id="S3.T3.2.2.2.m1.1.1.2.2.cmml" xref="S3.T3.2.2.2.m1.1.1.2.2">𝐿</ci><ci id="S3.T3.2.2.2.m1.1.1.2.3.cmml" xref="S3.T3.2.2.2.m1.1.1.2.3">𝑛</ci><ci id="S3.T3.2.2.2.m1.1.1.2.4.cmml" xref="S3.T3.2.2.2.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.2.2.2.m1.1.1.3.cmml" xref="S3.T3.2.2.2.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.m1.1c">Lnd/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.2.m1.1d">italic_L italic_n italic_d / italic_h</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.3.3" class="ltx_tr">
<td id="S3.T3.3.3.2" class="ltx_td ltx_align_left">T half</td>
<td id="S3.T3.3.3.3" class="ltx_td ltx_align_left">-</td>
<td id="S3.T3.3.3.1" class="ltx_td ltx_align_left"><math id="S3.T3.3.3.1.m1.1" class="ltx_Math" alttext="Lnd/h" display="inline"><semantics id="S3.T3.3.3.1.m1.1a"><mrow id="S3.T3.3.3.1.m1.1.1" xref="S3.T3.3.3.1.m1.1.1.cmml"><mrow id="S3.T3.3.3.1.m1.1.1.2" xref="S3.T3.3.3.1.m1.1.1.2.cmml"><mi id="S3.T3.3.3.1.m1.1.1.2.2" xref="S3.T3.3.3.1.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.3.3.1.m1.1.1.2.1" xref="S3.T3.3.3.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.3.3.1.m1.1.1.2.3" xref="S3.T3.3.3.1.m1.1.1.2.3.cmml">n</mi><mo id="S3.T3.3.3.1.m1.1.1.2.1a" xref="S3.T3.3.3.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.3.3.1.m1.1.1.2.4" xref="S3.T3.3.3.1.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.3.3.1.m1.1.1.1" xref="S3.T3.3.3.1.m1.1.1.1.cmml">/</mo><mi id="S3.T3.3.3.1.m1.1.1.3" xref="S3.T3.3.3.1.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.1.m1.1b"><apply id="S3.T3.3.3.1.m1.1.1.cmml" xref="S3.T3.3.3.1.m1.1.1"><divide id="S3.T3.3.3.1.m1.1.1.1.cmml" xref="S3.T3.3.3.1.m1.1.1.1"></divide><apply id="S3.T3.3.3.1.m1.1.1.2.cmml" xref="S3.T3.3.3.1.m1.1.1.2"><times id="S3.T3.3.3.1.m1.1.1.2.1.cmml" xref="S3.T3.3.3.1.m1.1.1.2.1"></times><ci id="S3.T3.3.3.1.m1.1.1.2.2.cmml" xref="S3.T3.3.3.1.m1.1.1.2.2">𝐿</ci><ci id="S3.T3.3.3.1.m1.1.1.2.3.cmml" xref="S3.T3.3.3.1.m1.1.1.2.3">𝑛</ci><ci id="S3.T3.3.3.1.m1.1.1.2.4.cmml" xref="S3.T3.3.3.1.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.3.3.1.m1.1.1.3.cmml" xref="S3.T3.3.3.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.1.m1.1c">Lnd/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.3.3.1.m1.1d">italic_L italic_n italic_d / italic_h</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.4.4" class="ltx_tr">
<td id="S3.T3.4.4.2" class="ltx_td ltx_align_left">T Relu</td>
<td id="S3.T3.4.4.3" class="ltx_td ltx_align_left">-</td>
<td id="S3.T3.4.4.1" class="ltx_td ltx_align_left"><math id="S3.T3.4.4.1.m1.1" class="ltx_Math" alttext="Lnd/h" display="inline"><semantics id="S3.T3.4.4.1.m1.1a"><mrow id="S3.T3.4.4.1.m1.1.1" xref="S3.T3.4.4.1.m1.1.1.cmml"><mrow id="S3.T3.4.4.1.m1.1.1.2" xref="S3.T3.4.4.1.m1.1.1.2.cmml"><mi id="S3.T3.4.4.1.m1.1.1.2.2" xref="S3.T3.4.4.1.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.4.4.1.m1.1.1.2.1" xref="S3.T3.4.4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.4.4.1.m1.1.1.2.3" xref="S3.T3.4.4.1.m1.1.1.2.3.cmml">n</mi><mo id="S3.T3.4.4.1.m1.1.1.2.1a" xref="S3.T3.4.4.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.4.4.1.m1.1.1.2.4" xref="S3.T3.4.4.1.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.4.4.1.m1.1.1.1" xref="S3.T3.4.4.1.m1.1.1.1.cmml">/</mo><mi id="S3.T3.4.4.1.m1.1.1.3" xref="S3.T3.4.4.1.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.1.m1.1b"><apply id="S3.T3.4.4.1.m1.1.1.cmml" xref="S3.T3.4.4.1.m1.1.1"><divide id="S3.T3.4.4.1.m1.1.1.1.cmml" xref="S3.T3.4.4.1.m1.1.1.1"></divide><apply id="S3.T3.4.4.1.m1.1.1.2.cmml" xref="S3.T3.4.4.1.m1.1.1.2"><times id="S3.T3.4.4.1.m1.1.1.2.1.cmml" xref="S3.T3.4.4.1.m1.1.1.2.1"></times><ci id="S3.T3.4.4.1.m1.1.1.2.2.cmml" xref="S3.T3.4.4.1.m1.1.1.2.2">𝐿</ci><ci id="S3.T3.4.4.1.m1.1.1.2.3.cmml" xref="S3.T3.4.4.1.m1.1.1.2.3">𝑛</ci><ci id="S3.T3.4.4.1.m1.1.1.2.4.cmml" xref="S3.T3.4.4.1.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.4.4.1.m1.1.1.3.cmml" xref="S3.T3.4.4.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.1.m1.1c">Lnd/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.4.4.1.m1.1d">italic_L italic_n italic_d / italic_h</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.6.6" class="ltx_tr">
<td id="S3.T3.6.6.3" class="ltx_td ltx_align_left">QK(T) rotary</td>
<td id="S3.T3.5.5.1" class="ltx_td ltx_align_left"><math id="S3.T3.5.5.1.m1.1" class="ltx_Math" alttext="Lnd/h" display="inline"><semantics id="S3.T3.5.5.1.m1.1a"><mrow id="S3.T3.5.5.1.m1.1.1" xref="S3.T3.5.5.1.m1.1.1.cmml"><mrow id="S3.T3.5.5.1.m1.1.1.2" xref="S3.T3.5.5.1.m1.1.1.2.cmml"><mi id="S3.T3.5.5.1.m1.1.1.2.2" xref="S3.T3.5.5.1.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.5.5.1.m1.1.1.2.1" xref="S3.T3.5.5.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.5.5.1.m1.1.1.2.3" xref="S3.T3.5.5.1.m1.1.1.2.3.cmml">n</mi><mo id="S3.T3.5.5.1.m1.1.1.2.1a" xref="S3.T3.5.5.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.5.5.1.m1.1.1.2.4" xref="S3.T3.5.5.1.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.5.5.1.m1.1.1.1" xref="S3.T3.5.5.1.m1.1.1.1.cmml">/</mo><mi id="S3.T3.5.5.1.m1.1.1.3" xref="S3.T3.5.5.1.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.1.m1.1b"><apply id="S3.T3.5.5.1.m1.1.1.cmml" xref="S3.T3.5.5.1.m1.1.1"><divide id="S3.T3.5.5.1.m1.1.1.1.cmml" xref="S3.T3.5.5.1.m1.1.1.1"></divide><apply id="S3.T3.5.5.1.m1.1.1.2.cmml" xref="S3.T3.5.5.1.m1.1.1.2"><times id="S3.T3.5.5.1.m1.1.1.2.1.cmml" xref="S3.T3.5.5.1.m1.1.1.2.1"></times><ci id="S3.T3.5.5.1.m1.1.1.2.2.cmml" xref="S3.T3.5.5.1.m1.1.1.2.2">𝐿</ci><ci id="S3.T3.5.5.1.m1.1.1.2.3.cmml" xref="S3.T3.5.5.1.m1.1.1.2.3">𝑛</ci><ci id="S3.T3.5.5.1.m1.1.1.2.4.cmml" xref="S3.T3.5.5.1.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.5.5.1.m1.1.1.3.cmml" xref="S3.T3.5.5.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.1.m1.1c">Lnd/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.5.5.1.m1.1d">italic_L italic_n italic_d / italic_h</annotation></semantics></math></td>
<td id="S3.T3.6.6.2" class="ltx_td ltx_align_left"><math id="S3.T3.6.6.2.m1.1" class="ltx_Math" alttext="Lnd/h" display="inline"><semantics id="S3.T3.6.6.2.m1.1a"><mrow id="S3.T3.6.6.2.m1.1.1" xref="S3.T3.6.6.2.m1.1.1.cmml"><mrow id="S3.T3.6.6.2.m1.1.1.2" xref="S3.T3.6.6.2.m1.1.1.2.cmml"><mi id="S3.T3.6.6.2.m1.1.1.2.2" xref="S3.T3.6.6.2.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.6.6.2.m1.1.1.2.1" xref="S3.T3.6.6.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.6.6.2.m1.1.1.2.3" xref="S3.T3.6.6.2.m1.1.1.2.3.cmml">n</mi><mo id="S3.T3.6.6.2.m1.1.1.2.1a" xref="S3.T3.6.6.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.6.6.2.m1.1.1.2.4" xref="S3.T3.6.6.2.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.6.6.2.m1.1.1.1" xref="S3.T3.6.6.2.m1.1.1.1.cmml">/</mo><mi id="S3.T3.6.6.2.m1.1.1.3" xref="S3.T3.6.6.2.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.2.m1.1b"><apply id="S3.T3.6.6.2.m1.1.1.cmml" xref="S3.T3.6.6.2.m1.1.1"><divide id="S3.T3.6.6.2.m1.1.1.1.cmml" xref="S3.T3.6.6.2.m1.1.1.1"></divide><apply id="S3.T3.6.6.2.m1.1.1.2.cmml" xref="S3.T3.6.6.2.m1.1.1.2"><times id="S3.T3.6.6.2.m1.1.1.2.1.cmml" xref="S3.T3.6.6.2.m1.1.1.2.1"></times><ci id="S3.T3.6.6.2.m1.1.1.2.2.cmml" xref="S3.T3.6.6.2.m1.1.1.2.2">𝐿</ci><ci id="S3.T3.6.6.2.m1.1.1.2.3.cmml" xref="S3.T3.6.6.2.m1.1.1.2.3">𝑛</ci><ci id="S3.T3.6.6.2.m1.1.1.2.4.cmml" xref="S3.T3.6.6.2.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.6.6.2.m1.1.1.3.cmml" xref="S3.T3.6.6.2.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.2.m1.1c">Lnd/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.6.6.2.m1.1d">italic_L italic_n italic_d / italic_h</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.8.8" class="ltx_tr">
<td id="S3.T3.7.7.1" class="ltx_td ltx_align_left"><math id="S3.T3.7.7.1.m1.1" class="ltx_Math" alttext="\text{K}=\text{Q}\circ\text{T}" display="inline"><semantics id="S3.T3.7.7.1.m1.1a"><mrow id="S3.T3.7.7.1.m1.1.1" xref="S3.T3.7.7.1.m1.1.1.cmml"><mtext id="S3.T3.7.7.1.m1.1.1.2" xref="S3.T3.7.7.1.m1.1.1.2a.cmml">K</mtext><mo id="S3.T3.7.7.1.m1.1.1.1" xref="S3.T3.7.7.1.m1.1.1.1.cmml">=</mo><mrow id="S3.T3.7.7.1.m1.1.1.3" xref="S3.T3.7.7.1.m1.1.1.3.cmml"><mtext id="S3.T3.7.7.1.m1.1.1.3.2" xref="S3.T3.7.7.1.m1.1.1.3.2a.cmml">Q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.T3.7.7.1.m1.1.1.3.1" xref="S3.T3.7.7.1.m1.1.1.3.1.cmml">∘</mo><mtext id="S3.T3.7.7.1.m1.1.1.3.3" xref="S3.T3.7.7.1.m1.1.1.3.3a.cmml">T</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.1.m1.1b"><apply id="S3.T3.7.7.1.m1.1.1.cmml" xref="S3.T3.7.7.1.m1.1.1"><eq id="S3.T3.7.7.1.m1.1.1.1.cmml" xref="S3.T3.7.7.1.m1.1.1.1"></eq><ci id="S3.T3.7.7.1.m1.1.1.2a.cmml" xref="S3.T3.7.7.1.m1.1.1.2"><mtext id="S3.T3.7.7.1.m1.1.1.2.cmml" xref="S3.T3.7.7.1.m1.1.1.2">K</mtext></ci><apply id="S3.T3.7.7.1.m1.1.1.3.cmml" xref="S3.T3.7.7.1.m1.1.1.3"><compose id="S3.T3.7.7.1.m1.1.1.3.1.cmml" xref="S3.T3.7.7.1.m1.1.1.3.1"></compose><ci id="S3.T3.7.7.1.m1.1.1.3.2a.cmml" xref="S3.T3.7.7.1.m1.1.1.3.2"><mtext id="S3.T3.7.7.1.m1.1.1.3.2.cmml" xref="S3.T3.7.7.1.m1.1.1.3.2">Q</mtext></ci><ci id="S3.T3.7.7.1.m1.1.1.3.3a.cmml" xref="S3.T3.7.7.1.m1.1.1.3.3"><mtext id="S3.T3.7.7.1.m1.1.1.3.3.cmml" xref="S3.T3.7.7.1.m1.1.1.3.3">T</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.1.m1.1c">\text{K}=\text{Q}\circ\text{T}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.7.7.1.m1.1d">K = Q ∘ T</annotation></semantics></math></td>
<td id="S3.T3.8.8.3" class="ltx_td ltx_align_left">-</td>
<td id="S3.T3.8.8.2" class="ltx_td ltx_align_left"><math id="S3.T3.8.8.2.m1.1" class="ltx_Math" alttext="Ln^{2}d/h" display="inline"><semantics id="S3.T3.8.8.2.m1.1a"><mrow id="S3.T3.8.8.2.m1.1.1" xref="S3.T3.8.8.2.m1.1.1.cmml"><mrow id="S3.T3.8.8.2.m1.1.1.2" xref="S3.T3.8.8.2.m1.1.1.2.cmml"><mi id="S3.T3.8.8.2.m1.1.1.2.2" xref="S3.T3.8.8.2.m1.1.1.2.2.cmml">L</mi><mo id="S3.T3.8.8.2.m1.1.1.2.1" xref="S3.T3.8.8.2.m1.1.1.2.1.cmml">⁢</mo><msup id="S3.T3.8.8.2.m1.1.1.2.3" xref="S3.T3.8.8.2.m1.1.1.2.3.cmml"><mi id="S3.T3.8.8.2.m1.1.1.2.3.2" xref="S3.T3.8.8.2.m1.1.1.2.3.2.cmml">n</mi><mn id="S3.T3.8.8.2.m1.1.1.2.3.3" xref="S3.T3.8.8.2.m1.1.1.2.3.3.cmml">2</mn></msup><mo id="S3.T3.8.8.2.m1.1.1.2.1a" xref="S3.T3.8.8.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.8.8.2.m1.1.1.2.4" xref="S3.T3.8.8.2.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.T3.8.8.2.m1.1.1.1" xref="S3.T3.8.8.2.m1.1.1.1.cmml">/</mo><mi id="S3.T3.8.8.2.m1.1.1.3" xref="S3.T3.8.8.2.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.2.m1.1b"><apply id="S3.T3.8.8.2.m1.1.1.cmml" xref="S3.T3.8.8.2.m1.1.1"><divide id="S3.T3.8.8.2.m1.1.1.1.cmml" xref="S3.T3.8.8.2.m1.1.1.1"></divide><apply id="S3.T3.8.8.2.m1.1.1.2.cmml" xref="S3.T3.8.8.2.m1.1.1.2"><times id="S3.T3.8.8.2.m1.1.1.2.1.cmml" xref="S3.T3.8.8.2.m1.1.1.2.1"></times><ci id="S3.T3.8.8.2.m1.1.1.2.2.cmml" xref="S3.T3.8.8.2.m1.1.1.2.2">𝐿</ci><apply id="S3.T3.8.8.2.m1.1.1.2.3.cmml" xref="S3.T3.8.8.2.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.T3.8.8.2.m1.1.1.2.3.1.cmml" xref="S3.T3.8.8.2.m1.1.1.2.3">superscript</csymbol><ci id="S3.T3.8.8.2.m1.1.1.2.3.2.cmml" xref="S3.T3.8.8.2.m1.1.1.2.3.2">𝑛</ci><cn type="integer" id="S3.T3.8.8.2.m1.1.1.2.3.3.cmml" xref="S3.T3.8.8.2.m1.1.1.2.3.3">2</cn></apply><ci id="S3.T3.8.8.2.m1.1.1.2.4.cmml" xref="S3.T3.8.8.2.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.T3.8.8.2.m1.1.1.3.cmml" xref="S3.T3.8.8.2.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.2.m1.1c">Ln^{2}d/h</annotation><annotation encoding="application/x-llamapun" id="S3.T3.8.8.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d / italic_h</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.11.11" class="ltx_tr">
<td id="S3.T3.9.9.1" class="ltx_td ltx_align_left"><math id="S3.T3.9.9.1.m1.1" class="ltx_Math" alttext="\text{QK}^{\text{T}}" display="inline"><semantics id="S3.T3.9.9.1.m1.1a"><msup id="S3.T3.9.9.1.m1.1.1" xref="S3.T3.9.9.1.m1.1.1.cmml"><mtext id="S3.T3.9.9.1.m1.1.1.2" xref="S3.T3.9.9.1.m1.1.1.2a.cmml">QK</mtext><mtext id="S3.T3.9.9.1.m1.1.1.3" xref="S3.T3.9.9.1.m1.1.1.3a.cmml">T</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.T3.9.9.1.m1.1b"><apply id="S3.T3.9.9.1.m1.1.1.cmml" xref="S3.T3.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T3.9.9.1.m1.1.1.1.cmml" xref="S3.T3.9.9.1.m1.1.1">superscript</csymbol><ci id="S3.T3.9.9.1.m1.1.1.2a.cmml" xref="S3.T3.9.9.1.m1.1.1.2"><mtext id="S3.T3.9.9.1.m1.1.1.2.cmml" xref="S3.T3.9.9.1.m1.1.1.2">QK</mtext></ci><ci id="S3.T3.9.9.1.m1.1.1.3a.cmml" xref="S3.T3.9.9.1.m1.1.1.3"><mtext mathsize="70%" id="S3.T3.9.9.1.m1.1.1.3.cmml" xref="S3.T3.9.9.1.m1.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.9.9.1.m1.1c">\text{QK}^{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.9.9.1.m1.1d">QK start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T3.10.10.2" class="ltx_td ltx_align_left"><math id="S3.T3.10.10.2.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T3.10.10.2.m1.1a"><mrow id="S3.T3.10.10.2.m1.1.1" xref="S3.T3.10.10.2.m1.1.1.cmml"><mi id="S3.T3.10.10.2.m1.1.1.2" xref="S3.T3.10.10.2.m1.1.1.2.cmml">L</mi><mo id="S3.T3.10.10.2.m1.1.1.1" xref="S3.T3.10.10.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T3.10.10.2.m1.1.1.3" xref="S3.T3.10.10.2.m1.1.1.3.cmml"><mi id="S3.T3.10.10.2.m1.1.1.3.2" xref="S3.T3.10.10.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T3.10.10.2.m1.1.1.3.3" xref="S3.T3.10.10.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.10.10.2.m1.1b"><apply id="S3.T3.10.10.2.m1.1.1.cmml" xref="S3.T3.10.10.2.m1.1.1"><times id="S3.T3.10.10.2.m1.1.1.1.cmml" xref="S3.T3.10.10.2.m1.1.1.1"></times><ci id="S3.T3.10.10.2.m1.1.1.2.cmml" xref="S3.T3.10.10.2.m1.1.1.2">𝐿</ci><apply id="S3.T3.10.10.2.m1.1.1.3.cmml" xref="S3.T3.10.10.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T3.10.10.2.m1.1.1.3.1.cmml" xref="S3.T3.10.10.2.m1.1.1.3">superscript</csymbol><ci id="S3.T3.10.10.2.m1.1.1.3.2.cmml" xref="S3.T3.10.10.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T3.10.10.2.m1.1.1.3.3.cmml" xref="S3.T3.10.10.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.10.10.2.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.10.10.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T3.11.11.3" class="ltx_td ltx_align_left"><math id="S3.T3.11.11.3.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T3.11.11.3.m1.1a"><mrow id="S3.T3.11.11.3.m1.1.1" xref="S3.T3.11.11.3.m1.1.1.cmml"><mi id="S3.T3.11.11.3.m1.1.1.2" xref="S3.T3.11.11.3.m1.1.1.2.cmml">L</mi><mo id="S3.T3.11.11.3.m1.1.1.1" xref="S3.T3.11.11.3.m1.1.1.1.cmml">⁢</mo><msup id="S3.T3.11.11.3.m1.1.1.3" xref="S3.T3.11.11.3.m1.1.1.3.cmml"><mi id="S3.T3.11.11.3.m1.1.1.3.2" xref="S3.T3.11.11.3.m1.1.1.3.2.cmml">n</mi><mn id="S3.T3.11.11.3.m1.1.1.3.3" xref="S3.T3.11.11.3.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.11.11.3.m1.1b"><apply id="S3.T3.11.11.3.m1.1.1.cmml" xref="S3.T3.11.11.3.m1.1.1"><times id="S3.T3.11.11.3.m1.1.1.1.cmml" xref="S3.T3.11.11.3.m1.1.1.1"></times><ci id="S3.T3.11.11.3.m1.1.1.2.cmml" xref="S3.T3.11.11.3.m1.1.1.2">𝐿</ci><apply id="S3.T3.11.11.3.m1.1.1.3.cmml" xref="S3.T3.11.11.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T3.11.11.3.m1.1.1.3.1.cmml" xref="S3.T3.11.11.3.m1.1.1.3">superscript</csymbol><ci id="S3.T3.11.11.3.m1.1.1.3.2.cmml" xref="S3.T3.11.11.3.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T3.11.11.3.m1.1.1.3.3.cmml" xref="S3.T3.11.11.3.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.11.11.3.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.11.11.3.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.13.13" class="ltx_tr">
<td id="S3.T3.13.13.3" class="ltx_td ltx_align_left">Mask</td>
<td id="S3.T3.12.12.1" class="ltx_td ltx_align_left"><math id="S3.T3.12.12.1.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T3.12.12.1.m1.1a"><mrow id="S3.T3.12.12.1.m1.1.1" xref="S3.T3.12.12.1.m1.1.1.cmml"><mi id="S3.T3.12.12.1.m1.1.1.2" xref="S3.T3.12.12.1.m1.1.1.2.cmml">L</mi><mo id="S3.T3.12.12.1.m1.1.1.1" xref="S3.T3.12.12.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.T3.12.12.1.m1.1.1.3" xref="S3.T3.12.12.1.m1.1.1.3.cmml"><mi id="S3.T3.12.12.1.m1.1.1.3.2" xref="S3.T3.12.12.1.m1.1.1.3.2.cmml">n</mi><mn id="S3.T3.12.12.1.m1.1.1.3.3" xref="S3.T3.12.12.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.12.12.1.m1.1b"><apply id="S3.T3.12.12.1.m1.1.1.cmml" xref="S3.T3.12.12.1.m1.1.1"><times id="S3.T3.12.12.1.m1.1.1.1.cmml" xref="S3.T3.12.12.1.m1.1.1.1"></times><ci id="S3.T3.12.12.1.m1.1.1.2.cmml" xref="S3.T3.12.12.1.m1.1.1.2">𝐿</ci><apply id="S3.T3.12.12.1.m1.1.1.3.cmml" xref="S3.T3.12.12.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T3.12.12.1.m1.1.1.3.1.cmml" xref="S3.T3.12.12.1.m1.1.1.3">superscript</csymbol><ci id="S3.T3.12.12.1.m1.1.1.3.2.cmml" xref="S3.T3.12.12.1.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T3.12.12.1.m1.1.1.3.3.cmml" xref="S3.T3.12.12.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.12.12.1.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.12.12.1.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T3.13.13.2" class="ltx_td ltx_align_left"><math id="S3.T3.13.13.2.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T3.13.13.2.m1.1a"><mrow id="S3.T3.13.13.2.m1.1.1" xref="S3.T3.13.13.2.m1.1.1.cmml"><mi id="S3.T3.13.13.2.m1.1.1.2" xref="S3.T3.13.13.2.m1.1.1.2.cmml">L</mi><mo id="S3.T3.13.13.2.m1.1.1.1" xref="S3.T3.13.13.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T3.13.13.2.m1.1.1.3" xref="S3.T3.13.13.2.m1.1.1.3.cmml"><mi id="S3.T3.13.13.2.m1.1.1.3.2" xref="S3.T3.13.13.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T3.13.13.2.m1.1.1.3.3" xref="S3.T3.13.13.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.13.13.2.m1.1b"><apply id="S3.T3.13.13.2.m1.1.1.cmml" xref="S3.T3.13.13.2.m1.1.1"><times id="S3.T3.13.13.2.m1.1.1.1.cmml" xref="S3.T3.13.13.2.m1.1.1.1"></times><ci id="S3.T3.13.13.2.m1.1.1.2.cmml" xref="S3.T3.13.13.2.m1.1.1.2">𝐿</ci><apply id="S3.T3.13.13.2.m1.1.1.3.cmml" xref="S3.T3.13.13.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T3.13.13.2.m1.1.1.3.1.cmml" xref="S3.T3.13.13.2.m1.1.1.3">superscript</csymbol><ci id="S3.T3.13.13.2.m1.1.1.3.2.cmml" xref="S3.T3.13.13.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T3.13.13.2.m1.1.1.3.3.cmml" xref="S3.T3.13.13.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.13.13.2.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.13.13.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr id="S3.T3.15.15" class="ltx_tr">
<td id="S3.T3.15.15.3" class="ltx_td ltx_align_left ltx_border_bb">Softmax</td>
<td id="S3.T3.14.14.1" class="ltx_td ltx_align_left ltx_border_bb"><math id="S3.T3.14.14.1.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T3.14.14.1.m1.1a"><mrow id="S3.T3.14.14.1.m1.1.1" xref="S3.T3.14.14.1.m1.1.1.cmml"><mi id="S3.T3.14.14.1.m1.1.1.2" xref="S3.T3.14.14.1.m1.1.1.2.cmml">L</mi><mo id="S3.T3.14.14.1.m1.1.1.1" xref="S3.T3.14.14.1.m1.1.1.1.cmml">⁢</mo><msup id="S3.T3.14.14.1.m1.1.1.3" xref="S3.T3.14.14.1.m1.1.1.3.cmml"><mi id="S3.T3.14.14.1.m1.1.1.3.2" xref="S3.T3.14.14.1.m1.1.1.3.2.cmml">n</mi><mn id="S3.T3.14.14.1.m1.1.1.3.3" xref="S3.T3.14.14.1.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.14.14.1.m1.1b"><apply id="S3.T3.14.14.1.m1.1.1.cmml" xref="S3.T3.14.14.1.m1.1.1"><times id="S3.T3.14.14.1.m1.1.1.1.cmml" xref="S3.T3.14.14.1.m1.1.1.1"></times><ci id="S3.T3.14.14.1.m1.1.1.2.cmml" xref="S3.T3.14.14.1.m1.1.1.2">𝐿</ci><apply id="S3.T3.14.14.1.m1.1.1.3.cmml" xref="S3.T3.14.14.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T3.14.14.1.m1.1.1.3.1.cmml" xref="S3.T3.14.14.1.m1.1.1.3">superscript</csymbol><ci id="S3.T3.14.14.1.m1.1.1.3.2.cmml" xref="S3.T3.14.14.1.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T3.14.14.1.m1.1.1.3.3.cmml" xref="S3.T3.14.14.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.14.14.1.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.14.14.1.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td id="S3.T3.15.15.2" class="ltx_td ltx_align_left ltx_border_bb"><math id="S3.T3.15.15.2.m1.1" class="ltx_Math" alttext="Ln^{2}" display="inline"><semantics id="S3.T3.15.15.2.m1.1a"><mrow id="S3.T3.15.15.2.m1.1.1" xref="S3.T3.15.15.2.m1.1.1.cmml"><mi id="S3.T3.15.15.2.m1.1.1.2" xref="S3.T3.15.15.2.m1.1.1.2.cmml">L</mi><mo id="S3.T3.15.15.2.m1.1.1.1" xref="S3.T3.15.15.2.m1.1.1.1.cmml">⁢</mo><msup id="S3.T3.15.15.2.m1.1.1.3" xref="S3.T3.15.15.2.m1.1.1.3.cmml"><mi id="S3.T3.15.15.2.m1.1.1.3.2" xref="S3.T3.15.15.2.m1.1.1.3.2.cmml">n</mi><mn id="S3.T3.15.15.2.m1.1.1.3.3" xref="S3.T3.15.15.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.T3.15.15.2.m1.1b"><apply id="S3.T3.15.15.2.m1.1.1.cmml" xref="S3.T3.15.15.2.m1.1.1"><times id="S3.T3.15.15.2.m1.1.1.1.cmml" xref="S3.T3.15.15.2.m1.1.1.1"></times><ci id="S3.T3.15.15.2.m1.1.1.2.cmml" xref="S3.T3.15.15.2.m1.1.1.2">𝐿</ci><apply id="S3.T3.15.15.2.m1.1.1.3.cmml" xref="S3.T3.15.15.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.T3.15.15.2.m1.1.1.3.1.cmml" xref="S3.T3.15.15.2.m1.1.1.3">superscript</csymbol><ci id="S3.T3.15.15.2.m1.1.1.3.2.cmml" xref="S3.T3.15.15.2.m1.1.1.3.2">𝑛</ci><cn type="integer" id="S3.T3.15.15.2.m1.1.1.3.3.cmml" xref="S3.T3.15.15.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.15.15.2.m1.1c">Ln^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.15.15.2.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.1" class="ltx_p">Review the computational procedure of <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\text{QK}^{\text{T}}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><msup id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mtext id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2a.cmml">QK</mtext><mtext id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3a.cmml">T</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2a.cmml" xref="S3.SS2.p5.1.m1.1.1.2"><mtext id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">QK</mtext></ci><ci id="S3.SS2.p5.1.m1.1.1.3a.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">T</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\text{QK}^{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">QK start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT</annotation></semantics></math>, it could be seen as two steps:</p>
</div>
<div id="S3.SS2.p6" class="ltx_para ltx_noindent">
<p id="S3.SS2.p6.3" class="ltx_p"><math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mo id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">∙</annotation></semantics></math> Element-wise product between <span id="S3.SS2.p6.3.1" class="ltx_text ltx_markedasmath">Q</span> and <span id="S3.SS2.p6.3.2" class="ltx_text ltx_markedasmath">K</span>.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para ltx_noindent">
<p id="S3.SS2.p7.1" class="ltx_p"><math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><mo id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><ci id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.1d">∙</annotation></semantics></math> Sum calculation along hidden dimension.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para ltx_noindent">
<p id="S3.SS2.p8.2" class="ltx_p">Its spatial complexity will also become <math id="S3.SS2.p8.1.m1.1" class="ltx_Math" alttext="Ln^{2}d/h" display="inline"><semantics id="S3.SS2.p8.1.m1.1a"><mrow id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml"><mrow id="S3.SS2.p8.1.m1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.2.cmml"><mi id="S3.SS2.p8.1.m1.1.1.2.2" xref="S3.SS2.p8.1.m1.1.1.2.2.cmml">L</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><msup id="S3.SS2.p8.1.m1.1.1.2.3" xref="S3.SS2.p8.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.p8.1.m1.1.1.2.3.2" xref="S3.SS2.p8.1.m1.1.1.2.3.2.cmml">n</mi><mn id="S3.SS2.p8.1.m1.1.1.2.3.3" xref="S3.SS2.p8.1.m1.1.1.2.3.3.cmml">2</mn></msup><mo id="S3.SS2.p8.1.m1.1.1.2.1a" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.4" xref="S3.SS2.p8.1.m1.1.1.2.4.cmml">d</mi></mrow><mo id="S3.SS2.p8.1.m1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.cmml">/</mo><mi id="S3.SS2.p8.1.m1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.3.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b"><apply id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1"><divide id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1"></divide><apply id="S3.SS2.p8.1.m1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2"><times id="S3.SS2.p8.1.m1.1.1.2.1.cmml" xref="S3.SS2.p8.1.m1.1.1.2.1"></times><ci id="S3.SS2.p8.1.m1.1.1.2.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2.2">𝐿</ci><apply id="S3.SS2.p8.1.m1.1.1.2.3.cmml" xref="S3.SS2.p8.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.p8.1.m1.1.1.2.3">superscript</csymbol><ci id="S3.SS2.p8.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2.3.2">𝑛</ci><cn type="integer" id="S3.SS2.p8.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.p8.1.m1.1.1.2.3.3">2</cn></apply><ci id="S3.SS2.p8.1.m1.1.1.2.4.cmml" xref="S3.SS2.p8.1.m1.1.1.2.4">𝑑</ci></apply><ci id="S3.SS2.p8.1.m1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">Ln^{2}d/h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.1.m1.1d">italic_L italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_d / italic_h</annotation></semantics></math> if fully expanded, only if it contracts along hidden dimension before expanding along sequence length, avoiding full expansion. It also works for <math id="S3.SS2.p8.2.m2.1" class="ltx_Math" alttext="\text{K}=\text{Q}\circ\text{T}" display="inline"><semantics id="S3.SS2.p8.2.m2.1a"><mrow id="S3.SS2.p8.2.m2.1.1" xref="S3.SS2.p8.2.m2.1.1.cmml"><mtext id="S3.SS2.p8.2.m2.1.1.2" xref="S3.SS2.p8.2.m2.1.1.2a.cmml">K</mtext><mo id="S3.SS2.p8.2.m2.1.1.1" xref="S3.SS2.p8.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.p8.2.m2.1.1.3" xref="S3.SS2.p8.2.m2.1.1.3.cmml"><mtext id="S3.SS2.p8.2.m2.1.1.3.2" xref="S3.SS2.p8.2.m2.1.1.3.2a.cmml">Q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p8.2.m2.1.1.3.1" xref="S3.SS2.p8.2.m2.1.1.3.1.cmml">∘</mo><mtext id="S3.SS2.p8.2.m2.1.1.3.3" xref="S3.SS2.p8.2.m2.1.1.3.3a.cmml">T</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.2.m2.1b"><apply id="S3.SS2.p8.2.m2.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1"><eq id="S3.SS2.p8.2.m2.1.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1.1"></eq><ci id="S3.SS2.p8.2.m2.1.1.2a.cmml" xref="S3.SS2.p8.2.m2.1.1.2"><mtext id="S3.SS2.p8.2.m2.1.1.2.cmml" xref="S3.SS2.p8.2.m2.1.1.2">K</mtext></ci><apply id="S3.SS2.p8.2.m2.1.1.3.cmml" xref="S3.SS2.p8.2.m2.1.1.3"><compose id="S3.SS2.p8.2.m2.1.1.3.1.cmml" xref="S3.SS2.p8.2.m2.1.1.3.1"></compose><ci id="S3.SS2.p8.2.m2.1.1.3.2a.cmml" xref="S3.SS2.p8.2.m2.1.1.3.2"><mtext id="S3.SS2.p8.2.m2.1.1.3.2.cmml" xref="S3.SS2.p8.2.m2.1.1.3.2">Q</mtext></ci><ci id="S3.SS2.p8.2.m2.1.1.3.3a.cmml" xref="S3.SS2.p8.2.m2.1.1.3.3"><mtext id="S3.SS2.p8.2.m2.1.1.3.3.cmml" xref="S3.SS2.p8.2.m2.1.1.3.3">T</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.2.m2.1c">\text{K}=\text{Q}\circ\text{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.2.m2.1d">K = Q ∘ T</annotation></semantics></math>, by combining those two components as follows:</p>
<table id="S3.E15" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E15X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{QK}^{\text{T}}=\text{Q}(\text{Q}\circ\text{T})^{\text{T}}" display="inline"><semantics id="S3.E15X.2.1.1.m1.1a"><mrow id="S3.E15X.2.1.1.m1.1.1" xref="S3.E15X.2.1.1.m1.1.1.cmml"><msup id="S3.E15X.2.1.1.m1.1.1.3" xref="S3.E15X.2.1.1.m1.1.1.3.cmml"><mtext id="S3.E15X.2.1.1.m1.1.1.3.2" xref="S3.E15X.2.1.1.m1.1.1.3.2a.cmml">QK</mtext><mtext id="S3.E15X.2.1.1.m1.1.1.3.3" xref="S3.E15X.2.1.1.m1.1.1.3.3a.cmml">T</mtext></msup><mo id="S3.E15X.2.1.1.m1.1.1.2" xref="S3.E15X.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.E15X.2.1.1.m1.1.1.1" xref="S3.E15X.2.1.1.m1.1.1.1.cmml"><mtext id="S3.E15X.2.1.1.m1.1.1.1.3" xref="S3.E15X.2.1.1.m1.1.1.1.3a.cmml">Q</mtext><mo id="S3.E15X.2.1.1.m1.1.1.1.2" xref="S3.E15X.2.1.1.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.E15X.2.1.1.m1.1.1.1.1" xref="S3.E15X.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E15X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.2a.cmml">Q</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">∘</mo><mtext id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.3a.cmml">T</mtext></mrow><mo stretchy="false" id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mtext id="S3.E15X.2.1.1.m1.1.1.1.1.3" xref="S3.E15X.2.1.1.m1.1.1.1.1.3a.cmml">T</mtext></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E15X.2.1.1.m1.1b"><apply id="S3.E15X.2.1.1.m1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1"><eq id="S3.E15X.2.1.1.m1.1.1.2.cmml" xref="S3.E15X.2.1.1.m1.1.1.2"></eq><apply id="S3.E15X.2.1.1.m1.1.1.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E15X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E15X.2.1.1.m1.1.1.3">superscript</csymbol><ci id="S3.E15X.2.1.1.m1.1.1.3.2a.cmml" xref="S3.E15X.2.1.1.m1.1.1.3.2"><mtext id="S3.E15X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E15X.2.1.1.m1.1.1.3.2">QK</mtext></ci><ci id="S3.E15X.2.1.1.m1.1.1.3.3a.cmml" xref="S3.E15X.2.1.1.m1.1.1.3.3"><mtext mathsize="70%" id="S3.E15X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.3.3">T</mtext></ci></apply><apply id="S3.E15X.2.1.1.m1.1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1.1"><times id="S3.E15X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.2"></times><ci id="S3.E15X.2.1.1.m1.1.1.1.3a.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.3"><mtext id="S3.E15X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.3">Q</mtext></ci><apply id="S3.E15X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1"><compose id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.1"></compose><ci id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.2"><mtext id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.2">Q</mtext></ci><ci id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.3"><mtext id="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.1.1.1.3">T</mtext></ci></apply><ci id="S3.E15X.2.1.1.m1.1.1.1.1.3a.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E15X.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.1.1.3">T</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.2.1.1.m1.1c">\displaystyle\text{QK}^{\text{T}}=\text{Q}(\text{Q}\circ\text{T})^{\text{T}}</annotation><annotation encoding="application/x-llamapun" id="S3.E15X.2.1.1.m1.1d">QK start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT = Q ( Q ∘ T ) start_POSTSUPERSCRIPT T end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(15)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p9" class="ltx_para ltx_noindent">
<p id="S3.SS2.p9.1" class="ltx_p">Thanks to the work of opt_einsum <cite class="ltx_cite ltx_citemacro_citep">(a. Smith &amp; Gray, <a href="#bib.bib1" title="" class="ltx_ref">2018</a>)</cite>, the optimization of Equation <a href="#S3.E15" title="15 ‣ 3.2 Computational and spatial complexity ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a> can be easily accomplished for commonly used backends, such as torch and tensorflow.</p>
</div>
<div id="S3.SS2.p10" class="ltx_para ltx_noindent">
<p id="S3.SS2.p10.1" class="ltx_p">The memory consumption of CoCA gets zero increase with the optimization of Equation <a href="#S3.E15" title="15 ‣ 3.2 Computational and spatial complexity ‣ 3 Theoretical explanation ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">Owing to GPU constraints, our experiments are not yet fully concluded. Nevertheless, we present some preliminary results that are indicative of the final outcome. We compare our model with LLaMA 7B <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib19" title="" class="ltx_ref">2023a</a>)</cite> and LLaMA2 7B-chat <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a href="#bib.bib20" title="" class="ltx_ref">2023b</a>)</cite>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setting</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Model Architecture</span>. We modified GPT-NeoX <cite class="ltx_cite ltx_citemacro_citep">(Black et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite> by incorporating our proposed CoCA method, as detailed in Section <a href="#S2.SS4" title="2.4 Collinear Constrained Attention(CoCA) ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.4</span></a>. For a comprehensive understanding of the implementation, please refer to the code provided in Appendix <a href="#A2" title="Appendix B Code ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>. We trained a more compact model consisting of 350M parameters. This configuration includes 24 layers with a hidden dimension of 1024 and 16 attention heads. We’ve set the maximum sequence length to 512 to further conserve GPUs.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Training Data</span>. Our model is trained on a combination of datasets, including the Pile training dataset <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a href="#bib.bib10" title="" class="ltx_ref">2020</a>)</cite>, BookCorpus <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite>, and the Wikipedia Corpus <cite class="ltx_cite ltx_citemacro_citep">(Foundation, <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>. Additionally, we incorporated open-source code from GitHub with 1+ stars, which we personally collected. From these datasets, we derived a sample of approximately 50B tokens, maintaining a composition of 75% text and 25% code.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.2" class="ltx_p"><span id="S4.SS1.p3.2.1" class="ltx_text ltx_font_bold">Training Procedure</span>. Our training leverages the next-token prediction objective. The optimization is carried out using AdamW <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov &amp; Hutter, <a href="#bib.bib12" title="" class="ltx_ref">2017</a>)</cite>, set with hyperparameters <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\beta_{1}=0.9" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><msub id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.2.2.cmml">β</mi><mn id="S4.SS1.p3.1.m1.1.1.2.3" xref="S4.SS1.p3.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><eq id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></eq><apply id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2.2">𝛽</ci><cn type="integer" id="S4.SS1.p3.1.m1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.2.3">1</cn></apply><cn type="float" id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\beta_{1}=0.9</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9</annotation></semantics></math> and <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\beta_{2}=0.95" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><msub id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2.2" xref="S4.SS1.p3.2.m2.1.1.2.2.cmml">β</mi><mn id="S4.SS1.p3.2.m2.1.1.2.3" xref="S4.SS1.p3.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><eq id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></eq><apply id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2.2">𝛽</ci><cn type="integer" id="S4.SS1.p3.2.m2.1.1.2.3.cmml" xref="S4.SS1.p3.2.m2.1.1.2.3">2</cn></apply><cn type="float" id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\beta_{2}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>. The learning rate adopts a linear warm-up of 1% of total steps, starting from 1e-7. Subsequently, we adjust the learning rate to 1e-4 and linearly decay it to 1e-5. The training harnesses the computational capabilities of 8 A100 GPUs, with a global batch size of 256 and an accumulation of 2 gradient steps. For the implementation, we deploy PyTorch <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> in tandem with Fully Sharded Data Parallel <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite>. Our models underwent 2 epochs of training, completing within a span of 72 hours.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Long sequence language modeling</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">We evaluated the long-sequence language modeling prowess of both our model and the LLaMA 7B model. This evaluation was conducted on 100 documents, each possessing at least 16,384 tokens, randomly sourced from the PG-19 dataset <cite class="ltx_cite ltx_citemacro_citep">(Rae et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>. This methodology follows the approach taken by <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite>. For each test document, we truncated the content to the initial 16,384 tokens. To evaluate perplexity across varied context window sizes, we utilized a sliding window method, in line with <cite class="ltx_cite ltx_citemacro_citep">(Press et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>, employing a stride S = 256.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.2 Long sequence language modeling ‣ 4 Experiments ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates a noteworthy trend: the perplexity of the LLaMA 7B model rapidly diverges beyond its training length. Conversely, our CoCA model sustains its perplexity at a consistently low plateau, showing only a minuscule uptick even at 24 times its training length. It’s important to highlight that, in its nascent state, CoCA’s perplexity is marginally higher than that of LLaMA 7B. This can be attributed to CoCA’s smaller parameter size, coupled with the fact that LLaMA 7B’s training length is 2,048—quadruple that of CoCA.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="309" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Sliding window perplexity(S=256) of 100 PG-19 documents. LLaMA 7B trained with 2,048 sequence length. CoCA trained with 512 sequence length.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Long-range dependence retrieval</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">Perplexity is a measure that captures a language model’s proficiency in predicting the next token. However, it doesn’t entirely encompass what we expect from an ideal model. While local attention excels at this task, it often falls short in capturing long-range dependencies.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p">To further evaluate this, we assessed the CoCA and LLaMA2 7B-chat models using a synthetic evaluation task of passkey retrieval, as proposed by <cite class="ltx_cite ltx_citemacro_citep">(Mohtashami &amp; Jaggi, <a href="#bib.bib13" title="" class="ltx_ref">2023</a>)</cite>. In this task, there is a random passkey hidden in a long document to be identified and retrieved. The prompt format can be seen in Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Long-range dependence retrieval ‣ 4 Experiments ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><pre id="S4.F5.1" class="ltx_verbatim ltx_font_typewriter">
   There is an important info hidden inside a lot of irrelevant
   text. Find it and memorize them. I will quiz you about the
   important information there.
   The grass is green. The sky is blue. The sun is yellow. Here
   we go. There and back again.(filler)
   The pass key is xxxxx. Remember it. xxxxx is the pass key.
   (passkey)
   The grass is green. The sky is blue. The sun is yellow. Here
   we go. There and back again.(filler)
   What is the pass key?
</pre>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Prompt format for passkey retrieval. The pass key ’xxxxx’ is randomly generated from 10,000 to 99,999</figcaption>
</figure>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p">We first repeat the filler to make the prompt longer than the individual sequence length at the first time from 256 to 8,192, then insert the passkey into a random position between the fillers. For any individual sequence length, we make 100 test samples. We check first 64 tokens of model outputs for calculating accuracy.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p">As depicted in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.3 Long-range dependence retrieval ‣ 4 Experiments ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the LLaMA2-7B-chat model, which was trained with a maximum length of 4,096 tokens, demonstrated failures when tested on sequences that were 25% longer than its training length. In contrast, CoCA consistently exhibited a high degree of accuracy, even when the test sequence length was expanded to 16 times its original training length. We will delve deeper into specific instances where the model fell short in Section <a href="#S4.SS5" title="4.5 Case study ‣ 4 Experiments ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.5</span></a>. It’s pertinent to note that we employed the NTK-aware RoPE (no fine-tuning) approach during inference for both CoCA and LLaMA2 7B-chat models. Further specifics can be found in Appendix <a href="#A1" title="Appendix A Rotary borders ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="5.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="311" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Performance curves of passkey retrieval. LLaMA2 7B-chat trained with 4,096 sequence length. CoCA trained with 512 sequence length.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Behaviour of attention score in extrapolation</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">Experiments are not complete yet.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Case study</h3>

<div id="S4.SS5.p1" class="ltx_para ltx_noindent">
<p id="S4.SS5.p1.1" class="ltx_p">As shown in Table<a href="#S4.T4" title="Table 4 ‣ 4.5 Case study ‣ 4 Experiments ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, the failure cases of CoCA were not completely wrong, it might be further improved, see Appendix <a href="#A1" title="Appendix A Rotary borders ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a> for more details.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Failure cases of CoCA</figcaption>
<table id="S4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:227.6pt;"><span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_bold ltx_align_top">CoCA result</span></th>
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="width:113.8pt;"><span id="S4.T4.1.1.1.2.1" class="ltx_text ltx_font_bold ltx_align_top">Ground Truth</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.2.1" class="ltx_tr">
<td id="S4.T4.1.2.1.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:227.6pt;">
<p id="S4.T4.1.2.1.1.1" class="ltx_p ltx_align_top">228.The grass is green. The sky is green.
The sun is yellow. The sun is yellow. The sun is yellow.
The sun is yellow. The sun is yellow. The sun is yellow.
The sun is yellow. The sun is yellow. The sun is yellow.
The grass is green. The</p>
</td>
<td id="S4.T4.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:113.8pt;">
<p id="S4.T4.1.2.1.2.1" class="ltx_p ltx_align_top">22841</p>
</td>
</tr>
<tr id="S4.T4.1.3.2" class="ltx_tr">
<td id="S4.T4.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:227.6pt;">
<p id="S4.T4.1.3.2.1.1" class="ltx_p ltx_align_top">57.The grass is green. The sky is yellow.
The sun is yellow. The sun is yellow. The sun is yellow.
The sun is yellow. The sun is yellow. The sun is yellow.
The sun is yellow. The sun is yellow. The sun is yellow.</p>
</td>
<td id="S4.T4.1.3.2.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:113.8pt;"></td>
</tr>
<tr id="S4.T4.1.4.3" class="ltx_tr">
<td id="S4.T4.1.4.3.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:227.6pt;">
<p id="S4.T4.1.4.3.1.1" class="ltx_p ltx_align_top">The grass is green.</p>
</td>
<td id="S4.T4.1.4.3.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:113.8pt;">
<p id="S4.T4.1.4.3.2.1" class="ltx_p ltx_align_top">57680</p>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this work, we observed an anomalous behavior between RoPE and attention matrices, which severely disrupts the monotonicity of RoPE, especially at closest positions containing critical information. To address this at its core, we introduced a new self-attention framework called Collinear Constrained Attention (CoCA). We provided mathematical evidence showcasing the superior characteristics of our method, such as a strong form of long-term decay, as well as computational and spatial efficiency for practical applications. Experimental findings confirm that CoCA delivers outstanding performance in both long-sequence language modeling and long-range dependence capturing. Additionally, CoCA seamlessly integrates with existing extrapolation, interpolation techniques, and other optimization methods designed for conventional Transformer models. This adaptability suggests that CoCA has the potential to evolve into an enhanced version of Transformer models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">a. Smith &amp; Gray (2018)</span>
<span class="ltx_bibblock">
Daniel G. a. Smith and Johnnie Gray.

</span>
<span class="ltx_bibblock">opt_einsum - a python package for optimizing contraction order for
einsum-like expressions.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Journal of Open Source Software</em>, 3(26):753, 2018.

</span>
<span class="ltx_bibblock">doi: <a href="10.21105/joss.00753" title="" class="ltx_ref ltx_Url">10.21105/joss.00753</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://doi.org/10.21105/joss.00753" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.21105/joss.00753</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et al. (2022)</span>
<span class="ltx_bibblock">
Sidney Black, Stella Biderman, Eric Hallahan, Quentin Anthony, Leo Gao,
Laurence Golding, Horace He, Connor Leahy, Kyle McDonell, Jason Phang,
Michael Pieler, Usvsn Sai Prashanth, Shivanshu Purohit, Laria Reynolds,
Jonathan Tow, Ben Wang, and Samuel Weinbach.

</span>
<span class="ltx_bibblock">GPT-NeoX-20B: An open-source autoregressive language model.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of BigScience Episode #5 – Workshop on
Challenges &amp; Perspectives in Creating Large Language Models</em>, pp. 95–136, virtual+Dublin, May 2022. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/2022.bigscience-1.9" title="" class="ltx_ref ltx_Url">10.18653/v1/2022.bigscience-1.9</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://aclanthology.org/2022.bigscience-1.9" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/2022.bigscience-1.9</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">bloc97 (2023)</span>
<span class="ltx_bibblock">
bloc97.

</span>
<span class="ltx_bibblock">Ntk-aware scaled rope allows llama models to have extended (8k+)
context size without any fine-tuning and minimal perplexity degradation,
2023.

</span>
<span class="ltx_bibblock">URL
<a href="https://www.reddit.com/r/LocalLLaMA/comments/14lz7j5/ntkaware_scaled_rope_allows_llama_modes_to_have/." title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.reddit.com/r/LocalLLaMA/comments/14lz7j5/ntkaware_scaled_rope_allows_llama_modes_to_have/.</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan,
Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda
Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, T. J.
Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeff Wu, Clemens
Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott
Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec
Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2005.14165, 2020.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:218971783" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:218971783</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian.

</span>
<span class="ltx_bibblock">Extending context window of large language models via positional
interpolation.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2306.15595, 2023.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:259262376" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:259262376</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Del’etang et al. (2022)</span>
<span class="ltx_bibblock">
Gr’egoire Del’etang, Anian Ruoss, Jordi Grau-Moya, Tim Genewein, Li Kevin
Wenliang, Elliot Catt, Marcus Hutter, Shane Legg, and Pedro A. Ortega.

</span>
<span class="ltx_bibblock">Neural networks and the chomsky hierarchy.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2207.02098, 2022.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:250280065" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:250280065</a>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1810.04805, 2019.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:52967399" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:52967399</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2021)</span>
<span class="ltx_bibblock">
Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and
Jie Tang.

</span>
<span class="ltx_bibblock">Glm: General language model pretraining with autoregressive blank
infilling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Annual Meeting of the Association for Computational
Linguistics</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:247519241" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:247519241</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Foundation (2021)</span>
<span class="ltx_bibblock">
Wikimedia Foundation.

</span>
<span class="ltx_bibblock">Wikimedia downloads, 2021.

</span>
<span class="ltx_bibblock">URL <a href="https://dumps.wikimedia.org" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://dumps.wikimedia.org</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2020)</span>
<span class="ltx_bibblock">
Leo Gao, Stella Rose Biderman, Sid Black, Laurence Golding, Travis Hoppe,
Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, Shawn
Presser, and Connor Leahy.

</span>
<span class="ltx_bibblock">The pile: An 800gb dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2101.00027, 2020.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:230435736" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:230435736</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et al. (2020)</span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and Franccois Fleuret.

</span>
<span class="ltx_bibblock">Transformers are rnns: Fast autoregressive transformers with linear
attention.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2020.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:220250819" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:220250819</a>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov &amp; Hutter (2017)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Fixing weight decay regularization in adam.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1711.05101, 2017.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:3312944" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:3312944</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohtashami &amp; Jaggi (2023)</span>
<span class="ltx_bibblock">
Amirkeivan Mohtashami and Martin Jaggi.

</span>
<span class="ltx_bibblock">Landmark attention: Random-access infinite context length for
transformers.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2305.16300, 2023.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:258887482" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:258887482</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et al. (2021)</span>
<span class="ltx_bibblock">
Ofir Press, Noah A. Smith, and Mike Lewis.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input
length extrapolation.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2108.12409, 2021.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:237347130" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:237347130</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rae et al. (2019)</span>
<span class="ltx_bibblock">
Jack W. Rae, Anna Potapenko, Siddhant M. Jayakumar, and Timothy P. Lillicrap.

</span>
<span class="ltx_bibblock">Compressive transformers for long-range sequence modelling.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1911.05507, 2019.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:207930593" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:207930593</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2021)</span>
<span class="ltx_bibblock">
Jianlin Su, Yu Lu, Shengfeng Pan, Bo Wen, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2104.09864, 2021.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:233307138" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:233307138</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022)</span>
<span class="ltx_bibblock">
Yutao Sun, Li Dong, Barun Patra, Shuming Ma, Shaohan Huang, Alon Benhaim,
Vishrav Chaudhary, Xia Song, and Furu Wei.

</span>
<span class="ltx_bibblock">A length-extrapolatable transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2212.10554, 2022.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:254877252" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:254877252</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric
Hambro, Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and
Guillaume Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2302.13971, 2023a.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:257219404" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:257219404</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin R. Stone, Peter Albert, Amjad Almahairi,
Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti
Bhosale, Daniel M. Bikel, Lukas Blecher, Cristian Cantón Ferrer, Moya
Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu,
Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony S.
Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor
Kerkez, Madian Khabsa, Isabel M. Kloumann, A. V. Korenev, Punit Singh Koura,
Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu,
Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog,
Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi,
Alan Schelten, Ruan Silva, Eric Michael Smith, R. Subramanian, Xia Tan, Binh
Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zhengxu Yan,
Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang,
Aurelien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2307.09288, 2023b.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:259950998" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:259950998</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Yanli Zhao, Andrew Gu, Rohan Varma, Liangchen Luo, Chien chin Huang, Min Xu,
Less Wright, Hamid Shojanazeri, Myle Ott, Sam Shleifer, Alban Desmaison, Can
Balioglu, Bernard Nguyen, Geeta Chauhan, Yuchen Hao, and Shen Li.

</span>
<span class="ltx_bibblock">Pytorch fsdp: Experiences on scaling fully sharded data parallel.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2304.11277, 2023.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:258297871" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:258297871</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2015)</span>
<span class="ltx_bibblock">
Yukun Zhu, Ryan Kiros, Richard S. Zemel, Ruslan Salakhutdinov, Raquel Urtasun,
Antonio Torralba, and Sanja Fidler.

</span>
<span class="ltx_bibblock">Aligning books and movies: Towards story-like visual explanations by
watching movies and reading books.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">2015 IEEE International Conference on Computer Vision (ICCV)</em>,
pp.  19–27, 2015.

</span>
<span class="ltx_bibblock">URL <a href="https://api.semanticscholar.org/CorpusID:6866988" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://api.semanticscholar.org/CorpusID:6866988</a>.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Rotary borders</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.2" class="ltx_p">For simplicity, let’s take the example of Figure <a href="#S2.F3" title="Figure 3 ‣ 2.3 Anomalous behavior between RoPE and attention matrices ‣ 2 Method ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, there are three borders during rotating. As shown in Figure <a href="#A1.F7" title="Figure 7 ‣ Appendix A Rotary borders ‣ Cure the headache of Transformers via Collinear Constrained Attention" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. We use the relative coordinate system by regarding <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p1.1.m1.1a"><msub id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">𝐪</mi><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">𝐪</ci><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_x</annotation></semantics></math>-axis:</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.2" class="ltx_p"><math id="A1.p2.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="A1.p2.1.m1.1a"><mo id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><ci id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">∙</annotation></semantics></math> The first border is <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="A1.p2.2.m2.1a"><msub id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml"><mi id="A1.p2.2.m2.1.1.2" xref="A1.p2.2.m2.1.1.2.cmml">𝐤</mi><mi id="A1.p2.2.m2.1.1.3" xref="A1.p2.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.1.cmml" xref="A1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.p2.2.m2.1.1.2.cmml" xref="A1.p2.2.m2.1.1.2">𝐤</ci><ci id="A1.p2.2.m2.1.1.3.cmml" xref="A1.p2.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="A1.p3" class="ltx_para ltx_noindent">
<p id="A1.p3.2" class="ltx_p"><math id="A1.p3.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="A1.p3.1.m1.1a"><mo id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="A1.p3.1.m1.1d">∙</annotation></semantics></math> The second border is <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="-{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p3.2.m2.1a"><mrow id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml"><mo id="A1.p3.2.m2.1.1a" xref="A1.p3.2.m2.1.1.cmml">−</mo><msub id="A1.p3.2.m2.1.1.2" xref="A1.p3.2.m2.1.1.2.cmml"><mi id="A1.p3.2.m2.1.1.2.2" xref="A1.p3.2.m2.1.1.2.2.cmml">𝐪</mi><mi id="A1.p3.2.m2.1.1.2.3" xref="A1.p3.2.m2.1.1.2.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><apply id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1"><minus id="A1.p3.2.m2.1.1.1.cmml" xref="A1.p3.2.m2.1.1"></minus><apply id="A1.p3.2.m2.1.1.2.cmml" xref="A1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p3.2.m2.1.1.2.1.cmml" xref="A1.p3.2.m2.1.1.2">subscript</csymbol><ci id="A1.p3.2.m2.1.1.2.2.cmml" xref="A1.p3.2.m2.1.1.2.2">𝐪</ci><ci id="A1.p3.2.m2.1.1.2.3.cmml" xref="A1.p3.2.m2.1.1.2.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">-{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p3.2.m2.1d">- bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="A1.p4" class="ltx_para ltx_noindent">
<p id="A1.p4.2" class="ltx_p"><math id="A1.p4.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="A1.p4.1.m1.1a"><mo id="A1.p4.1.m1.1.1" xref="A1.p4.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="A1.p4.1.m1.1b"><ci id="A1.p4.1.m1.1.1.cmml" xref="A1.p4.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="A1.p4.1.m1.1d">∙</annotation></semantics></math> The last border is <math id="A1.p4.2.m2.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p4.2.m2.1a"><msub id="A1.p4.2.m2.1.1" xref="A1.p4.2.m2.1.1.cmml"><mi id="A1.p4.2.m2.1.1.2" xref="A1.p4.2.m2.1.1.2.cmml">𝐪</mi><mi id="A1.p4.2.m2.1.1.3" xref="A1.p4.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p4.2.m2.1b"><apply id="A1.p4.2.m2.1.1.cmml" xref="A1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p4.2.m2.1.1.1.cmml" xref="A1.p4.2.m2.1.1">subscript</csymbol><ci id="A1.p4.2.m2.1.1.2.cmml" xref="A1.p4.2.m2.1.1.2">𝐪</ci><ci id="A1.p4.2.m2.1.1.3.cmml" xref="A1.p4.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.2.m2.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p4.2.m2.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="A1.p5" class="ltx_para ltx_noindent">
<p id="A1.p5.3" class="ltx_p">Every time when the relative angle of <math id="A1.p5.1.m1.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p5.1.m1.1a"><msub id="A1.p5.1.m1.1.1" xref="A1.p5.1.m1.1.1.cmml"><mi id="A1.p5.1.m1.1.1.2" xref="A1.p5.1.m1.1.1.2.cmml">𝐪</mi><mi id="A1.p5.1.m1.1.1.3" xref="A1.p5.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p5.1.m1.1b"><apply id="A1.p5.1.m1.1.1.cmml" xref="A1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p5.1.m1.1.1.1.cmml" xref="A1.p5.1.m1.1.1">subscript</csymbol><ci id="A1.p5.1.m1.1.1.2.cmml" xref="A1.p5.1.m1.1.1.2">𝐪</ci><ci id="A1.p5.1.m1.1.1.3.cmml" xref="A1.p5.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.1.m1.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.1.m1.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="A1.p5.2.m2.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="A1.p5.2.m2.1a"><msub id="A1.p5.2.m2.1.1" xref="A1.p5.2.m2.1.1.cmml"><mi id="A1.p5.2.m2.1.1.2" xref="A1.p5.2.m2.1.1.2.cmml">𝐤</mi><mi id="A1.p5.2.m2.1.1.3" xref="A1.p5.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p5.2.m2.1b"><apply id="A1.p5.2.m2.1.1.cmml" xref="A1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p5.2.m2.1.1.1.cmml" xref="A1.p5.2.m2.1.1">subscript</csymbol><ci id="A1.p5.2.m2.1.1.2.cmml" xref="A1.p5.2.m2.1.1.2">𝐤</ci><ci id="A1.p5.2.m2.1.1.3.cmml" xref="A1.p5.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.2.m2.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p5.2.m2.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> crossover these borders, the monotonicity of <math id="A1.p5.3.m3.2" class="ltx_Math" alttext="a(m,n)" display="inline"><semantics id="A1.p5.3.m3.2a"><mrow id="A1.p5.3.m3.2.3" xref="A1.p5.3.m3.2.3.cmml"><mi id="A1.p5.3.m3.2.3.2" xref="A1.p5.3.m3.2.3.2.cmml">a</mi><mo id="A1.p5.3.m3.2.3.1" xref="A1.p5.3.m3.2.3.1.cmml">⁢</mo><mrow id="A1.p5.3.m3.2.3.3.2" xref="A1.p5.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="A1.p5.3.m3.2.3.3.2.1" xref="A1.p5.3.m3.2.3.3.1.cmml">(</mo><mi id="A1.p5.3.m3.1.1" xref="A1.p5.3.m3.1.1.cmml">m</mi><mo id="A1.p5.3.m3.2.3.3.2.2" xref="A1.p5.3.m3.2.3.3.1.cmml">,</mo><mi id="A1.p5.3.m3.2.2" xref="A1.p5.3.m3.2.2.cmml">n</mi><mo stretchy="false" id="A1.p5.3.m3.2.3.3.2.3" xref="A1.p5.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p5.3.m3.2b"><apply id="A1.p5.3.m3.2.3.cmml" xref="A1.p5.3.m3.2.3"><times id="A1.p5.3.m3.2.3.1.cmml" xref="A1.p5.3.m3.2.3.1"></times><ci id="A1.p5.3.m3.2.3.2.cmml" xref="A1.p5.3.m3.2.3.2">𝑎</ci><interval closure="open" id="A1.p5.3.m3.2.3.3.1.cmml" xref="A1.p5.3.m3.2.3.3.2"><ci id="A1.p5.3.m3.1.1.cmml" xref="A1.p5.3.m3.1.1">𝑚</ci><ci id="A1.p5.3.m3.2.2.cmml" xref="A1.p5.3.m3.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p5.3.m3.2c">a(m,n)</annotation><annotation encoding="application/x-llamapun" id="A1.p5.3.m3.2d">italic_a ( italic_m , italic_n )</annotation></semantics></math> will perform a reversal. Leading the model confusing when extrapolating.</p>
</div>
<div id="A1.p6" class="ltx_para ltx_noindent">
<p id="A1.p6.3" class="ltx_p">CoCA fundamentally solved the problem of the border of <math id="A1.p6.1.m1.1" class="ltx_Math" alttext="{\mathbf{k}}_{j}" display="inline"><semantics id="A1.p6.1.m1.1a"><msub id="A1.p6.1.m1.1.1" xref="A1.p6.1.m1.1.1.cmml"><mi id="A1.p6.1.m1.1.1.2" xref="A1.p6.1.m1.1.1.2.cmml">𝐤</mi><mi id="A1.p6.1.m1.1.1.3" xref="A1.p6.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p6.1.m1.1b"><apply id="A1.p6.1.m1.1.1.cmml" xref="A1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p6.1.m1.1.1.1.cmml" xref="A1.p6.1.m1.1.1">subscript</csymbol><ci id="A1.p6.1.m1.1.1.2.cmml" xref="A1.p6.1.m1.1.1.2">𝐤</ci><ci id="A1.p6.1.m1.1.1.3.cmml" xref="A1.p6.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.1.m1.1c">{\mathbf{k}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p6.1.m1.1d">bold_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and we applied NTK(no fine-tuning) here in CoCA during inference to reduce the confusion of <math id="A1.p6.2.m2.1" class="ltx_Math" alttext="-{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p6.2.m2.1a"><mrow id="A1.p6.2.m2.1.1" xref="A1.p6.2.m2.1.1.cmml"><mo id="A1.p6.2.m2.1.1a" xref="A1.p6.2.m2.1.1.cmml">−</mo><msub id="A1.p6.2.m2.1.1.2" xref="A1.p6.2.m2.1.1.2.cmml"><mi id="A1.p6.2.m2.1.1.2.2" xref="A1.p6.2.m2.1.1.2.2.cmml">𝐪</mi><mi id="A1.p6.2.m2.1.1.2.3" xref="A1.p6.2.m2.1.1.2.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p6.2.m2.1b"><apply id="A1.p6.2.m2.1.1.cmml" xref="A1.p6.2.m2.1.1"><minus id="A1.p6.2.m2.1.1.1.cmml" xref="A1.p6.2.m2.1.1"></minus><apply id="A1.p6.2.m2.1.1.2.cmml" xref="A1.p6.2.m2.1.1.2"><csymbol cd="ambiguous" id="A1.p6.2.m2.1.1.2.1.cmml" xref="A1.p6.2.m2.1.1.2">subscript</csymbol><ci id="A1.p6.2.m2.1.1.2.2.cmml" xref="A1.p6.2.m2.1.1.2.2">𝐪</ci><ci id="A1.p6.2.m2.1.1.2.3.cmml" xref="A1.p6.2.m2.1.1.2.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.2.m2.1c">-{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p6.2.m2.1d">- bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="A1.p6.3.m3.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p6.3.m3.1a"><msub id="A1.p6.3.m3.1.1" xref="A1.p6.3.m3.1.1.cmml"><mi id="A1.p6.3.m3.1.1.2" xref="A1.p6.3.m3.1.1.2.cmml">𝐪</mi><mi id="A1.p6.3.m3.1.1.3" xref="A1.p6.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p6.3.m3.1b"><apply id="A1.p6.3.m3.1.1.cmml" xref="A1.p6.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p6.3.m3.1.1.1.cmml" xref="A1.p6.3.m3.1.1">subscript</csymbol><ci id="A1.p6.3.m3.1.1.2.cmml" xref="A1.p6.3.m3.1.1.2">𝐪</ci><ci id="A1.p6.3.m3.1.1.3.cmml" xref="A1.p6.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p6.3.m3.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p6.3.m3.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div id="A1.p7" class="ltx_para ltx_noindent">
<p id="A1.p7.2" class="ltx_p">Apart from applying NTK to reduce the confusion of <math id="A1.p7.1.m1.1" class="ltx_Math" alttext="-{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p7.1.m1.1a"><mrow id="A1.p7.1.m1.1.1" xref="A1.p7.1.m1.1.1.cmml"><mo id="A1.p7.1.m1.1.1a" xref="A1.p7.1.m1.1.1.cmml">−</mo><msub id="A1.p7.1.m1.1.1.2" xref="A1.p7.1.m1.1.1.2.cmml"><mi id="A1.p7.1.m1.1.1.2.2" xref="A1.p7.1.m1.1.1.2.2.cmml">𝐪</mi><mi id="A1.p7.1.m1.1.1.2.3" xref="A1.p7.1.m1.1.1.2.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.p7.1.m1.1b"><apply id="A1.p7.1.m1.1.1.cmml" xref="A1.p7.1.m1.1.1"><minus id="A1.p7.1.m1.1.1.1.cmml" xref="A1.p7.1.m1.1.1"></minus><apply id="A1.p7.1.m1.1.1.2.cmml" xref="A1.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="A1.p7.1.m1.1.1.2.1.cmml" xref="A1.p7.1.m1.1.1.2">subscript</csymbol><ci id="A1.p7.1.m1.1.1.2.2.cmml" xref="A1.p7.1.m1.1.1.2.2">𝐪</ci><ci id="A1.p7.1.m1.1.1.2.3.cmml" xref="A1.p7.1.m1.1.1.2.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.1.m1.1c">-{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p7.1.m1.1d">- bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="A1.p7.2.m2.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="A1.p7.2.m2.1a"><msub id="A1.p7.2.m2.1.1" xref="A1.p7.2.m2.1.1.cmml"><mi id="A1.p7.2.m2.1.1.2" xref="A1.p7.2.m2.1.1.2.cmml">𝐪</mi><mi id="A1.p7.2.m2.1.1.3" xref="A1.p7.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p7.2.m2.1b"><apply id="A1.p7.2.m2.1.1.cmml" xref="A1.p7.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p7.2.m2.1.1.1.cmml" xref="A1.p7.2.m2.1.1">subscript</csymbol><ci id="A1.p7.2.m2.1.1.2.cmml" xref="A1.p7.2.m2.1.1.2">𝐪</ci><ci id="A1.p7.2.m2.1.1.3.cmml" xref="A1.p7.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p7.2.m2.1c">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.p7.2.m2.1d">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, it might be more effective by limiting the rotary boundary at the beginning of training. We left this for future works.</p>
</div>
<figure id="A1.F7" class="ltx_figure"><img src="6.png" id="A1.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="393" height="279" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Relative coordinate system by regarding <math id="A1.F7.3.m1.1" class="ltx_Math" alttext="{\mathbf{q}}_{j}" display="inline"><semantics id="A1.F7.3.m1.1b"><msub id="A1.F7.3.m1.1.1" xref="A1.F7.3.m1.1.1.cmml"><mi id="A1.F7.3.m1.1.1.2" xref="A1.F7.3.m1.1.1.2.cmml">𝐪</mi><mi id="A1.F7.3.m1.1.1.3" xref="A1.F7.3.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A1.F7.3.m1.1c"><apply id="A1.F7.3.m1.1.1.cmml" xref="A1.F7.3.m1.1.1"><csymbol cd="ambiguous" id="A1.F7.3.m1.1.1.1.cmml" xref="A1.F7.3.m1.1.1">subscript</csymbol><ci id="A1.F7.3.m1.1.1.2.cmml" xref="A1.F7.3.m1.1.1.2">𝐪</ci><ci id="A1.F7.3.m1.1.1.3.cmml" xref="A1.F7.3.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.3.m1.1d">{\mathbf{q}}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.F7.3.m1.1e">bold_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> as <math id="A1.F7.4.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A1.F7.4.m2.1b"><mi id="A1.F7.4.m2.1.1" xref="A1.F7.4.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A1.F7.4.m2.1c"><ci id="A1.F7.4.m2.1.1.cmml" xref="A1.F7.4.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.4.m2.1d">x</annotation><annotation encoding="application/x-llamapun" id="A1.F7.4.m2.1e">italic_x</annotation></semantics></math>-axis</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Code</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p">We give an example of our code based on GPT-NeoX <cite class="ltx_cite ltx_citemacro_citep">(Black et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite>. You have to rewrite the code as follows to use CoCA. Due to page width restrictions, if there is a problem with line breaks in the code, please contact me.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.1" class="ltx_p">The file is <span id="A2.p2.1.1" class="ltx_text">transformer.py</span>, you have to modify the definition of <span id="A2.p2.1.2" class="ltx_text">attention</span> in <span id="A2.p2.1.3" class="ltx_text">ParallelSelfAttention</span>:</p>
</div>
<div id="A2.p3" class="ltx_para ltx_noindent">
<pre id="A2.p3.1" class="ltx_verbatim ltx_font_typewriter">

    from opt_einsum import contract

    def attention(
        self, query_layer, t_layer, query_rot, value_layer,
        layer_past, attention_mask
    ):
        # ===================================
        # Raw attention scores. [b, np, s, s]
        # ===================================

        # change from baddmm to opt_einsum
        # notice to pip install opt_einsum
        attention_scores = \
                contract(’nbpd,sbpd,nbpd-&gt;bpns’,
                          query_layer, # [sq, b, np, hn]
                          t_layer, # [sk, b, np, hn]
                          query_rot, # [sq, b, np, hn]
                          backend=’torch’
                        ) / self.norm_factor

        # ==================================================
        # Update attention mask for inference. [b, np, sq, sk]
        # ==================================================

        if self.use_cache:
            with torch.no_grad():
                attention_mask = attention_mask[
                    ..., : attention_scores.size(3),
                    : attention_scores.size(3)
                ]

        # ===========================
        # Attention probs and dropout
        # ===========================

        if exists(self.rpe):
            rpe = self.rpe(query_layer.size(0), t_layer.size(0))
            attention_scores += rpe  # [1, np, sq, sk]

        if self.pos_emb == "alibi":
            attention_scores = self.alibi_embed(attention_scores)

        # attention scores and attention mask [b, np, sq, sk]
        attention_probs = \
                    self.scale_mask_softmax(attention_scores,
                                            attention_mask)

        # This is actually dropping out entire tokens to attend
        # to, which might seem a bit unusual, but is taken from
        # the original Transformer paper.
        with mpu.get_cuda_rng_tracker().fork():
            attention_probs = \
                    self.attention_dropout(attention_probs)

        # =========================
        # Context layer. [sq, b, hp]
        # =========================

        # value_layer -&gt; context layer.
        # [sk, b, np, hn] --&gt; [b, np, sq, hn]

        # context layer shape: [b, np, sq, hn]
        output_size = (
            value_layer.size(1),
            value_layer.size(2),
            query_layer.size(0),
            value_layer.size(3),
        )

        # change view [sk, b * np, hn]
        value_layer = value_layer.view(
            value_layer.size(0),
            output_size[0] * output_size[1], -1
        )

        # change view [b * np, sq, sk]
        attention_probs = attention_probs.view(
            output_size[0] * output_size[1], output_size[2], -1
        )

        # matmul: [b * np, sq, hn]
        context_layer = torch.bmm(attention_probs,
                                  value_layer.transpose(0, 1))

        # change view [b, np, sq, hn]
        context_layer = context_layer.view(*output_size)
        return context_layer

</pre>
</div>
<div id="A2.p4" class="ltx_para ltx_noindent">
<p id="A2.p4.1" class="ltx_p">The other one is the definition of <span id="A2.p4.1.1" class="ltx_text">forward</span> in <span id="A2.p4.1.2" class="ltx_text">ParallelSelfAttention</span>:</p>
</div>
<div id="A2.p5" class="ltx_para ltx_noindent">
<pre id="A2.p5.1" class="ltx_verbatim ltx_font_typewriter">

    def forward(self, hidden_states, attention_mask,
                layer_past=None
        ):

        # hidden_states: [sq, b, h]

        # =====================
        # Query, Key, and Value
        # =====================

        # Attention heads [sq, b, h] --&gt; [sq, b, (np * 3 * hn)]
        mixed_x_layer, _ = self.query_key_value(hidden_states)

        # [sq, b, (np * 3 * hn)] --&gt; [sq, b, np, 3 * hn]
        new_tensor_shape = mixed_x_layer.size()[:-1] + (
            self.num_attention_heads_per_partition,
            3 * self.hidden_size_per_attention_head,
        )
        mixed_x_layer = mixed_x_layer.view(*new_tensor_shape)

        # replace key_layer with t_layer
        (query_layer, t_layer, value_layer) = \
            mpu.split_tensor_along_last_dim(mixed_x_layer, 3)

        t_layer_1 = t_layer[..., : t_layer.shape[-1] // 2]
        t_layer_2 = t_layer[..., t_layer.shape[-1] // 2 :]
        t_layer = (t_layer_1+t_layer_2)/2

        t_layer = F.relu(t_layer)

        t_layer = torch.cat((t_layer, t_layer), dim=-1)

        if exists(self.rotary_emb):
            if exists(self.rotary_ndims):
                # partial rotary
                query_rot, query_pass = (
                    query_layer[..., : self.rotary_ndims],
                    query_layer[..., self.rotary_ndims :],
                )
                t_rot, t_pass = (
                    t_layer[..., : self.rotary_ndims],
                    t_layer[..., self.rotary_ndims :],
                )
            else:
                # full rotary
                query_rot, t_rot = query_layer, t_layer

            apply_rotary_fn = (
                apply_rotary_pos_emb_torch if self.bf16 \
                    else apply_rotary_pos_emb
            )

            seq_len = query_layer.shape[0]
            offset = 0
            if exists(layer_past) and layer_past.numel() &gt; 0:
                offset = layer_past[0].shape[0]
                seq_len += offset
            cos, sin = self.rotary_emb(value_layer,
                                       seq_len=seq_len)
            query_rot, t_layer = apply_rotary_fn(
                query_rot, t_rot, cos, sin, offset=offset
            )

            if exists(self.rotary_ndims):
                query_rot = torch.cat((query_rot, query_pass),
                                      dim=-1)
                t_layer = torch.cat((t_layer, t_pass), dim=-1)


        # ==================================
        # Cache key and value for inference
        # ==================================

        if exists(layer_past) and layer_past.numel() &gt; 0:
            past_t, past_value = layer_past
            t_layer = \
                torch.cat((past_t.type_as(t_layer), t_layer),
                          dim=0)
            value_layer = torch.cat(
                (past_value.type_as(value_layer), value_layer),
                dim=0
            )

        if self.use_cache:
            present = torch.stack((t_layer, value_layer))

        if self.use_flash_attention:
            context_layer = \
                self.flash_attention(query_layer, t_layer,
                                     value_layer)
        elif not self.sparse:
            context_layer = self.attention(
                query_layer, t_layer, query_rot, value_layer,
                layer_past, attention_mask
            )
        else:
            context_layer = self.sparse_attention(
                query_layer, t_layer, value_layer, attention_mask
            )

        # [b, np, sq, hn] --&gt; [sq, b, np, hn]
        context_layer = \
            context_layer.permute(2, 0, 1, 3).contiguous()

        # [sq, b, np, hn] --&gt; [sq, b, hp]
        new_context_layer_shape = context_layer.size()[:-2] + (
            self.hidden_size_per_partition,
        )
        context_layer = \
            context_layer.view(*new_context_layer_shape)

        # =================
        # Output. [sq, b, h]
        # =================

        output, bias = self.dense(context_layer)

        if self.use_cache:
            output = [output, present]

        return output, bias

</pre>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Parity check retrieval</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p">Experiments are not completed yet.
</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Sep 21 05:26:53 2023 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
